function P(r,o,i){return o>r?o:i<r?i:r}function W(r){return+(r>0)-+(r<0)}function er(r){return Math.round(r*1e4)/1e4}var J={};function or(r){return"-"+r[0].toLowerCase()}function R(r){return J[r]||(J[r]=r.replace(/([A-Z])/g,or))}function y(r,o){return!r||r.length===0?[]:r.nodeName?[r]:[].slice.call(r[0].nodeName?r:(o||document.documentElement).querySelectorAll(r))}function K(r,o){for(var i in o)i.indexOf("_")&&r.setAttribute("data-"+R(i),o[i])}function ir(r){return function(o,i){for(var u in i)u.indexOf("_")&&(r===!0||r[u])&&o.style.setProperty("--"+R(u),er(i[u]))}}var E,C=[];function ar(){E=0,C.slice().forEach(function(r){return r()}),V()}function V(){!E&&C.length&&(E=requestAnimationFrame(ar))}function lr(r){return C.push(r),V(),function(){C=C.filter(function(o){return o!==r}),!C.length&&E&&(cancelAnimationFrame(E),E=0)}}function Q(r,o,i,u){return typeof r=="function"?r(o,i,u):r}function O(){}function tr(r){r=r||{};var o=r.onChange||O,i=r.onHidden||O,u=r.onShown||O,k=r.onScroll||O,U=r.cssProps?ir(r.cssProps):O,T=r.scrollingElement,z=T?y(T)[0]:window,e=T?y(T)[0]:document.documentElement,L=!1,a={},d=[],f,c,X;function I(){d=y(r.targets||"[data-scroll]",y(r.scope||e)[0]).map(function(s){return{element:s}})}function F(){var s=e.clientWidth,t=e.clientHeight,l=W(-f+(f=e.scrollLeft||window.pageXOffset)),v=W(-c+(c=e.scrollTop||window.pageYOffset)),m=e.scrollLeft/(e.scrollWidth-s||1),S=e.scrollTop/(e.scrollHeight-t||1);L=L||a.scrollDirX!==l||a.scrollDirY!==v||a.scrollPercentX!==m||a.scrollPercentY!==S,a.scrollDirX=l,a.scrollDirY=v,a.scrollPercentX=m,a.scrollPercentY=S;for(var $=!1,Y=0;Y<d.length;Y++){var n=d[Y],h=n.element,p=h,g=0,w=0;do g+=p.offsetLeft,w+=p.offsetTop,p=p.offsetParent;while(p&&p!==z);var b=h.clientHeight||h.offsetHeight||0,A=h.clientWidth||h.offsetWidth||0,_=(P(g+A,f,f+s)-P(g,f,f+s))/A,q=(P(w+b,c,c+t)-P(w,c,c+t))/b,x=_===1?0:W(g-f),rr=q===1?0:W(w-c),j=P((f-(A/2+g-s/2))/(s/2),-1,1),B=P((c-(b/2+w-t/2))/(t/2),-1,1),D=void 0;r.offset?D=Q(r.offset,h,n,e)<=c?1:0:(Q(r.threshold,h,n,e)||0)<_*q?D=1:D=0;var G=n.visible!==D,nr=n._changed||G||n.visibleX!==_||n.visibleY!==q||n.index!==Y||n.elementHeight!==b||n.elementWidth!==A||n.offsetX!==g||n.offsetY!==w||n.intersectX!==n.intersectX||n.intersectY!==n.intersectY||n.viewportX!==j||n.viewportY!==B;nr&&($=!0,n._changed=!0,n._visibleChanged=G,n.visible=D,n.elementHeight=b,n.elementWidth=A,n.index=Y,n.offsetX=g,n.offsetY=w,n.visibleX=_,n.visibleY=q,n.intersectX=x,n.intersectY=rr,n.viewportX=j,n.viewportY=B,n.visible=D)}!X&&(L||$)&&(X=lr(M))}function M(){Z(),L&&(L=!1,K(e,{scrollDirX:a.scrollDirX,scrollDirY:a.scrollDirY}),U(e,a),k(e,a,d));for(var s=d.length,t=s-1;t>-1;t--){var l=d[t],v=l.element,m=l.visible,S=v.hasAttribute("scrollout-once")||!1;l._changed&&(l._changed=!1,U(v,l)),l._visibleChanged&&(K(v,{scroll:m?"in":"out"}),o(v,l,e),(m?u:i)(v,l,e)),m&&(r.once||S)&&d.splice(t,1)}}function Z(){X&&(X(),X=void 0)}I(),F(),M();var N=0,H=function(){N=N||setTimeout(function(){N=0,F()},0)};return window.addEventListener("resize",H),z.addEventListener("scroll",H),{index:I,update:F,teardown:function(){Z(),window.removeEventListener("resize",H),z.removeEventListener("scroll",H)}}}var cr=tr;export{cr as l};
