import{c as commonjsGlobal}from"./@editorjs.ba2deff0.js";var jsxgraphcore={exports:{}};(function(module,exports){(function(g,P){module.exports?module.exports=P():g.returnExports=P()})(typeof self!="undefined"?self:commonjsGlobal,function(){/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */var requirejs,require,define;return function(g){var P,y,v,m,l={},c={},h={},e={},o=Object.prototype.hasOwnProperty,t=[].slice,s=/\.js$/;function a(_,E){return o.call(_,E)}function d(_,E){var x,S,O,w,T,M,N,A,R,L,D,k=E&&E.split("/"),B=h.map,I=B&&B["*"]||{};if(_){for(T=(_=_.split("/")).length-1,h.nodeIdCompat&&s.test(_[T])&&(_[T]=_[T].replace(s,"")),_[0].charAt(0)==="."&&k&&(_=k.slice(0,k.length-1).concat(_)),R=0;R<_.length;R++)if((D=_[R])===".")_.splice(R,1),R-=1;else if(D===".."){if(R===0||R===1&&_[2]===".."||_[R-1]==="..")continue;R>0&&(_.splice(R-1,2),R-=2)}_=_.join("/")}if((k||I)&&B){for(R=(x=_.split("/")).length;R>0;R-=1){if(S=x.slice(0,R).join("/"),k){for(L=k.length;L>0;L-=1)if((O=B[k.slice(0,L).join("/")])&&(O=O[S])){w=O,M=R;break}}if(w)break;!N&&I&&I[S]&&(N=I[S],A=R)}!w&&N&&(w=N,M=A),w&&(x.splice(0,M,w),_=x.join("/"))}return _}function u(_,E){return function(){var x=t.call(arguments,0);return typeof x[0]!="string"&&x.length===1&&x.push(null),y.apply(g,x.concat([_,E]))}}function n(_){return function(E){l[_]=E}}function p(_){if(a(c,_)){var E=c[_];delete c[_],e[_]=!0,P.apply(g,E)}if(!a(l,_)&&!a(e,_))throw new Error("No "+_);return l[_]}function f(_){var E,x=_?_.indexOf("!"):-1;return x>-1&&(E=_.substring(0,x),_=_.substring(x+1,_.length)),[E,_]}function b(_){return _?f(_):[]}function C(_){return function(){return h&&h.config&&h.config[_]||{}}}v=function(_,E){var x,S,O=f(_),w=O[0],T=E[1];return _=O[1],w&&(x=p(w=d(w,T))),w?_=x&&x.normalize?x.normalize(_,(S=T,function(M){return d(M,S)})):d(_,T):(w=(O=f(_=d(_,T)))[0],_=O[1],w&&(x=p(w))),{f:w?w+"!"+_:_,n:_,pr:w,p:x}},m={require:function(_){return u(_)},exports:function(_){var E=l[_];return E!==void 0?E:l[_]={}},module:function(_){return{id:_,uri:"",exports:l[_],config:C(_)}}},P=function(_,E,x,S){var O,w,T,M,N,A,R,L=[],D=typeof x;if(A=b(S=S||_),D==="undefined"||D==="function"){for(E=!E.length&&x.length?["require","exports","module"]:E,N=0;N<E.length;N+=1)if((w=(M=v(E[N],A)).f)==="require")L[N]=m.require(_);else if(w==="exports")L[N]=m.exports(_),R=!0;else if(w==="module")O=L[N]=m.module(_);else if(a(l,w)||a(c,w)||a(e,w))L[N]=p(w);else{if(!M.p)throw new Error(_+" missing "+w);M.p.load(M.n,u(S,!0),n(w),{}),L[N]=l[w]}T=x?x.apply(l[_],L):void 0,_&&(O&&O.exports!==g&&O.exports!==l[_]?l[_]=O.exports:T===g&&R||(l[_]=T))}else _&&(l[_]=x)},requirejs=require=y=function(_,E,x,S,O){if(typeof _=="string")return m[_]?m[_](E):p(v(_,b(E)).f);if(!_.splice){if((h=_).deps&&y(h.deps,h.callback),!E)return;E.splice?(_=E,E=x,x=null):_=g}return E=E||function(){},typeof x=="function"&&(x=S,S=O),S?P(g,_,E,x):setTimeout(function(){P(g,_,E,x)},4),y},y.config=function(_){return y(_)},requirejs._defined=l,(define=function(_,E,x){if(typeof _!="string")throw new Error("See almond README: incorrect module build, no module name");E.splice||(x=E,E=[]),a(l,_)||a(c,_)||(c[_]=[_,E,x])}).amd={jQuery:!0}}(),define("../node_modules/almond/almond",function(){}),define("jxg",[],function(){var g={};return typeof JXG!="object"||JXG.extend||(g=JXG),g.extend=function(P,y,v,m){var l;for(l in v=v||!1,m=m||!1,y)(!v||v&&y.hasOwnProperty(l))&&(P[m?l.toLowerCase():l]=y[l])},g.defineConstant=function(P,y,v,m){(m=m||!1)&&g.exists(P[y])||Object.defineProperty(P,y,{value:v,writable:!1,enumerable:!0,configurable:!1})},g.extendConstants=function(P,y,v,m){var l,c;for(l in v=v||!1,m=m||!1,y)(!v||v&&y.hasOwnProperty(l))&&(c=m?l.toUpperCase():l,this.defineConstant(P,c,y[l]))},g.extend(g,{boards:{},readers:{},elements:{},registerElement:function(P,y){P=P.toLowerCase(),this.elements[P]=y},registerReader:function(P,y){var v,m;for(v=0;v<y.length;v++)m=y[v].toLowerCase(),typeof this.readers[m]!="function"&&(this.readers[m]=P)},shortcut:function(P,y){return function(){return P[y].apply(this,arguments)}},getRef:function(P,y){return g.deprecated("JXG.getRef()","Board.select()"),P.select(y)},getReference:function(P,y){return g.deprecated("JXG.getReference()","Board.select()"),P.select(y)},getBoardByContainerId:function(P){var y;for(y in JXG.boards)if(JXG.boards.hasOwnProperty(y)&&JXG.boards[y].container===P)return JXG.boards[y];return null},deprecated:function(P,y){var v=P+" is deprecated.";y&&(v+=" Please use "+y+" instead."),g.warn(v)},warn:function(P){typeof window=="object"&&window.console&&console.warn?console.warn("WARNING:",P):typeof document=="object"&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+P+"<br />")},debugInt:function(P){var y,v;for(y=0;y<arguments.length;y++)v=arguments[y],typeof window=="object"&&window.console&&console.log?console.log(v):typeof document=="object"&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=v+"<br/>")},debugWST:function(P){var y=new Error;g.debugInt.apply(this,arguments),y&&y.stack&&(g.debugInt("stacktrace"),g.debugInt(y.stack.split(`
`).slice(1).join(`
`)))},debugLine:function(P){var y=new Error;g.debugInt.apply(this,arguments),y&&y.stack&&g.debugInt("Called from",y.stack.split(`
`).slice(2,3).join(`
`))},debug:function(P){g.debugInt.apply(this,arguments)}}),g}),define("base/constants",["jxg"],function(g){var P,y="1.4.3";return P={version:y,licenseText:"JSXGraph v1.4.3 Copyright (C) see https://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_TYPE_FOREIGNOBJECT:31,OBJECT_TYPE_VIEW3D:32,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_REFLECTION_ON_LINE:4,GENTYPE_REFLECTION_ON_POINT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_POLYGONCOPY:48,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82},g.extendConstants(g,P),P}),define("utils/type",["jxg","base/constants"],function(g,P){return g.extend(g,{isId:function(y,v){return typeof v=="string"&&!!y.objects[v]},isName:function(y,v){return typeof v=="string"&&!!y.elementsByName[v]},isGroup:function(y,v){return typeof v=="string"&&!!y.groups[v]},isString:function(y){return typeof y=="string"},isNumber:function(y){return typeof y=="number"||Object.prototype.toString.call(y)==="[Object Number]"},isFunction:function(y){return typeof y=="function"},isArray:function(y){return Array.isArray?Array.isArray(y):y!==null&&typeof y=="object"&&typeof y.splice=="function"&&typeof y.join=="function"},isObject:function(y){return typeof y=="object"&&!this.isArray(y)},isPoint:function(y){return y!==null&&typeof y=="object"&&y.elementClass===P.OBJECT_CLASS_POINT},isPointType:function(y,v){var m,l;return!!this.isArray(v)||!!(this.isFunction(v)&&(m=v(),this.isArray(m)&&m.length>1))||(l=y.select(v),this.isPoint(l))},isTransformationOrArray:function(y){if(y!==null){if(this.isArray(y)&&y.length>0)return this.isTransformationOrArray(y[0]);if(typeof y=="object")return y.type===P.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(y,v){var m=!(y==null||y===null);return(v=v||!1)?m&&y!=="":m},isEmpty:function(y){return Object.keys(y).length===0},def:function(y,v){return this.exists(y)?y:v},str2Bool:function(y){return!this.exists(y)||(typeof y=="boolean"?y:!!this.isString(y)&&y.toLowerCase()==="true")},createEvalFunction:function(y,v,m){var l,c=[];for(l=0;l<m;l++)c[l]=g.createFunction(v[l],y,"",!0);return function(h){return c[h]()}},createFunction:function(y,v,m,l){var c=null;return this.exists(l)&&!l||!this.isString(y)?this.isFunction(y)?c=y:(this.isNumber(y)||this.isString(y))&&(c=function(){return y}):c=v.jc.snippet(y,!0,m,!0),c!==null&&(c.origin=y),c},providePoints:function(y,v,m,l,c){var h,e,o,t,s,a=0,d=[];for(this.isArray(v)||(v=[v]),o=v.length,this.exists(c)&&(a=c.length),a===0&&(t=this.copyAttributes(m,y.options,l)),h=0;h<o;++h)if(a>0&&(e=Math.min(h,a-1),t=this.copyAttributes(m,y.options,l,c[e])),this.isArray(v[h])&&v[h].length>1?(d.push(y.create("point",v[h],t)),d[d.length-1]._is_new=!0):this.isFunction(v[h])?(s=v[h](),this.isArray(s)&&s.length>1&&(d.push(y.create("point",[v[h]],t)),d[d.length-1]._is_new=!0)):d.push(y.select(v[h])),!this.isPoint(d[h]))return!1;return d},bind:function(y,v){return function(){return y.apply(v,arguments)}},evaluate:function(y){return this.isFunction(y)?y():y},indexOf:function(y,v,m){var l,c=this.exists(m);if(Array.indexOf&&!c)return y.indexOf(v);for(l=0;l<y.length;l++)if(c&&y[l][m]===v||!c&&y[l]===v)return l;return-1},eliminateDuplicates:function(y){var v,m=y.length,l=[],c={};for(v=0;v<m;v++)c[y[v]]=0;for(v in c)c.hasOwnProperty(v)&&l.push(v);return l},swap:function(y,v,m){var l;return l=y[v],y[v]=y[m],y[m]=l,y},uniqueArray:function(y){var v,m,l,c=[];if(y.length===0)return[];for(v=0;v<y.length;v++)if(l=this.isArray(y[v]),this.exists(y[v]))for(m=v+1;m<y.length;m++)l&&g.cmpArrays(y[v],y[m])?y[v]=[]:l||y[v]!==y[m]||(y[v]="");else y[v]="";for(m=0,v=0;v<y.length;v++)(l=this.isArray(y[v]))||y[v]===""?l&&y[v].length!==0&&(c[m]=y[v].slice(0),m++):(c[m]=y[v],m++);return y=c,c},isInArray:function(y,v){return g.indexOf(y,v)>-1},coordsArrayToMatrix:function(y,v){var m,l=[],c=[];for(m=0;m<y.length;m++)v?(l.push(y[m].usrCoords[1]),c.push(y[m].usrCoords[2])):c.push([y[m].usrCoords[1],y[m].usrCoords[2]]);return v&&(c=[l,c]),c},cmpArrays:function(y,v){var m;if(y===v)return!0;if(y.length!==v.length)return!1;for(m=0;m<y.length;m++)if(this.isArray(y[m])&&this.isArray(v[m])){if(!this.cmpArrays(y[m],v[m]))return!1}else if(y[m]!==v[m])return!1;return!0},removeElementFromArray:function(y,v){var m;for(m=0;m<y.length;m++)if(y[m]===v)return y.splice(m,1),y;return y},trunc:function(y,v){return v=g.def(v,0),this.toFixed(y,v)},_decimalAdjust:function(y,v,m){return m===void 0||+m==0?Math[y](v):(v=+v,m=+m,isNaN(v)||typeof m!="number"||m%1!=0?NaN:(v=v.toString().split("e"),+((v=(v=Math[y](+(v[0]+"e"+(v[1]?+v[1]-m:-m)))).toString().split("e"))[0]+"e"+(v[1]?+v[1]+m:m))))},_round10:function(y,v){return this._decimalAdjust("round",y,v)},_floor10:function(y,v){return this._decimalAdjust("floor",y,v)},_ceil10:function(y,v){return this._decimalAdjust("ceil",y,v)},toFixed:function(y,v){return this._round10(y,-v).toFixed(v)},autoDigits:function(y){var v=Math.abs(y);return v>.1?this.toFixed(y,2):v>=.01?this.toFixed(y,4):v>=1e-4?this.toFixed(y,6):y},keys:function(y,v){var m,l=[];for(m in y)v?y.hasOwnProperty(m)&&l.push(m):l.push(m);return l},clone:function(y){var v={};return v.prototype=y,v},cloneAndCopy:function(y,v){var m,l=function(){};for(m in l.prototype=y,v)l[m]=v[m];return l},merge:function(y,v){var m,l;for(m in v)if(v.hasOwnProperty(m))if(this.isArray(v[m]))for(y[m]||(y[m]=[]),l=0;l<v[m].length;l++)typeof v[m][l]=="object"?y[m][l]=this.merge(y[m][l],v[m][l]):y[m][l]=v[m][l];else typeof v[m]=="object"?(y[m]||(y[m]={}),y[m]=this.merge(y[m],v[m])):y[m]=v[m];return y},deepCopy:function(y,v,m){var l,c,h,e;if(m=m||!1,typeof y!="object"||y===null)return y;if(this.isArray(y))for(l=[],c=0;c<y.length;c++)typeof(h=y[c])=="object"?this.exists(h.board)?l[c]=h.id:l[c]=this.deepCopy(h):l[c]=h;else{for(c in l={},y)y.hasOwnProperty(c)&&(e=m?c.toLowerCase():c,(h=y[c])!==null&&typeof h=="object"?this.exists(h.board)?l[e]=h.id:l[e]=this.deepCopy(h):l[e]=h);for(c in v)v.hasOwnProperty(c)&&(e=m?c.toLowerCase():c,typeof(h=v[c])=="object"?this.isArray(h)||!this.exists(l[e])?l[e]=this.deepCopy(h):l[e]=this.deepCopy(l[e],h,m):l[e]=h)}return l},copyAttributes:function(y,v,m){var l,c,h,e,o,t={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(l=(h=arguments.length)<3||t[m]?g.deepCopy(v.elements,null,!0):{},h<4&&this.exists(m)&&this.exists(v.layer[m])&&(l.layer=v.layer[m]),e=v,o=!0,c=2;c<h;c++){if(!this.exists(e[arguments[c]])){o=!1;break}e=e[arguments[c]]}for(o&&(l=g.deepCopy(l,e,!0)),e=typeof y=="object"?y:{},o=!0,c=3;c<h;c++){if(!this.exists(e[arguments[c]])){o=!1;break}e=e[arguments[c]]}if(o&&this.extend(l,e,null,!0),arguments[2]==="board")return l;for(e=v,o=!0,c=2;c<h;c++){if(!this.exists(e[arguments[c]])){o=!1;break}e=e[arguments[c]]}return o&&this.exists(e.label)&&(l.label=g.deepCopy(e.label,l.label)),l.label=g.deepCopy(v.label,l.label),l},copyPrototypeMethods:function(y,v,m){var l;for(l in y.prototype[m]=v.prototype.constructor,v.prototype)v.prototype.hasOwnProperty(l)&&(y.prototype[l]=v.prototype[l])},toJSON:function(y,v){var m,l,c,h;if(v=g.def(v,!1),JSON.stringify&&!v)try{return JSON.stringify(y)}catch{}switch(typeof y){case"object":if(y){if(m=[],this.isArray(y)){for(c=0;c<y.length;c++)m.push(g.toJSON(y[c],v));return"["+m.join(",")+"]"}for(l in y)if(y.hasOwnProperty(l)){try{h=g.toJSON(y[l],v)}catch{h=""}v?m.push(l+":"+h):m.push('"'+l+'":'+h)}return"{"+m.join(",")+"} "}return"null";case"string":return"'"+y.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return y.toString()}return"0"},clearVisPropOld:function(y){return y.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",tabindex:-1e5,transitionduration:0,top:-1e5,visible:null},y},isInObject:function(y,v){var m;for(m in y)if(y.hasOwnProperty(m)&&y[m]===v)return!0;return!1},escapeHTML:function(y){return y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(y){return y.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(y){return y.charAt(0).toUpperCase()+y.substring(1).toLowerCase()},trimNumber:function(y){return(y=(y=y.replace(/^0+/,"")).replace(/0+$/,""))[y.length-1]!=="."&&y[y.length-1]!==","||(y=y.slice(0,-1)),y[0]!=="."&&y[0]!==","||(y="0"+y),y},filterElements:function(y,v){var m,l,c,h,e,o,t,s=y.length,a=[];if(typeof v!="function"&&typeof v!="object")return a;for(m=0;m<s;m++){if(t=!0,c=y[m],typeof v=="object"){for(l in v)if(v.hasOwnProperty(l)&&(h=l.toLowerCase(),e=typeof c[l]=="function"?c[l]():c[l],o=c.visProp&&typeof c.visProp[h]=="function"?c.visProp[h]():c.visProp&&c.visProp[h],!(t=typeof v[l]=="function"?v[l](e)||v[l](o):e===v[l]||o===v[l])))break}else typeof v=="function"&&(t=v(c));t&&a.push(c)}return a},trim:function(y){return y.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(y,v){return typeof html_sanitize=="function"&&v?html_sanitize(y,function(){},function(m){return m}):(y&&typeof y=="string"&&(y=y.replace(/</g,"&lt;").replace(/>/g,"&gt;")),y)},evalSlider:function(y){return y&&y.type===P.OBJECT_TYPE_GLIDER&&typeof y.Value=="function"?y.Value():y}}),g}),define("utils/env",["jxg","utils/type"],function(g,P){return g.extendConstants(g,{touchProperty:"touches"}),g.extend(g,{isTouchEvent:function(y){return g.exists(y[g.touchProperty])},isPointerEvent:function(y){return g.exists(y.pointerId)},isMouseEvent:function(y){return!g.isTouchEvent(y)&&!g.isPointerEvent(y)},getNumberOfTouchPoints:function(y){var v=-1;return g.isTouchEvent(y)&&(v=y[g.touchProperty].length),v},isFirstTouch:function(y){var v=g.getNumberOfTouchPoints(y);return g.isPointerEvent(y)?y.isPrimary:v===1},isBrowser:typeof window=="object"&&typeof document=="object",supportsES6:function(){try{return new Function("(a = 0) => a"),!0}catch{return!1}},supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var y=!1;if(this.isNode())try{y=!!module.require("canvas")}catch{}return y||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&(!!module.exports||typeof commonjsGlobal=="object"&&commonjsGlobal.requirejsVars&&!commonjsGlobal.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&typeof self=="object"&&typeof self.postMessage=="function"},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&window.ontouchstart!==void 0},isAndroid:function(){return P.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return P.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z.]*Safari/)>-1},isMetroApp:function(){return typeof window=="object"&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return P.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1},isFirefoxOS:function(){return P.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")===-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var y,v,m=3;if(typeof document!="object")return 0;v=(y=document.createElement("div")).getElementsByTagName("i");do y.innerHTML="<!--[if gt IE "+ ++m+"]><i></i><![endif]-->";while(v[0]);return m>4?m:void 0}(),getDimensions:function(y,v){var m,l,c,h,e,o,t,s,a,d=/\d+(\.\d*)?px/;if(!this.isBrowser||y===null)return{width:500,height:500};if(m=(v=v||document).getElementById(y),!P.exists(m))throw new Error(`
JSXGraph: HTML container element '`+y+"' not found.");return(l=m.style.display)!=="none"&&l!==null?m.clientWidth>0&&m.clientHeight>0?{width:m.clientWidth,height:m.clientHeight}:(a=window.getComputedStyle?window.getComputedStyle(m):m.style,{width:d.test(a.width)?parseFloat(a.width):0,height:d.test(a.height)?parseFloat(a.height):0}):(h=(c=m.style).visibility,e=c.position,o=c.display,c.visibility="hidden",c.position="absolute",c.display="block",t=m.clientWidth,s=m.clientHeight,c.display=o,c.position=e,c.visibility=h,{width:t,height:s})},addEvent:function(y,v,m,l){var c=function(){return m.apply(l,arguments)};c.origin=m,l["x_internal"+v]=l["x_internal"+v]||[],l["x_internal"+v].push(c),P.exists(y)&&P.exists(y.addEventListener)&&y.addEventListener(v,c,!1),P.exists(y)&&P.exists(y.attachEvent)&&y.attachEvent("on"+v,c)},removeEvent:function(y,v,m,l){var c;if(P.exists(l))if(P.exists(l["x_internal"+v]))if(P.isArray(l["x_internal"+v]))if((c=P.indexOf(l["x_internal"+v],m,"origin"))!==-1){try{P.exists(y)&&P.exists(y.removeEventListener)&&y.removeEventListener(v,l["x_internal"+v][c],!1),P.exists(y)&&P.exists(y.detachEvent)&&y.detachEvent("on"+v,l["x_internal"+v][c])}catch{g.debug("event not registered in browser: ("+v+" -- "+m+")")}l["x_internal"+v].splice(c,1)}else g.debug("removeEvent: no such event function in internal list: "+m);else g.debug("owner[x_internal + "+v+"] is not an array");else g.debug("no such type: "+v);else g.debug("no such owner")},removeAllEvents:function(y,v,m){var l;if(m["x_internal"+v]){for(l=m["x_internal"+v].length-1;l>=0;l--)g.removeEvent(y,v,m["x_internal"+v][l].origin,m);m["x_internal"+v].length>0&&g.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(y,v,m){var l,c,h,e=0,o=0;if(y||(y=window.event),h=y[g.touchProperty],P.exists(h)&&h.length===0&&(h=y.changedTouches),P.exists(v)&&P.exists(h))if(v===-1){for(c=h.length,l=0;l<c;l++)if(h[l]){y=h[l];break}}else y=h[v];return y.clientX&&(e=y.clientX,o=y.clientY),[e,o]},getOffset:function(y){var v,m=y,l=y,c=m.offsetLeft-m.scrollLeft,h=m.offsetTop-m.scrollTop;for(c=(v=this.getCSSTransform([c,h],m))[0],h=v[1],m=m.offsetParent;m;){for(c+=m.offsetLeft,h+=m.offsetTop,m.offsetParent&&(c+=m.clientLeft-m.scrollLeft,h+=m.clientTop-m.scrollTop),c=(v=this.getCSSTransform([c,h],m))[0],h=v[1],l=l.parentNode;l!==m;)c+=l.clientLeft-l.scrollLeft,h+=l.clientTop-l.scrollTop,c=(v=this.getCSSTransform([c,h],l))[0],h=v[1],l=l.parentNode;m=m.offsetParent}return[c,h]},getStyle:function(y,v){var m,l=y.ownerDocument;return l.defaultView&&l.defaultView.getComputedStyle?m=l.defaultView.getComputedStyle(y,null).getPropertyValue(v):y.currentStyle&&g.ieVersion>=9?m=y.currentStyle[v]:y.style&&(v=v.replace(/-([a-z]|[0-9])/gi,function(c,h){return h.toUpperCase()}),m=y.style[v]),m},getProp:function(y,v){var m=parseInt(this.getStyle(y,v),10);return isNaN(m)?0:m},getCSSTransform:function(y,v){var m,l,c,h,e,o,t,s=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(e=s.length,m=0,c="";m<e;m++)if(P.exists(v.style[s[m]])){c=v.style[s[m]];break}if(c!==""&&(h=c.indexOf("("))>0){for(e=c.length,l=0,o=(t=c.substring(h+1,e-1).split(",")).length;l<o;l++)t[l]=parseFloat(t[l]);c.indexOf("matrix")===0?(y[0]+=t[4],y[1]+=t[5]):c.indexOf("translateX")===0?y[0]+=t[0]:c.indexOf("translateY")===0?y[1]+=t[0]:c.indexOf("translate")===0&&(y[0]+=t[0],y[1]+=t[1])}return P.exists(v.style.zoom)&&(c=v.style.zoom)!==""&&(y[0]*=parseFloat(c),y[1]*=parseFloat(c)),y},getCSSTransformMatrix:function(y){var v,m,l,c,h,e,o,t,s=y.ownerDocument,a=["transform","webkitTransform","MozTransform","msTransform","oTransform"],d=[[1,0,0],[0,1,0],[0,0,1]];if(s.defaultView&&s.defaultView.getComputedStyle)l=(t=s.defaultView.getComputedStyle(y,null)).getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform");else for(h=a.length,v=0,l="";v<h;v++)if(P.exists(y.style[a[v]])){l=y.style[a[v]];break}if(l!==""&&(c=l.indexOf("("))>0){for(h=l.length,m=0,e=(o=l.substring(c+1,h-1).split(",")).length;m<e;m++)o[m]=parseFloat(o[m]);l.indexOf("matrix")===0?d=[[1,0,0],[0,o[0],o[1]],[0,o[2],o[3]]]:l.indexOf("scaleX")===0?d[1][1]=o[0]:l.indexOf("scaleY")===0?d[2][2]=o[0]:l.indexOf("scale")===0&&(d[1][1]=o[0],d[2][2]=o[1])}return P.exists(y.style.zoom)&&(l=y.style.zoom)!==""&&(d[1][1]*=parseFloat(l),d[2][2]*=parseFloat(l)),d},timedChunk:function(y,v,m,l){var c=y.concat(),h=function(){var e=+new Date;do v.call(m,c.shift());while(c.length>0&&+new Date-e<300);c.length>0?window.setTimeout(h,1):l(y)};window.setTimeout(h,1)},_getScaleFactors:function(y){var v=y.getBoundingClientRect().width,m=y.getBoundingClientRect().height,l=window.screen.width/v,c=window.screen.height/m,h=.5*(window.screen.height-m),e=Math.min(l,c);return window.matchMedia&&window.matchMedia("(orientation:landscape)").matches&&window.screen.width<window.screen.height&&(l=window.screen.height/v,c=window.screen.width/m,e=Math.min(l,c),h=.5*(window.screen.width-m)),{scale:e*=.85,vshift:h,width:v}},scaleJSXGraphDiv:function(y,v,m,l){var c,h,e=document.styleSheets.length,o=[":fullscreen",":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"],t=o.length,s="{margin:0 auto;transform:matrix("+m+",0,0,"+m+",0,"+l+");}",a=new RegExp(".*#"+y+":.*full.*screen.*#"+v+".*auto;.*transform:.*matrix");for(e===0&&((c=document.createElement("style")).appendChild(document.createTextNode("")),document.body.appendChild(c),e=document.styleSheets.length),document.styleSheets[e-1].cssRules.length>0&&a.test(document.styleSheets[e-1].cssRules[0].cssText)&&document.styleSheets[e-1].deleteRule&&document.styleSheets[e-1].deleteRule(0),h=0;h<t;h++)try{document.styleSheets[e-1].insertRule("#"+y+o[h]+" #"+v+s,0);break}catch{}h===t&&(console.log("JXG.scaleJSXGraphDiv: Could not add any CSS rule."),console.log("One possible reason could be that the id of the JSXGraph container does not start with a letter."))}}),g}),define("utils/xml",["jxg","utils/type"],function(g,P){return g.XML={cleanWhitespace:function(y){for(var v=y.firstChild;P.exists(v);)v.nodeType!==3||/\S/.test(v.nodeValue)?v.nodeType===1&&this.cleanWhitespace(v):y.removeChild(v),v=v.nextSibling},parse:function(y){var v,m;return m=typeof DOMParser=="function"||typeof DOMParser=="object"?DOMParser:function(){this.parseFromString=function(l){var c;return typeof ActiveXObject=="function"&&(c=new ActiveXObject("MSXML.DomDocument")).loadXML(l),c}},v=new m().parseFromString(y,"text/xml"),this.cleanWhitespace(v),v}},g.XML}),define("utils/event",["jxg","utils/type"],function(g,P){return g.EventEmitter={eventHandlers:{},suspended:{},trigger:function(y,v){var m,l,c,h,e,o;for(e=y.length,l=0;l<e;l++)if(h=this.eventHandlers[y[l]],!this.suspended[y[l]]){if(this.suspended[y[l]]=!0,h)for(o=h.length,m=0;m<o;m++)(c=h[m]).handler.apply(c.context,v);this.suspended[y[l]]=!1}return this},on:function(y,v,m){return P.isArray(this.eventHandlers[y])||(this.eventHandlers[y]=[]),m=P.def(m,this),this.eventHandlers[y].push({handler:v,context:m}),this},off:function(y,v){var m;return y&&P.isArray(this.eventHandlers[y])?(v?((m=P.indexOf(this.eventHandlers[y],v,"handler"))>-1&&this.eventHandlers[y].splice(m,1),this.eventHandlers[y].length===0&&delete this.eventHandlers[y]):delete this.eventHandlers[y],this):this},eventify:function(y){y.eventHandlers={},y.on=this.on,y.off=this.off,y.triggerEventHandlers=this.trigger,y.trigger=this.trigger,y.suspended={}}},g.EventEmitter}),define("math/math",["jxg","utils/type"],function(g,P){var y,v=function(m){var l,c;return m.memo||(l={},c=Array.prototype.join,m.memo=function(){var h=c.call(arguments);return l[h]!==y?l[h]:l[h]=m.apply(this,arguments)}),m.memo};return g.Math={eps:1e-6,relDif:function(m,l){var c=Math.abs(m),h=Math.abs(l);return(h=Math.max(c,h))===0?0:Math.abs(m-l)/h},mod:function(m,l){return m-Math.floor(m/l)*l},vector:function(m,l){var c,h;for(l=l||0,c=[],h=0;h<m;h++)c[h]=l;return c},matrix:function(m,l,c){var h,e,o;for(c=c||0,l=l||m,h=[],e=0;e<m;e++)for(h[e]=[],o=0;o<l;o++)h[e][o]=c;return h},identity:function(m,l){var c,h;for(l===y&&typeof l!="number"&&(l=m),c=this.matrix(m,l),h=0;h<Math.min(m,l);h++)c[h][h]=1;return c},frustum:function(m,l,c,h,e,o){var t=this.matrix(4,4);return t[0][0]=2*e/(l-m),t[0][1]=0,t[0][2]=(l+m)/(l-m),t[0][3]=0,t[1][0]=0,t[1][1]=2*e/(h-c),t[1][2]=(h+c)/(h-c),t[1][3]=0,t[2][0]=0,t[2][1]=0,t[2][2]=-(o+e)/(o-e),t[2][3]=-o*e*2/(o-e),t[3][0]=0,t[3][1]=0,t[3][2]=-1,t[3][3]=0,t},projection:function(m,l,c,h){var e=c*Math.tan(m/2),o=e*l;return this.frustum(-o,o,-e,e,c,h)},matVecMult:function(m,l){var c,h,e,o=m.length,t=l.length,s=[];if(t===3)for(c=0;c<o;c++)s[c]=m[c][0]*l[0]+m[c][1]*l[1]+m[c][2]*l[2];else for(c=0;c<o;c++){for(h=0,e=0;e<t;e++)h+=m[c][e]*l[e];s[c]=h}return s},matMatMult:function(m,l){var c,h,e,o,t=m.length,s=t>0?l[0].length:0,a=l.length,d=this.matrix(t,s);for(c=0;c<t;c++)for(h=0;h<s;h++){for(e=0,o=0;o<a;o++)e+=m[c][o]*l[o][h];d[c][h]=e}return d},transpose:function(m){var l,c,h,e,o;for(e=m.length,o=m.length>0?m[0].length:0,l=this.matrix(o,e),c=0;c<o;c++)for(h=0;h<e;h++)l[c][h]=m[h][c];return l},inverse:function(m){var l,c,h,e,o,t,s,a=m.length,d=[],u=[],n=[];for(l=0;l<a;l++){for(d[l]=[],c=0;c<a;c++)d[l][c]=m[l][c];u[l]=l}for(c=0;c<a;c++){for(o=Math.abs(d[c][c]),t=c,l=c+1;l<a;l++)Math.abs(d[l][c])>o&&(o=Math.abs(d[l][c]),t=l);if(o<=this.eps)return[];if(t>c){for(h=0;h<a;h++)s=d[c][h],d[c][h]=d[t][h],d[t][h]=s;s=u[c],u[c]=u[t],u[t]=s}for(e=1/d[c][c],l=0;l<a;l++)d[l][c]*=e;for(d[c][c]=e,h=0;h<a;h++)if(h!==c){for(l=0;l<a;l++)l!==c&&(d[l][h]-=d[l][c]*d[c][h]);d[c][h]=-e*d[c][h]}}for(l=0;l<a;l++){for(h=0;h<a;h++)n[u[h]]=d[l][h];for(h=0;h<a;h++)d[l][h]=n[h]}return d},innerProduct:function(m,l,c){var h,e=0;for(c!==y&&P.isNumber(c)||(c=m.length),h=0;h<c;h++)e+=m[h]*l[h];return e},crossProduct:function(m,l){return[m[1]*l[2]-m[2]*l[1],m[2]*l[0]-m[0]*l[2],m[0]*l[1]-m[1]*l[0]]},norm:function(m,l){var c,h=0;for(l!==y&&P.isNumber(l)||(l=m.length),c=0;c<l;c++)h+=m[c]*m[c];return Math.sqrt(h)},axpy:function(m,l,c){var h,e=l.length,o=[];for(h=0;h<e;h++)o[h]=m*l[h]+c[h];return o},factorial:v(function(m){return m<0?NaN:(m=Math.floor(m))===0||m===1?1:m*this.factorial(m-1)}),binomial:v(function(m,l){var c,h;if(l>m||l<0)return NaN;if(l=Math.round(l),m=Math.round(m),l===0||l===m)return 1;for(c=1,h=0;h<l;h++)c*=m-h,c/=h+1;return c}),cosh:Math.cosh||function(m){return .5*(Math.exp(m)+Math.exp(-m))},sinh:Math.sinh||function(m){return .5*(Math.exp(m)-Math.exp(-m))},acosh:Math.acosh||function(m){return Math.log(m+Math.sqrt(m*m-1))},asinh:Math.asinh||function(m){return m===-1/0?m:Math.log(m+Math.sqrt(m*m+1))},cot:function(m){return 1/Math.tan(m)},acot:function(m){return(m>=0?.5:-.5)*Math.PI-Math.atan(m)},nthroot:function(m,l){var c=1/l;return l<=0||Math.floor(l)!==l?NaN:m===0?0:m>0?Math.exp(c*Math.log(m)):l%2==1?-Math.exp(c*Math.log(-m)):NaN},cbrt:Math.cbrt||function(m){return this.nthroot(m,3)},pow:function(m,l){return m===0?l===0?1:0:Math.floor(l)===l?Math.pow(m,l):m>0?Math.exp(l*Math.log(m)):NaN},ratpow:function(m,l,c){var h;return l===0?1:c===0?NaN:(h=this.gcd(l,c),this.nthroot(this.pow(m,l/h),c/h))},log10:function(m){return Math.log(m)/Math.log(10)},log2:function(m){return Math.log(m)/Math.log(2)},log:function(m,l){return l!==void 0&&P.isNumber(l)?Math.log(m)/Math.log(l):Math.log(m)},sign:Math.sign||function(m){return(m=+m)==0||isNaN(m)?m:m>0?1:-1},squampow:function(m,l){var c;if(Math.floor(l)===l){for(c=1,l<0&&(m=1/m,l*=-1);l!==0;)1&l&&(c*=m),l>>=1,m*=m;return c}return this.pow(m,l)},gcd:function(m,l){if(m=Math.abs(m),l=Math.abs(l),!P.isNumber(m)||!P.isNumber(l))return NaN;if(l>m){var c=m;m=l,l=c}for(;;){if((m%=l)===0)return l;if((l%=m)===0)return m}},lcm:function(m,l){var c;return P.isNumber(m)&&P.isNumber(l)?(c=m*l)!==0?c/this.gcd(m,l):0:NaN},erf:function(m){return this.ProbFuncs.erf(m)},erfc:function(m){return this.ProbFuncs.erfc(m)},erfi:function(m){return this.ProbFuncs.erfi(m)},ndtr:function(m){return this.ProbFuncs.ndtr(m)},ndtri:function(m){return this.ProbFuncs.ndtri(m)},lt:function(m,l){return m<l},leq:function(m,l){return m<=l},gt:function(m,l){return m>l},geq:function(m,l){return m>=l},eq:function(m,l){return m===l},neq:function(m,l){return m!==l},and:function(m,l){return m&&l},not:function(m){return!m},or:function(m,l){return m||l},xor:function(m,l){return(m||l)&&!(m&&l)},normalize:function(m){var l,c,h=2*m[3],e=m[4]/h;return m[5]=e,m[6]=-m[1]/h,m[7]=-m[2]/h,isFinite(e)?Math.abs(e)>=1?(m[0]=(m[6]*m[6]+m[7]*m[7]-e*e)/(2*e),m[1]=-m[6]/e,m[2]=-m[7]/e,m[3]=1/(2*e),m[4]=1):(c=e<=0?-1:1,m[0]=c*(m[6]*m[6]+m[7]*m[7]-e*e)*.5,m[1]=-c*m[6],m[2]=-c*m[7],m[3]=c/2,m[4]=c*e):(l=Math.sqrt(m[1]*m[1]+m[2]*m[2]),m[0]/=l,m[1]/=l,m[2]/=l,m[3]=0,m[4]=1),m},toGL:function(m){var l,c,h;if(l=typeof Float32Array=="function"?new Float32Array(16):new Array(16),m.length!==4&&m[0].length!==4)return l;for(c=0;c<4;c++)for(h=0;h<4;h++)l[c+4*h]=m[c][h];return l},Vieta:function(m){var l,c,h,e=m.length,o=[];for(o=m.slice(),l=1;l<e;++l){for(h=o[l],o[l]*=o[l-1],c=l-1;c>=1;--c)o[c]+=o[c-1]*h;o[0]+=h}return o}},g.Math}),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],function(g,P,y,v,m){return g.Coords=function(l,c,h,e){this.board=h,this.usrCoords=[],this.scrCoords=[],this.emitter=!v.exists(e)||e,this.emitter&&y.eventify(this),this.setCoordinates(l,c,!1,!0)},g.extend(g.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>m.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(l){var c=Math.round,h=this.board,e=this.usrCoords,o=h.origin.scrCoords;l===!0?(this.scrCoords[0]=c(e[0]),this.scrCoords[1]=c(e[0]*o[1]+e[1]*h.unitX),this.scrCoords[2]=c(e[0]*o[2]-e[2]*h.unitY)):(this.scrCoords[0]=e[0],this.scrCoords[1]=e[0]*o[1]+e[1]*h.unitX,this.scrCoords[2]=e[0]*o[2]-e[2]*h.unitY)},screen2usr:function(){var l=this.board.origin.scrCoords,c=this.scrCoords,h=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(c[1]-l[1])/h.unitX,this.usrCoords[2]=(l[2]-c[2])/h.unitY},distance:function(l,c){var h,e,o=0,t=this.usrCoords,s=this.scrCoords;if(l===P.COORDS_BY_USER){if(h=c.usrCoords,(o=(e=t[0]-h[0])*e)>m.eps*m.eps)return Number.POSITIVE_INFINITY;o+=(e=t[1]-h[1])*e,o+=(e=t[2]-h[2])*e}else h=c.scrCoords,o+=(e=s[1]-h[1])*e,o+=(e=s[2]-h[2])*e;return Math.sqrt(o)},setCoordinates:function(l,c,h,e){var o=this.usrCoords,t=this.scrCoords,s=[o[0],o[1],o[2]],a=[t[0],t[1],t[2]];return l===P.COORDS_BY_USER?(c.length===2?(o[0]=1,o[1]=c[0],o[2]=c[1]):(o[0]=c[0],o[1]=c[1],o[2]=c[2],this.normalizeUsrCoords()),this.usr2screen(h)):(c.length===2?(t[1]=c[0],t[2]=c[1]):(t[1]=c[1],t[2]=c[2]),this.screen2usr()),!this.emitter||e||a[1]===t[1]&&a[2]===t[2]||this.triggerEventHandlers(["update"],[s,a]),this},copy:function(l,c){return c===void 0&&(c=0),this[l].slice(c)},isReal:function(){return!isNaN(this.usrCoords[1]+this.usrCoords[2])&&Math.abs(this.usrCoords[0])>m.eps},__evt__update:function(l,c){},__evt:function(){}}),g.Coords}),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],function(g,P,y,v){var m={each:function(l,c,h){var e,o,t=[];if(P.exists(l.length))for(o=l.length,e=0;e<o;e++)t.push(c.call(this,l[e],h));return t},coords:function(l,c){var h=l;return l&&l.elementClass===y.OBJECT_CLASS_POINT?h=l.coords:l.usrCoords&&l.scrCoords&&l.usr2screen&&(h=l),c&&(h=new v(y.COORDS_BY_USER,h.usrCoords,h.board)),h},coordsArray:function(l,c){var h;return(h=P.isArray(l)?l:this.coords(l).usrCoords).length<3&&h.unshift(1),c&&(h=[h[0],h[1],h[2]]),h}};return g.Expect=m,m}),define("math/probfuncs",["math/math","utils/type"],function(g,P){return g.ProbFuncs={MAXNUM:17014118346046923e22,SQRTH:.7071067811865476,SQRT2:1.4142135623730951,MAXLOG:708.3964185322641,P:[2461969814735305e-25,.5641895648310689,7.463210564422699,48.63719709856814,196.5208329560771,526.4451949954773,934.5285271719576,1027.5518868951572,557.5353353693994],Q:[13.228195115474499,86.70721408859897,354.9377788878199,975.7085017432055,1823.9091668790973,2246.3376081871097,1656.6630919416134,557.5353408177277],R:[.5641895835477551,1.275366707599781,5.019050422511805,6.160210979930536,7.4097426995044895,2.9788666537210022],S:[2.2605286322011726,9.396035249380015,12.048953980809666,17.08144507475659,9.608968090632859,3.369076451000815],T:[9.604973739870516,90.02601972038427,2232.005345946843,7003.325141128051,55592.30130103949],U:[33.56171416475031,521.3579497801527,4594.323829709801,22629.000061389095,49267.39426086359],M:128,MINV:.0078125,expx2:function(y,v){var m,l,c,h;return y=Math.abs(y),v<0&&(y=-y),m=(c=this.MINV*Math.floor(this.M*y+.5))*c,l=2*c*(h=y-c)+h*h,v<0&&(m=-m,l=-l),m+l>this.MAXLOG?1/0:m=Math.exp(m)*Math.exp(l)},polevl:function(y,v,m){var l,c;if(P.exists(v.reduce))return v.reduce(function(h,e){return h*y+e},0);for(c=0,l=0;c<=m;c++)l=l*y+v[c];return l},p1evl:function(y,v,m){var l,c;if(P.exists(v.reduce))return v.reduce(function(h,e){return h*y+e},1);for(c=0,l=1;c<m;c++)l=l*y+v[c];return l},ndtr:function(y){var v,m,l;return v=y*this.SQRTH,(l=Math.abs(v))<1?m=.5+.5*this.erf(v):(m=.5*this.erfce(l),l=this.expx2(y,-1),m*=Math.sqrt(l),v>0&&(m=1-m)),m},_underflow:function(y){return console.log("erfc","UNDERFLOW"),y<0?2:0},erfc:function(y){var v,m,l,c,h;return(l=y<0?-y:y)<1?1-this.erf(y):(h=-y*y)<-this.MAXLOG?this._underflow(y):(h=this.expx2(y,-1),l<8?(v=this.polevl(l,this.P,8),m=this.p1evl(l,this.Q,8)):(v=this.polevl(l,this.R,5),m=this.p1evl(l,this.S,6)),c=h*v/m,y<0&&(c=2-c),c===0?this._underflow(y):c)},erfce:function(y){var v,m;return y<8?(v=this.polevl(y,this.P,8),m=this.p1evl(y,this.Q,8)):(v=this.polevl(y,this.R,5),m=this.p1evl(y,this.S,6)),v/m},erf:function(y){var v;return Math.abs(y)>1?1-this.erfc(y):(v=y*y,y*this.polevl(v,this.T,4)/this.p1evl(v,this.U,5))},s2pi:2.5066282746310007,P0:[-59.96335010141079,98.00107541859997,-56.67628574690703,13.931260938727968,-1.2391658386738125],Q0:[1.9544885833814176,4.676279128988815,86.36024213908905,-225.46268785411937,200.26021238006066,-82.03722561683334,15.90562251262117,-1.1833162112133],P1:[4.0554489230596245,31.525109459989388,57.16281922464213,44.08050738932008,14.684956192885803,2.1866330685079025,-.1402560791713545,-.03504246268278482,-.0008574567851546854],Q1:[15.779988325646675,45.39076351288792,41.3172038254672,15.04253856929075,2.504649462083094,-.14218292285478779,-.03808064076915783,-.0009332594808954574],P2:[3.2377489177694603,6.915228890689842,3.9388102529247444,1.3330346081580755,.20148538954917908,.012371663481782003,.00030158155350823543,26580697468673755e-22,6239745391849833e-24],Q2:[6.02427039364742,3.6798356385616087,1.3770209948908132,.21623699359449663,.013420400608854318,.00032801446468212774,28924786474538068e-22,6790194080099813e-24],ndtri:function(y){var v,m,l,c,h;return y<=0?-1/0:y>=1?1/0:(h=1,(m=y)>.8646647167633873&&(m=1-m,h=0),m>.1353352832366127?(v=(m-=.5)+m*((c=m*m)*this.polevl(c,this.P0,4)/this.p1evl(c,this.Q0,8)),v*=this.s2pi):(l=1/(v=Math.sqrt(-2*Math.log(m))),v=v-Math.log(v)/v-(v<8?l*this.polevl(l,this.P1,8)/this.p1evl(l,this.Q1,8):l*this.polevl(l,this.P2,8)/this.p1evl(l,this.Q2,8)),h!==0&&(v=-v),v))},erfi:function(y){return this.ndtri(.5*(y+1))*this.SQRTH}},g.ProbFuncs}),define("math/ia",["jxg","math/math","utils/type"],function(g,P,y){g.Math.DoubleBits=function(){var l,c,h,e,o,t,s,a,d=new Float64Array(1),u=new Uint32Array(d.buffer);Float64Array!==void 0&&(d[0]=1,u[1]===1072693248?(l=function(n){return d[0]=n,[u[0],u[1]]},c=function(n,p){return u[0]=n,u[1]=p,d[0]},h=function(n){return d[0]=n,u[0]},e=function(n){return d[0]=n,u[1]},this.doubleBits=l,this.pack=c,this.lo=h,this.hi=e):u[0]===1072693248&&(o=function(n){return d[0]=n,[u[1],u[0]]},t=function(n,p){return u[1]=n,u[0]=p,d[0]},s=function(n){return d[0]=n,u[1]},a=function(n){return d[0]=n,u[0]},this.doubleBits=o,this.pack=t,this.lo=s,this.hi=a))},g.extend(g.Math.DoubleBits.prototype,{sign:function(l){return this.hi(l)>>>31},exponent:function(l){return(this.hi(l)<<1>>>21)-1023},fraction:function(l){var c=this.lo(l),h=this.hi(l),e=1048575&h;return 2146435072&h&&(e+=1<<20),[c,e]},denormalized:function(l){return!(2146435072&this.hi(l))}});var v=new g.Math.DoubleBits,m=function(l,c){if(l!==void 0&&c!==void 0){if(P.IntervalArithmetic.isInterval(l)){if(!P.IntervalArithmetic.isSingleton(l))throw new TypeError("JXG.Math.IntervalArithmetic: interval `lo` must be a singleton");this.lo=l.lo}else this.lo=l;if(P.IntervalArithmetic.isInterval(c)){if(!P.IntervalArithmetic.isSingleton(c))throw new TypeError("JXG.Math.IntervalArithmetic: interval `hi` must be a singleton");this.hi=c.hi}else this.hi=c}else{if(l!==void 0)return Array.isArray(l)?new m(l[0],l[1]):new m(l,l);this.lo=this.hi=0}};return g.extend(m.prototype,{print:function(){console.log("[",this.lo,this.hi,"]")},set:function(l,c){return this.lo=l,this.hi=c,this},bounded:function(l,c){return this.set(P.IntervalArithmetic.prev(l),P.IntervalArithmetic.next(c))},boundedSingleton:function(l){return this.bounded(l,l)},assign:function(l,c){if(typeof l!="number"||typeof c!="number")throw new TypeError("JXG.Math.Interval#assign: arguments must be numbers");return isNaN(l)||isNaN(c)||l>c?this.setEmpty():this.set(l,c)},setEmpty:function(){return this.set(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},setWhole:function(){return this.set(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY)},open:function(l,c){return this.assign(P.IntervalArithmetic.next(l),P.IntervalArithmetic.prev(c))},halfOpenLeft:function(l,c){return this.assign(P.IntervalArithmetic.next(l),c)},halfOpenRight:function(l,c){return this.assign(l,P.IntervalArithmetic.prev(c))},toArray:function(){return[this.lo,this.hi]},clone:function(){return new m().set(this.lo,this.hi)}}),g.Math.IntervalArithmetic={Interval:function(l,c){return new m(l,c)},isInterval:function(l){return l!==null&&typeof l=="object"&&typeof l.lo=="number"&&typeof l.hi=="number"},isSingleton:function(l){return l.lo===l.hi},add:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),new m(this.addLo(l.lo,c.lo),this.addHi(l.hi,c.hi))},sub:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),new m(this.subLo(l.lo,c.hi),this.subHi(l.hi,c.lo))},mul:function(l,c){var h,e,o,t,s;return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(l)||this.isEmpty(c)?this.EMPTY.clone():(h=l.lo,e=l.hi,o=c.lo,t=c.hi,s=new m,h<0?e>0?o<0?t>0?(s.lo=Math.min(this.mulLo(h,t),this.mulLo(e,o)),s.hi=Math.max(this.mulHi(h,o),this.mulHi(e,t))):(s.lo=this.mulLo(e,o),s.hi=this.mulHi(h,o)):t>0?(s.lo=this.mulLo(h,t),s.hi=this.mulHi(e,t)):(s.lo=0,s.hi=0):o<0?t>0?(s.lo=this.mulLo(h,t),s.hi=this.mulHi(h,o)):(s.lo=this.mulLo(e,t),s.hi=this.mulHi(h,o)):t>0?(s.lo=this.mulLo(h,t),s.hi=this.mulHi(e,o)):(s.lo=0,s.hi=0):e>0?o<0?t>0?(s.lo=this.mulLo(e,o),s.hi=this.mulHi(e,t)):(s.lo=this.mulLo(e,o),s.hi=this.mulHi(h,t)):t>0?(s.lo=this.mulLo(h,o),s.hi=this.mulHi(e,t)):(s.lo=0,s.hi=0):(s.lo=0,s.hi=0),s)},div:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(l)||this.isEmpty(c)?this.EMPTY.clone():this.zeroIn(c)?c.lo!==0?c.hi!==0?this.divZero(l):this.divNegative(l,c.lo):c.hi!==0?this.divPositive(l,c.hi):this.EMPTY.clone():this.divNonZero(l,c)},positive:function(l){return new m(l.lo,l.hi)},negative:function(l){return y.isNumber(l)?new m(-l):new m(-l.hi,-l.lo)},isEmpty:function(l){return l.lo>l.hi},isWhole:function(l){return l.lo===-1/0&&l.hi===1/0},zeroIn:function(l){return this.hasValue(l,0)},hasValue:function(l,c){return!this.isEmpty(l)&&l.lo<=c&&c<=l.hi},hasInterval:function(l,c){return!!this.isEmpty(l)||!this.isEmpty(c)&&c.lo<=l.lo&&l.hi<=c.hi},intervalsOverlap:function(l,c){return!this.isEmpty(l)&&!this.isEmpty(c)&&(l.lo<=c.lo&&c.lo<=l.hi||c.lo<=l.lo&&l.lo<=c.hi)},divNonZero:function(l,c){var h=l.lo,e=l.hi,o=c.lo,t=c.hi,s=new m;return e<0?t<0?(s.lo=this.divLo(e,o),s.hi=this.divHi(h,t)):(s.lo=this.divLo(h,o),s.hi=this.divHi(e,t)):h<0?t<0?(s.lo=this.divLo(e,t),s.hi=this.divHi(h,t)):(s.lo=this.divLo(h,o),s.hi=this.divHi(e,o)):t<0?(s.lo=this.divLo(e,t),s.hi=this.divHi(h,o)):(s.lo=this.divLo(h,t),s.hi=this.divHi(e,o)),s},divPositive:function(l,c){return l.lo===0&&l.hi===0?l:this.zeroIn(l)?this.WHOLE:l.hi<0?new m(Number.NEGATIVE_INFINITY,this.divHi(l.hi,c)):new m(this.divLo(l.lo,c),Number.POSITIVE_INFINITY)},divNegative:function(l,c){return l.lo===0&&l.hi===0?l:this.zeroIn(l)?this.WHOLE:l.hi<0?new m(this.divLo(l.hi,c),Number.POSITIVE_INFINITY):new m(Number.NEGATIVE_INFINITY,this.divHi(l.lo,c))},divZero:function(l){return l.lo===0&&l.hi===0?l:this.WHOLE},fmod:function(l,c){var h,e;return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(l)||this.isEmpty(c)?this.EMPTY.clone():(h=l.lo<0?c.lo:c.hi,e=(e=l.lo/h)<0?Math.ceil(e):Math.floor(e),this.sub(l,this.mul(c,new m(e))))},multiplicativeInverse:function(l){return y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)?this.EMPTY.clone():this.zeroIn(l)?l.lo!==0?l.hi!==0?this.WHOLE:new m(Number.NEGATIVE_INFINITY,this.divHi(1,l.lo)):l.hi!==0?new m(this.divLo(1,l.hi),Number.POSITIVE_INFINITY):this.EMPTY.clone():new m(this.divLo(1,l.hi),this.divHi(1,l.lo))},pow:function(l,c){var h,e;if(y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l))return this.EMPTY.clone();if(this.isInterval(c)){if(!this.isSingleton(c))return this.EMPTY.clone();c=c.lo}return c===0?l.lo===0&&l.hi===0?this.EMPTY.clone():this.ONE.clone():c<0?this.pow(this.multiplicativeInverse(l),-c):c%1==0?l.hi<0?(h=this.powLo(-l.hi,c),e=this.powHi(-l.lo,c),(1&c)==1?new m(-e,-h):new m(h,e)):l.lo<0?(1&c)==1?new m(-this.powLo(-l.lo,c),this.powHi(l.hi,c)):new m(0,this.powHi(Math.max(-l.lo,l.hi),c)):new m(this.powLo(l.lo,c),this.powHi(l.hi,c)):(console.warn("power is not an integer, you should use nth-root instead, returning an empty interval"),this.EMPTY.clone())},sqrt:function(l){return y.isNumber(l)&&(l=this.Interval(l)),this.nthRoot(l,2)},nthRoot:function(l,c){var h,e,o,t,s;if(y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)||c<0)return this.EMPTY.clone();if(this.isInterval(c)){if(!this.isSingleton(c))return this.EMPTY.clone();c=c.lo}return h=1/c,l.hi<0?c%1==0&&(1&c)==1?(e=this.powHi(-l.lo,h),o=this.powLo(-l.hi,h),new m(-e,-o)):this.EMPTY.clone():l.lo<0?(t=this.powHi(l.hi,h),c%1==0&&(1&c)==1?(s=-this.powHi(-l.lo,h),new m(s,t)):new m(0,t)):new m(this.powLo(l.lo,h),this.powHi(l.hi,h))},exp:function(l){return y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)?this.EMPTY.clone():new m(this.expLo(l.lo),this.expHi(l.hi))},log:function(l){var c;return y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)?this.EMPTY.clone():(c=l.lo<=0?Number.NEGATIVE_INFINITY:this.logLo(l.lo),new m(c,this.logHi(l.hi)))},ln:function(l){return this.log(l)},log10:function(l){return this.isEmpty(l)?this.EMPTY.clone():this.div(this.log(l),this.log(new m(10,10)))},log2:function(l){return this.isEmpty(l)?this.EMPTY.clone():this.div(this.log(l),this.log(new m(2,2)))},hull:function(l,c){var h=this.isEmpty(l),e=this.isEmpty(c);return h&&e?this.EMPTY.clone():h?c.clone():e?l.clone():new m(Math.min(l.lo,c.lo),Math.max(l.hi,c.hi))},intersection:function(l,c){var h,e;return this.isEmpty(l)||this.isEmpty(c)?this.EMPTY.clone():(h=Math.max(l.lo,c.lo))<=(e=Math.min(l.hi,c.hi))?new m(h,e):this.EMPTY.clone()},union:function(l,c){if(!this.intervalsOverlap(l,c))throw new Error("Interval#unions do not overlap");return new m(Math.min(l.lo,c.lo),Math.max(l.hi,c.hi))},difference:function(l,c){if(this.isEmpty(l)||this.isWhole(c))return this.EMPTY.clone();if(this.intervalsOverlap(l,c)){if(l.lo<c.lo&&c.hi<l.hi)throw new Error("Interval.difference: difference creates multiple intervals");return c.lo<=l.lo&&c.hi===1/0||c.hi>=l.hi&&c.lo===-1/0?this.EMPTY.clone():c.lo<=l.lo?new m().halfOpenLeft(c.hi,l.hi):new m().halfOpenRight(l.lo,c.lo)}return l.clone()},width:function(l){return this.isEmpty(l)?0:this.subHi(l.hi,l.lo)},abs:function(l){return y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)?this.EMPTY.clone():l.lo>=0?l.clone():l.hi<=0?this.negative(l):new m(0,Math.max(-l.lo,l.hi))},max:function(l,c){var h=this.isEmpty(l),e=this.isEmpty(c);return h&&e?this.EMPTY.clone():h?c.clone():e?l.clone():new m(Math.max(l.lo,c.lo),Math.max(l.hi,c.hi))},min:function(l,c){var h=this.isEmpty(l),e=this.isEmpty(c);return h&&e?this.EMPTY.clone():h?c.clone():e?l.clone():new m(Math.min(l.lo,c.lo),Math.min(l.hi,c.hi))},onlyInfinity:function(l){return!isFinite(l.lo)&&l.lo===l.hi},_handleNegative:function(l){var c;return l.lo<0&&(l.lo===-1/0?(l.lo=0,l.hi=1/0):(c=Math.ceil(-l.lo/this.piTwiceLow),l.lo+=this.piTwiceLow*c,l.hi+=this.piTwiceLow*c)),l},cos:function(l){var c,h,e,o,t,s,a,d;return this.isEmpty(l)||this.onlyInfinity(l)?this.EMPTY.clone():(c=new m().set(l.lo,l.hi),this._handleNegative(c),h=this.PI_TWICE,e=this.fmod(c,h),this.width(e)>=h.lo?new m(-1,1):e.lo>=this.piHigh?(o=this.cos(this.sub(e,this.PI)),this.negative(o)):(t=e.lo,s=e.hi,a=this.cosLo(s),d=this.cosHi(t),s<=this.piLow?new m(a,d):s<=h.lo?new m(-1,Math.max(a,d)):new m(-1,1)))},sin:function(l){return this.isEmpty(l)||this.onlyInfinity(l)?this.EMPTY.clone():this.cos(this.sub(l,this.PI_HALF))},tan:function(l){var c,h,e;return this.isEmpty(l)||this.onlyInfinity(l)?this.EMPTY.clone():(c=new m().set(l.lo,l.hi),this._handleNegative(c),e=this.PI,(h=this.fmod(c,e)).lo>=this.piHalfLow&&(h=this.sub(h,e)),h.lo<=-this.piHalfLow||h.hi>=this.piHalfLow?this.WHOLE.clone():new m(this.tanLo(h.lo),this.tanHi(h.hi)))},asin:function(l){var c,h;return this.isEmpty(l)||l.hi<-1||l.lo>1?this.EMPTY.clone():(c=l.lo<=-1?-this.piHalfHigh:this.asinLo(l.lo),h=l.hi>=1?this.piHalfHigh:this.asinHi(l.hi),new m(c,h))},acos:function(l){var c,h;return this.isEmpty(l)||l.hi<-1||l.lo>1?this.EMPTY.clone():(c=l.hi>=1?0:this.acosLo(l.hi),h=l.lo<=-1?this.piHigh:this.acosHi(l.lo),new m(c,h))},atan:function(l){return this.isEmpty(l)?this.EMPTY.clone():new m(this.atanLo(l.lo),this.atanHi(l.hi))},sinh:function(l){return this.isEmpty(l)?this.EMPTY.clone():new m(this.sinhLo(l.lo),this.sinhHi(l.hi))},cosh:function(l){return this.isEmpty(l)?this.EMPTY.clone():l.hi<0?new m(this.coshLo(l.hi),this.coshHi(l.lo)):l.lo>=0?new m(this.coshLo(l.lo),this.coshHi(l.hi)):new m(1,this.coshHi(-l.lo>l.hi?l.lo:l.hi))},tanh:function(l){return this.isEmpty(l)?this.EMPTY.clone():new m(this.tanhLo(l.lo),this.tanhHi(l.hi))},equal:function(l,c){return this.isEmpty(l)?this.isEmpty(c):!this.isEmpty(c)&&l.lo===c.lo&&l.hi===c.hi},notEqual:function(l,c){return this.isEmpty(l)?!this.isEmpty(c):this.isEmpty(c)||l.hi<c.lo||l.lo>c.hi},lt:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),!this.isEmpty(l)&&!this.isEmpty(c)&&l.hi<c.lo},gt:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),!this.isEmpty(l)&&!this.isEmpty(c)&&l.lo>c.hi},leq:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),!this.isEmpty(l)&&!this.isEmpty(c)&&l.hi<=c.lo},geq:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),!this.isEmpty(l)&&!this.isEmpty(c)&&l.lo>=c.hi},piLow:3.141592653589793,piHigh:3.1415926535897936,piHalfLow:1.5707963267948966,piHalfHigh:1.5707963267948968,piTwiceLow:6.283185307179586,piTwiceHigh:6.283185307179587,identity:function(l){return l},_prev:function(l){return l===1/0?l:this.nextafter(l,-1/0)},_next:function(l){return l===-1/0?l:this.nextafter(l,1/0)},prev:function(l){return this._prev(l)},next:function(l){return this._next(l)},toInteger:function(l){return l<0?Math.ceil(l):Math.floor(l)},addLo:function(l,c){return this.prev(l+c)},addHi:function(l,c){return this.next(l+c)},subLo:function(l,c){return this.prev(l-c)},subHi:function(l,c){return this.next(l-c)},mulLo:function(l,c){return this.prev(l*c)},mulHi:function(l,c){return this.next(l*c)},divLo:function(l,c){return this.prev(l/c)},divHi:function(l,c){return this.next(l/c)},intLo:function(l){return this.toInteger(this.prev(l))},intHi:function(l){return this.toInteger(this.next(l))},logLo:function(l){return this.prev(Math.log(l))},logHi:function(l){return this.next(Math.log(l))},expLo:function(l){return this.prev(Math.exp(l))},expHi:function(l){return this.next(Math.exp(l))},sinLo:function(l){return this.prev(Math.sin(l))},sinHi:function(l){return this.next(Math.sin(l))},cosLo:function(l){return this.prev(Math.cos(l))},cosHi:function(l){return this.next(Math.cos(l))},tanLo:function(l){return this.prev(Math.tan(l))},tanHi:function(l){return this.next(Math.tan(l))},asinLo:function(l){return this.prev(Math.asin(l))},asinHi:function(l){return this.next(Math.asin(l))},acosLo:function(l){return this.prev(Math.acos(l))},acosHi:function(l){return this.next(Math.acos(l))},atanLo:function(l){return this.prev(Math.atan(l))},atanHi:function(l){return this.next(Math.atan(l))},sinhLo:function(l){return this.prev(P.sinh(l))},sinhHi:function(l){return this.next(P.sinh(l))},coshLo:function(l){return this.prev(P.cosh(l))},coshHi:function(l){return this.next(P.cosh(l))},tanhLo:function(l){return this.prev(P.tanh(l))},tanhHi:function(l){return this.next(P.tanh(l))},sqrtLo:function(l){return this.prev(Math.sqrt(l))},sqrtHi:function(l){return this.next(Math.sqrt(l))},powLo:function(l,c){var h;if(c%1!=0)return this.prev(Math.pow(l,c));for(h=(1&c)==1?l:1,c>>=1;c>0;)l=this.mulLo(l,l),(1&c)==1&&(h=this.mulLo(l,h)),c>>=1;return h},powHi:function(l,c){var h;if(c%1!=0)return this.next(Math.pow(l,c));for(h=(1&c)==1?l:1,c>>=1;c>0;)l=this.mulHi(l,l),(1&c)==1&&(h=this.mulHi(l,h)),c>>=1;return h},disable:function(){this.next=this.prev=this.identity},enable:function(){this.prev=function(l){return this._prev(l)},this.next=function(l){return this._next(l)}},SMALLEST_DENORM:Math.pow(2,-1074),UINT_MAX:-1>>>0,nextafter:function(l,c){var h,e;return isNaN(l)||isNaN(c)?NaN:l===c?l:l===0?c<0?-this.SMALLEST_DENORM:this.SMALLEST_DENORM:(e=v.hi(l),h=v.lo(l),c>l==l>0?h===this.UINT_MAX?(e+=1,h=0):h+=1:h===0?(h=this.UINT_MAX,e-=1):h-=1,v.pack(h,e))}},g.Math.IntervalArithmetic.PI=new m(P.IntervalArithmetic.piLow,P.IntervalArithmetic.piHigh),g.Math.IntervalArithmetic.PI_HALF=new m(P.IntervalArithmetic.piHalfLow,P.IntervalArithmetic.piHalfHigh),g.Math.IntervalArithmetic.PI_TWICE=new m(P.IntervalArithmetic.piTwiceLow,P.IntervalArithmetic.piTwiceHigh),g.Math.IntervalArithmetic.ZERO=new m(0),g.Math.IntervalArithmetic.ONE=new m(1),g.Math.IntervalArithmetic.WHOLE=new m().setWhole(),g.Math.IntervalArithmetic.EMPTY=new m().setEmpty(),g.Math.IntervalArithmetic}),define("math/extrapolate",["math/math"],function(g){return g.Extrapolate={upper:15,infty:1e4,wynnEps:function(P,y,v){var m,l,c,h,e;if(v[y]=P,y===0)e=P;else{for(c=0,m=y;m>0;m--)l=c,c=v[m-1],h=v[m]-c,Math.abs(h)<=1e-15?v[m-1]=1e20:v[m-1]=1*l+1/h;e=v[y%2]}return e},aitken:function(P,y,v){var m,l,c,h,e,o;if(v[y]=P,y<2)m=P;else{for(h=y/2,e=1;e<=h;e++)l=v[(o=y-2*e)+2]-2*v[o+1]+v[o],Math.abs(l)<1e-15?v[o]=1e20:(c=v[o]-v[o+1],v[o]-=c*c/l);m=v[y%2]}return m},brezinski:function(P,y,v){var m,l,c,h,e,o,t,s;if(v[y]=P,y<3)m=P;else{for(o=y/3,s=y,t=1;t<=o;t++)c=v[(s-=3)+1]-v[s],h=v[s+2]-v[s+1],l=(e=v[s+3]-v[s+2])*(h-c)-c*(e-h),Math.abs(l)<1e-15?v[s]=1e20:v[s]=v[s+1]-c*h*(e-h)/l;m=v[y%3]}return m},iteration:function(P,y,v,m,l){var c,h,e,o,t=NaN,s=[],a="finite",d=y;for(l=l||0,c=1;c<=this.upper;c++){if(h=v(P+(d=l===0?y/(c+1):.5*d),!0),e=this[m](h,c-1,s),isNaN(e)){a="NaN";break}if(h!==0&&e/h>this.infty){t=e,a="infinite";break}if(o=e-t,Math.abs(o)<1e-7)break;t=e}return[t,a,1-(c-1)/this.upper]},levin:function(P,y,v,m,l,c){var h,e,o,t;if(t=1/(m+y),l[y]=P/v,c[y]=1/v,y>0&&(l[y-1]=l[y]-l[y-1],c[y-1]=c[y]-c[y-1],y>1))for(o=(m+y-1)*t,h=2;h<=y;h++)e=(m+y-h)*Math.pow(o,h-2)*t,l[y-h]=l[y-h+1]-e*l[y-h],c[y-h]=c[y-h+1]-e*c[y-h],t*=o;return Math.abs(c[0])<1e-15?1e20:l[0]/c[0]},iteration_levin:function(P,y,v,m){var l,c,h,e,o,t,s,a=NaN,d=[],u=[],n="finite",p=y;for(m=m||0,e=v(P+y,!0),l=1;l<=this.upper;l++){if(o=(c=v(P+(p=m===0?y/(l+1):.5*p),!0))-e,s=(Math.abs(o)<1?"u":"t")=="u"?(1+l)*o:o,e=c,t=(h=this.levin(c,l-1,s,1,d,u))-a,isNaN(h)){n="NaN";break}if(c!==0&&h/c>this.infty){a=h,n="infinite";break}if(Math.abs(t)<1e-7)break;a=h}return[a,n,1-(l-1)/this.upper]},limit:function(P,y,v){return this.iteration_levin(P,y,v,0)}},g.Extrapolate}),define("math/qdt",["math/math","utils/type"],function(g,P){return g.Quadtree=function(y){this.capacity=10,this.points=[],this.xlb=y[0],this.xub=y[2],this.ylb=y[3],this.yub=y[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null},P.extend(g.Quadtree.prototype,{contains:function(y,v){return this.xlb<y&&y<=this.xub&&this.ylb<v&&v<=this.yub},insert:function(y){return!!this.contains(y.usrCoords[1],y.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(y),!0):(this.northWest===null&&this.subdivide(),!!this.northWest.insert(y)||!!this.northEast.insert(y)||!!this.southEast.insert(y)||!!this.southWest.insert(y)))},subdivide:function(){var y,v=this.points.length,m=this.xlb+(this.xub-this.xlb)/2,l=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new g.Quadtree([this.xlb,this.yub,m,l]),this.northEast=new g.Quadtree([m,this.yub,this.xub,l]),this.southEast=new g.Quadtree([this.xlb,l,m,this.ylb]),this.southWest=new g.Quadtree([m,l,this.xub,this.ylb]),y=0;y<v;y+=1)this.northWest.insert(this.points[y]),this.northEast.insert(this.points[y]),this.southEast.insert(this.points[y]),this.southWest.insert(this.points[y])},_query:function(y,v){var m;if(this.contains(y,v)){if(this.northWest===null)return this;if((m=this.northWest._query(y,v))||(m=this.northEast._query(y,v))||(m=this.southEast._query(y,v))||(m=this.southWest._query(y,v)))return m}return!1},query:function(y,v){var m,l;return P.exists(v)?(m=y,l=v):(m=y.usrCoords[1],l=y.usrCoords[2]),this._query(m,l)}}),g.Quadtree}),define("math/numerics",["jxg","utils/type","utils/env","math/math"],function(g,P,y,v){var m={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[.16666666666666666,.3333333333333333,.3333333333333333,.16666666666666666],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return v.Numerics={Gauss:function(l,c){var h,e,o,t,s,a=v.eps,d=l.length>0?l[0].length:0;if(d!==c.length||d!==l.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(t=[],s=c.slice(0,d),h=0;h<d;h++)t[h]=l[h].slice(0,d);for(e=0;e<d;e++){for(h=d-1;h>e;h--)if(Math.abs(t[h][e])>a)if(Math.abs(t[e][e])<a)P.swap(t,h,e),P.swap(s,h,e);else for(t[h][e]/=t[e][e],s[h]-=t[h][e]*s[e],o=e+1;o<d;o++)t[h][o]-=t[h][e]*t[e][o];if(Math.abs(t[e][e])<a)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(t,s,!0),s},backwardSolve:function(l,c,h){var e,o,t,s,a;for(e=h?c:c.slice(0,c.length),o=l.length,t=l.length>0?l[0].length:0,s=o-1;s>=0;s--){for(a=t-1;a>s;a--)e[s]-=l[s][a]*e[a];e[s]/=l[s][s]}return e},gaussBareiss:function(l){var c,h,e,o,t,s,a,d,u,n=v.eps;if((a=l.length)<=0)return 0;for(l[0].length<a&&(a=l[0].length),d=[],o=0;o<a;o++)d[o]=l[o].slice(0,a);for(h=1,e=1,c=0;c<a-1;c++){if(s=d[c][c],Math.abs(s)<n){for(o=c+1;o<a&&!(Math.abs(d[o][c])>=n);o++);if(o===a)return 0;for(t=c;t<a;t++)u=d[o][t],d[o][t]=d[c][t],d[c][t]=u;e=-e,s=d[c][c]}for(o=c+1;o<a;o++)for(t=c+1;t<a;t++)u=s*d[o][t]-d[o][c]*d[c][t],d[o][t]=u/h;h=s}return e*d[a-1][a-1]},det:function(l){return l.length===2&&l[0].length===2?l[0][0]*l[1][1]-l[1][0]*l[0][1]:this.gaussBareiss(l)},Jacobi:function(l){var c,h,e,o,t,s,a,d,u,n=v.eps*v.eps,p=0,f=l.length,b=[[0,0,0],[0,0,0],[0,0,0]],C=[[0,0,0],[0,0,0],[0,0,0]],_=0;for(c=0;c<f;c++){for(h=0;h<f;h++)b[c][h]=0,C[c][h]=l[c][h],p+=Math.abs(C[c][h]);b[c][c]=1}if(f===1)return[C,b];if(p<=0)return[C,b];p/=f*f;do{for(d=0,u=0,h=1;h<f;h++)for(c=0;c<h;c++)if((o=Math.abs(C[c][h]))>u&&(u=o),d+=o,o>=n){for(o=.5*Math.atan2(2*C[c][h],C[c][c]-C[h][h]),t=Math.sin(o),s=Math.cos(o),e=0;e<f;e++)a=C[e][c],C[e][c]=s*a+t*C[e][h],C[e][h]=-t*a+s*C[e][h],a=b[e][c],b[e][c]=s*a+t*b[e][h],b[e][h]=-t*a+s*b[e][h];for(C[c][c]=s*C[c][c]+t*C[h][c],C[h][h]=-t*C[c][h]+s*C[h][h],C[c][h]=0,e=0;e<f;e++)C[c][e]=C[e][c],C[h][e]=C[e][h]}_+=1}while(Math.abs(d)/p>n&&_<2e3);return[C,b]},NewtonCotes:function(l,c,h){var e,o,t,s=0,a=h&&P.isNumber(h.number_of_nodes)?h.number_of_nodes:28,d={trapez:!0,simpson:!0,milne:!0},u=h&&h.integration_type&&d.hasOwnProperty(h.integration_type)&&d[h.integration_type]?h.integration_type:"milne",n=(l[1]-l[0])/a;switch(u){case"trapez":for(s=.5*(c(l[0])+c(l[1])),e=l[0],o=0;o<a-1;o++)s+=c(e+=n);s*=n;break;case"simpson":if(a%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(t=a/2,s=c(l[0])+c(l[1]),e=l[0],o=0;o<t-1;o++)s+=2*c(e+=2*n);for(e=l[0]-n,o=0;o<t;o++)s+=4*c(e+=2*n);s*=n/3;break;default:if(a%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(t=.25*a,s=7*(c(l[0])+c(l[1])),e=l[0],o=0;o<t-1;o++)s+=14*c(e+=4*n);for(e=l[0]-3*n,o=0;o<t;o++)s+=32*(c(e+=4*n)+c(e+2*n));for(e=l[0]-2*n,o=0;o<t;o++)s+=12*c(e+=4*n);s*=2*n/45}return s},Romberg:function(l,c,h){var e,o,t,s,a,d,u,n,p=[],f=0,b=1/0,C=h&&P.isNumber(h.max_iterations)?h.max_iterations:20,_=h&&P.isNumber(h.eps)?h.eps:h.eps||1e-7;for(e=l[0],t=(o=l[1])-e,a=1,p[0]=.5*t*(c(e)+c(o)),d=0;d<C;++d){for(s=0,t*=.5,a*=2,n=1,u=1;u<a;u+=2)s+=c(e+u*t);for(p[d+1]=.5*p[d]+s*t,f=p[d+1],u=d-1;u>=0;--u)n*=4,p[u]=p[u+1]+(p[u+1]-p[u])/(n-1),f=p[u];if(Math.abs(f-b)<_*Math.abs(f))break;b=f}return f},GaussLegendre:function(l,c,h){var e,o,t,s,a,d,u,n,p=0,f=[],b=[],C=h&&P.isNumber(h.n)?h.n:12;if(C>18&&(C=18),f[2]=[.5773502691896257],b[2]=[1],f[4]=[.33998104358485626,.8611363115940526],b[4]=[.6521451548625461,.34785484513745385],f[6]=[.2386191860831969,.6612093864662645,.932469514203152],b[6]=[.46791393457269104,.3607615730481386,.17132449237917036],f[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],b[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],f[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],b[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],f[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],b[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],f[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],b[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],f[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],b[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],f[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],b[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],f[3]=[0,.7745966692414834],b[3]=[.8888888888888888,.5555555555555556],f[5]=[0,.5384693101056831,.906179845938664],b[5]=[.5688888888888889,.47862867049936647,.23692688505618908],f[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],b[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],f[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],b[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],f[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],b[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],f[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],b[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],f[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],b[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],f[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],b[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],e=l[0],o=l[1],s=C+1>>1,u=f[C],n=b[C],d=.5*(o-e),a=.5*(o+e),!0&C)for(p=n[0]*c(a),t=1;t<s;++t)p+=n[t]*(c(a+d*u[t])+c(a-d*u[t]));else for(p=0,t=0;t<s;++t)p+=n[t]*(c(a+d*u[t])+c(a-d*u[t]));return d*p},_rescale_error:function(l,c,h){var e,o,t=2220446049250313e-31;return l=Math.abs(l),h!==0&&l!==0&&(l=(e=Math.pow(200*l/h,1.5))<1?h*e:h),c>20041683600089728e-310&&(o=50*t*c)>l&&(l=o),l},_gaussKronrod:function(l,c,h,e,o,t,s){var a,d,u,n,p,f,b,C,_,E,x,S=l[0],O=l[1],w=.5*(S+O),T=.5*(O-S),M=Math.abs(T),N=c(w),A=0,R=N*t[h-1],L=Math.abs(R),D=0,k=[],B=[];for(h%2==0&&(A=N*o[h/2-1]),a=Math.floor((h-1)/2),p=0;p<a;p++)E=(C=c(w-(b=T*e[f=2*p+1])))+(_=c(w+b)),k[f]=C,B[f]=_,A+=o[p]*E,R+=t[f]*E,L+=t[f]*(Math.abs(C)+Math.abs(_));for(a=Math.floor(h/2),p=0;p<a;p++)C=c(w-(b=T*e[x=2*p])),_=c(w+b),k[x]=C,B[x]=_,R+=t[x]*(C+_),L+=t[x]*(Math.abs(C)+Math.abs(_));for(u=.5*R,D=t[h-1]*Math.abs(N-u),p=0;p<h-1;p++)D+=t[p]*(Math.abs(k[p]-u)+Math.abs(B[p]-u));return n=(R-A)*T,L*=M,D*=M,d=R*=T,s.abserr=this._rescale_error(n,L,D),s.resabs=L,s.resasc=D,d},GaussKronrod15:function(l,c,h){return this._gaussKronrod(l,c,8,[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782],h)},GaussKronrod21:function(l,c,h){return this._gaussKronrod(l,c,11,[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169],h)},GaussKronrod31:function(l,c,h){return this._gaussKronrod(l,c,16,[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154],h)},_workspace:function(l,c){return{limit:c,size:0,nrmax:0,i:0,alist:[l[0]],blist:[l[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var h,e,o,t,s,a=this.size-1,d=this.limit,u=this.nrmax,n=this.order[u];if(a<2)return this.order[0]=0,this.order[1]=1,void(this.i=n);for(h=this.elist[n];u>0&&h>this.elist[this.order[u-1]];)this.order[u]=this.order[u-1],u--;for(s=a<d/2+2?a:d-a+1,o=u+1;o<s&&h<this.elist[this.order[o]];)this.order[o-1]=this.order[o],o++;for(this.order[o-1]=n,e=this.elist[a],t=s-1;t>o-2&&e>=this.elist[this.order[t]];)this.order[t+1]=this.order[t],t--;this.order[t+1]=a,n=this.order[u],this.i=n,this.nrmax=u},set_initial_result:function(h,e){this.size=1,this.rlist[0]=h,this.elist[0]=e},update:function(h,e,o,t,s,a,d,u){var n=this.i,p=this.size,f=this.level[this.i]+1;u>t?(this.alist[n]=s,this.rlist[n]=d,this.elist[n]=u,this.level[n]=f,this.alist[p]=h,this.blist[p]=e,this.rlist[p]=o,this.elist[p]=t,this.level[p]=f):(this.blist[n]=e,this.rlist[n]=o,this.elist[n]=t,this.level[n]=f,this.alist[p]=s,this.blist[p]=a,this.rlist[p]=d,this.elist[p]=u,this.level[p]=f),this.size++,f>this.maximum_level&&(this.maximum_level=f),this.qpsrt()},retrieve:function(){var h=this.i;return{a:this.alist[h],b:this.blist[h],r:this.rlist[h],e:this.elist[h]}},sum_results:function(){var h,e=this.size,o=0;for(h=0;h<e;h++)o+=this.rlist[h];return o},subinterval_too_small:function(h,e,o){var t=1.0000000000000222*(Math.abs(e)+22250738585072014e-321);return Math.abs(h)<=t&&Math.abs(o)<=t}}},Qag:function(l,c,h){var e,o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w,T=this._workspace(l,1e3),M=h&&P.isNumber(h.limit)?h.limit:15,N=h&&P.isNumber(h.epsrel)?h.epsrel:1e-7,A=h&&P.isNumber(h.epsabs)?h.epsabs:1e-7,R=h&&P.isFunction(h.q)?h.q:this.GaussKronrod15,L={},D=0,k=0,B=0,I=0,Y=0,q=0,V=0,W=0,X=0,Q=0;if(M>T.limit&&g.warn("iteration limit exceeds available workspace"),A<=0&&(N<50*v.eps||N<5e-29)&&g.warn("tolerance cannot be acheived with given epsabs and epsrel"),t=R.apply(this,[l,c,L]),s=L.abserr,a=L.resabs,d=L.resasc,T.set_initial_result(t,s),u=Math.max(A,N*Math.abs(t)),s<=11102230246251565e-30*a&&s>u)return g.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(s<=u&&s!==d||s===0)return t;if(M===1)return g.warn("a maximum of one iteration was insufficient"),-1/0;e=t,o=s,D=1;do Y=0,q=0,V=0,W=0,X=0,Q=0,C=(O=T.retrieve()).a,_=O.b,E=O.r,x=O.e,n=C,f=p=.5*(C+_),b=_,Y=R.apply(this,[[n,p],c,L]),W=L.abserr,S=L.resasc,q=R.apply(this,[[f,b],c,L]),o+=(Q=W+(X=L.abserr))-x,e+=(V=Y+q)-E,S!==W&&L.resasc!==X&&(w=E-V,Math.abs(w)<=1e-5*Math.abs(V)&&Q>=.99*x&&k++,D>=10&&Q>x&&B++),o>(u=Math.max(A,N*Math.abs(e)))&&((k>=6||B>=20)&&(I=2),T.subinterval_too_small(n,f,b)&&(I=3)),T.update(n,p,Y,W,f,b,q,X),C=(O=T.retrieve()).a_i,_=O.b_i,E=O.r_i,x=O.e_i,D++;while(D<M&&!I&&o>u);return T.sum_results()},I:function(l,c){return this.Qag(l,c,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(l,c,h){var e,o=0,t=v.eps,s=l.apply(h,[c]);for(P.isArray(c)&&(c=c[0]);o<50&&Math.abs(s)>t;)e=this.D(l,h)(c),Math.abs(e)>t?c-=s/e:c+=.2*Math.random()-1,s=l.apply(h,[c]),o+=1;return c},root:function(l,c,h){return this.chandrupatla(l,c,h)},generalizedNewton:function(l,c,h,e){var o,t,s,a,d,u,n,p,f,b,C,_,E,x,S=0;for(this.generalizedNewton.t1memo?(o=this.generalizedNewton.t1memo,t=this.generalizedNewton.t2memo):(o=h,t=e),b=(p=l.X(o)-c.X(t))*p+(f=l.Y(o)-c.Y(t))*f,C=this.D(l.X,l),_=this.D(c.X,c),E=this.D(l.Y,l),x=this.D(c.Y,c);b>v.eps&&S<10;)s=C(o),a=-_(t),d=E(o),o-=((u=-x(t))*p-a*f)/(n=s*u-a*d),t-=(s*f-d*p)/n,b=(p=l.X(o)-c.X(t))*p+(f=l.Y(o)-c.Y(t))*f,S+=1;return this.generalizedNewton.t1memo=o,this.generalizedNewton.t2memo=t,Math.abs(o)<Math.abs(t)?[l.X(o),l.Y(o)]:[c.X(t),c.Y(t)]},Neville:function(l){var c=[],h=function(e){return function(o,t){var s,a,d,u=v.binomial,n=l.length,p=n-1,f=0,b=0;if(!t)for(d=1,s=0;s<n;s++)c[s]=u(p,s)*d,d*=-1;for(a=o,s=0;s<n;s++){if(a===0)return l[s][e]();d=c[s]/a,a-=1,f+=l[s][e]()*d,b+=d}return f/b}};return[h("X"),h("Y"),0,function(){return l.length-1}]},splineDef:function(l,c){var h,e,o,t=Math.min(l.length,c.length),s=[],a=[],d=[],u=[],n=[],p=[];if(t===2)return[0,0];for(e=0;e<t;e++)h={X:l[e],Y:c[e]},d.push(h);for(d.sort(function(f,b){return f.X-b.X}),e=0;e<t;e++)l[e]=d[e].X,c[e]=d[e].Y;for(e=0;e<t-1;e++)u.push(l[e+1]-l[e]);for(e=0;e<t-2;e++)n.push(6*(c[e+2]-c[e+1])/u[e+1]-6*(c[e+1]-c[e])/u[e]);for(s.push(2*(u[0]+u[1])),a.push(n[0]),e=0;e<t-3;e++)o=u[e+1]/s[e],s.push(2*(u[e+1]+u[e+2])-o*u[e+1]),a.push(n[e+1]-o*a[e]);for(p[t-3]=a[t-3]/s[t-3],e=t-4;e>=0;e--)p[e]=(a[e]-u[e+1]*p[e+1])/s[e];for(e=t-3;e>=0;e--)p[e+1]=p[e];return p[0]=0,p[t-1]=0,p},splineEval:function(l,c,h,e){var o,t,s,a,d,u,n,p=Math.min(c.length,h.length),f=1,b=!1,C=[];for(P.isArray(l)?(f=l.length,b=!0):l=[l],o=0;o<f;o++){if(l[o]<c[0]||c[o]>c[p-1])return NaN;for(t=1;t<p&&!(l[o]<=c[t]);t++);s=h[t-=1],a=(h[t+1]-h[t])/(c[t+1]-c[t])-(c[t+1]-c[t])/6*(e[t+1]+2*e[t]),d=e[t]/2,u=(e[t+1]-e[t])/(6*(c[t+1]-c[t])),n=l[o]-c[t],C.push(s+(a+(d+u*n)*n)*n)}return b?C:C[0]},generatePolynomialTerm:function(l,c,h,e){var o,t=[];for(o=c;o>=0;o--)t=t.concat(["(",l[o].toPrecision(e),")"]),o>1?t=t.concat(["*",h,"<sup>",o,"<","/sup> + "]):o===1&&(t=t.concat(["*",h," + "]));return t.join("")},lagrangePolynomial:function(l){var c=[],h=this,e=function(o,t){var s,a,d,u,n=l.length,p=0,f=0;if(!t)for(s=0;s<n;s++){for(c[s]=1,d=l[s].X(),a=0;a<n;a++)a!==s&&(c[s]*=d-l[a].X());c[s]=1/c[s]}for(s=0;s<n;s++){if(o===(d=l[s].X()))return l[s].Y();f+=u=c[s]/(o-d),p+=u*l[s].Y()}return p/f};return e.getTerm=function(o,t,s){return h.lagrangePolynomialTerm(l,o,t,s)()},e},lagrangePolynomialTerm:function(l,c,h,e){return function(){var o,t,s,a,d,u,n=l.length,p=[],f=[],b=[],C=!0;for(h=h||"x",e===void 0&&(e=" * "),o=n-1,a=0;a<n;a++)b[a]=0;for(s=0;s<n;s++){for(d=l[s].Y(),u=l[s].X(),p=[],a=0;a<n;a++)a!==s&&(d/=u-l[a].X(),p.push(l[a].X()));for(f=[1].concat(v.Vieta(p)),a=0;a<f.length;a++)b[a]+=(a%2==1?-1:1)*f[a]*d}for(t="",a=0;a<b.length;a++)d=b[a],Math.abs(d)<v.eps||(g.exists(c)&&(d=y._round10(d,-c)),C?(t+=d>0?d:"-"+-d,C=!1):t+=d>0?" + "+d:" - "+-d,o-a>1?t+=e+h+"^"+(o-a):o-a==1&&(t+=e+h));return t}},_initCubicPoly:function(l,c,h,e){return[l,h,-3*l+3*c-2*h-e,2*l-2*c+h+e]},CardinalSpline:function(l,c,h){var e,o,t,s,a=[],d=this;return s=P.isFunction(c)?c:function(){return c},h===void 0&&(h="uniform"),o=function(u){return function(n,p){var f,b,C,_,E,x,S,O,w,T;if(l.length<2)return NaN;if(!p)for(t=s(),C={X:function(){return 2*l[0].X()-l[1].X()},Y:function(){return 2*l[0].Y()-l[1].Y()},Dist:function(M){var N=this.X()-M.X(),A=this.Y()-M.Y();return Math.sqrt(N*N+A*A)}},_={X:function(){return 2*l[l.length-1].X()-l[l.length-2].X()},Y:function(){return 2*l[l.length-1].Y()-l[l.length-2].Y()},Dist:function(M){var N=this.X()-M.X(),A=this.Y()-M.Y();return Math.sqrt(N*N+A*A)}},T=(e=[C].concat(l,[_])).length,a[u]=[],f=0;f<T-3;f++)h==="centripetal"?(S=e[f].Dist(e[f+1]),O=e[f+2].Dist(e[f+1]),w=e[f+3].Dist(e[f+2]),S=Math.sqrt(S),O=Math.sqrt(O),w=Math.sqrt(w),O<v.eps&&(O=1),S<v.eps&&(S=O),w<v.eps&&(w=O),E=(e[f+1][u]()-e[f][u]())/S-(e[f+2][u]()-e[f][u]())/(O+S)+(e[f+2][u]()-e[f+1][u]())/O,x=(e[f+2][u]()-e[f+1][u]())/O-(e[f+3][u]()-e[f+1][u]())/(w+O)+(e[f+3][u]()-e[f+2][u]())/w,E*=O,x*=O,a[u][f]=d._initCubicPoly(e[f+1][u](),e[f+2][u](),t*E,t*x)):a[u][f]=d._initCubicPoly(e[f+1][u](),e[f+2][u](),t*(e[f+2][u]()-e[f][u]()),t*(e[f+3][u]()-e[f+1][u]()));return isNaN(n)?NaN:(T=l.length,n<=0?l[0][u]():n>=T?l[T-1][u]():(f=Math.floor(n))===n?l[f][u]():(n-=f,(b=a[u][f])===void 0?NaN:((b[3]*n+b[2])*n+b[1])*n+b[0]))}},[o("X"),o("Y"),0,function(){return l.length-1}]},CatmullRomSpline:function(l,c){return this.CardinalSpline(l,.5,c)},regressionPolynomial:function(l,c,h){var e,o,t,s,a,d,u="";if(P.isPoint(l)&&P.isFunction(l.Value))o=function(){return l.Value()};else if(P.isFunction(l))o=l;else{if(!P.isNumber(l))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof l+"'.");o=function(){return l}}if(arguments.length===3&&P.isArray(c)&&P.isArray(h))a=0;else if(arguments.length===2&&P.isArray(c)&&c.length>0&&P.isPoint(c[0]))a=1;else{if(!(arguments.length===2&&P.isArray(c)&&c.length>0&&c[0].usrCoords&&c[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");a=2}return(d=function(n,p){var f,b,C,_,E,x,S,O,w,T=c.length;if(w=Math.floor(o()),!p){if(a===1)for(t=[],s=[],f=0;f<T;f++)t[f]=c[f].X(),s[f]=c[f].Y();if(a===2)for(t=[],s=[],f=0;f<T;f++)t[f]=c[f].usrCoords[1],s[f]=c[f].usrCoords[2];if(a===0)for(t=[],s=[],f=0;f<T;f++)P.isFunction(c[f])?t.push(c[f]()):t.push(c[f]),P.isFunction(h[f])?s.push(h[f]()):s.push(h[f]);for(C=[],b=0;b<T;b++)C.push([1]);for(f=1;f<=w;f++)for(b=0;b<T;b++)C[b][f]=C[b][f-1]*t[b];E=s,_=v.transpose(C),x=v.matMatMult(_,C),S=v.matVecMult(_,E),e=v.Numerics.Gauss(x,S),u=v.Numerics.generatePolynomialTerm(e,w,"x",3)}for(O=e[w],f=w-1;f>=0;f--)O=O*n+e[f];return O}).getTerm=function(){return u},d},bezier:function(l){var c,h,e=function(o){return function(t,s){var a=3*Math.floor(t),d=t%1,u=1-d;return s||(h=3*Math.floor((l.length-1)/3),c=Math.floor(h/3)),t<0?l[0][o]():t>=c?l[h][o]():isNaN(t)?NaN:u*u*(u*l[a][o]()+3*d*l[a+1][o]())+(3*u*l[a+2][o]()+d*l[a+3][o]())*d*d}};return[e("X"),e("Y"),0,function(){return Math.floor(l.length/3)}]},bspline:function(l,c){var h,e=function(o){return function(t,s){var a,d,u,n,p=l.length,f=p-1,b=c;if(f<=0)return NaN;if(f+2<=b&&(b=f+1),t<=0)return l[0][o]();if(t>=f-b+2)return l[f][o]();for(u=Math.floor(t)+b-1,h=function(C,_){var E,x=[];for(E=0;E<C+_+1;E++)x[E]=E<_?0:E<=C?E-_+1:C-_+2;return x}(f,b),n=function(C,_,E,x){var S,O,w,T,M,N=[];for(_[x]<=C&&C<_[x+1]?N[x]=1:N[x]=0,S=2;S<=E;S++)for(O=x-S+1;O<=x;O++)w=O<=x-S+1||O<0?0:N[O],T=O>=x?0:N[O+1],M=_[O+S-1]-_[O],N[O]=M===0?0:(C-_[O])/M*w,(M=_[O+S]-_[O+1])!=0&&(N[O]+=(_[O+S]-C)/M*T);return N}(t,h,b,u),a=0,d=u-b+1;d<=u;d++)d<p&&d>=0&&(a+=l[d][o]()*n[d]);return a}};return[e("X"),e("Y"),0,function(){return l.length-1}]},D:function(l,c){return P.exists(c)?function(h,e){var o=1e-5;return(l.apply(c,[h+o,e])-l.apply(c,[h-o,e]))/2e-5}:function(h,e){var o=1e-5;return(l(h+o,e)-l(h-o,e))/2e-5}},_riemannValue:function(l,c,h,e){var o,t,s,a;if(e<0&&(h!=="trapezoidal"&&(l+=e),e*=-1,h==="lower"?h="upper":h==="upper"&&(h="lower")),a=.01*e,h==="right")o=c(l+e);else if(h==="middle")o=c(l+.5*e);else if(h==="left"||h==="trapezoidal")o=c(l);else if(h==="lower"){for(o=c(l),s=l+a;s<=l+e;s+=a)(t=c(s))<o&&(o=t);(t=c(l+e))<o&&(o=t)}else if(h==="upper"){for(o=c(l),s=l+a;s<=l+e;s+=a)(t=c(s))>o&&(o=t);(t=c(l+e))>o&&(o=t)}else o=h==="random"?c(l+e*Math.random()):h==="simpson"?(c(l)+4*c(l+.5*e)+c(l+e))/6:c(l);return o},riemann:function(l,c,h,e,o){var t,s,a,d,u,n,p,f=[],b=[],C=0,_=e,E=0;if(P.isArray(l)?(u=l[0],d=l[1]):d=l,(c=Math.floor(c))<=0)return[f,b,E];for(s=(o-e)/c,t=0;t<c;t++)a=this._riemannValue(_,d,h,s),f[C]=_,b[C]=a,C+=1,_+=s,h==="trapezoidal"&&(a=d(_)),f[C]=_,b[C]=a,C+=1;for(t=0;t<c;t++)a=u?this._riemannValue(_,u,h,-s):0,f[C]=_,b[C]=a,C+=1,_-=s,h==="trapezoidal"&&u&&(a=u(_)),f[C]=_,b[C]=a,h!=="trapezoidal"?(n=a,p=b[2*(c-1)-2*t]):(p=.5*(d(_+s)+d(_)),n=u?.5*(u(_+s)+u(_)):0),E+=(p-n)*s,f[C+=1]=_,b[C]=b[2*(c-1)-2*t],C+=1;return[f,b,E]},riemannsum:function(l,c,h,e,o){return g.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(l,c,h,e,o)[2]},rungeKutta:function(l,c,h,e,o){var t,s,a,d,u,n,p=[],f=[],b=(h[1]-h[0])/e,C=h[0],_=c.length,E=[],x=0;for(P.isString(l)&&(l=m[l]||m.euler),n=l.s,t=0;t<_;t++)p[t]=c[t];for(s=0;s<e;s++){for(E[x]=[],t=0;t<_;t++)E[x][t]=p[t];for(x+=1,d=[],a=0;a<n;a++){for(t=0;t<_;t++)f[t]=0;for(u=0;u<a;u++)for(t=0;t<_;t++)f[t]+=l.A[a][u]*b*d[u][t];for(t=0;t<_;t++)f[t]+=p[t];d.push(o(C+l.c[a]*b,f))}for(t=0;t<_;t++)f[t]=0;for(u=0;u<n;u++)for(t=0;t<_;t++)f[t]+=l.b[u]*d[u][t];for(t=0;t<_;t++)p[t]=p[t]+b*f[t];C+=b}return E},maxIterationsRoot:80,maxIterationsMinimize:500,findBracket:function(l,c,h){var e,o,t,s,a,d,u,n,p,f;if(P.isArray(c))return c;for(e=c,t=l.call(h,e),f=(s=[e-.1*(o=e===0?1:e),e+.1*o,e-1,e+1,e-.5*o,e+.5*o,e-.6*o,e+.6*o,e-1*o,e+1*o,e-2*o,e+2*o,e-5*o,e+5*o,e-10*o,e+10*o,e-50*o,e+50*o,e-100*o,e+100*o]).length,p=0;p<f&&(a=s[p],!(t*(d=l.call(h,a))<=0));p++);return a<e&&(u=e,e=a,a=u,n=t,t=d,d=n),[e,t,a,d]},fzero:function(l,c,h){var e,o,t,s,a,d,u,n,p,f,b,C,_,E,x,S=v.eps,O=this.maxIterationsRoot,w=0;if(P.isArray(c)){if(c.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");e=c[0],s=l.call(h,e),o=c[1],a=l.call(h,o)}else e=(u=this.findBracket(l,c,h))[0],s=u[1],o=u[2],a=u[3];if(Math.abs(s)<=S)return e;if(Math.abs(a)<=S)return o;if(s*a>0)return P.isArray(c)?this.fminbr(l,[e,o],h):this.Newton(l,e,h);for(t=e,d=s;w<O;){if(n=o-e,Math.abs(d)<Math.abs(a)&&(e=o,o=t,t=e,s=a,a=d,d=s),C=2*S*Math.abs(o)+.5*S,x=.5*(t-o),Math.abs(x)<=C||Math.abs(a)<=S)return o;Math.abs(n)>=C&&Math.abs(s)>Math.abs(a)&&(f=t-o,e===t?(_=f*(p=a/s),E=1-p):(_=(b=a/s)*(f*(E=s/d)*(E-(p=a/d))-(o-e)*(p-1)),E=(E-1)*(p-1)*(b-1)),_>0?E=-E:_=-_,_<.75*f*E-.5*Math.abs(C*E)&&_<Math.abs(n*E*.5)&&(x=_/E)),Math.abs(x)<C&&(x=x>0?C:-C),e=o,s=a,o+=x,((a=l.call(h,o))>0&&d>0||a<0&&d<0)&&(t=e,d=s),w++}return o},chandrupatla:function(l,c,h){var e,o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M,N=0,A=this.maxIterationsRoot,R=1+.001*Math.random(),L=.5*R,D=v.eps;if(P.isArray(c)){if(c.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");e=c[0],o=l.call(h,e),t=c[1],s=l.call(h,t)}else e=(a=this.findBracket(l,c,h))[0],o=a[1],t=a[2],s=a[3];if(o*s>0)return P.isArray(c)?this.fminbr(l,[e,t],h):this.Newton(l,e,h);d=e,u=t,f=o,b=s;do{if(p=d+L*(u-d),_=l.call(h,p),Math.sign(_)===Math.sign(f)?(n=d,d=p,C=f,f=_):(n=u,u=d,C=b,b=f),E=d=p,x=f=_,Math.abs(b)<Math.abs(f)&&(E=u,x=b),(S=(2*D*Math.abs(E)+5e-6)/Math.abs(u-d))>.5||x===0)break;O=(d-u)/(n-u),w=(f-b)/(C-b),T=1-Math.sqrt(1-O),M=Math.sqrt(O),(L=T<w&&w<M?f/(b-f)*(C/(b-C))+f/(C-f)*(b/(C-b))*((n-d)/(u-d)):.5*R)<S&&(L=S),L>1-S&&(L=1-S),N++}while(N<=A);return E},fminbr:function(l,c,h){var e,o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O=.5*(3-Math.sqrt(5)),w=v.eps,T=v.eps,M=this.maxIterationsMinimize,N=0;if(!P.isArray(c)||c.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(t=s=(e=c[0])+O*((o=c[1])-e),a=s,d=u=l.call(h,s),n=u;N<M;){if(p=o-e,f=.5*(e+o),b=T*Math.abs(t)+w/3,Math.abs(t-f)+.5*p<=2*b)return t;C=O*(t<f?o-t:e-t),Math.abs(t-a)>=b&&(_=(t-s)*(E=(t-s)*(d-n))-(t-a)*(x=(t-a)*(d-u)),(E=2*(E-x))>0?_=-_:E=-E,Math.abs(_)<Math.abs(C*E)&&_>E*(e-t+2*b)&&_<E*(o-t-2*b)&&(C=_/E)),Math.abs(C)<b&&(C=C>0?b:-b),x=t+C,(S=l.call(h,x))<=d?(x<t?o=t:e=t,s=a,a=t,t=x,u=n,n=d,d=S):(x<t?e=x:o=x,S<=n||a===t?(s=a,a=x,u=n,n=S):(S<=u||s===t||s===a)&&(s=x,u=S)),N+=1}return t},RamerDouglasPeucker:function(l,c){var h,e,o,t=[],s=[],a=function(d,u,n,p,f){var b=function(_,E,x){var S,O,w,T,M,N,A,R,L,D,k,B=1e4,I=0,Y=E;if(x-E<2)return[-1,0];if(w=_[E].scrCoords,T=_[x].scrCoords,isNaN(w[1])||isNaN(w[2]))return[NaN,E];if(isNaN(T[1])||isNaN(T[2]))return[NaN,x];for(O=E+1;O<x;O++){if(M=_[O].scrCoords,isNaN(M[1])||isNaN(M[2]))return[NaN,O];N=(N=(N=M[1]-w[1])==1/0?B:N)===-1/0?-B:N,A=(A=(A=M[2]-w[2])==1/0?B:A)===-1/0?-B:A,(D=(R=(R=(R=T[1]-w[1])==1/0?B:R)===-1/0?-B:R)*R+(L=(L=(L=T[2]-w[2])==1/0?B:L)===-1/0?-B:L)*L)>=v.eps?((k=(N*R+A*L)/D)<0?k=0:k>1&&(k=1),S=(N-=k*R)*N+(A-=k*L)*A):(k=0,S=N*N+A*A),S>I&&(I=S,Y=O)}return[Math.sqrt(I),Y]}(d,u,n),C=b[1];if(isNaN(b[0])){a(d,u,C-1,p,f),f.push(d[C]);do++C;while(C<=n&&isNaN(d[C].scrCoords[1]+d[C].scrCoords[2]));C<=n&&f.push(d[C]),a(d,C+1,n,p,f)}else b[0]>p?(a(d,u,C,p,f),a(d,C,n,p,f)):f.push(d[n])};for(o=l.length,h=0;;){for(;h<o&&isNaN(l[h].scrCoords[1]+l[h].scrCoords[2]);)h+=1;for(e=h+1;e<o&&!isNaN(l[e].scrCoords[1]+l[e].scrCoords[2]);)e+=1;if(e--,h<o&&e>h&&((s=[])[0]=l[h],a(l,h,e,c,s),t=t.concat(s)),h>=o)break;e<o-1&&t.push(l[e+1]),h=e+1}return t},RamerDouglasPeuker:function(l,c){return g.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(l,c)},Visvalingam:function(l,c){var h,e,o,t,s,a,d,u,n,p=[],f=[],b=[];if((e=l.length)<=2)return l;for(p[0]={used:!0,lft:null,node:null},s=0,h=1;h<e-1;h++)o=Math.abs(g.Math.Numerics.det([l[h-1].usrCoords,l[h].usrCoords,l[h+1].usrCoords])),isNaN(o)||(n={v:o,idx:h},f.push(n),p[h]={used:!0,lft:s,node:n},p[s].rt=h,s=h);for(p[e-1]={used:!0,rt:null,lft:s,node:null},p[s].rt=e-1,t=-1/0;f.length>c;)f.sort(function(C,_){return _.v-C.v}),p[h=f.pop().idx].used=!1,t=p[h].node.v,s=p[h].lft,a=p[h].rt,p[s].rt=a,p[a].lft=s,(d=p[s].lft)!==null&&(o=Math.abs(g.Math.Numerics.det([l[d].usrCoords,l[s].usrCoords,l[a].usrCoords])),p[s].node.v=o>=t?o:t),(u=p[a].rt)!==null&&(o=Math.abs(g.Math.Numerics.det([l[s].usrCoords,l[a].usrCoords,l[u].usrCoords])),p[a].node.v=o>=t?o:t);b=[l[h=0]];do h=p[h].rt,b.push(l[h]);while(p[h].rt!==null);return b}},v.Numerics}),define("math/nlp",["jxg"],function(g){return g.Math.Nlp={arr:function(P){var y,v=new Array(P);for(y=0;y<P;y++)v[y]=0;return v},arr2:function(P,y){for(var v=0,m=new Array(P);v<P;)m[v]=this.arr(y),v++;return m},arraycopy:function(P,y,v,m,l){for(var c=0;c<l;)v[c+m]=P[c+y],c++},Normal:0,MaxIterationsReached:1,DivergingRoundingErrors:2,FindMinimum:function(P,y,v,m,l,c,h,e){var o,t,s=v+2,a=this.arr(y+1),d=this;return a[0]=0,this.arraycopy(m,0,a,1,y),t=function(u,n,p,f){var b,C,_=d.arr(u);return d.arraycopy(p,1,_,0,u),b=d.arr(n),C=P(u,n,_,b),d.arraycopy(b,0,f,1,n),C},o=this.cobylb(t,y,v,s,a,l,c,h,e),this.arraycopy(a,1,m,0,y),o},cobylb:function(P,y,v,m,l,c,h,e,o){var t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M,N,A,R,L,D,k,B,I,Y,q,V,W=-1,X=0,Q=0,G=y+1,F=v+1,U=c,z=0,re=!1,te=!1,le=0,oe=0,he=0,H=this.arr(1+m),ce=this.arr2(1+y,1+G),de=this.arr2(1+y,1+y),ne=this.arr2(1+m,1+G),ge=this.arr2(1+y,1+F),fe=this.arr(1+y),ye=this.arr(1+y),Ce=this.arr(1+y),ue=this.arr(1+y),Pe=this.arr(1+y);for(e>=2&&console.log("The initial value of RHO is "+U+" and PARMU is set to zero."),f=0,n=1/U,s=1;s<=y;++s)ce[s][G]=l[s],ce[s][s]=U,de[s][s]=n;b=G,C=!1;e:for(;;){if(f>=o&&f>0){W=this.MaxIterationsReached;break e}for(++f,X=P(y,v,l,H),Q=0,d=1;d<=v;++d)Q=Math.max(Q,-H[d]);if(f!==e-1&&e!==3||this.PrintIterationResult(f,X,Q,l,y,e),H[F]=X,H[m]=Q,_=!0,!C){for(_=!1,s=1;s<=m;++s)ne[s][b]=H[s];if(f<=G){if(b<=y)if(ne[F][G]<=X)l[b]=ce[b][G];else{for(ce[b][G]=l[b],d=1;d<=m;++d)ne[d][b]=ne[d][G],ne[d][G]=H[d];for(d=1;d<=b;++d){for(ce[b][d]=-U,n=0,s=d;s<=b;++s)n-=de[s][d];de[b][d]=n}}if(f<=y){l[b=f]+=U;continue e}}C=!0}t:for(;;){i:do{if(!_){for(E=ne[F][G]+z*ne[m][G],x=G,a=1;a<=y;++a)(n=ne[F][a]+z*ne[m][a])<E?(x=a,E=n):n===E&&z===0&&ne[m][a]<ne[m][x]&&(x=a);if(x<=y){for(s=1;s<=m;++s)n=ne[s][G],ne[s][G]=ne[s][x],ne[s][x]=n;for(s=1;s<=y;++s){for(n=ce[s][x],ce[s][x]=0,ce[s][G]+=n,p=0,d=1;d<=y;++d)ce[s][d]-=n,p-=de[d][s];de[x][s]=p}}for(S=0,s=1;s<=y;++s)for(a=1;a<=y;++a)n=this.DOT_PRODUCT(this.PART(this.ROW(de,s),1,y),this.PART(this.COL(ce,a),1,y))-(s===a?1:0),S=Math.max(S,Math.abs(n));if(S>.1){W=this.DivergingRoundingErrors;break e}for(d=1;d<=F;++d){for(H[d]=-ne[d][G],a=1;a<=y;++a)Pe[a]=ne[d][a]+H[d];for(s=1;s<=y;++s)ge[s][d]=(d===F?-1:1)*this.DOT_PRODUCT(this.PART(Pe,1,y),this.PART(this.COL(de,s),1,y))}for(re=!0,le=.25*U,O=2.1*U,a=1;a<=y;++a){for(w=0,d=1;d<=y;++d)w+=de[a][d]*de[a][d];for(T=0,d=1;d<=y;++d)T+=ce[d][a]*ce[d][a];fe[a]=1/Math.sqrt(w),ye[a]=Math.sqrt(T),(fe[a]<le||ye[a]>O)&&(re=!1)}if(!C&&!re){for(b=0,n=O,a=1;a<=y;++a)ye[a]>n&&(b=a,n=ye[a]);if(b===0)for(a=1;a<=y;++a)fe[a]<n&&(b=a,n=fe[a]);for(n=.5*U*fe[b],d=1;d<=y;++d)ue[d]=n*de[b][d];for(M=0,N=0,t=0,d=1;d<=F;++d)t=this.DOT_PRODUCT(this.PART(this.COL(ge,d),1,y),this.PART(ue,1,y)),d<F&&(n=ne[d][G],M=Math.max(M,-t-n),N=Math.max(N,t-n));for(A=z*(M-N)>2*t?-1:1,n=0,s=1;s<=y;++s)ue[s]=A*ue[s],ce[s][b]=ue[s],n+=de[b][s]*ue[s];for(d=1;d<=y;++d)de[b][d]/=n;for(a=1;a<=y;++a){if(a!==b)for(n=this.DOT_PRODUCT(this.PART(this.ROW(de,a),1,y),this.PART(ue,1,y)),d=1;d<=y;++d)de[a][d]-=n*de[b][d];l[a]=ce[a][G]+ue[a]}continue e}if(!(te=this.trstlp(y,v,ge,H,U,ue))){for(n=0,d=1;d<=y;++d)n+=ue[d]*ue[d];if(n<.25*U*U){C=!0;break i}}for(t=0,R=0,H[F]=0,d=1;d<=F;++d)t=H[d]-this.DOT_PRODUCT(this.PART(this.COL(ge,d),1,y),this.PART(ue,1,y)),d<F&&(R=Math.max(R,t));if(z<1.5*(L=(oe=ne[m][G]-R)>0?t/oe:0)){for(z=2*L,e>=2&&console.log("Increase in PARMU to "+z),D=ne[F][G]+z*ne[m][G],a=1;a<=y;++a)if((n=ne[F][a]+z*ne[m][a])<D||n===D&&z===0&&ne[m][a]<ne[m][G])continue t}for(he=z*oe-t,d=1;d<=y;++d)l[d]=ce[d][G]+ue[d];C=!0;continue e}for(_=!1,k=ne[F][G]+z*ne[m][G]-(X+z*Q),z===0&&X===ne[F][G]&&(he=oe,k=ne[m][G]-Q),B=k<=0?1:0,b=0,a=1;a<=y;++a)(n=Math.abs(this.DOT_PRODUCT(this.PART(this.ROW(de,a),1,y),this.PART(ue,1,y))))>B&&(b=a,B=n),Ce[a]=n*fe[a];for(I=1.1*U,u=0,a=1;a<=y;++a)if(Ce[a]>=le||Ce[a]>=fe[a]){if(n=ye[a],k>0){for(n=0,d=1;d<=y;++d)n+=Math.pow(ue[d]-ce[d][a],2);n=Math.sqrt(n)}n>I&&(u=a,I=n)}if(u>0&&(b=u),b!==0){for(n=0,s=1;s<=y;++s)ce[s][b]=ue[s],n+=de[b][s]*ue[s];for(d=1;d<=y;++d)de[b][d]/=n;for(a=1;a<=y;++a)if(a!==b)for(n=this.DOT_PRODUCT(this.PART(this.ROW(de,a),1,y),this.PART(ue,1,y)),d=1;d<=y;++d)de[a][d]-=n*de[b][d];for(d=1;d<=m;++d)ne[d][b]=H[d];if(k>0&&k>=.1*he)continue t}}while(0);if(re){if(U<=h){W=this.Normal;break e}if(Y=0,q=0,(U*=.5)<=1.5*h&&(U=h),z>0){for(V=0,d=1;d<=F;++d){for(q=Y=ne[d][G],s=1;s<=y;++s)Y=Math.min(Y,ne[d][s]),q=Math.max(q,ne[d][s]);d<=v&&Y<.5*q&&(n=Math.max(q,0)-Y,V=V<=0?n:Math.min(V,n))}V===0?z=0:q-Y<z*V&&(z=(q-Y)/V)}e>=2&&console.log("Reduction in RHO to "+U+"  and PARMU = "+z),e===2&&this.PrintIterationResult(f,ne[F][G],ne[m][G],this.COL(ce,G),y,e)}else C=!1}}switch(W){case this.Normal:if(e>=1&&console.log("%nNormal return from subroutine COBYLA%n"),te)return e>=1&&this.PrintIterationResult(f,X,Q,l,y,e),W;break;case this.MaxIterationsReached:e>=1&&console.log("%nReturn from subroutine COBYLA because the MAXFUN limit has been reached.%n");break;case this.DivergingRoundingErrors:e>=1&&console.log("%nReturn from subroutine COBYLA because rounding errors are becoming damaging.%n")}for(d=1;d<=y;++d)l[d]=ce[d][G];return X=ne[F][G],Q=ne[m][G],e>=1&&this.PrintIterationResult(f,X,Q,l,y,e),W},trstlp:function(P,y,v,m,l,c){var h,e,o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M,N,A,R,L,D,k,B,I,Y,q,V,W,X=0,Q=0,G=0,F=this.arr2(1+P,1+P),U=this.arr(2+y),z=this.arr(2+y),re=this.arr(1+P),te=this.arr(1+P),le=this.arr(2+y),oe=this.arr(2+y),he=y,H=0;for(o=1;o<=P;++o)F[o][o]=1,c[o]=0;if(h=0,e=0,y>=1){for(t=1;t<=y;++t)m[t]>e&&(e=m[t],h=t);for(t=1;t<=y;++t)oe[t]=t,z[t]=e-m[t]}s=!0;do{e:for(;;){(!s||s&&e===0)&&(h=he=y+1,oe[he]=he,z[he]=0),s=!1,a=0,d=0,u=0,n=0;t:do{if(p=he===y?e:-this.DOT_PRODUCT(this.PART(c,1,P),this.PART(this.COL(v,he),1,P)),d===0||p<a?(a=p,Q=H,d=3):H>Q?(Q=H,d=3):--d,d===0)break e;if(f=0,h<=H){if(h<H){b=oe[h],C=z[h],t=h;do{for(x=oe[E=t+1],S=this.DOT_PRODUCT(this.PART(this.COL(F,t),1,P),this.PART(this.COL(v,x),1,P)),X=Math.sqrt(S*S+U[E]*U[E]),O=U[E]/X,w=S/X,U[E]=O*U[t],U[t]=X,o=1;o<=P;++o)X=O*F[o][E]+w*F[o][t],F[o][E]=O*F[o][t]-w*F[o][E],F[o][t]=X;oe[t]=x,z[t]=z[E],t=E}while(t<H);oe[t]=b,z[t]=C}if(--H,he>y)for(X=1/U[H],t=1;t<=P;++t)re[t]=X*F[t][H];else for(X=this.DOT_PRODUCT(this.PART(re,1,P),this.PART(this.COL(F,H+1),1,P)),t=1;t<=P;++t)re[t]-=X*F[t][H+1]}else{for(x=oe[h],t=1;t<=P;++t)te[t]=v[t][x];for(T=0,t=P;t>H;){for(S=0,M=0,o=1;o<=P;++o)S+=X=F[o][t]*te[o],M+=Math.abs(X);if(N=M+.1*Math.abs(S),A=M+.2*Math.abs(S),(M>=N||N>=A)&&(S=0),T===0)T=S;else for(E=t+1,O=S/(X=Math.sqrt(S*S+T*T)),w=T/X,T=X,o=1;o<=P;++o)X=O*F[o][t]+w*F[o][E],F[o][E]=O*F[o][E]-w*F[o][t],F[o][t]=X;--t}if(T===0){f=-1,t=H;do{for(R=0,L=0,o=1;o<=P;++o)R+=X=F[o][t]*te[o],L+=Math.abs(X);if(N=L+.1*Math.abs(R),A=L+.2*Math.abs(R),L<N&&N<A){if((X=R/U[t])>0&&oe[t]<=y&&(W=z[t]/X,(f<0||W<f)&&(f=W)),t>=2)for(D=oe[t],o=1;o<=P;++o)te[o]-=X*v[o][D];le[t]=X}else le[t]=0}while(--t>0);if(f<0)break e;for(t=1;t<=H;++t)z[t]=Math.max(0,z[t]-f*le[t]);if(h<H){b=oe[h],C=z[h],t=h;do{for(D=oe[E=t+1],S=this.DOT_PRODUCT(this.PART(this.COL(F,t),1,P),this.PART(this.COL(v,D),1,P)),X=Math.sqrt(S*S+U[E]*U[E]),O=U[E]/X,w=S/X,U[E]=O*U[t],U[t]=X,o=1;o<=P;++o)X=O*F[o][E]+w*F[o][t],F[o][E]=O*F[o][t]-w*F[o][E],F[o][t]=X;oe[t]=D,z[t]=z[E],t=E}while(t<H);oe[t]=b,z[t]=C}if((X=this.DOT_PRODUCT(this.PART(this.COL(F,H),1,P),this.PART(this.COL(v,x),1,P)))===0)break e;U[H]=X,z[h]=0,z[H]=f}else U[++H]=T,z[h]=z[H],z[H]=0;if(oe[h]=oe[H],oe[H]=x,he>y&&x!==he){for(t=H-1,S=this.DOT_PRODUCT(this.PART(this.COL(F,t),1,P),this.PART(this.COL(v,x),1,P)),X=Math.sqrt(S*S+U[H]*U[H]),O=U[H]/X,w=S/X,U[H]=O*U[t],U[t]=X,o=1;o<=P;++o)X=O*F[o][H]+w*F[o][t],F[o][H]=O*F[o][t]-w*F[o][H],F[o][t]=X;oe[H]=oe[t],oe[t]=x,X=z[t],z[t]=z[H],z[H]=X}if(he>y)for(X=1/U[H],t=1;t<=P;++t)re[t]=X*F[t][H];else for(x=oe[H],X=(this.DOT_PRODUCT(this.PART(re,1,P),this.PART(this.COL(v,x),1,P))-1)/U[H],t=1;t<=P;++t)re[t]-=X*F[t][H]}for(k=l*l,I=0,B=0,o=1;o<=P;++o)Math.abs(c[o])>=1e-6*l&&(k-=c[o]*c[o]),I+=c[o]*re[o],B+=re[o]*re[o];if(k<=0)break e;if(X=Math.sqrt(B*k),Math.abs(I)>=1e-6*X&&(X=Math.sqrt(B*k+I*I)),u=n=k/(X+I),he===y){if(A=u+.2*e,u>=(N=u+.1*e)||N>=A)break t;u=Math.min(u,e)}for(t=1;t<=P;++t)te[t]=c[t]+u*re[t];if(he===y)for(G=e,e=0,t=1;t<=H;++t)X=m[x=oe[t]]-this.DOT_PRODUCT(this.PART(this.COL(v,x),1,P),this.PART(te,1,P)),e=Math.max(e,X);t=H;do{for(Y=0,q=0,o=1;o<=P;++o)Y+=X=F[o][t]*te[o],q+=Math.abs(X);if(N=q+.1*Math.abs(Y),A=q+.2*Math.abs(Y),(q>=N||N>=A)&&(Y=0),le[t]=Y/U[t],t>=2)for(x=oe[t],o=1;o<=P;++o)te[o]-=le[t]*v[o][x]}while(t-->=2);for(he>y&&(le[H]=Math.max(0,le[H])),t=1;t<=P;++t)te[t]=c[t]+u*re[t];if(he>H)for(t=H+1;t<=he;++t){for(_=e-m[x=oe[t]],V=e+Math.abs(m[x]),o=1;o<=P;++o)_+=X=v[o][x]*te[o],V+=Math.abs(X);N=V+.1*Math.abs(_),A=V+.2*Math.abs(_),(V>=N||N>=A)&&(_=0),le[t]=_}for(f=1,h=0,t=1;t<=he;++t)le[t]<0&&(X=z[t]/(z[t]-le[t]))<f&&(f=X,h=t);for(X=1-f,t=1;t<=P;++t)c[t]=X*c[t]+f*te[t];for(t=1;t<=he;++t)z[t]=Math.max(0,X*z[t]+f*le[t]);he===y&&(e=G+f*(e-G))}while(h>0);if(u===n)return!0}}while(he===y);return!1},PrintIterationResult:function(P,y,v,m,l,c){c>1&&console.log("NFVALS = "+P+"  F = "+y+"  MAXCV = "+v),c>1&&console.log("X = "+this.PART(m,1,l))},ROW:function(P,y){return P[y].slice()},COL:function(P,y){var v,m=P.length,l=this.arr(m);for(v=0;v<m;++v)l[v]=P[v][y];return l},PART:function(P,y,v){return P.slice(y,v+1)},FORMAT:function(P){return P.join(",")},DOT_PRODUCT:function(P,y){var v,m=0,l=P.length;for(v=0;v<l;++v)m+=P[v]*y[v];return m}},g.Math.Nlp}),define("math/statistics",["jxg","math/math","utils/type"],function(g,P,y){return P.Statistics={sum:function(v){var m,l=v.length,c=0;for(m=0;m<l;m++)c+=v[m];return c},prod:function(v){var m,l=v.length,c=1;for(m=0;m<l;m++)c*=v[m];return c},mean:function(v){return v.length>0?this.sum(v)/v.length:0},median:function(v){var m,l;return v.length>0?(ArrayBuffer.isView(v)?(m=new Float64Array(v)).sort():(m=v.slice(0)).sort(function(c,h){return c-h}),1&(l=m.length)?m[parseInt(.5*l,10)]:.5*(m[.5*l-1]+m[.5*l])):0},percentile:function(v,m){var l,c,h,e,o,t=[];if(v.length>0){for(ArrayBuffer.isView(v)?(l=new Float64Array(v)).sort():(l=v.slice(0)).sort(function(s,a){return s-a}),c=l.length,e=y.isArray(m)?m:[m],h=0;h<e.length;h++)o=c*e[h]*.01,parseInt(o,10)===o?t.push(.5*(l[o-1]+l[o])):t.push(l[parseInt(o,10)]);return y.isArray(m)?t:t[0]}return 0},variance:function(v){var m,l,c,h=v.length;if(h>1){for(m=this.mean(v),l=0,c=0;c<h;c++)l+=(v[c]-m)*(v[c]-m);return l/(v.length-1)}return 0},sd:function(v){return Math.sqrt(this.variance(v))},weightedMean:function(v,m){if(v.length!==m.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return v.length>0?this.mean(this.multiply(v,m)):0},max:function(v){return Math.max.apply(this,v)},min:function(v){return Math.min.apply(this,v)},range:function(v){return[this.min(v),this.max(v)]},abs:function(v){var m,l,c;if(y.isArray(v))if(v.map)c=v.map(Math.abs);else for(l=v.length,c=[],m=0;m<l;m++)c[m]=Math.abs(v[m]);else c=ArrayBuffer.isView(v)?v.map(Math.abs):Math.abs(v);return c},add:function(v,m){var l,c,h=[];if(v=y.evalSlider(v),m=y.evalSlider(m),y.isArray(v)&&y.isNumber(m))for(c=v.length,l=0;l<c;l++)h[l]=v[l]+m;else if(y.isNumber(v)&&y.isArray(m))for(c=m.length,l=0;l<c;l++)h[l]=v+m[l];else if(y.isArray(v)&&y.isArray(m))for(c=Math.min(v.length,m.length),l=0;l<c;l++)h[l]=v[l]+m[l];else h=v+m;return h},div:function(v,m){var l,c,h=[];if(v=y.evalSlider(v),m=y.evalSlider(m),y.isArray(v)&&y.isNumber(m))for(c=v.length,l=0;l<c;l++)h[l]=v[l]/m;else if(y.isNumber(v)&&y.isArray(m))for(c=m.length,l=0;l<c;l++)h[l]=v/m[l];else if(y.isArray(v)&&y.isArray(m))for(c=Math.min(v.length,m.length),l=0;l<c;l++)h[l]=v[l]/m[l];else h=v/m;return h},divide:function(){g.deprecated("Statistics.divide()","Statistics.div()"),P.Statistics.div.apply(P.Statistics,arguments)},mod:function(v,m,l){var c,h,e=[],o=function(t,s){return t%s};if((l=y.def(l,!1))&&(o=P.mod),v=y.evalSlider(v),m=y.evalSlider(m),y.isArray(v)&&y.isNumber(m))for(h=v.length,c=0;c<h;c++)e[c]=o(v[c],m);else if(y.isNumber(v)&&y.isArray(m))for(h=m.length,c=0;c<h;c++)e[c]=o(v,m[c]);else if(y.isArray(v)&&y.isArray(m))for(h=Math.min(v.length,m.length),c=0;c<h;c++)e[c]=o(v[c],m[c]);else e=o(v,m);return e},multiply:function(v,m){var l,c,h=[];if(v=y.evalSlider(v),m=y.evalSlider(m),y.isArray(v)&&y.isNumber(m))for(c=v.length,l=0;l<c;l++)h[l]=v[l]*m;else if(y.isNumber(v)&&y.isArray(m))for(c=m.length,l=0;l<c;l++)h[l]=v*m[l];else if(y.isArray(v)&&y.isArray(m))for(c=Math.min(v.length,m.length),l=0;l<c;l++)h[l]=v[l]*m[l];else h=v*m;return h},subtract:function(v,m){var l,c,h=[];if(v=y.evalSlider(v),m=y.evalSlider(m),y.isArray(v)&&y.isNumber(m))for(c=v.length,l=0;l<c;l++)h[l]=v[l]-m;else if(y.isNumber(v)&&y.isArray(m))for(c=m.length,l=0;l<c;l++)h[l]=v-m[l];else if(y.isArray(v)&&y.isArray(m))for(c=Math.min(v.length,m.length),l=0;l<c;l++)h[l]=v[l]-m[l];else h=v-m;return h},TheilSenRegression:function(v){var m,l,c=[],h=[],e=[];for(m=0;m<v.length;m++){for(h.length=0,l=0;l<v.length;l++)Math.abs(v[l].usrCoords[1]-v[m].usrCoords[1])>P.eps&&(h[l]=(v[l].usrCoords[2]-v[m].usrCoords[2])/(v[l].usrCoords[1]-v[m].usrCoords[1]));c[m]=this.median(h),e.push(v[m].usrCoords[2]-c[m]*v[m].usrCoords[1])}return[this.median(e),this.median(c),-1]},generateGaussian:function(v,m){var l,c,h;if(this.hasSpare)return this.hasSpare=!1,this.spare*m+v;do h=(l=2*Math.random()-1)*l+(c=2*Math.random()-1)*c;while(h>=1||h===0);return h=Math.sqrt(-2*Math.log(h)/h),this.spare=c*h,this.hasSpare=!0,v+m*l*h}},P.Statistics}),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],function(g,P,y,v,m,l,c){return v.Geometry={},g.extend(v.Geometry,{angle:function(h,e,o){var t,s,a,d,u=[],n=[],p=[];return g.deprecated("Geometry.angle()","Geometry.rad()"),h.coords?(u[0]=h.coords.usrCoords[1],u[1]=h.coords.usrCoords[2]):(u[0]=h[0],u[1]=h[1]),e.coords?(n[0]=e.coords.usrCoords[1],n[1]=e.coords.usrCoords[2]):(n[0]=e[0],n[1]=e[1]),o.coords?(p[0]=o.coords.usrCoords[1],p[1]=o.coords.usrCoords[2]):(p[0]=o[0],p[1]=o[1]),t=u[0]-n[0],s=u[1]-n[1],a=p[0]-n[0],d=p[1]-n[1],Math.atan2(t*d-s*a,t*a+s*d)},trueAngle:function(h,e,o){return 57.29577951308232*this.rad(h,e,o)},rad:function(h,e,o){var t,s,a,d,u,n,p;return h.coords?(t=h.coords.usrCoords[1],s=h.coords.usrCoords[2]):(t=h[0],s=h[1]),e.coords?(a=e.coords.usrCoords[1],d=e.coords.usrCoords[2]):(a=e[0],d=e[1]),o.coords?(u=o.coords.usrCoords[1],n=o.coords.usrCoords[2]):(u=o[0],n=o[1]),(p=Math.atan2(n-d,u-a)-Math.atan2(s-d,t-a))<0&&(p+=6.283185307179586),p},angleBisector:function(h,e,o,t){var s,a,d,u,n,p=h.coords.usrCoords,f=e.coords.usrCoords,b=o.coords.usrCoords;return l.exists(t)||(t=h.board),f[0]===0?new y(P.COORDS_BY_USER,[1,.5*(p[1]+b[1]),.5*(p[2]+b[2])],t):(u=p[1]-f[1],n=p[2]-f[2],s=Math.atan2(n,u),u=b[1]-f[1],n=b[2]-f[2],d=.5*(s+(a=Math.atan2(n,u))),s>a&&(d+=Math.PI),u=Math.cos(d)+f[1],n=Math.sin(d)+f[2],new y(P.COORDS_BY_USER,[1,u,n],t))},reflection:function(h,e,o){var t,s,a,d,u,n,p=e.coords.usrCoords,f=h.point1.coords.usrCoords,b=h.point2.coords.usrCoords;return l.exists(o)||(o=e.board),d=b[1]-f[1],u=b[2]-f[2],t=p[1]-f[1],n=(d*(p[2]-f[2])-u*t)/(d*d+u*u),s=p[1]+2*n*u,a=p[2]-2*n*d,new y(P.COORDS_BY_USER,[s,a],o)},rotation:function(h,e,o,t){var s,a,d,u,n,p,f=e.coords.usrCoords,b=h.coords.usrCoords;return l.exists(t)||(t=e.board),s=f[1]-b[1],a=f[2]-b[2],n=s*(d=Math.cos(o))-a*(u=Math.sin(o))+b[1],p=s*u+a*d+b[2],new y(P.COORDS_BY_USER,[n,p],t)},perpendicular:function(h,e,o){var t,s,a,d,u,n=h.point1.coords.usrCoords,p=h.point2.coords.usrCoords,f=e.coords.usrCoords;return l.exists(o)||(o=e.board),e===h.point1?(t=n[1]+p[2]-n[2],s=n[2]-p[1]+n[1],u=n[0]*p[0],Math.abs(u)<v.eps&&(t=p[2],s=-p[1]),d=[u,t,s],a=!0):e===h.point2?(t=p[1]+n[2]-p[2],s=p[2]-n[1]+p[1],u=n[0]*p[0],Math.abs(u)<v.eps&&(t=n[2],s=-n[1]),d=[u,t,s],a=!1):Math.abs(v.innerProduct(f,h.stdform,3))<v.eps?(t=f[1]+p[2]-f[2],s=f[2]-p[1]+f[1],u=p[0],Math.abs(u)<v.eps&&(t=p[2],s=-p[1]),a=!0,Math.abs(u)>v.eps&&Math.abs(t-f[1])<v.eps&&Math.abs(s-f[2])<v.eps&&(t=f[1]+n[2]-f[2],s=f[2]-n[1]+f[1],a=!1),d=[u,t,s]):(d=[0,h.stdform[1],h.stdform[2]],d=v.crossProduct(d,f),d=v.crossProduct(d,h.stdform),a=!0),[new y(P.COORDS_BY_USER,d,o),a]},circumcenterMidpoint:function(){g.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(h,e,o,t){var s,a,d,u,n=h.coords.usrCoords,p=e.coords.usrCoords,f=o.coords.usrCoords;return l.exists(t)||(t=h.board),s=[p[0]-n[0],-p[2]+n[2],p[1]-n[1]],a=[.5*(n[0]+p[0]),.5*(n[1]+p[1]),.5*(n[2]+p[2])],d=v.crossProduct(s,a),s=[f[0]-p[0],-f[2]+p[2],f[1]-p[1]],a=[.5*(p[0]+f[0]),.5*(p[1]+f[1]),.5*(p[2]+f[2])],u=v.crossProduct(s,a),new y(P.COORDS_BY_USER,v.crossProduct(d,u),t)},distance:function(h,e,o){var t,s=0;for(o||(o=Math.min(h.length,e.length)),t=0;t<o;t++)s+=(h[t]-e[t])*(h[t]-e[t]);return Math.sqrt(s)},affineDistance:function(h,e,o){var t;return(t=this.distance(h,e,o))>v.eps&&(Math.abs(h[0])<v.eps||Math.abs(e[0])<v.eps)?1/0:t},affineRatio:function(h,e,o){var t;return l.exists(h.usrCoords)&&(h=h.usrCoords),l.exists(e.usrCoords)&&(e=e.usrCoords),l.exists(o.usrCoords)&&(o=o.usrCoords),t=e[1]-h[1],Math.abs(t)>v.eps?(o[1]-h[1])/t:(o[2]-h[2])/(e[2]-h[2])},sortVertices:function(h){for(var e,o=c.each(h,c.coordsArray),t=o.length,s=null;o[0][0]===o[t-1][0]&&o[0][1]===o[t-1][1]&&o[0][2]===o[t-1][2];)s=o.pop(),t--;return e=o[0],o.sort(function(a,d){return(a[2]===e[2]&&a[1]===e[1]?-1/0:Math.atan2(a[2]-e[2],a[1]-e[1]))-(d[2]===e[2]&&d[1]===e[1]?-1/0:Math.atan2(d[2]-e[2],d[1]-e[1]))}),s!==null&&o.push(s),o},signedTriangle:function(h,e,o){var t=c.coordsArray(h),s=c.coordsArray(e),a=c.coordsArray(o);return .5*((s[1]-t[1])*(a[2]-t[2])-(s[2]-t[2])*(a[1]-t[1]))},signedPolygon:function(h,e){var o,t,s=0,a=c.each(h,c.coordsArray);for(e===void 0&&(e=!0),e?a.unshift(a[a.length-1]):a=this.sortVertices(a),t=a.length,o=1;o<t;o++)s+=a[o-1][1]*a[o][2]-a[o][1]*a[o-1][2];return .5*s},GrahamScan:function(h){var e,o=1,t=c.each(h,c.coordsArray),s=t.length;for(s=(t=this.sortVertices(t)).length,e=2;e<s;e++){for(;this.signedTriangle(t[o-1],t[o],t[e])<=0;){if(o>1)o-=1;else if(e===s-1)break;e+=1}o+=1,t=l.swap(t,o,e)}return t.slice(0,o)},calcStraight:function(h,e,o,t){var s,a,d,u,n,p,f,b,C,_;if(l.exists(t)||(t=10),p=l.evaluate(h.visProp.straightfirst),f=l.evaluate(h.visProp.straightlast),Math.abs(e.scrCoords[0])<v.eps&&(p=!0),Math.abs(o.scrCoords[0])<v.eps&&(f=!0),(p||f)&&((b=[])[0]=h.stdform[0]-h.stdform[1]*h.board.origin.scrCoords[1]/h.board.unitX+h.stdform[2]*h.board.origin.scrCoords[2]/h.board.unitY,b[1]=h.stdform[1]/h.board.unitX,b[2]=-h.stdform[2]/h.board.unitY,!isNaN(b[0]+b[1]+b[2]))){if(s=!p&&Math.abs(e.usrCoords[0])>=v.eps&&e.scrCoords[1]>=0&&e.scrCoords[1]<=h.board.canvasWidth&&e.scrCoords[2]>=0&&e.scrCoords[2]<=h.board.canvasHeight,a=!f&&Math.abs(o.usrCoords[0])>=v.eps&&o.scrCoords[1]>=0&&o.scrCoords[1]<=h.board.canvasWidth&&o.scrCoords[2]>=0&&o.scrCoords[2]<=h.board.canvasHeight,u=(d=this.meetLineBoard(b,h.board,t))[0],n=d[1],!s&&!a&&(!p&&f&&!this.isSameDirection(e,o,u)&&!this.isSameDirection(e,o,n)||p&&!f&&!this.isSameDirection(o,e,u)&&!this.isSameDirection(o,e,n)))return;s?a||(_=this.isSameDir(e,o,u,n)?n:u):a?C=this.isSameDir(e,o,u,n)?u:n:this.isSameDir(e,o,u,n)?(C=u,_=n):(_=u,C=n),C&&e.setCoordinates(P.COORDS_BY_USER,C.usrCoords),_&&o.setCoordinates(P.COORDS_BY_USER,_.usrCoords)}},calcLineDelimitingPoints:function(h,e,o){var t,s,a,d,u,n,p,f,b,C,_;if(u=l.evaluate(h.visProp.straightfirst),n=l.evaluate(h.visProp.straightlast),Math.abs(e.scrCoords[0])<v.eps&&(u=!0),Math.abs(o.scrCoords[0])<v.eps&&(n=!0),(p=[])[0]=h.stdform[0]-h.stdform[1]*h.board.origin.scrCoords[1]/h.board.unitX+h.stdform[2]*h.board.origin.scrCoords[2]/h.board.unitY,p[1]=h.stdform[1]/h.board.unitX,p[2]=-h.stdform[2]/h.board.unitY,!isNaN(p[0]+p[1]+p[2])){if(C=!u,_=!n,s=h.board.getBoundingBox(),h.getSlope()>=0?(a=this.projectPointToLine({coords:{usrCoords:[1,s[2],s[1]]}},h,h.board),d=this.projectPointToLine({coords:{usrCoords:[1,s[0],s[3]]}},h,h.board)):(a=this.projectPointToLine({coords:{usrCoords:[1,s[0],s[1]]}},h,h.board),d=this.projectPointToLine({coords:{usrCoords:[1,s[2],s[3]]}},h,h.board)),!C&&!_&&(!u&&!n&&(t=e.distance(P.COORDS_BY_USER,o),Math.abs(e.distance(P.COORDS_BY_USER,a)+a.distance(P.COORDS_BY_USER,o)-t)>v.eps||Math.abs(e.distance(P.COORDS_BY_USER,d)+d.distance(P.COORDS_BY_USER,o)-t)>v.eps)||!u&&n&&!this.isSameDirection(e,o,a)&&!this.isSameDirection(e,o,d)||u&&!n&&!this.isSameDirection(o,e,a)&&!this.isSameDirection(o,e,d)))return;C?_||(b=this.isSameDir(e,o,a,d)?d:a):_?f=this.isSameDir(e,o,a,d)?a:d:this.isSameDir(e,o,a,d)?(f=a,b=d):(b=a,f=d),f&&e.setCoordinates(P.COORDS_BY_USER,f.usrCoords),b&&o.setCoordinates(P.COORDS_BY_USER,b.usrCoords)}},calcLabelQuadrant:function(h){return h<0&&(h+=2*Math.PI),["rt","urt","top","ulft","lft","llft","lrt"][Math.floor((h+Math.PI/8)/(Math.PI/4))%8]},isSameDir:function(h,e,o,t){var s=e.usrCoords[1]-h.usrCoords[1],a=e.usrCoords[2]-h.usrCoords[2],d=t.usrCoords[1]-o.usrCoords[1],u=t.usrCoords[2]-o.usrCoords[2];return Math.abs(e.usrCoords[0])<v.eps&&(s=e.usrCoords[1],a=e.usrCoords[2]),Math.abs(h.usrCoords[0])<v.eps&&(s=-h.usrCoords[1],a=-h.usrCoords[2]),s*d+a*u>=0},isSameDirection:function(h,e,o){var t,s,a,d,u=!1;return t=e.usrCoords[1]-h.usrCoords[1],s=e.usrCoords[2]-h.usrCoords[2],a=o.usrCoords[1]-h.usrCoords[1],d=o.usrCoords[2]-h.usrCoords[2],Math.abs(t)<v.eps&&(t=0),Math.abs(s)<v.eps&&(s=0),Math.abs(a)<v.eps&&(a=0),Math.abs(d)<v.eps&&(d=0),(t>=0&&a>=0||t<=0&&a<=0)&&(u=s>=0&&d>=0||s<=0&&d<=0),u},intersectionFunction:function(h,e,o,t,s,a){var d,u,n=this;return d=e.elementClass===P.OBJECT_CLASS_CURVE&&(e.type===P.OBJECT_TYPE_ARC||e.type===P.OBJECT_TYPE_SECTOR),u=o.elementClass===P.OBJECT_CLASS_CURVE&&(o.type===P.OBJECT_TYPE_ARC||o.type===P.OBJECT_TYPE_SECTOR),e.elementClass!==P.OBJECT_CLASS_CURVE&&o.elementClass!==P.OBJECT_CLASS_CURVE||e.elementClass!==P.OBJECT_CLASS_CURVE&&e.elementClass!==P.OBJECT_CLASS_CIRCLE||o.elementClass!==P.OBJECT_CLASS_CURVE&&o.elementClass!==P.OBJECT_CLASS_CIRCLE?e.elementClass===P.OBJECT_CLASS_CURVE&&!d&&o.elementClass===P.OBJECT_CLASS_LINE||o.elementClass===P.OBJECT_CLASS_CURVE&&!u&&e.elementClass===P.OBJECT_CLASS_LINE?function(){return n.meetCurveLine(e,o,t,e.board,a)}:e.elementClass===P.OBJECT_CLASS_LINE&&o.elementClass===P.OBJECT_CLASS_LINE?function(){var p,f,b=l.evaluate(e.visProp.straightfirst),C=l.evaluate(e.visProp.straightlast),_=l.evaluate(o.visProp.straightfirst),E=l.evaluate(o.visProp.straightlast);return l.evaluate(a)||b&&C&&_&&E?n.meet(e.stdform,o.stdform,t,e.board):(p=n.meetSegmentSegment(e.point1.coords.usrCoords,e.point2.coords.usrCoords,o.point1.coords.usrCoords,o.point2.coords.usrCoords),f=!b&&p[1]<0||!C&&p[1]>1||!_&&p[2]<0||!E&&p[2]>1?[0,NaN,NaN]:p[0],new y(P.COORDS_BY_USER,f,e.board))}:function(){var p,f,b,C=n.meet(e.stdform,o.stdform,t,e.board),_=!0;return a?C:(e.elementClass!==P.OBJECT_CLASS_LINE||(p=l.evaluate(e.visProp.straightfirst),f=l.evaluate(e.visProp.straightlast),p&&f||(b=n.affineRatio(e.point1.coords,e.point2.coords,C),!(!f&&b>1+v.eps||!p&&b<0-v.eps))))&&(o.elementClass!==P.OBJECT_CLASS_LINE||(p=l.evaluate(o.visProp.straightfirst),f=l.evaluate(o.visProp.straightlast),p&&f||(b=n.affineRatio(o.point1.coords,o.point2.coords,C),!(!f&&b>1+v.eps||!p&&b<0-v.eps))))?d&&((_=n.coordsOnArc(e,C))&&u&&(_=n.coordsOnArc(o,C)),!_)?new y(g.COORDS_BY_USER,[0,NaN,NaN],e.board):C:new y(g.COORDS_BY_USER,[0,NaN,NaN],e.board)}:function(){return n.meetCurveCurve(e,o,t,s,e.board)}},coordsOnArc:function(h,e){var o=this.rad(h.radiuspoint,h.center,e.usrCoords.slice(1)),t=0,s=this.rad(h.radiuspoint,h.center,h.anglepoint),a=l.evaluate(h.visProp.selection);return(a==="minor"&&s>Math.PI||a==="major"&&s<Math.PI)&&(t=s,s=2*Math.PI),!(o<t||o>s)},meet:function(h,e,o,t){var s=v.eps;return Math.abs(h[3])<s&&Math.abs(e[3])<s?this.meetLineLine(h,e,o,t):Math.abs(h[3])>=s&&Math.abs(e[3])<s?this.meetLineCircle(e,h,o,t):Math.abs(h[3])<s&&Math.abs(e[3])>=s?this.meetLineCircle(h,e,o,t):this.meetCircleCircle(h,e,o,t)},meetLineBoard:function(h,e,o){var t,s,a,d,u=[];for(l.exists(o)||(o=0),u[0]=v.crossProduct(h,[o,0,1]),u[1]=v.crossProduct(h,[o,1,0]),u[2]=v.crossProduct(h,[-o-e.canvasHeight,0,1]),u[3]=v.crossProduct(h,[-o-e.canvasWidth,1,0]),a=0;a<4;a++)if(Math.abs(u[a][0])>v.eps){for(d=2;d>0;d--)u[a][d]/=u[a][0];u[a][0]=1}return Math.abs(u[1][0])<v.eps?(t=u[0],s=u[2]):Math.abs(u[0][0])<v.eps?(t=u[1],s=u[3]):u[1][2]<0?(t=u[0],s=u[3][2]>e.canvasHeight?u[2]:u[3]):u[1][2]>e.canvasHeight?(t=u[2],s=u[3][2]<0?u[0]:u[3]):(t=u[1],s=u[3][2]<0?u[0]:u[3][2]>e.canvasHeight?u[2]:u[3]),[t=new y(P.COORDS_BY_SCREEN,t.slice(1),e),s=new y(P.COORDS_BY_SCREEN,s.slice(1),e)]},meetLineLine:function(h,e,o,t){var s=isNaN(h[5]+e[5])?[0,0,0]:v.crossProduct(h,e);return new y(P.COORDS_BY_USER,s,t)},meetLineCircle:function(h,e,o,t){var s,a,d,u,n,p,f,b,C;return e[4]<v.eps?Math.abs(v.innerProduct([1,e[6],e[7]],h,3))<v.eps?new y(P.COORDS_BY_USER,e.slice(6,8),t):new y(P.COORDS_BY_USER,[NaN,NaN],t):(d=e[0],a=e.slice(1,3),s=e[3],u=h[0],n=h.slice(1,3),p=s,(b=(f=a[0]*n[1]-a[1]*n[0])*f-4*p*(s*u*u-(a[0]*n[0]+a[1]*n[1])*u+d))>-v.eps*v.eps?(C=[(-f+(b=Math.sqrt(Math.abs(b))))/(2*p),(-f-b)/(2*p)],new y(P.COORDS_BY_USER,o===0?[-C[0]*-n[1]-u*n[0],-C[0]*n[0]-u*n[1]]:[-C[1]*-n[1]-u*n[0],-C[1]*n[0]-u*n[1]],t)):new y(P.COORDS_BY_USER,[0,0,0],t))},meetCircleCircle:function(h,e,o,t){var s;return h[4]<v.eps?Math.abs(this.distance(h.slice(6,2),e.slice(6,8))-e[4])<v.eps?new y(P.COORDS_BY_USER,h.slice(6,8),t):new y(P.COORDS_BY_USER,[0,0,0],t):e[4]<v.eps?Math.abs(this.distance(e.slice(6,2),h.slice(6,8))-h[4])<v.eps?new y(P.COORDS_BY_USER,e.slice(6,8),t):new y(P.COORDS_BY_USER,[0,0,0],t):(s=[e[3]*h[0]-h[3]*e[0],e[3]*h[1]-h[3]*e[1],e[3]*h[2]-h[3]*e[2],0,1,1/0,1/0,1/0],s=v.normalize(s),this.meetLineCircle(s,h,o,t))},meetCurveCurve:function(h,e,o,t,s,a){var d;return d=l.exists(a)&&a==="newton"?m.generalizedNewton(h,e,o,t):h.bezierDegree===3||e.bezierDegree===3?this.meetBezierCurveRedBlueSegments(h,e,o):this.meetCurveRedBlueSegments(h,e,o),new y(P.COORDS_BY_USER,d,s)},meetCurveLine:function(h,e,o,t,s){var a,d;return l.exists(t)||(t=h.board),h.elementClass===P.OBJECT_CLASS_CURVE?(a=h,d=e):(a=e,d=h),this.meetCurveLineDiscrete(a,d,o,t,!s)},meetCurveLineContinuous:function(h,e,o,t,s){var a,d,u,n,p,f,b,C,_,E,x,S,O,w=v.eps,T=v.eps;for(n=this.meetCurveLineDiscrete(h,e,o,t,s),p=n.usrCoords[1],f=n.usrCoords[2],d=function(M){var N,A;return M>h.maxX()||M<h.minX()?1/0:(N=p-h.X(M))*N+(A=f-h.Y(M))*A},u=function(M){var N=e.stdform[0]+e.stdform[1]*h.X(M)+e.stdform[2]*h.Y(M);return N*N},C=(h.maxX()-h.minX())/50,_=h.minX(),S=1e-4,x=NaN,E=0;E<50&&(a=m.root(d,[Math.max(_,h.minX()),Math.min(_+C,h.maxX())]),!((O=Math.abs(d(a)))<=S&&(x=a,(S=O)<w)));E++)_+=C;return a=x,O=u(a=m.root(u,[Math.max(a-C,h.minX()),Math.min(a+C,h.maxX())])),b=isNaN(O)||Math.abs(O)>T?0:1,new y(P.COORDS_BY_USER,[b,h.X(a),h.Y(a)],t)},meetCurveLineDiscrete:function(h,e,o,t,s){var a,d,u,n,p,f,b,C=e.point1.coords.usrCoords,_=e.point2.coords.usrCoords,E=0,x=h.numberPoints,S=l.evaluate(e.visProp.straightfirst),O=l.evaluate(e.visProp.straightlast);for(f=new y(P.COORDS_BY_USER,[0,NaN,NaN],t),C[0]===0?C=[1,_[1]+e.stdform[2],_[2]-e.stdform[1]]:_[0]===0&&(_=[1,C[1]+e.stdform[2],C[2]-e.stdform[1]]),n=h.points[0].usrCoords,a=1;a<x;a+=h.bezierDegree)if(u=n.slice(0),n=h.points[a].usrCoords,this.distance(u,n)>v.eps){for(b=h.bezierDegree===3?this.meetBeziersegmentBeziersegment([h.points[a-1].usrCoords.slice(1),h.points[a].usrCoords.slice(1),h.points[a+1].usrCoords.slice(1),h.points[a+2].usrCoords.slice(1)],[C.slice(1),_.slice(1)],s):[this.meetSegmentSegment(u,n,C,_)],d=0;d<b.length;d++)if(0<=(p=b[d])[1]&&p[1]<=1){if(E===o)return s&&(!S&&p[2]<0||!O&&p[2]>1)?f:f=new y(P.COORDS_BY_USER,p[0],t);E+=1}}return f},meetCurveRedBlueSegments:function(h,e,o){var t,s,a,d,u,n,p,f,b,C=0,_=e.numberPoints,E=h.numberPoints;if(_<=1||E<=1)return[0,NaN,NaN];for(t=1;t<E;t++)for(a=h.points[t-1].usrCoords,d=h.points[t].usrCoords,f=Math.min(a[1],d[1]),b=Math.max(a[1],d[1]),n=e.points[0].usrCoords,s=1;s<_;s++)if(u=n,n=e.points[s].usrCoords,Math.min(u[1],n[1])<b&&Math.max(u[1],n[1])>f&&(p=this.meetSegmentSegment(a,d,u,n))[1]>=0&&p[2]>=0&&(p[1]<1&&p[2]<1||t===E-1&&p[1]===1||s===_-1&&p[2]===1)){if(C===o)return p[0];C++}return[0,NaN,NaN]},meetSegmentSegment:function(h,e,o,t){var s,a,d,u=v.crossProduct(h,e),n=v.crossProduct(o,t),p=v.crossProduct(u,n);return Math.abs(p[0])<v.eps?[p,1/0,1/0]:(p[1]/=p[0],p[2]/=p[0],p[0]/=p[0],d=h[a=Math.abs(e[1]-e[0]*h[1])<v.eps?2:1]/h[0],s=(p[a]-d)/(e[0]!==0?e[a]/e[0]-d:e[a]),d=o[a=Math.abs(t[1]-t[0]*o[1])<v.eps?2:1]/o[0],[p,s,(p[a]-d)/(t[0]!==0?t[a]/t[0]-d:t[a])])},_bezierSplit:function(h){var e,o,t,s,a,d;return e=[.5*(h[0][0]+h[1][0]),.5*(h[0][1]+h[1][1])],o=[.5*(h[1][0]+h[2][0]),.5*(h[1][1]+h[2][1])],t=[.5*(h[2][0]+h[3][0]),.5*(h[2][1]+h[3][1])],d=[.5*((s=[.5*(e[0]+o[0]),.5*(e[1]+o[1])])[0]+(a=[.5*(o[0]+t[0]),.5*(o[1]+t[1])])[0]),.5*(s[1]+a[1])],[[h[0],e,s,d],[d,a,t,h[3]]]},_bezierBbox:function(h){var e=[];return h.length===4?(e[0]=Math.min(h[0][0],h[1][0],h[2][0],h[3][0]),e[1]=Math.max(h[0][1],h[1][1],h[2][1],h[3][1]),e[2]=Math.max(h[0][0],h[1][0],h[2][0],h[3][0]),e[3]=Math.min(h[0][1],h[1][1],h[2][1],h[3][1])):(e[0]=Math.min(h[0][0],h[1][0]),e[1]=Math.max(h[0][1],h[1][1]),e[2]=Math.max(h[0][0],h[1][0]),e[3]=Math.min(h[0][1],h[1][1])),e},_bezierOverlap:function(h,e){return h[2]>=e[0]&&h[0]<=e[2]&&h[1]>=e[3]&&h[3]<=e[1]},_bezierListConcat:function(h,e,o,t){var s,a=l.exists(t),d=0,u=e.length,n=h.length;for(n>0&&u>0&&(h[n-1][1]===1&&e[0][1]===0||a&&h[n-1][2]===1&&e[0][2]===0)&&(d=1),s=d;s<u;s++)a&&(e[s][2]*=.5,e[s][2]+=t),e[s][1]*=.5,e[s][1]+=o,h.push(e[s])},_bezierMeetSubdivision:function(h,e,o){var t,s,a,d,u,n,p,f,b,C,_,E,x=[];return s=this._bezierBbox(e),t=this._bezierBbox(h),this._bezierOverlap(s,t)?o<5?(n=(a=this._bezierSplit(h))[0],p=a[1],d=(a=this._bezierSplit(e))[0],u=a[1],this._bezierListConcat(x,this._bezierMeetSubdivision(n,d,o+1),0,0),this._bezierListConcat(x,this._bezierMeetSubdivision(n,u,o+1),0,.5),this._bezierListConcat(x,this._bezierMeetSubdivision(p,d,o+1),.5,0),this._bezierListConcat(x,this._bezierMeetSubdivision(p,u,o+1),.5,.5),x):(_=[1].concat(h[0]),E=[1].concat(h[3]),b=[1].concat(e[0]),C=[1].concat(e[3]),(f=this.meetSegmentSegment(_,E,b,C))[1]>=0&&f[2]>=0&&f[1]<=1&&f[2]<=1?[f]:[]):[]},_bezierLineMeetSubdivision:function(h,e,o,t){var s,a,d,u,n,p,f,b,C,_,E=[];return s=this._bezierBbox(e),a=this._bezierBbox(h),t&&!this._bezierOverlap(a,s)?[]:o<5?(u=(d=this._bezierSplit(h))[0],n=d[1],this._bezierListConcat(E,this._bezierLineMeetSubdivision(u,e,o+1),0),this._bezierListConcat(E,this._bezierLineMeetSubdivision(n,e,o+1),.5),E):(C=[1].concat(h[0]),_=[1].concat(h[3]),f=[1].concat(e[0]),b=[1].concat(e[1]),(p=this.meetSegmentSegment(C,_,f,b))[1]>=0&&p[1]<=1&&(!t||p[2]>=0&&p[2]<=1)?[p]:[])},meetBeziersegmentBeziersegment:function(h,e,o){var t,s,a;for((t=h.length===4&&e.length===4?this._bezierMeetSubdivision(h,e,0):this._bezierLineMeetSubdivision(h,e,0,o)).sort(function(d,u){return 1e7*(d[1]-u[1])+(d[2]-u[2])}),s=[],a=0;a<t.length;a++)a!==0&&t[a][1]===t[a-1][1]&&t[a][2]===t[a-1][2]||s.push(t[a]);return s},meetBezierCurveRedBlueSegments:function(h,e,o){var t,s,a,d,u,n,p,f,b,C,_=0,E=0,x=e.numberPoints,S=h.numberPoints,O=[];if(x<e.bezierDegree+1||S<h.bezierDegree+1)return[0,NaN,NaN];for(x-=e.bezierDegree,S-=h.bezierDegree,h.type===P.OBJECT_TYPE_SECTOR&&(_=3,S-=3),e.type===P.OBJECT_TYPE_SECTOR&&(E=3,x-=3),s=_;s<S;s+=h.bezierDegree)for(n=[(t=h.points)[s].usrCoords.slice(1),t[s+1].usrCoords.slice(1)],h.bezierDegree===3&&(n[2]=t[s+2].usrCoords.slice(1),n[3]=t[s+3].usrCoords.slice(1)),f=this._bezierBbox(n),a=E;a<x;a+=e.bezierDegree)if(p=[(t=e.points)[a].usrCoords.slice(1),t[a+1].usrCoords.slice(1)],e.bezierDegree===3&&(p[2]=t[a+2].usrCoords.slice(1),p[3]=t[a+3].usrCoords.slice(1)),b=this._bezierBbox(p),this._bezierOverlap(f,b)){if((C=this.meetBeziersegmentBeziersegment(n,p)).length===0)continue;for(d=0;d<C.length;d++)(u=C[d])[1]<-v.eps||u[1]>1+v.eps||u[2]<-v.eps||u[2]>1+v.eps||O.push(u);if(O.length>o)return O[o][0]}return O.length>o?O[o][0]:[0,NaN,NaN]},bezierSegmentEval:function(h,e){var o,t,s,a=1-h;return t=0,s=0,t+=(o=a*a*a)*e[0][0],s+=o*e[0][1],t+=(o=3*h*a*a)*e[1][0],s+=o*e[1][1],t+=(o=3*h*h*a)*e[2][0],s+=o*e[2][1],[1,t+=(o=h*h*h)*e[3][0],s+=o*e[3][1]]},bezierArc:function(h,e,o,t,s){var a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M,N,A=.5*Math.PI,R=e[1],L=e[2],D=e[0],k=[],B=[];for(p=this.distance(e,h),R/=D,L/=D,f=this.rad(h.slice(1),e.slice(1),o.slice(1)),s===-1&&(f=2*Math.PI-f),(a=h)[1]/=a[0],a[2]/=a[0],a[0]/=a[0],n=a.slice(0),t?(k=[R,R+.333*(a[1]-R),R+.666*(a[1]-R),a[1]],B=[L,L+.333*(a[2]-L),L+.666*(a[2]-L),a[2]]):(k=[a[1]],B=[a[2]]);f>v.eps;)f>A?(b=A,f-=A):(b=f,f=0),N=[[1,0,0],[R*(1-(C=Math.cos(s*b)))+L*(_=Math.sin(s*b)),C,-_],[L*(1-C)-R*_,_,C]],n=[(T=v.matVecMult(N,a))[0]/T[0],T[1]/T[0],T[2]/T[0]],E=a[1]-R,x=a[2]-L,S=n[1]-R,O=n[2]-L,M=Math.sqrt((E+S)*(E+S)+(x+O)*(x+O)),w=Math.abs(O-x)>v.eps?(E+S)*(p/M-.5)/(O-x)*8/3:(x+O)*(p/M-.5)/(E-S)*8/3,d=[1,a[1]-w*x,a[2]+w*E],u=[1,n[1]+w*O,n[2]-w*S],k=k.concat([d[1],u[1],n[1]]),B=B.concat([d[2],u[2],n[2]]),a=n.slice(0);return t&&(k=k.concat([n[1]+.333*(R-n[1]),n[1]+.666*(R-n[1]),R]),B=B.concat([n[2]+.333*(L-n[2]),n[2]+.666*(L-n[2]),L])),[k,B]},projectPointToCircle:function(h,e,o){var t,s,a,d,u,n=e.center.coords.usrCoords;return l.exists(o)||(o=h.board),l.isPoint(h)?(t=h.coords.distance(P.COORDS_BY_USER,e.center.coords),s=h.coords.usrCoords):(t=h.distance(P.COORDS_BY_USER,e.center.coords),s=h.usrCoords),Math.abs(t)<v.eps&&(t=v.eps),u=e.Radius()/t,a=n[1]+u*(s[1]-n[1]),d=n[2]+u*(s[2]-n[2]),new y(P.COORDS_BY_USER,[a,d],o)},projectPointToLine:function(h,e,o){var t,s=[0,e.stdform[1],e.stdform[2]];return l.exists(o)||(o=l.exists(h.coords)?h.board:e.board),t=l.exists(h.coords)?h.coords.usrCoords:h.usrCoords,s=v.crossProduct(s,t),new y(P.COORDS_BY_USER,v.crossProduct(s,e.stdform),o)},projectCoordsToSegment:function(h,e,o){var t,s=[o[1]-e[1],o[2]-e[2]],a=[h[1]-e[1],h[2]-e[2]];return Math.abs(s[0])<v.eps&&Math.abs(s[1])<v.eps?[e,0]:(t=v.innerProduct(a,s),[[1,(t/=v.innerProduct(s,s))*s[0]+e[1],t*s[1]+e[2]],t])},projectCoordsToBeziersegment:function(h,e,o){var t;return t=g.Math.Numerics.fminbr(function(s){var a=[1,e.X(o+s),e.Y(o+s)];return a[1]-=h[1],a[2]-=h[2],a[1]*a[1]+a[2]*a[2]},[0,1]),[[1,e.X(t+o),e.Y(t+o)],t]},projectPointToCurve:function(h,e,o){l.exists(o)||(o=h.board);var t=h.X(),s=h.Y(),a=h.position||0;return this.projectCoordsToCurve(t,s,a,e,o)},projectCoordsToCurve:function(h,e,o,t,s){var a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M,N,A,R,L,D=Number.POSITIVE_INFINITY;if(l.exists(s)||(s=t.board),l.evaluate(t.visProp.curvetype)==="plot"){if(o=0,p=D,a=t.numberPoints===0?[0,1,1]:[t.Z(0),t.X(0),t.Y(0)],t.numberPoints>1)for(C=[1,h,e],t.bezierDegree===3?n=0:x=[t.Z(0),t.X(0),t.Y(0)],u=0;u<t.numberPoints-1;u++)t.bezierDegree===3?O=this.projectCoordsToBeziersegment(C,t,n):(S=[t.Z(u+1),t.X(u+1),t.Y(u+1)],O=this.projectCoordsToSegment(C,x,S)),b=O[1],_=O[0],0<=b&&b<=1?(f=this.distance(_,C),E=u+b):b<0?(_=x,f=this.distance(x,C),E=u):b>1&&u===t.numberPoints-2&&(_=S,f=this.distance(_,C),E=t.numberPoints-1),f<p&&(p=f,o=E,a=_),t.bezierDegree===3?(n++,u+=2):x=S;d=new y(P.COORDS_BY_USER,a,s)}else{for(w=function(k){var B,I;return k<t.minX()||k>t.maxX()?1/0:(B=h-t.X(k))*B+(I=e-t.Y(k))*I},N=w(o),R=t.minX(),A=((L=t.maxX())-R)/50,T=R,u=0;u<50;u++)((M=w(T))<N||N===1/0)&&(o=T,N=M),T+=A;o=(o=(o=m.fminbr(w,[Math.max(o-A,R),Math.min(o+A,L)]))<R?R:o)>L?L:o,d=new y(P.COORDS_BY_USER,[t.X(o),t.Y(o)],s)}return[t.updateTransform(d),o]},projectCoordsToPolygon:function(h,e){var o,t,s,a,d,u=e.vertices.length,n=1/0;for(o=0;o<u-1;o++)0<=(s=g.Math.Geometry.projectCoordsToSegment(h,e.vertices[o].coords.usrCoords,e.vertices[o+1].coords.usrCoords))[1]&&s[1]<=1?(t=g.Math.Geometry.distance(s[0],h,3),a=s[0]):s[1]<0?(t=g.Math.Geometry.distance(e.vertices[o].coords.usrCoords,h,3),a=e.vertices[o].coords.usrCoords):(t=g.Math.Geometry.distance(e.vertices[o+1].coords.usrCoords,h,3),a=e.vertices[o+1].coords.usrCoords),t<n&&(d=a.slice(0),n=t);return d},projectPointToTurtle:function(h,e,o){var t,s,a,d,u,n,p,f,b,C,_=0,E=0,x=Number.POSITIVE_INFINITY,S=e.objects.length;for(l.exists(o)||(o=h.board),u=0;u<S;u++)(p=e.objects[u]).elementClass===P.OBJECT_CLASS_CURVE&&(t=(b=this.projectPointToCurve(h,p))[0],C=b[1],(n=this.distance(t.usrCoords,h.coords.usrCoords))<x&&(a=t.usrCoords[1],d=t.usrCoords[2],s=C,x=n,f=p,E=_),_+=p.numberPoints);return t=new y(P.COORDS_BY_USER,[a,d],o),[f.updateTransform(t),s+E]},projectPointToPoint:function(h,e){return e.coords},projectPointToBoard:function(h,e){var o,t,s,a=e||h.board,d=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],u=h.coords||h,n=a.getBoundingBox();for(o=0;o<4;o++)(s=d[o])[0]*u.usrCoords[s[1]]<s[0]*n[s[2]]&&((t=v.crossProduct([1,n[s[3]],n[s[4]]],[1,n[s[5]],n[s[6]]]))[3]=0,t=v.normalize(t),u=this.projectPointToLine({coords:u},{stdform:t},a));return u},distPointLine:function(h,e){var o,t=e[1],s=e[2],a=e[0];return Math.abs(t)+Math.abs(s)<v.eps?Number.POSITIVE_INFINITY:(o=t*h[1]+s*h[2]+a,t*=t,s*=s,Math.abs(o)/Math.sqrt(t+s))},reuleauxPolygon:function(h,e){var o,t=2*Math.PI,s=t/e,a=(e-1)/2,d=0,u=function(n,p){return function(f,b){var C=(f%t+t)%t,_=Math.floor(C/s)%e;return b||(d=h[0].Dist(h[a]),o=v.Geometry.rad([h[0].X()+1,h[0].Y()],h[0],h[a%e])),isNaN(_)?_:(C=.5*C+_*s*.5+o,h[_][n]()+d*Math[p](C))}};return[u("X","cos"),u("Y","sin"),0,t]},meet3Planes:function(h,e,o,t,s,a){var d,u,n,p,f,b=[0,0,0];for(d=v.crossProduct(s,h),u=v.crossProduct(h,o),n=v.crossProduct(o,s),p=v.innerProduct(h,n,3),f=0;f<3;f++)b[f]=(e*n[f]+t*d[f]+a*u[f])/p;return b},meetPlanePlane:function(h,e,o,t){var s,a,d,u=[0,0,0],n=[0,0,0];for(s=0;s<3;s++)u[s]=l.evaluate(h[s]),n[s]=l.evaluate(e[s]);for(a=v.crossProduct(u,n),s=0;s<3;s++)u[s]=l.evaluate(o[s]),n[s]=l.evaluate(t[s]);return d=v.crossProduct(u,n),v.crossProduct(a,d)},project3DTo3DPlane:function(h,e,o){var t,s;return o=o||[0,0,0],t=v.norm(e),s=(v.innerProduct(h,e,3)-v.innerProduct(o,e,3))/t,v.axpy(-s,e,h)},getPlaneBounds:function(h,e,o,t,s){var a,d,u,n,p;return h[2]+e[0]!==0?(u=[[h[0],e[0]],[h[1],e[1]]],n=[t-o[0],t-o[1]],a=(p=m.Gauss(u,n))[0],d=p[1],n=[s-o[0],s-o[1]],[a,(p=m.Gauss(u,n))[0],d,p[1]]):null}}),v.Geometry}),define("math/plot",["jxg","base/constants","base/coords","math/math","math/extrapolate","math/numerics","math/statistics","math/geometry","math/ia","utils/type"],function(g,P,y,v,m,l,c,h,e,o){return v.Plot={checkReal:function(t){var s,a,d=!1,u=t.length;for(s=0;s<u;s++)if(a=t[s].usrCoords,!isNaN(a[1])&&!isNaN(a[2])&&Math.abs(a[0])>v.eps){d=!0;break}return d},updateParametricCurveNaive:function(t,s,a,d){var u,n,p=!1,f=(a-s)/d;for(u=0;u<d;u++)n=s+u*f,t.points[u].setCoordinates(P.COORDS_BY_USER,[t.X(n,p),t.Y(n,p)],!1),t.points[u]._t=n,p=!0;return t},isSegmentOutside:function(t,s,a,d,u){return s<0&&d<0||s>u.canvasHeight&&d>u.canvasHeight||t<0&&a<0||t>u.canvasWidth&&a>u.canvasWidth},isDistOK:function(t,s,a,d){return Math.abs(t)<a&&Math.abs(s)<d&&!isNaN(t+s)},isSegmentDefined:function(t,s,a,d){return!(isNaN(t+s)&&isNaN(a+d))},updateParametricCurveOld:function(t,s,a){var d,u,n,p,f,b,C,_,E,x,S,O=!1,w=new y(P.COORDS_BY_USER,[0,0],t.board,!1),T=[],M=[],N=[],A=[],R=!1,L=0,D=function(k,B,I){var Y,q,V=I[1]-k[1],W=I[2]-k[2],X=B[0]-k[1],Q=B[1]-k[2],G=X*X+Q*Q;return G>=v.eps&&(Y=(V*X+W*Q)/G)>0&&(Y<=1?(V-=Y*X,W-=Y*Q):(V-=X,W-=Q)),q=V*V+W*W,Math.sqrt(q)};for(g.deprecated("Curve.updateParametricCurveOld()"),t.board.updateQuality===t.board.BOARD_QUALITY_LOW?(E=15,x=10,S=10):(E=21,x=.7,S=.7),A[0]=a-s,d=1;d<E;d++)A[d]=.5*A[d-1];d=1,T[0]=1,M[0]=0,u=s,w.setCoordinates(P.COORDS_BY_USER,[t.X(u,O),t.Y(u,O)],!1),O=!0,f=w.scrCoords[1],b=w.scrCoords[2],u=a,w.setCoordinates(P.COORDS_BY_USER,[t.X(u,O),t.Y(u,O)],!1),n=w.scrCoords[1],p=w.scrCoords[2],N[0]=[n,p],C=1,_=0,t.points=[],t.points[L++]=new y(P.COORDS_BY_SCREEN,[f,b],t.board,!1);do{for(R=this.isDistOK(n-f,p-b,x,S)||this.isSegmentOutside(f,b,n,p,t.board);_<E&&(!R||_<6)&&(_<=7||this.isSegmentDefined(f,b,n,p));)T[C]=d,M[C]=_,N[C]=[n,p],C+=1,u=s+(d=2*d-1)*A[++_],w.setCoordinates(P.COORDS_BY_USER,[t.X(u,O),t.Y(u,O)],!1,!0),n=w.scrCoords[1],p=w.scrCoords[2],R=this.isDistOK(n-f,p-b,x,S)||this.isSegmentOutside(f,b,n,p,t.board);L>1&&D(t.points[L-2].scrCoords,[n,p],t.points[L-1].scrCoords)<.015&&(L-=1),t.points[L]=new y(P.COORDS_BY_SCREEN,[n,p],t.board,!1),t.points[L]._t=u,L+=1,f=n,b=p,n=N[C-=1][0],p=N[C][1],_=M[C]+1,d=2*T[C]}while(C>0&&L<5e5);return t.numberPoints=t.points.length,t},_insertPoint_v2:function(t,s,a){var d=!isNaN(this._lastCrds[1]+this._lastCrds[2]),u=!isNaN(s.scrCoords[1]+s.scrCoords[2]),n=t.board.canvasWidth,p=t.board.canvasHeight,f=500;(!(u=u&&s.scrCoords[1]>-500&&s.scrCoords[2]>-500&&s.scrCoords[1]<n+f&&s.scrCoords[2]<p+f)&&d||u&&(!d||Math.abs(s.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(s.scrCoords[2]-this._lastCrds[2])>.7))&&(s._t=a,t.points.push(s),this._lastCrds=s.copy("scrCoords"))},neighborhood_isNaN_v2:function(t,s){var a,d,u=new y(P.COORDS_BY_USER,[0,0],t.board,!1);return a=s+v.eps,u.setCoordinates(P.COORDS_BY_USER,[t.X(a,!0),t.Y(a,!0)],!1),d=u.usrCoords,!!(isNaN(d[1]+d[2])||(a=s-v.eps,u.setCoordinates(P.COORDS_BY_USER,[t.X(a,!0),t.Y(a,!0)],!1),d=u.usrCoords,isNaN(d[1]+d[2])))},_borderCase:function(t,s,a,d,u,n,p,f){var b,C,_,E,x,S,O,w=null,T=!1;if(f<=1){if(C=new y(P.COORDS_BY_USER,[0,0],t.board,!1),isNaN(s[1]+s[2])&&!isNaN(d[1]+d[2])&&!this.neighborhood_isNaN_v2(t,u)||isNaN(a[1]+a[2])&&!isNaN(d[1]+d[2])&&!this.neighborhood_isNaN_v2(t,n)||isNaN(d[1]+d[2])&&(!isNaN(s[1]+s[2])||!isNaN(a[1]+a[2]))&&!this.neighborhood_isNaN_v2(t,p))return!1;E=0;do{if(isNaN(s[1]+s[2])&&!isNaN(d[1]+d[2]))x=u,S=p,O=n;else if(isNaN(a[1]+a[2])&&!isNaN(d[1]+d[2]))x=n,S=p,O=u;else if(isNaN(d[1]+d[2])&&!isNaN(a[1]+a[2]))x=p,S=n,O=n+(n-p);else{if(!isNaN(d[1]+d[2])||isNaN(s[1]+s[2]))return!1;x=p,S=u,O=u-(p-u)}b=.5*(x+S),C.setCoordinates(P.COORDS_BY_USER,[t.X(b,!0),t.Y(b,!0)],!1),_=C.usrCoords,(T=isNaN(_[1]+_[2]))?x=b:(O=S,S=b),++E}while(T&&E<30);if(E<30&&(w=_.slice(),d=_.slice(),S=b),(t.X(S,!0)-t.X(O,!0))/(S-O),(t.Y(S,!0)-t.Y(O,!0))/(S-O),w!==null)return this._insertPoint_v2(t,new y(P.COORDS_BY_USER,w,t.board,!1)),!0}return!1},_plotRecursive_v2:function(t,s,a,d,u,n,p){var f,b,C,_,E,x=0,S=new y(P.COORDS_BY_USER,[0,0],t.board,!1);if(!(t.numberPoints>65536))return n<this.nanLevel&&this._isUndefined(t,s,a,d,u)||n<this.nanLevel&&this._isOutside(s,a,d,u,t.board)?this:(f=.5*(a+u),S.setCoordinates(P.COORDS_BY_USER,[t.X(f,!0),t.Y(f,!0)],!1),b=S.scrCoords,this._borderCase(t,s,d,b,a,u,f,n)||(C=this._triangleDists(s,d,b),_=n<this.smoothLevel&&C[3]<p,E=n<this.jumpLevel&&(C[2]>.99*C[0]||C[1]>.99*C[0]||C[0]===1/0||C[1]===1/0||C[2]===1/0),n<this.smoothLevel+2&&C[0]<.5*(C[1]+C[2])&&(x=0,_=!1),--n,E?this._insertPoint_v2(t,new y(P.COORDS_BY_SCREEN,[NaN,NaN],t.board,!1),f):n<=x||_?this._insertPoint_v2(t,S,f):(this._plotRecursive_v2(t,s,a,b,f,n,p),isNaN(S.scrCoords[1]+S.scrCoords[2])||this._insertPoint_v2(t,S,f),this._plotRecursive_v2(t,b,f,d,u,n,p))),this)},updateParametricCurve_v2:function(t,s,a){var d,u,n,p,f,b,C,_,E,x=!1,S=new y(P.COORDS_BY_USER,[0,0],t.board,!1),O=new y(P.COORDS_BY_USER,[0,0],t.board,!1);return t.board.updateQuality===t.board.BOARD_QUALITY_LOW?(f=o.evaluate(t.visProp.recursiondepthlow)||13,b=2,this.smoothLevel=f-6,this.jumpLevel=3):(f=o.evaluate(t.visProp.recursiondepthhigh)||17,b=2,this.smoothLevel=f-9,this.jumpLevel=2),this.nanLevel=f-4,t.points=[],this.xterm==="x"?(C=.3*((_=t.board.getBoundingBox())[2]-_[0]),.3*(_[1]-_[3]),d=Math.max(s,_[0]-C),u=Math.min(a,_[2]+C)):(d=s,u=a),S.setCoordinates(P.COORDS_BY_USER,[t.X(d,x),t.Y(d,x)],!1),x=!0,O.setCoordinates(P.COORDS_BY_USER,[t.X(u,x),t.Y(u,x)],!1),E=this._findStartPoint(t,S.scrCoords,d,O.scrCoords,u),S.setCoordinates(P.COORDS_BY_SCREEN,E[0],!1),d=E[1],E=this._findStartPoint(t,O.scrCoords,u,S.scrCoords,d),O.setCoordinates(P.COORDS_BY_SCREEN,E[0],!1),u=E[1],this._visibleArea=[d,u],n=S.copy("scrCoords"),p=O.copy("scrCoords"),S._t=d,t.points.push(S),this._lastCrds=S.copy("scrCoords"),this._plotRecursive_v2(t,n,d,p,u,f,b),O._t=u,t.points.push(O),t.numberPoints=t.points.length,t},_insertLimesPoint:function(t,s,a,d,u){var n,p,f;Math.abs(this._lastUsrCrds[1])===1/0&&Math.abs(u.left_x)===1/0||Math.abs(this._lastUsrCrds[2])===1/0&&Math.abs(u.left_y)===1/0||((n=new y(P.COORDS_BY_USER,[u.left_x,u.left_y],t.board))._t=a,t.points.push(n),isNaN(u.left_x)||isNaN(u.left_y)||isNaN(u.right_x)||isNaN(u.right_y)||!(Math.abs(u.left_x-u.right_x)>v.eps||Math.abs(u.left_y-u.right_y)>v.eps)||((p=new y(P.COORDS_BY_SCREEN,s,t.board))._t=a,t.points.push(p)),(f=new y(P.COORDS_BY_USER,[u.right_x,u.right_y],t.board))._t=a,t.points.push(f),this._lastScrCrds=f.copy("scrCoords"),this._lastUsrCrds=f.copy("usrCoords"))},_insertPoint:function(t,s,a,d,u){var n,p=!isNaN(this._lastScrCrds[1]+this._lastScrCrds[2]),f=!isNaN(s[1]+s[2]),b=t.board.canvasWidth,C=t.board.canvasHeight,_=500;o.exists(u)?this._insertLimesPoint(t,s,a,d,u):(f=f&&s[1]>-500&&s[2]>-500&&s[1]<b+_&&s[2]<C+_,(p||f)&&(f&&p&&Math.abs(s[1]-this._lastScrCrds[1])<.8&&Math.abs(s[2]-this._lastScrCrds[2])<.8||Math.abs(s[1])===1/0&&Math.abs(this._lastUsrCrds[1])===1/0||Math.abs(s[2])===1/0&&Math.abs(this._lastUsrCrds[2])===1/0||((n=new y(P.COORDS_BY_SCREEN,s,t.board))._t=a,t.points.push(n),this._lastScrCrds=n.copy("scrCoords"),this._lastUsrCrds=n.copy("usrCoords"))))},_triangleDists:function(t,s,a){var d;return d=[t[0]*s[0],.5*(t[1]+s[1]),.5*(t[2]+s[2])],[h.distance(t,s,3),h.distance(t,a,3),h.distance(a,s,3),h.distance(a,d,3)]},_isUndefined:function(t,s,a,d,u){var n,p,f;if(!isNaN(s[1]+s[2])||!isNaN(d[1]+d[2]))return!1;for(f=new y(P.COORDS_BY_USER,[0,0],t.board,!1),p=0;p<20;++p)if(n=a+Math.random()*(u-a),f.setCoordinates(P.COORDS_BY_USER,[t.X(n,!0),t.Y(n,!0)],!1),!isNaN(f.scrCoords[0]+f.scrCoords[1]+f.scrCoords[2]))return!1;return!0},_isOutside:function(t,s,a,d,u){var n=500,p=u.canvasWidth,f=u.canvasHeight;return t[1]<-500&&a[1]<-500||t[2]<-500&&a[2]<-500||t[1]>p+n&&a[1]>p+n||t[2]>f+n&&a[2]>f+n},_isOutsidePoint:function(t,s){var a=500,d=s.canvasWidth,u=s.canvasHeight;return t[1]<-500||t[2]<-500||t[1]>d+a||t[2]>u+a},_findStartPoint:function(t,s,a,d,u){return new y(P.COORDS_BY_USER,[0,0],t.board,!1),t.board.getBoundingBox(),[s,a]},_getBorderPos:function(t,s,a,d,u,n,p){var f,b,C,_,E,x;if(b=new y(P.COORDS_BY_USER,[0,0],t.board,!1),_=0,isNaN(a[1]+a[2])&&!isNaN(u[1]+u[2]))x=s,E=d;else if(isNaN(p[1]+p[2])&&!isNaN(u[1]+u[2]))x=n,E=d;else if(isNaN(u[1]+u[2])&&!isNaN(p[1]+p[2]))x=d,E=n;else{if(!isNaN(u[1]+u[2])||isNaN(a[1]+a[2]))return!1;x=d,E=s}do f=.5*(E+x),b.setCoordinates(P.COORDS_BY_USER,[t.X(f,!0),t.Y(f,!0)],!1),C=b.usrCoords,isNaN(C[1]+C[2])?x=f:E=f,++_;while(_<30&&Math.abs(E-x)>v.eps);return f},_getCuspPos:function(t,s,a){var d=[t.X(s,!0),t.Y(s,!0)],u=[t.X(a,!0),t.Y(a,!0)];return l.fminbr(function(n){var p=[t.X(n,!0),t.Y(n,!0)];return-(Math.sqrt((d[0]-p[0])*(d[0]-p[0])+(d[1]-p[1])*(d[1]-p[1]))+Math.sqrt((u[0]-p[0])*(u[0]-p[0])+(u[1]-p[1])*(u[1]-p[1])))},[s,a],t)},_getJumpPos:function(t,s,a){return l.fminbr(function(d){var u=v.eps*v.eps,n=[t.X(d,!0),t.Y(d,!0)],p=[t.X(d+u,!0),t.Y(d+u,!0)];return-Math.abs((p[1]-n[1])/(p[0]-n[0]))},[s,a],t)},_getLimits:function(t,s){var a,d,u,n,p,f=2/(t.maxX()-t.minX());return d=(a=m.limit(s,-f,t.X))[0],a[1]==="infinite"&&(d=Math.sign(d)*(1/0)),n=(a=m.limit(s,-f,t.Y))[0],a[1]==="infinite"&&(n=Math.sign(n)*(1/0)),u=(a=m.limit(s,f,t.X))[0],a[1]==="infinite"&&(u=Math.sign(u)*(1/0)),p=(a=m.limit(s,f,t.Y))[0],a[1]==="infinite"&&(p=Math.sign(p)*(1/0)),{left_x:d,left_y:n,right_x:u,right_y:p,t:s}},_getLimes:function(t,s,a,d,u,n,p,f,b){var C;return f==="border"?C=this._getBorderPos(t,s,a,d,u,n,p):f==="cusp"?C=this._getCuspPos(t,s,n):f==="jump"&&(C=this._getJumpPos(t,s,n)),this._getLimits(t,C)},_plotNonRecursive:function(t,s,a,d,u,n){var p,f,b,C,_,E,x,S,O,w,T,M=null,N=!1,A="",R=[],L=0;for(S=t.board.origin.scrCoords,R[L++]=[s,a,d,u,n,1/0];L>0;){if(s=(T=R[--L])[0],a=T[1],d=T[2],u=T[3],O=T[4],w=T[5],N=!1,A="",M=null,t.points.length>65536)return;O<this.nanLevel&&(this._isUndefined(t,s,a,d,u)||this._isOutside(s,a,d,u,t.board))||(p=.5*(a+u),E=t.X(p,!0),x=t.Y(p,!0),f=[1,S[1]+E*t.board.unitX,S[2]-x*t.board.unitY],b=this._triangleDists(s,d,f),C=isNaN(s[1]+s[2]),_=isNaN(d[1]+d[2]),C&&!_||!C&&_?A="border":b[0]>.66*w||b[0]<this.cusp_threshold*(b[1]+b[2])||b[1]>5*b[2]||b[2]>5*b[1]?A="cusp":(b[2]>this.jump_threshold*b[0]||b[1]>this.jump_threshold*b[0]||b[0]===1/0||b[1]===1/0||b[2]===1/0)&&(A="jump"),N=A===""&&O<this.smoothLevel&&b[3]<this.smooth_threshold,O<this.testLevel&&!N&&(A===""?N=!0:M=this._getLimes(t,a,s,p,f,u,d,A,O)),M!==null?(f=[1,NaN,NaN],this._insertPoint(t,f,p,O,M)):O<=0||N?this._insertPoint(t,f,p,O,null):(R[L++]=[f,p,d,u,O-1,b[0]],R[L++]=[s,a,f,p,O-1,b[0]]))}return this},updateParametricCurve_v3:function(t,s,a){var d,u,n,p,f,b,C,_,E=!1,x=new y(P.COORDS_BY_USER,[0,0],t.board,!1),S=new y(P.COORDS_BY_USER,[0,0],t.board,!1);return f=t.board.updateQuality===t.board.BOARD_QUALITY_LOW?o.evaluate(t.visProp.recursiondepthlow)||14:o.evaluate(t.visProp.recursiondepthhigh)||17,this.smoothLevel=7,this.nanLevel=f-4,this.testLevel=4,this.cusp_threshold=.5,this.jump_threshold=.99,this.smooth_threshold=2,t.points=[],t.xterm==="x"?(b=.3*((C=t.board.getBoundingBox())[2]-C[0]),d=Math.max(s,C[0]-b),u=Math.min(a,C[2]+b)):(d=s,u=a),x.setCoordinates(P.COORDS_BY_USER,[t.X(d,E),t.Y(d,E)],!1),E=!0,S.setCoordinates(P.COORDS_BY_USER,[t.X(u,E),t.Y(u,E)],!1),_=this._findStartPoint(t,x.scrCoords,d,S.scrCoords,u),x.setCoordinates(P.COORDS_BY_SCREEN,_[0],!1),d=_[1],_=this._findStartPoint(t,S.scrCoords,u,x.scrCoords,d),S.setCoordinates(P.COORDS_BY_SCREEN,_[0],!1),u=_[1],this._visibleArea=[d,u],n=x.copy("scrCoords"),p=S.copy("scrCoords"),x._t=d,t.points.push(x),this._lastScrCrds=x.copy("scrCoords"),this._lastUsrCrds=x.copy("usrCoords"),this._plotNonRecursive(t,n,d,p,u,f),S._t=u,t.points.push(S),t.numberPoints=t.points.length,t},_criticalInterval:function(t,s,a){var d,u,n,p,f,b,C,_=!1,E=-1/0,x=!1,S=!1,O=0,w=[],T=[],M=[];for(C=c.abs(t),(p=c.median(C))<1e-7?(p=1e-7,x=!0):p*=this.criticalThreshold,d=0;d<s;d++)C[d]>p?(M.push({i:d,v:t[d],group:O}),E=d,_||(_=!0)):_&&d>E+4&&(M.length>0&&w.push(M.slice(0)),M=[],_=!1,O++);for(_&&M.length>1&&w.push(M.slice(0)),x&&w.length===0&&(S=!0),u=0;u<w.length;u++)if(T[u]="point",!((n=w[u].length)<64)){for(b=0,f=Math.sign(w[u][0].v),d=1;d<n;d++)Math.sign(w[u][d].v)!==f&&(b++,f=Math.sign(w[u][d].v));6*b>n&&(T[u]="interval")}return{smooth:S,groups:w,types:T}},Component:function(){this.left_isNaN=!1,this.right_isNaN=!1,this.left_t=null,this.right_t=null,this.t_values=[],this.x_values=[],this.y_values=[],this.len=0},findComponents:function(t,s,a,d){var u,n,p,f,b,C,_=[],E=0,x=0,S=0,O=!1,w=!1;for(p=(a-s)/d,_[E]=new this.Component,C=_[E],u=0,n=s;u<=d;u++,n+=p)f=t.X(n,w),b=t.Y(n,w),isNaN(f)||isNaN(b)?++S>1&&O&&(C.right_isNaN=!0,C.right_t=n-p,C.len=x,O=!1,_[++E]=new this.Component,C=_[E],S=0):(O||(O=!0,x=0,S>0&&(C.left_t=n-p,C.left_isNaN=!0)),S=0,C.t_values[x]=n,C.x_values[x]=f,C.y_values[x]=b,x++),u===0&&(w=!0);return O?C.len=x:_.pop(),_},getPointType:function(t,s,a,d,u,n,p){var f=u[0],b=n[0],C=d.length,_={idx:s,t:a,x:f[s],y:b[s],type:"other"};return s<5?(_.type="borderleft",_.idx=0,_.t=d[0],_.x=f[0],_.y=b[0],_):(s>p-6&&(_.type="borderright",_.idx=C-1,_.t=d[C-1],_.x=f[C-1],_.y=b[C-1]),_)},newtonApprox:function(t,s,a,d,u){var n,p=0;for(n=d;n>0;n--)p=(p+u[n][t])*(s-(n-1)*a)/n;return p+u[0][t]},thiele:function(t,s,a,d,u){var n,p=0;for(n=u;n>1;n--)p=(t-a[d+n])/(s[n][d+1]-s[n-2][d+1]+p);return s[0][d+1]+(t-a[d+1])/(s[1][d+1]+p)},differenceMethodExperiments:function(t,s){var a,d,u,n,p,f,b,C,_,E,x,S=t.t_values,O=t.x_values,w=t.y_values,T=[],M=[],N=[],A=[],R=[],L=[],D=[],k=[],B=0,I=[];for(p=S[1]-S[0],R.push([]),L.push([]),D.push([]),k.push([]),u=w.length,a=0;a<u;a++)R[0][a]=O[a],L[0][a]=w[a],D[0][a]=O[a],k[0][a]=w[a];for(R.push([]),L.push([]),D.push([]),k.push([]),f=p,u=w.length-1,a=0;a<u;a++)T[a]=O[a+1]-O[a],M[a]=w[a+1]-w[a],N[a]=T[a],A[a]=M[a],R[1][a]=T[a],L[1][a]=M[a],D[1][a]=f/T[a],k[1][a]=f/M[a];for(u--,n=Math.min(8,w.length-1),d=1;d<n;d++){for(R.push([]),L.push([]),D.push([]),k.push([]),f*=p,a=0;a<u;a++)T[a]=T[a+1]-T[a],M[a]=M[a+1]-M[a],R[d+1][a]=T[a],L[d+1][a]=M[a],D[d+1][a]=f/(D[d][a+1]-D[d][a])+D[d-1][a+1],k[d+1][a]=f/(k[d][a+1]-k[d][a])+k[d-1][a+1];if((x=this._criticalPoints(M,u,d))===!1){console.log("Polynomial of degree",d),x=[];break}if(x.length>0&&++B>1&&d%2==0)break;u--}for(a=0;a<x.length;a++){for(C=-1/0,_=0;_<x[a].length;_++)(E=Math.abs(x[a][_].v))>C&&(C=E,b=_);b=Math.floor(x[a][b].i+d/2),I.push(this.getPointType(s,b,S,O,w,N,A,u+1))}return[I,R,L,D,k]},getCenterOfCriticalInterval:function(t,s,a){var d,u,n,p,f,b=0,C=0,_=a[1]-a[0],E=[];for(d=-1/0,E=[],u=0;u<t.length;u++)(p=Math.abs(t[u].v))>d?(E=[u],d=p,n=u):d===p&&E.push(u);if(E.length>0&&(f=E.reduce(function(x,S){return x+S},0)/E.length,n=Math.floor(f),f+=t[0].i),d<1/0){for(u=0;u<t.length;u++)b+=Math.abs(t[u].v)*t[u].i,C+=Math.abs(t[u].v);f=b/C}return f+=s/2,[t[n].i+s/2,f,a[Math.floor(f)]+_*(f-Math.floor(f))]},differenceMethod:function(t,s){var a,d,u,n,p,f,b,C,_,E,x=t.t_values,S=t.x_values,O=t.y_values,w=[],T=[],M=0,N=-1,A=-1,R=[],L=[];for(u=O.length,w.push(new Float64Array(S)),T.push(new Float64Array(O)),u--,n=Math.min(12,u),d=0;d<n&&(w.push(new Float64Array(u)),T.push(new Float64Array(u)),w[d+1]=w[d].map(function(D,k,B){return B[k+1]-D}),T[d+1]=T[d].map(function(D,k,B){return B[k+1]-D}),(C=this._criticalInterval(T[d+1],u,d)).smooth===!0&&(A=d,R=[]),b=this._criticalInterval(w[d+1],u,d),N===-1&&b.smooth===!0&&(N=d),!(A>=0));d++){if(C.groups.length>0&&++M>2&&(d+1)%2==0){R=C.groups,E=C.types;break}u--}for(a=0;a<R.length;a++)E[a]!=="interval"&&(f=this.getCenterOfCriticalInterval(R[a],d+1,x),C[0],p=Math.floor(f[1]),_=f[2],L.push(this.getPointType(s,p,_,x,w,T,u+1)));return[L,w,T,N,A]},_insertPoint_v4:function(t,s,a,d){var u,n,p,f=null;t.points.length>0&&(f=t.points[t.points.length-1].scrCoords),u=new y(P.COORDS_BY_USER,s,t.board),f!==null&&(n=u.scrCoords[1]-f[1])*n+(p=u.scrCoords[2]-f[2])*p<.8*.8||(u._t=a,t.points.push(u))},getInterval:function(t,s,a){var d,u;return e.disable(),d=e.Interval(s,a),t.board.mathLib=e,t.board.mathLibJXG=e,t.X(d,!0),u=t.Y(d,!0),t.board.mathLib=Math,t.board.mathLibJXG=g.Math,u},sign:function(t){return t<0?-1:t>0?1:0},handleBorder:function(t,s,a,d,u){var n,p,f,b,C,_,E,x,S,O,w,T,M=a.idx;if(T=s.t_values[1]-s.t_values[0],a.type==="borderleft"?f=(p=n=s.left_isNaN?s.left_t:a.t-T)+T:a.type==="borderright"?p=(f=n=s.right_isNaN?s.right_t:a.t+T)-T:console.log("No bordercase!!!"),(O=this.findComponents(t,p,f,32)).length!==0){for(a.type==="borderleft"&&(p=O[0].left_t,f=O[0].t_values[0],T=O[0].t_values[1]-O[0].t_values[0],n=p=p===null?f-T:p,b=this.getInterval(t,p,f),o.isObject(b)&&(E=b.lo,x=b.hi,C=t.X(n,!0),_=u[1][M]<0?x:E,this._insertPoint_v4(t,[1,C,_],n))),w=O[0].t_values.length,S=0;S<w;S++)n=O[0].t_values[S],C=O[0].x_values[S],_=O[0].y_values[S],this._insertPoint_v4(t,[1,C,_],n);a.type==="borderright"&&(p=O[0].t_values[w-1],f=O[0].right_t,T=O[0].t_values[1]-O[0].t_values[0],n=f=f===null?p+T:f,b=this.getInterval(t,p,f),o.isObject(b)&&(E=b.lo,x=b.hi,C=t.X(n,!0),_=u[1][M]>0?x:E,this._insertPoint_v4(t,[1,C,_],n)))}},_seconditeration_v4:function(t,s,a,d,u){var n,p,f,b,C,_,E,x,S,O,w,T,M;for(p=s.t_values[a.idx-2],f=s.t_values[a.idx+2],C=this.findComponents(t,p,f,64),E=0;E<C.length;E++){for(_=C[E],x=(b=this.differenceMethod(_,t))[0],O=b[1],w=b[2],T=0,S=0;S<=x.length;S++){for(M=S===x.length?_.len:x[S].idx,n=T;n<M;n++)isNaN(_.x_values[n])||isNaN(_.y_values[n])||this._insertPoint_v4(t,[1,_.x_values[n],_.y_values[n]],_.t_values[n]);S<x.length&&(this.handleSingularity(t,_,x[S],O,w),T=x[S].idx+1)}M=_.len,E<C.length-1&&this._insertPoint_v4(t,[1,NaN,NaN],_.right_t)}return this},_recurse_v4:function(t,s,a,d,u,n,p,f){var b,C,_=.5*(s+a),E=t.X(_,!0),x=t.Y(_,!0);f!==0?(b=(E-d)*t.board.unitX,C=(x-u)*t.board.unitY,Math.sqrt(b*b+C*C)>2?this._recurse_v4(t,s,_,d,u,E,x,f-1):this._insertPoint_v4(t,[1,E,x],_),b=(E-n)*t.board.unitX,C=(x-p)*t.board.unitY,Math.sqrt(b*b+C*C)>2?this._recurse_v4(t,_,a,E,x,n,p,f-1):this._insertPoint_v4(t,[1,E,x],_)):this._insertPoint_v4(t,[1,NaN,NaN],_)},handleSingularity:function(t,s,a,d,u){var n,p,f,b,C,_,E,x,S,O,w,T=a.idx,M=100;n=a.t,console.log("HandleSingularity at t =",n),p=s.t_values[T-5],f=s.t_values[T+5],b=this.getInterval(t,p,f),o.isObject(b)?(x=b.lo,S=b.hi):u[0][T-1]<u[0][T+1]?(x=u[0][T-1],S=u[0][T+1]):(x=u[0][T+1],S=u[0][T-1]),E=t.X(n,!0),O=(u[0][T-3]-u[0][T-5])/(s.t_values[T-3]-s.t_values[T-5]),w=(u[0][T+3]-u[0][T+5])/(s.t_values[T+3]-s.t_values[T+5]),console.log(":::",O,w),O<-100?(this._insertPoint_v4(t,[1,E,x],n,!0),w<=M&&this._insertPoint_v4(t,[1,NaN,NaN],n)):O>M?(this._insertPoint_v4(t,[1,E,S],n),w>=-100&&this._insertPoint_v4(t,[1,NaN,NaN],n)):(x===-1/0&&(this._insertPoint_v4(t,[1,E,x],n,!0),this._insertPoint_v4(t,[1,NaN,NaN],n)),S===1/0&&(this._insertPoint_v4(t,[1,NaN,NaN],n),this._insertPoint_v4(t,[1,E,S],n,!0)),a.t<s.t_values[T]?(C=T-1,_=T):(C=T,_=T+1),p=s.t_values[C],f=s.t_values[_],this._recurse_v4(t,p,f,d[0][C],u[0][C],d[0][_],u[0][_],10)),w<-100?this._insertPoint_v4(t,[1,E,S],n):w>M&&this._insertPoint_v4(t,[1,E,x],n)},steps:1021,criticalThreshold:1e3,plot_v4:function(t,s,a,d){var u,n,p,f,b,C,_,E,x,S,O,w,T,M,N,A=(a-s)/d,R=function(k){return t.Y(k,!0)},L=function(k){return-t.Y(k,!0)},D=.5*A;for(p=this.findComponents(t,s,a,d),f=0;f<p.length;f++){for(b=p[f],C=(x=this.differenceMethod(b,t))[0],S=x[1],O=x[2],x[3],x[4],C.length!==0&&C[0].type==="borderleft"||C.unshift({idx:0,t:b.t_values[0],x:b.x_values[0],y:b.y_values[0],type:"borderleft"}),C[C.length-1].type!=="borderright"&&(n=b.t_values.length,C.push({idx:n-1,t:b.t_values[n-1],x:b.x_values[n-1],y:b.y_values[n-1],type:"borderright"})),E=0,_=0;_<=C.length;_++){for(n=_===C.length?b.len:C[_].idx-1,u=E;u<n-2;u++)this._insertPoint_v4(t,[1,b.x_values[u],b.y_values[u]],b.t_values[u]),u>=E+3&&u<n-3&&O.length>3&&Math.abs(O[2][u])>.2*Math.abs(O[0][u])&&(w=b.t_values[u],D=.25*A,N=this.getInterval(t,w,w+A),o.isObject(N)?O[2][u]>0?this._insertPoint_v4(t,[1,w+D,N.lo],w+D):this._insertPoint_v4(t,[1,w+A-D,N.hi],w+A-D):(T=l.fminbr(R,[w,w+A]))<(M=l.fminbr(L,[w,w+A]))?(this._insertPoint_v4(t,[1,t.X(T,!0),t.Y(T,!0)],T),this._insertPoint_v4(t,[1,t.X(M,!0),t.Y(M,!0)],M)):(this._insertPoint_v4(t,[1,t.X(M,!0),t.Y(M,!0)],M),this._insertPoint_v4(t,[1,t.X(T,!0),t.Y(T,!0)],T)));_<C.length&&(u=C[_].idx,C[_].type==="borderleft"||C[_].type==="borderright"?this.handleBorder(t,b,C[_],S,O):this._seconditeration_v4(t,b,C[_],S,O),E=C[_].idx+1+1)}n=b.len,f<p.length-1&&this._insertPoint_v4(t,[1,NaN,NaN],b.right_t)}},updateParametricCurve_v4:function(t,s,a){var d,u,n,p;t.xterm==="x"?(n=.3*((p=t.board.getBoundingBox())[2]-p[0]),d=Math.max(s,p[0]-n),u=Math.min(a,p[2]+n)):(d=s,u=a),t.points=[],this.plot_v4(t,d,u,this.steps),t.numberPoints=t.points.length},updateParametricCurve:function(t,s,a){return this.updateParametricCurve_v2(t,s,a)}},v.Plot}),define("math/metapost",["utils/type","math/math"],function(g,P){return P.Metapost={MP_ENDPOINT:0,MP_EXPLICIT:1,MP_GIVEN:2,MP_CURL:3,MP_OPEN:4,MP_END_CYCLE:5,UNITY:1,FRACTION_ONE:1,FRACTION_THREE:3,ONE_EIGHTY_DEG:Math.PI,THREE_SIXTY_DEG:2*Math.PI,EPS_SQ:1e-5*1e-5,make_choices:function(y){var v,m,l,c,h,e,o,t,s,a,d,u,n,p,f;o=y[0];do{if(!o)break;e=o.next,o.rtype>this.MP_EXPLICIT&&(o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y)<this.EPS_SQ&&(o.rtype=this.MP_EXPLICIT,o.ltype===this.MP_OPEN&&(o.ltype=this.MP_CURL,o.set_left_curl(this.UNITY)),e.ltype=this.MP_EXPLICIT,e.rtype===this.MP_OPEN&&(e.rtype=this.MP_CURL,e.set_right_curl(this.UNITY)),o.rx=o.x,e.lx=o.x,o.ry=o.y,e.ly=o.y),o=e}while(o!==y[0]);for(m=y[0];m.ltype===this.MP_OPEN&&m.rtype===this.MP_OPEN;)if((m=m.next)===y[0]){m.ltype=this.MP_END_CYCLE;break}for(o=m;o;){if(e=o.next,o.rtype>=this.MP_GIVEN){for(;e.ltype===this.MP_OPEN&&e.rtype===this.MP_OPEN;)e=e.next;for(l=0,t=o,h=y.length,u=[],n=[],p=[],f=[null];a=t.next,u.push(a.x-t.x),n.push(a.y-t.y),p.push(this.mp_pyth_add(u[l],n[l])),l>0&&(d=n[l-1]/p[l-1],s=u[l-1]/p[l-1],f.push(Math.atan2(n[l]*s-u[l]*d,u[l]*s+n[l]*d))),l++,(t=a)===e&&(h=l),!(l>=h&&t.ltype!==this.MP_END_CYCLE););l===h?f.push(0):f.push(f[1]),e.ltype===this.MP_OPEN&&((c=e.rx-e.x)*c+(v=e.ry-e.y)*v<this.EPS_SQ?(e.ltype=this.MP_CURL,e.set_left_curl(this.UNITY)):(e.ltype=this.MP_GIVEN,e.set_left_given(Math.atan2(v,c)))),o.rtype===this.MP_OPEN&&o.ltype===this.MP_EXPLICIT&&((c=o.x-o.lx)*c+(v=o.y-o.ly)*v<this.EPS_SQ?(o.rtype=this.MP_CURL,o.set_right_curl(this.UNITY)):(o.rtype=this.MP_GIVEN,o.set_right_given(Math.atan2(v,c)))),this.mp_solve_choices(o,e,h,u,n,p,f)}else o.rtype===this.MP_ENDPOINT&&(o.rx=o.x,o.ry=o.y,e.lx=e.x,e.ly=e.y);if((o=e)===m)break}},mp_solve_choices:function(y,v,m,l,c,h,e){var o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M,N,A,R,L,D,k,B;for(d=h.length+1,b=new Array(d),f=new Array(d),s=new Array(d),S=new Array(d),k=0;k<d;k++)S[k]=s[k]=f[k]=b[k]=0;for(n=0,p=y,_=0;;){if(E=p.next,n===0)if(p.rtype===this.MP_GIVEN){if(E.ltype===this.MP_GIVEN)return o=Math.atan2(c[0],l[0]),N=(M=this.mp_n_sin_cos(y.right_given()-o))[0],A=M[1],L=(R=this.mp_n_sin_cos(v.left_given()-o))[0],D=R[1],void this.mp_set_controls(y,v,l[0],c[0],A,N,-D,L);s[0]=p.right_given()-Math.atan2(c[0],l[0]),s[0]=this.reduce_angle(s[0]),b[0]=0,f[0]=0}else if(p.rtype===this.MP_CURL){if(E.ltype===this.MP_CURL)return y.rtype=this.MP_EXPLICIT,v.ltype=this.MP_EXPLICIT,C=Math.abs(v.left_tension()),O=Math.abs(y.right_tension()),x=this.UNITY/(3*O),y.rx=y.x+l[0]*x,y.ry=y.y+c[0]*x,x=this.UNITY/(3*C),v.lx=v.x-l[0]*x,void(v.ly=v.y-c[0]*x);T=p.right_curl(),C=Math.abs(E.left_tension()),O=Math.abs(p.right_tension()),b[0]=this.mp_curl_ratio(T,O,C),s[0]=-e[1]*b[0],f[0]=0}else p.rtype===this.MP_OPEN&&(b[0]=0,s[0]=0,f[0]=this.FRACTION_ONE);else if(p.ltype===this.MP_END_CYCLE||p.ltype===this.MP_OPEN){if(o=this.UNITY/(3*Math.abs(_.right_tension())-this.UNITY),w=h[n]*(this.FRACTION_THREE-this.UNITY/Math.abs(_.right_tension())),a=this.UNITY/(3*Math.abs(E.left_tension())-this.UNITY),u=h[n-1]*(this.FRACTION_THREE-this.UNITY/Math.abs(E.left_tension())),w*=T=this.FRACTION_ONE-b[n-1]*o,(C=Math.abs(p.left_tension()))<(O=Math.abs(p.right_tension()))?w*=Math.pow(C/O,2):C>O&&(u*=Math.pow(O/C,2)),x=u/(u+w),b[n]=x*a,t=-e[n+1]*b[n],_.rtype===this.MP_CURL?(f[n]=0,s[n]=t-e[1]*(this.FRACTION_ONE-x)):(x=(this.FRACTION_ONE-x)/T,t-=e[n]*x,x*=o,s[n]=t-s[n-1]*x,f[n]=-f[n-1]*x),p.ltype===this.MP_END_CYCLE){for(o=0,a=this.FRACTION_ONE;(n-=1)===0&&(n=m),o=s[n]-o*b[n],a=f[n]-a*b[n],n!==m;);for(o/=this.FRACTION_ONE-a,S[m]=o,s[0]=o,B=1;B<m;B++)s[B]=s[B]+o*f[B];break}}else{if(p.ltype===this.MP_CURL){T=p.left_curl(),C=Math.abs(p.left_tension()),O=Math.abs(_.right_tension()),x=this.mp_curl_ratio(T,C,O),S[m]=-s[m-1]*x/(this.FRACTION_ONE-x*b[m-1]);break}if(p.ltype===this.MP_GIVEN){S[m]=p.left_given()-Math.atan2(c[m-1],l[m-1]),S[m]=this.reduce_angle(S[m]);break}}_=p,p=E,n+=1}for(n=m-1;n>-1;n--)S[n]=s[n]-S[n+1]*b[n];for(p=y,n=0;E=p.next,N=(M=this.mp_n_sin_cos(S[n]))[0],A=M[1],L=(R=this.mp_n_sin_cos(-e[n+1]-S[n+1]))[0],D=R[1],this.mp_set_controls(p,E,l[n],c[n],A,N,D,L),p=E,++n!==m;);},mp_n_sin_cos:function(y){return[Math.cos(y),Math.sin(y)]},mp_set_controls:function(y,v,m,l,c,h,e,o){var t,s,a,d,u;a=Math.abs(v.left_tension()),t=Math.abs(y.right_tension()),u=this.mp_velocity(c,h,e,o,t),s=this.mp_velocity(e,o,c,h,a),(y.right_tension()<0||v.left_tension()<0)&&(c>=0&&e>=0||c<=0&&e<=0)&&(d=Math.abs(c)*o+Math.abs(e)*h)>0&&(d*=1.00024414062,y.right_tension()<0&&this.mp_ab_vs_cd(Math.abs(e),this.FRACTION_ONE,u,d)<0&&(u=Math.abs(e)/d),v.left_tension()<0&&this.mp_ab_vs_cd(Math.abs(c),this.FRACTION_ONE,s,d)<0&&(s=Math.abs(c)/d)),y.rx=y.x+(m*h-l*c)*u,y.ry=y.y+(l*h+m*c)*u,v.lx=v.x-(m*o+l*e)*s,v.ly=v.y-(l*o-m*e)*s,y.rtype=this.MP_EXPLICIT,v.ltype=this.MP_EXPLICIT},mp_pyth_add:function(y,v){return Math.sqrt(y*y+v*v)},mp_curl_ratio:function(y,v,m){var l=1/v,c=1/m;return Math.min(4,((3-l)*l*l*y+c*c*c)/(l*l*l*y+(3-c)*c*c))},mp_ab_vs_cd:function(y,v,m,l){return y*v==m*l?0:y*v>m*l?1:-1},mp_velocity:function(y,v,m,l,c){return Math.min(4,(2+Math.sqrt(2)*(y-m/16)*(m-y/16)*(v-l))/(1.5*c*(2+(Math.sqrt(5)-1)*v+(3-Math.sqrt(5))*l)))},reduce_angle:function(y){return Math.abs(y)>this.ONE_EIGHTY_DEG&&(y>0?y-=this.THREE_SIXTY_DEG:y+=this.THREE_SIXTY_DEG),y},makeknots:function(y,v,m){var l,c,h=[];for(v=v||1,c=y.length,l=0;l<c;l++)h.push({x:y[l][0],y:y[l][1],ltype:this.MP_OPEN,rtype:this.MP_OPEN,ly:v,ry:v,lx:v,rx:v,left_curl:function(){return this.lx||0},right_curl:function(){return this.rx||0},left_tension:function(){return this.ly||(this.ly=1),this.ly},right_tension:function(){return this.ry||(this.ry=1),this.ry},set_right_curl:function(e){this.rx=e||0},set_left_curl:function(e){this.lx=e||0}});for(c=h.length,l=0;l<c;l++)h[l].next=h[l+1]||h[l],h[l].set_right_given=h[l].set_right_curl,h[l].set_left_given=h[l].set_left_curl,h[l].right_given=h[l].right_curl,h[l].left_given=h[l].left_curl;return h[c-1].next=h[0],m||(h[c-1].rtype=this.MP_ENDPOINT,h[c-1].ltype=this.MP_CURL,h[0].rtype=this.MP_CURL),h},curve:function(y,v){var m,l,c,h,e=[],o=[];for(c in v=v||{tension:1,direction:{},curl:{},isClosed:!1},l=(m=this.makeknots(y,g.evaluate(v.tension),v.isClosed)).length,v.direction)v.direction.hasOwnProperty(c)&&(h=g.evaluate(v.direction[c]),g.isArray(h)?(h[0]!==!1&&(m[c].lx=h[0]*Math.PI/180,m[c].ltype=this.MP_GIVEN),h[1]!==!1&&(m[c].rx=h[1]*Math.PI/180,m[c].rtype=this.MP_GIVEN)):(m[c].lx=h*Math.PI/180,m[c].rx=h*Math.PI/180,m[c].ltype=m[c].rtype=this.MP_GIVEN));for(c in v.curl)v.curl.hasOwnProperty(c)&&(h=g.evaluate(v.curl[c]),parseInt(c,10)===0?(m[c].rtype=this.MP_CURL,m[c].set_right_curl(h)):parseInt(c,10)===l-1&&(m[c].ltype=this.MP_CURL,m[c].set_left_curl(h)));for(this.make_choices(m),c=0;c<l-1;c++)e.push(m[c].x),e.push(m[c].rx),e.push(m[c+1].lx),o.push(m[c].y),o.push(m[c].ry),o.push(m[c+1].ly);return e.push(m[l-1].x),o.push(m[l-1].y),v.isClosed&&(e.push(m[l-1].rx),o.push(m[l-1].ry),e.push(m[0].lx),o.push(m[0].ly),e.push(m[0].x),o.push(m[0].y)),[e,o]}},P.Metapost}),define("utils/zip",["jxg"],function(g){var P=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],v=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],l=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];return g.Util=g.Util||{},g.Util.Unzip=function(h){var e,o,t,s,a=[],d=0,u=[],n=new Array(32768),p=0,f=!1,b=h.length,C=0,_=1,E=new Array(288),x=new Array(32),S=0,O=null,w=(new Array(64),new Array(64),0),T=new Array(17),M=[];function N(){return C<b?h[C++]:-1}function A(){_=1}function R(){var G;try{return G=1&_,(_>>=1)===0&&(G=1&(_=N()),_=_>>1|128),G}catch(F){throw F}}function L(G){var F=0,U=G;try{for(;U--;)F=F<<1|R();G&&(F=P[F]>>8-G)}catch(z){throw z}return F}function D(){p=0}function k(G){n[p++]=G,a.push(String.fromCharCode(G)),p===32768&&(p=0)}function B(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function I(){for(;;){if(T[w]>=s)return-1;if(t[T[w]]===w)return T[w]++;T[w]++}}function Y(){var G,F=O[S];if(w===17)return-1;if(S++,w++,(G=I())>=0)F.b0=G;else if(F.b0=32768,Y())return-1;if((G=I())>=0)F.b1=G,F.jump=null;else if(F.b1=32768,F.jump=O[S],F.jumppos=S,Y())return-1;return w--,0}function q(G,F,U,z){var re;for(O=G,S=0,t=U,s=F,re=0;re<17;re++)T[re]=0;return w=0,Y()?-1:0}function V(G){for(var F,U,z=0,re=G[z];;)if(R()){if(!(32768&re.b1))return re.b1;for(re=re.jump,F=G.length,U=0;U<F;U++)if(G[U]===re){z=U;break}}else{if(!(32768&re.b0))return re.b0;re=G[++z]}}function W(){var G,F,U,z,re,te,le,oe,he,H,ce,de,ne,ge,fe;do if(G=R(),(F=L(2))===0)for(A(),he=N(),he|=N()<<8,ce=N(),65535&(he^~(ce|=N()<<8))&&g.debug(`BlockLen checksum mismatch
`);he--;)k(N());else if(F===1)for(;;)if((z=P[L(7)]>>1)>23?(z=z<<1|R())>199?z=(z-=128)<<1|R():(z-=48)>143&&(z+=136):z+=256,z<256)k(z);else{if(z===256)break;for(oe=L(v[z-=257])+y[z],z=P[L(5)]>>3,l[z]>8?(H=L(8),H|=L(l[z]-8)<<8):H=L(l[z]),H+=m[z],z=0;z<oe;z++)k(n[p-H&32767])}else if(F===2){for(te=new Array(320),ne=257+L(5),ge=1+L(5),fe=4+L(4),z=0;z<19;z++)te[z]=0;for(z=0;z<fe;z++)te[c[z]]=L(3);for(oe=x.length,U=0;U<oe;U++)x[U]=new B;if(q(x,19,te))return D(),1;for(de=ne+ge,U=0,-1;U<de;)if((z=V(x))<16)te[U++]=z;else if(z===16){if(U+(z=3+L(2))>de)return D(),1;for(re=U?te[U-1]:0;z--;)te[U++]=re}else{if(U+(z=z===17?3+L(3):11+L(7))>de)return D(),1;for(;z--;)te[U++]=0}for(oe=E.length,U=0;U<oe;U++)E[U]=new B;if(q(E,ne,te))return D(),1;for(oe=E.length,U=0;U<oe;U++)x[U]=new B;for(le=[],U=ne;U<te.length;U++)le[U-ne]=te[U];if(q(x,ge,le))return D(),1;for(;;)if((z=V(E))>=256){if((z-=256)===0)break;for(oe=L(v[z-=1])+y[z],z=V(x),l[z]>8?(H=L(8),H|=L(l[z]-8)<<8):H=L(l[z]),H+=m[z];oe--;)k(n[p-H&32767])}else k(z)}while(!G);return D(),A(),0}function X(){var G,F,U,z,re,te=[];try{if(a=[],f=!1,te[0]=N(),te[1]=N(),te[0]===120&&te[1]===218&&(W(),u[d]=[a.join(""),"geonext.gxt"],d++),te[0]===31&&te[1]===139&&(Q(),u[d]=[a.join(""),"file"],d++),te[0]===80&&te[1]===75){if(f=!0,te[2]=N(),te[3]=N(),te[2]===3&&te[3]===4){for(te[0]=N(),te[1]=N(),e=N(),e|=N()<<8,re=N(),re|=N()<<8,N(),N(),N(),N(),N(),N()<<8,N()<<16,N()<<24,N(),N()<<8,N()<<16,N()<<24,N(),N()<<8,N()<<16,N()<<24,z=N(),z|=N()<<8,U=N(),U|=N()<<8,G=0,M=[];z--;)(F=N())==="/"|F===":"?G=0:G<255&&(M[G++]=String.fromCharCode(F));for(o||(o=M),G=0;G<U;)F=N(),G++;if(re===8&&(W(),u[d]=new Array(2),u[d][0]=a.join(""),u[d][1]=M.join(""),d++),Q())return!1}return!0}}catch(le){throw le}return!1}function Q(){var G,F,U=[];if(8&e&&(U[0]=N(),U[1]=N(),U[2]=N(),U[3]=N(),U[0]===80&&U[1]===75&&U[2]===7&&U[3]===8?(N(),N()<<8,N()<<16,N()<<24):U[0]|U[1]<<8|U[2]<<16|U[3]<<24,N(),N()<<8,N()<<16,N()<<24,N(),N()<<8,N()<<16,N()<<24),f&&X())return!1;if(U[0]=N(),U[0]!==8)return!0;if(e=N(),N(),N(),N(),N(),N(),N(),4&e)for(U[0]=N(),U[2]=N(),w=U[0]+256*U[1],G=0;G<w;G++)N();if(8&e)for(G=0,M=[],F=N();F;)F!=="7"&&F!==":"||(G=0),G<255&&(M[G++]=F),F=N();if(16&e)for(F=N();F;)F=N();return 2&e&&(N(),N()),W(),N(),N()<<8,N()<<16,N()<<24,N(),N()<<8,N()<<16,N()<<24,f&&X(),!1}T[0]=0,g.Util.Unzip.prototype.unzipFile=function(G){var F;for(this.unzip(),F=0;F<u.length;F++)if(u[F][1]===G)return u[F][0];return""},g.Util.Unzip.prototype.unzip=function(){return X(),u}},g.Util}),define("utils/encoding",["jxg"],function(g){var P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return g.Util=g.Util||{},g.Util.UTF8={encode:function(y){var v,m,l="",c=y.length;if(y=y.replace(/\r\n/g,`
`),typeof unescape=="function"&&typeof encodeURIComponent=="function")return unescape(encodeURIComponent(y));for(v=0;v<c;v++)(m=y.charCodeAt(v))<128?l+=String.fromCharCode(m):m>127&&m<2048?(l+=String.fromCharCode(m>>6|192),l+=String.fromCharCode(63&m|128)):(l+=String.fromCharCode(m>>12|224),l+=String.fromCharCode(m>>6&63|128),l+=String.fromCharCode(63&m|128));return l},decode:function(y){var v,m,l,c=0,h=0,e=0,o=[],t=y.length,s=[];for(v=0;v<t;v++)m=y.charCodeAt(v),l=P[m],h=e!==0?63&m|h<<6:255>>l&m,(e=P[256+e+l])===0&&(h>65535?o.push(55232+(h>>10),56320+(1023&h)):o.push(h),++c%1e4==0&&(s.push(String.fromCharCode.apply(null,o)),o=[]));return s.push(String.fromCharCode.apply(null,o)),s.join("")},asciiCharCodeAt:function(y,v){var m=y.charCodeAt(v);if(m>255)switch(m){case 8364:m=128;break;case 8218:m=130;break;case 402:m=131;break;case 8222:m=132;break;case 8230:m=133;break;case 8224:m=134;break;case 8225:m=135;break;case 710:m=136;break;case 8240:m=137;break;case 352:m=138;break;case 8249:m=139;break;case 338:m=140;break;case 381:m=142;break;case 8216:m=145;break;case 8217:m=146;break;case 8220:m=147;break;case 8221:m=148;break;case 8226:m=149;break;case 8211:m=150;break;case 8212:m=151;break;case 732:m=152;break;case 8482:m=153;break;case 353:m=154;break;case 8250:m=155;break;case 339:m=156;break;case 382:m=158;break;case 376:m=159}return m}},g.Util.UTF8}),define("utils/base64",["jxg","utils/encoding"],function(g,P){var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v="=";function m(c,h){return 255&c.charCodeAt(h)}function l(c,h){return y.indexOf(c.charAt(h))}return g.Util=g.Util||{},g.Util.Base64={encode:function(c){var h,e,o,t,s,a=[];for(t=(o=(s=P.encode(c)).length)%3,h=0;h<o-t;h+=3)e=m(s,h)<<16|m(s,h+1)<<8|m(s,h+2),a.push(y.charAt(e>>18),y.charAt(e>>12&63),y.charAt(e>>6&63),y.charAt(63&e));switch(t){case 1:e=m(s,o-1),a.push(y.charAt(e>>2),y.charAt(e<<4&63),v,v);break;case 2:e=m(s,o-2)<<8|m(s,o-1),a.push(y.charAt(e>>10),y.charAt(e>>4&63),y.charAt(e<<2&63),v)}return a.join("")},decode:function(c,h){var e,o,t,s,a,d,u=[],n=[];if((t=(e=c.replace(/[^A-Za-z0-9+/=]/g,"")).length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for(e.charAt(t-1)===v&&(s=1,e.charAt(t-2)===v&&(s=2),t-=4),o=0;o<t;o+=4)a=l(e,o)<<18|l(e,o+1)<<12|l(e,o+2)<<6|l(e,o+3),n.push(a>>16,a>>8&255,255&a),o%1e4==0&&(u.push(String.fromCharCode.apply(null,n)),n=[]);switch(s){case 1:a=l(e,t)<<12|l(e,t+1)<<6|l(e,t+2),n.push(a>>10,a>>2&255);break;case 2:a=l(e,o)<<6|l(e,o+1),n.push(a>>4)}return u.push(String.fromCharCode.apply(null,n)),d=u.join(""),h&&(d=P.decode(d)),d},decodeAsArray:function(c){var h,e=this.decode(c),o=[],t=e.length;for(h=0;h<t;h++)o[h]=e.charCodeAt(h);return o}},g.Util.Base64}),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],function(g,P,y,v){return g.Server={modules:{},runningCalls:{},handleError:function(m){g.debug("error occured, server says: "+m.message)},callServer:function(m,l,c,h){var e,o,t,s,a,d,u;for(d in h=h||!1,c)c.hasOwnProperty(d)&&""+escape(d)+escape(c[d]);a=v.toJSON(c);do s=m+Math.floor(4096*Math.random());while(v.exists(this.runningCalls[s]));return this.runningCalls[s]={action:m},v.exists(c.module)&&(this.runningCalls[s].module=c.module),e=g.serverBase+"JXGServer.py",o="action="+escape(m)+"&id="+s+"&dataJSON="+escape(y.encode(a)),this.cbp=function(n){var p,f,b,C,_,E,x,S;if(p=new P.Unzip(y.decodeAsArray(n)).unzip(),v.isArray(p)&&p.length>0&&(p=p[0][0]),v.exists(p)){if((f=window.JSON&&window.JSON.parse?window.JSON.parse(p):new Function("return "+p)()).type==="error")this.handleError(f);else if(f.type==="response"){for(E=f.id,x=0;x<f.fields.length;x++)C=(b=f.fields[x]).namespace+(typeof new Function("return "+b.namespace)()=="object"?".":".prototype.")+b.name+" = "+b.value,new Function(C)();for(x=0;x<f.handler.length;x++){for(b=f.handler[x],_=[],S=0;S<b.parameters.length;S++)_[S]='"'+b.parameters[S]+'": '+b.parameters[S];C="if(typeof JXG.Server.modules."+this.runningCalls[E].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[E].module+" = {};",C+="JXG.Server.modules."+this.runningCalls[E].module+"."+b.name+"_cb = "+b.callback+";",C+="JXG.Server.modules."+this.runningCalls[E].module+"."+b.name+" = function ("+b.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[E].module+"."+b.name+"_cb;var __JXGSERVER_PAR__ = {"+_.join(",")+', "module": "'+this.runningCalls[E].module+'", "handler": "'+b.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(C)()}delete this.runningCalls[E],l(f.data)}}},this.cb=g.bind(this.cbp,this),window.XMLHttpRequest?(t=new XMLHttpRequest).overrideMimeType("text/plain; charset=iso-8859-1"):t=new ActiveXObject("Microsoft.XMLHTTP"),!(!t||(t.open("POST",e,!h),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h||(t.onreadystatechange=(u=this.cb,function(){return t.readyState===4&&t.status===200&&(u(t.responseText),!0)})),t.send(o),!h))&&(this.cb(t.responseText),!0)},loadModule_cb:function(m){var l;for(l=0;l<m.length;l++)g.debug(m[l].name+": "+m[l].value)},loadModule:function(m){return g.Server.callServer("load",g.Server.loadModule_cb,{module:m},!0)}},g.Server.load=g.Server.loadModule,g.Server}),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],function(g,P,y,v,m,l){var c;return y.Symbolic={generateSymbolicCoordinatesPartial:function(h,e,o,t){var s,a,d,u=e.ancestors,n=0,p=function(f){return t==="underscore"?o+"_{"+f+"}":t==="brace"?o+"["+f+"]":o+f};for(a in h.listOfFreePoints=[],h.listOfDependantPoints=[],u)if(u.hasOwnProperty(a)&&(s=0,l.isPoint(u[a]))){for(d in u[a].ancestors)u[a].ancestors.hasOwnProperty(d)&&s++;s===0?(u[a].symbolic.x=u[a].coords.usrCoords[1],u[a].symbolic.y=u[a].coords.usrCoords[2],h.listOfFreePoints.push(u[a])):(n+=1,u[a].symbolic.x=p(n),n+=1,u[a].symbolic.y=p(n),h.listOfDependantPoints.push(u[a]))}return l.isPoint(e)&&(e.symbolic.x="x",e.symbolic.y="y"),n},clearSymbolicCoordinates:function(h){var e=function(o){var t,s=o&&o.length||0;for(t=0;t<s;t++)l.isPoint(o[t])&&(o[t].symbolic.x="",o[t].symbolic.y="")};e(h.listOfFreePoints),e(h.listOfDependantPoints),delete h.listOfFreePoints,delete h.listOfDependantPoints},generatePolynomials:function(h,e,o){var t,s,a,d,u=e.ancestors,n=[],p=[];for(t in o&&this.generateSymbolicCoordinatesPartial(h,e,"u","brace"),u[e.id]=e,u)if(u.hasOwnProperty(t)&&(d=0,n=[],l.isPoint(u[t]))){for(s in u[t].ancestors)u[t].ancestors.hasOwnProperty(s)&&d++;if(d>0)for(n=u[t].generatePolynomial(),a=0;a<n.length;a++)p.push(n[a])}return o&&this.clearSymbolicCoordinates(h),p},geometricLocusByGroebnerBase:function(h,e){var o,t,s,a,d,u,n,p,f,b,C,_,E=h.options.locus,x={},S=this.generateSymbolicCoordinatesPartial(h,e,"u","brace"),O=new P(g.COORDS_BY_USR,[0,0],h),w=new P(g.COORDS_BY_USR,[h.canvasWidth,h.canvasHeight],h),T=1,M=0,N=0,A=0;if(m.modules.geoloci===c&&m.loadModule("geoloci"),m.modules.geoloci===c)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(u=O.usrCoords[1],n=w.usrCoords[1],p=w.usrCoords[2],f=O.usrCoords[2],E.translateToOrigin&&h.listOfFreePoints.length>0){for(M=(s=E.toOrigin!==c&&E.toOrigin!==null&&l.isInArray(h.listOfFreePoints,E.toOrigin.id)?E.toOrigin:h.listOfFreePoints[0]).symbolic.x,N=s.symbolic.y,d=0;d<h.listOfFreePoints.length;d++)h.listOfFreePoints[d].symbolic.x-=M,h.listOfFreePoints[d].symbolic.y-=N;if(u-=M,n-=M,p-=N,f-=N,E.translateTo10&&h.listOfFreePoints.length>1){for(a=E.to10!==c&&E.to10!==null&&E.to10.id!==E.toOrigin.id&&l.isInArray(h.listOfFreePoints,E.to10.id)?E.to10:h.listOfFreePoints[0].id===s.id?h.listOfFreePoints[1]:h.listOfFreePoints[0],A=v.rad([1,0],[0,0],[a.symbolic.x,a.symbolic.y]),b=Math.cos(-A),C=Math.sin(-A),d=0;d<h.listOfFreePoints.length;d++)_=h.listOfFreePoints[d].symbolic.x,h.listOfFreePoints[d].symbolic.x=b*h.listOfFreePoints[d].symbolic.x-C*h.listOfFreePoints[d].symbolic.y,h.listOfFreePoints[d].symbolic.y=C*_+b*h.listOfFreePoints[d].symbolic.y;if(a.symbolic.y=0,_=u,u=b*u-C*p,p=C*_+b*p,_=n,n=b*n-C*f,f=C*_+b*f,E.stretch&&Math.abs(a.symbolic.x)>y.eps){for(T=a.symbolic.x,d=0;d<h.listOfFreePoints.length;d++)h.listOfFreePoints[d].symbolic.x/=T,h.listOfFreePoints[d].symbolic.y/=T;for(d=0;d<h.objectsList.length;d++)h.objectsList[d].elementClass===g.OBJECT_CLASS_CIRCLE&&h.objectsList[d].method==="pointRadius"&&(x[d]=h.objectsList[d].radius,h.objectsList[d].radius/=T);u/=T,n/=T,p/=T,f/=T,a.symbolic.x=1}}for(d=0;d<h.listOfFreePoints.length;d++)_=h.listOfFreePoints[d].symbolic.x,Math.abs(_)<y.eps&&(h.listOfFreePoints[d].symbolic.x=0),Math.abs(_-Math.round(_))<y.eps&&(h.listOfFreePoints[d].symbolic.x=Math.round(_)),_=h.listOfFreePoints[d].symbolic.y,Math.abs(_)<y.eps&&(h.listOfFreePoints[d].symbolic.y=0),Math.abs(_-Math.round(_))<y.eps&&(h.listOfFreePoints[d].symbolic.y=Math.round(_))}for(d in o=this.generatePolynomials(h,e).join(","),this.cbp=function(R){t=R},this.cb=l.bind(this.cbp,this),m.modules.geoloci.lociCoCoA(u,n,p,f,S,o,T,A,M,N,this.cb,!0),this.clearSymbolicCoordinates(h),x)x.hasOwnProperty(d)&&(h.objects[d].radius=x[d]);return t}},y.Symbolic}),define("math/clip",["jxg","base/constants","base/coords","math/math","math/geometry","utils/type"],function(g,P,y,v,m,l){return v.Clip={_isSeparator:function(c){return isNaN(c.coords.usrCoords[1])&&isNaN(c.coords.usrCoords[2])},makeDoublyLinkedList:function(c){var h,e=null,o=[],t=c.length;if(t>0)for(h=0;h<t;h++)this._isSeparator(c[h])?(c[h]._next=c[(h+1)%t],c[h]._prev=c[(t+h-1)%t]):(e===null&&(e=h,o.push(e)),this._isSeparator(c[(h+1)%t])||h===t-1?(c[h]._next=c[e],c[e]._prev=c[h],c[h]._end=!0,e=null):(c[h]._next=c[(h+1)%t],c[e]._prev=c[h]),this._isSeparator(c[(t+h-1)%t])||(c[h]._prev=c[(t+h-1)%t]));return o},det:function(c,h,e){return(c[1]-e[1])*(h[2]-e[2])-(h[1]-e[1])*(c[2]-e[2])},windingNumber:function(c,h){var e,o,t,s,a,d=0,u=h.length,n=c[1],p=c[2];if(u===0)return 0;if(isNaN(n)||isNaN(p)||h[0].coords.usrCoords[1]===n&&h[0].coords.usrCoords[2]===p)return 1;for(a=0;a<u;a++)if(e=h[a].coords.usrCoords,o=h[(a+1)%u].coords.usrCoords,!(e[0]===0||o[0]===0||isNaN(e[1])||isNaN(o[1])||isNaN(e[2])||isNaN(o[2]))){if(o[2]===p){if(o[1]===n)return 1;if(e[2]===p&&o[1]>n==e[1]<n)return 0}if(e[2]<p!=o[2]<p)if(s=2*(o[2]>e[2]?1:0)-1,e[1]>=n)if(o[1]>n)d+=s;else{if((t=this.det(e,o,c))===0)return 0;t>0==o[2]>e[2]&&(d+=s)}else o[1]>n&&(t=this.det(e,o,c))>0+v.eps==o[2]>e[2]&&(d+=s)}return d},Vertex:function(c,h,e,o,t,s){this.pos=h,this.intersection=!0,this.coords=c,this.elementClass=P.OBJECT_CLASS_POINT,this.data={alpha:e,path:o,pathname:t,done:!1,type:s,idx:0},this.neighbour=null,this.entry_exit=!1},_addToList:function(c,h,e){var o=c.length,t=v.eps*v.eps;o>0&&Math.abs(c[o-1].coords.usrCoords[0]-h.usrCoords[0])<t&&Math.abs(c[o-1].coords.usrCoords[1]-h.usrCoords[1])<t&&Math.abs(c[o-1].coords.usrCoords[2]-h.usrCoords[2])<t||c.push({pos:e,intersection:!1,coords:h,elementClass:P.OBJECT_CLASS_POINT})},sortIntersections:function(c){var h,e,o,t,s,a,d=[],u=c.length;for(h=0;h<u;h++)if(c[h].sort(function(n,p){return n.data.alpha>p.data.alpha?1:-1}),c[h].length>0){for(s=c[h].length-1,a=(t=(o=c[h][0]).data.path[o.pos])._next,h===u-1&&(t._end=!1),o.data.alpha===0&&o.data.type==="T"?(t.intersection=!0,t.data=o.data,t.neighbour=o.neighbour,t.neighbour.neighbour=t,t.entry_exit=!1,c[h][0]=t):(o._prev=t,o._prev._next=o),e=1;e<=s;e++)(o=c[h][e])._prev=c[h][e-1],o._prev._next=o;(o=c[h][s])._next=a,o._next._prev=o,h===u-1&&(o._end=!0),d=d.concat(c[h])}return d},_inbetween:function(c,h,e){var o,t=v.eps*v.eps,s=e[1]-h[1],a=e[2]-h[2],d=c[1]-h[1],u=c[2]-h[2];return s===0&&a===0&&d===0&&u===0||(o=Math.abs(d)<t&&Math.abs(s)<t?u/a:d/s,Math.abs(o)<t&&(o=0),o)},_print_array:function(c){var h,e;for(h=0;h<c.length;h++)try{e="",c[h]._end&&(e=" end"),console.log(h,c[h].coords.usrCoords,c[h].data.type,"	","prev",c[h]._prev.coords.usrCoords,"next",c[h]._next.coords.usrCoords+e)}catch{console.log(h,c[h].coords.usrCoords)}},_print_list:function(c){for(var h,e=0;e<100&&(h=c.data?c.data.alpha:"-",console.log("	",c.coords.usrCoords,`
		is:`,c.intersection,"end:",c._end,h,`
		-:`,c._prev.coords.usrCoords,`
		+:`,c._next.coords.usrCoords,`
		n:`,c.intersection?c.neighbour.coords.usrCoords:"-"),!c._end);)c=c._next,e++},_noOverlap:function(c,h,e,o){var t,s,a,d,u,n=Math.sqrt(v.eps),p=!1;for(t=0;t<3;t++)if(s=Math.min(c[t],h[t]),a=Math.max(c[t],h[t]),d=Math.min(e[t],o[t]),u=Math.max(e[t],o[t]),a<d-n||s>u+n){p=!0;break}return p},findIntersections:function(c,h,e){var o,t,s,a,d,u,n,p,f,b,C,_,E,x=[],S=v.eps,O=c.length,w=h.length,T=[],M=[],N=[],A=!1,R=!1;for(t=0;t<w;t++)N.push([]);for(o=0;o<O;o++)if(M.push([]),this._isSeparator(c[o])||this._isSeparator(c[(o+1)%O]))A=!0;else{if(A&&o===O-1)break;for(a=c[o].coords.usrCoords,d=c[(o+1)%O].coords.usrCoords,t=0;t<w;t++)if(this._isSeparator(h[t])||this._isSeparator(h[(t+1)%w]))R=!0;else{if(R&&t===w-1)break;if(u=h[t].coords.usrCoords,n=h[(t+1)%w].coords.usrCoords,!this._noOverlap(a,d,u,n)&&(x=m.meetSegmentSegment(a,d,u,n),p=m.distance(a,d,3),f=m.distance(u,n,3),x[1]*p>-S&&x[1]<1-S/p&&x[2]*f>-S&&x[2]<1-S/f||x[1]===1/0&&x[2]===1/0&&v.norm(x[0],3)<S)){if(s=new y(P.COORDS_BY_USER,x[0],e),C="X",Math.abs(x[1])*p<S||Math.abs(x[2])*f<S)C="T",Math.abs(x[1])*p<S&&(x[1]=0),Math.abs(x[2])*f<S&&(x[2]=0),s=x[1]===0?new y(P.COORDS_BY_USER,a,e):new y(P.COORDS_BY_USER,u,e);else if(x[1]===1/0&&x[2]===1/0&&v.norm(x[0],3)<S){(b=this._inbetween(a,u,n))>=0&&b<1&&(C="T",s=new y(P.COORDS_BY_USER,a,e),x[1]=0,x[2]=b,_=new this.Vertex(s,o,x[1],c,"S",C),E=new this.Vertex(s,t,x[2],h,"C",C),_.neighbour=E,E.neighbour=_,M[o].push(_),N[t].push(E)),b=this._inbetween(u,a,d),m.distance(a,u,3)>S&&b>=0&&b<1&&(C="T",s=new y(P.COORDS_BY_USER,u,e),x[1]=b,x[2]=0,_=new this.Vertex(s,o,x[1],c,"S",C),E=new this.Vertex(s,t,x[2],h,"C",C),_.neighbour=E,E.neighbour=_,M[o].push(_),N[t].push(E));continue}_=new this.Vertex(s,o,x[1],c,"S",C),E=new this.Vertex(s,t,x[2],h,"C",C),_.neighbour=E,E.neighbour=_,M[o].push(_),N[t].push(E)}}}for(T=this.sortIntersections(M),o=0;o<T.length;o++)T[o].data.idx=o,T[o].neighbour.data.idx=o;return[T,this.sortIntersections(N)]},_getPosition:function(c,h,e,o){var t=this.det(c,h,e),s=this.det(c,e,o);return this.det(h,e,o)>=0?t>=0&&s>=0?"left":"right":t>=0||s>=0?"left":"right"},_classifyDegenerateIntersections:function(c){var h,e,o,t,s,a,d,u,n,p,f,b,C;for(d=0,c._tours=0;;){if(c.intersection&&c.data.type==="T"&&(h=c._next.coords.usrCoords,e=c._prev.coords.usrCoords,m.distance(c.coords.usrCoords,h,3)<v.eps&&(h=c._next._next.coords.usrCoords),m.distance(c.coords.usrCoords,e,3)<v.eps&&(e=c._prev._prev.coords.usrCoords),t=(s=c.neighbour)._prev.coords.usrCoords,o=s._next.coords.usrCoords,m.distance(s.coords.usrCoords,o,3)<v.eps&&(o=s._next._next.coords.usrCoords),m.distance(s.coords.usrCoords,t,3)<v.eps&&(t=s._prev._prev.coords.usrCoords),p=this.det(c.coords.usrCoords,e,t),f=this.det(c.coords.usrCoords,h,o),b=this.det(c.coords.usrCoords,e,o),C=this.det(c.coords.usrCoords,h,t),p===0&&f===0&&b===0&&C===0&&(c.coords.usrCoords[1]*=1+Math.random()*v.eps,c.coords.usrCoords[2]*=1+Math.random()*v.eps,s.coords.usrCoords[1]=c.coords.usrCoords[1],s.coords.usrCoords[2]=c.coords.usrCoords[2],p=this.det(c.coords.usrCoords,e,t),f=this.det(c.coords.usrCoords,h,o),b=this.det(c.coords.usrCoords,e,o),C=this.det(c.coords.usrCoords,h,t)),n=!1,p===0?m.affineRatio(c.coords.usrCoords,e,t)<0&&(n=!0):f===0?m.affineRatio(c.coords.usrCoords,h,o)<0&&(n=!0):b===0?m.affineRatio(c.coords.usrCoords,e,o)>0&&(n=!0):C===0&&m.affineRatio(c.coords.usrCoords,h,t)>0&&(n=!0),n&&(u=t,t=o,o=u,u=p,p=b,b=u,u=f,f=C,C=u),l.exists(c.delayedStatus)||(c.delayedStatus=[]),p===0&&f===0?c.delayedStatus=["on","on"]:p===0?(a=this._getPosition(h,t,s.coords.usrCoords,o),c.delayedStatus=["on",a]):f===0?(a=this._getPosition(e,t,s.coords.usrCoords,o),c.delayedStatus=[a,"on"]):c.delayedStatus.length===0&&(this._getPosition(e,t,s.coords.usrCoords,o)!==this._getPosition(h,t,s.coords.usrCoords,o)?c.data.type="X":c.data.type="B")),l.exists(c._tours)&&c._tours++,c._tours>3||c._end||d>1e3){d>1e3&&console.log("Clipping: _classifyDegenerateIntersections exit"),l.exists(c._tours)&&delete c._tours;break}c.intersection&&d++,c=c._next}},_handleIntersectionChains:function(c){var h,e=0,o="Null",t=!1,s=!1,a=!1;for(a;c.intersection===!0&&(c.data.type==="T"&&(c.delayedStatus[0]!=="on"&&c.delayedStatus[1]==="on"?(t=!0,h=c,o=c.delayedStatus[0]):t&&c.delayedStatus[0]==="on"&&c.delayedStatus[1]==="on"?c.data.type="B":t&&c.delayedStatus[0]==="on"&&c.delayedStatus[1]!=="on"&&(t=!1,o===c.delayedStatus[1]?(h.data.type="DB",c.data.type="DB"):(h.data.type="DX",c.data.type="DX"))),e++),c._end&&(s=!0),!s||t;){if(e>1e3){console.log("Warning: _handleIntersectionChains: intersection chain reached maximum numbers of iterations");break}c=c._next}},_handleFullyDegenerateCase:function(c,h,e){var o,t,s,a,d,u,n,p,f,b,C,_,E,x=[c,h];for(s=0;s<2;s++){for(b=(o=x[s]).length,p=0,E=!0;p<b;p++)if(!o[p].intersection){E=!1;break}if(E)for(C=(t=x[(s+1)%2]).length,p=0;p<b;p++){for(d=o[p].coords.usrCoords,u=o[(p+1)%b].coords.usrCoords,a=[.5*(d[0]+u[0]),.5*(d[1]+u[1]),.5*(d[2]+u[2])],f=0,_=!1;f<C;f++)if(Math.abs(this.det(t[f].coords.usrCoords,t[(f+1)%C].coords.usrCoords,a))<v.eps){_=!0;break}if(!_){n={pos:p,intersection:!1,coords:new y(P.COORDS_BY_USER,a,e),elementClass:P.OBJECT_CLASS_POINT},o[p]._next=n,n._prev=o[p],o[(p+1)%b]._prev=n,n._next=o[(p+1)%b],o[p]._end&&(o[p]._end=!1,n._end=!0);break}}}},_getStatus:function(c,h){for(;c.intersection&&!c._end;)c=c._next;return[c,this.windingNumber(c.coords.usrCoords,h)%2==0?"entry":"exit"]},markEntryExit:function(c,h,e){var o,t,s,a,d,u,n,p=null,f=0;for(u=e.length,d=0;d<u;d++)for(n=e[d],this._classifyDegenerateIntersections(c[n]),this._handleIntersectionChains(c[n]),t=(a=this._getStatus(c[n],h))[0],o=a[1],t._starter=!0,s=0,p=null,f=0;t.intersection===!0&&(t.data.type==="X"&&f===1&&(p.entry_exit=o,o==="exit"&&(p.data.type="X"),f=2),t.data.type!=="X"&&t.data.type!=="DB"||(t.entry_exit=o,o=o==="entry"?"exit":"entry"),t.data.type==="DX"&&(f===0?(p=t,f=1):f===1?(t.entry_exit=o,p.entry_exit=o,o==="exit"?p.data.type="X":t.data.type="X",o=o==="entry"?"exit":"entry",p=null,f=0):f===2&&(t.entry_exit=o,t.data.type="X",o=o==="entry"?"exit":"entry",p=null,f=0))),t=t._next,!(l.exists(t._starter)||s>1e4);)s++},_stayOnPath:function(c,h){var e=!0;return c.intersection&&c.data.type!=="B"&&(e=h===c.entry_exit),e},_addVertex:function(c,h,e){return isNaN(h.coords.usrCoords[1])||isNaN(h.coords.usrCoords[2])||c.push(h),h.intersection&&h.data.done?(e&&console.log("Add last intersection point",h.coords.usrCoords,"on",h.data.pathname,h.entry_exit,h.data.type),!0):(h.intersection&&(h.data.done=!0,e&&console.log("Add intersection point",h.coords.usrCoords,"on",h.data.pathname,h.entry_exit,h.data.type)),!1)},tracing:function(c,h,e){var o,t,s,a,d=0,u=1e4,n=0,p=[],f=!1,b=!1;for(b;n<h.length&&d<u;)if((t=h[n]).data.done||t.data.type!=="X")n++;else{p.length>0&&p.push([NaN,NaN]),s=t.data.idx,o=c,f=this._addVertex(p,t,b),a=t.entry_exit;do{if(f)break;if(e==="intersection"&&t.entry_exit==="entry"||e==="union"&&t.entry_exit==="exit"||e==="difference"&&o===c==(t.entry_exit==="exit")){do if(t=t._next,f=this._addVertex(p,t,b))break;while(this._stayOnPath(t,a));d++}else{do if(t=t._prev,f=this._addVertex(p,t,b))break;while(this._stayOnPath(t,a));d++}if(f)break;if(!t.neighbour)return console.log("Tracing: emergency break - no neighbour!!!!!!!!!!!!!!!!!",d),[[0],[0]];if((t=t.neighbour).data.done)break;t.data.done=!0,a=t.entry_exit,o=t.data.path}while(t.data.idx!==s&&d<u);d>=u&&console.log("Tracing: stopping an infinite loop!",d),n++}return this._getCoordsArrays(p,!1)},isEmptyCase:function(c,h,e){return e==="intersection"&&(c.length===0||h.length===0)||e==="union"&&c.length===0&&h.length===0||e==="difference"&&c.length===0},_getCoordsArrays:function(c,h){var e,o=[],t=[],s=c.length;for(e=0;e<s;e++)c[e].coords?(o.push(c[e].coords.usrCoords[1]),t.push(c[e].coords.usrCoords[2])):(o.push(c[e][0]),t.push(c[e][1]));return h&&s>0&&(c[0].coords?(o.push(c[0].coords.usrCoords[1]),t.push(c[0].coords.usrCoords[2])):(o.push(c[0][0]),t.push(c[0][1]))),[o,t]},handleEmptyIntersection:function(c,h,e){var o,t,s=!1,a=[];if(c.length===0)return a=e==="union"?h:[],this._getCoordsArrays(a,!0);if(h.length===0)return a=e==="intersection"?[]:c,this._getCoordsArrays(a,!0);if(c.length>0)for(o=c[0];o.intersection&&!(o=o._next)._end;);if(h.length>0)for(t=h[0];t.intersection&&!(t=t._next)._end;);return this.windingNumber(o.coords.usrCoords,h)===0?this.windingNumber(t.coords.usrCoords,c)!==0?(e==="union"?(a=a.concat(c)).push(c[0]):e==="difference"&&((a=a.concat(c)).push(c[0]),m.signedPolygon(c)*m.signedPolygon(h)>0&&a.reverse(),a.push([NaN,NaN])),e!=="difference"&&e!=="intersection"||((a=a.concat(h)).push(h[0]),s=!1)):e==="difference"?(a=a.concat(c),s=!0):e==="union"&&((a=a.concat(c)).push(c[0]),a.push([NaN,NaN]),(a=a.concat(h)).push(h[0])):e==="intersection"?(a=a.concat(c),s=!0):e==="union"&&(a=a.concat(h)).push(h[0]),this._getCoordsArrays(a,s)},_countCrossingIntersections:function(c){var h,e=c.length,o=0;for(h=0;h<e;h++)c[h].data.type==="X"&&o++;return o},_getPath:function(c,h){var e,o,t,s,a,d,u,n=[];if(c.elementClass!==P.OBJECT_CLASS_CURVE||c.type!==P.OBJECT_TYPE_ARC&&c.type!==P.OBJECT_TYPE_SECTOR){if(c.elementClass===P.OBJECT_CLASS_CURVE&&l.exists(c.points))for(o=c.numberPoints,e=0;e<o;e++)this._addToList(n,c.points[e],e);else if(c.type===P.OBJECT_TYPE_POLYGON)for(e=0;e<c.vertices.length;e++)this._addToList(n,c.vertices[e].coords,e);else if(c.elementClass===P.OBJECT_CLASS_CIRCLE)for(u=359,t=c.Radius(),s=2*Math.PI/u,e=0;e<=u;e++)this._addToList(n,new y(P.COORDS_BY_USER,[c.center.coords.usrCoords[0],c.center.coords.usrCoords[1]+Math.cos(e*s)*t,c.center.coords.usrCoords[2]+Math.sin(e*s)*t],h),e);else if(l.isArray(c))for(o=c.length,e=0;e<o;e++)l.exists(c[e].coords)?this._addToList(n,c[e].coords,e):l.isArray(c[e])?this._addToList(n,new y(P.COORDS_BY_USER,c[e],h),e):l.exists(c[e].usrCoords)&&this._addToList(n,c[e],e)}else{for(a=m.rad(c.radiuspoint,c.center,c.anglepoint),u=Math.floor(180*a/Math.PI),t=c.Radius(),s=a/u,d=Math.atan2(c.radiuspoint.coords.usrCoords[2]-c.center.coords.usrCoords[2],c.radiuspoint.coords.usrCoords[1]-c.center.coords.usrCoords[1]),c.type===P.OBJECT_TYPE_SECTOR&&this._addToList(n,c.center.coords,0),e=0;e<=u;e++)this._addToList(n,new y(P.COORDS_BY_USER,[c.center.coords.usrCoords[0],c.center.coords.usrCoords[1]+Math.cos(e*s+d)*t,c.center.coords.usrCoords[2]+Math.sin(e*s+d)*t],h),e+1);c.type===P.OBJECT_TYPE_SECTOR&&this._addToList(n,c.center.coords,u+2)}return n},greinerHormann:function(c,h,e,o){var t,s,a,d,u=[],n=[];return(t=(u=this._getPath(c,o)).length)>0&&m.distance(u[0].coords.usrCoords,u[t-1].coords.usrCoords,3)<v.eps&&u.pop(),(t=(n=this._getPath(h,o)).length)>0&&m.distance(n[0].coords.usrCoords,n[t-1].coords.usrCoords,3)<v.eps*v.eps&&n.pop(),this.isEmptyCase(u,n,e)?[[],[]]:(a=this.makeDoublyLinkedList(u),d=this.makeDoublyLinkedList(n),s=this.findIntersections(u,n,o)[0],this._handleFullyDegenerateCase(u,n,o),this.markEntryExit(u,n,a),this.markEntryExit(n,u,d),this._countCrossingIntersections(s)===0?this.handleEmptyIntersection(u,n,e):this.tracing(u,s,e))},union:function(c,h,e){return this.greinerHormann(c,h,"union",e)},intersection:function(c,h,e){return this.greinerHormann(c,h,"intersection",e)},difference:function(c,h,e){return this.greinerHormann(c,h,"difference",e)}},g.extend(v.Clip,{}),v.Clip}),define("math/poly",["jxg","math/math","utils/type"],function(g,P,y){return P.Poly={},P.Poly.Ring=function(v){this.vars=v},g.extend(P.Poly.Ring.prototype,{}),P.Poly.Monomial=function(v,m,l){var c;if(!y.exists(v))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(y.isArray(l)||(l=[]),c=(l=l.slice(0,v.vars.length)).length;c<v.vars.length;c++)l.push(0);this.ring=v,this.coefficient=m||0,this.exponents=y.deepCopy(l)},g.extend(P.Poly.Monomial.prototype,{copy:function(){return new P.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var v,m=[];for(v=0;v<this.ring.vars.length;v++)m.push(this.ring.vars[v]+"^"+this.exponents[v]);return this.coefficient+"*"+m.join("*")}}),P.Poly.Polynomial=function(v,m){var l;if(!y.exists(v))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");l=y.exists(m)&&y.isString(m)?void 0:[],this.ring=v,this.monomials=l},g.extend(P.Poly.Polynomial.prototype,{findSignature:function(v){var m;for(m=0;m<this.monomials.length;m++)if(y.cmpArrays(this.monomials[m].exponents,v))return m;return-1},addSubMonomial:function(v,m){var l;(l=this.findSignature(v.exponents))>-1?this.monomials[l].coefficient+=m*v.coefficient:(v.coefficient*=m,this.monomials.push(v))},add:function(v){var m;if(!y.exists(v)||v.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(y.isArray(v.exponents))this.addSubMonomial(v,1);else for(m=0;m<v.monomials.length;m++)this.addSubMonomial(v.monomials[m],1)},sub:function(v){var m;if(!y.exists(v)||v.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(y.isArray(v.exponents))this.addSubMonomial(v,-1);else for(m=0;m<v.monomials.length;m++)this.addSubMonomial(v.monomials[m],-1)},copy:function(){var v,m;for(m=new P.Poly.Polynomial(this.ring),v=0;v<this.monomials.length;v++)m.monomials.push(this.monomials[v].copy());return m},print:function(){var v,m=[];for(v=0;v<this.monomials.length;v++)m.push("("+this.monomials[v].print()+")");return m.join("+")}}),P.Poly}),define("math/complex",["jxg","utils/type"],function(g,P){return g.Complex=function(y,v){this.isComplex=!0,y&&y.isComplex&&(v=y.imaginary,y=y.real),this.real=y||0,this.imaginary=v||0,this.absval=0,this.angle=0},g.extend(g.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(y){return P.isNumber(y)?this.real+=y:(this.real+=y.real,this.imaginary+=y.imaginary),this},sub:function(y){return P.isNumber(y)?this.real-=y:(this.real-=y.real,this.imaginary-=y.imaginary),this},mult:function(y){var v,m;return P.isNumber(y)?(this.real*=y,this.imaginary*=y):(v=this.real,m=this.imaginary,this.real=v*y.real-m*y.imaginary,this.imaginary=v*y.imaginary+m*y.real),this},div:function(y){var v,m,l;if(P.isNumber(y)){if(Math.abs(y)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=y,this.imaginary/=y}else{if(Math.abs(y.real)<Math.eps&&Math.abs(y.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;v=y.real*y.real+y.imaginary*y.imaginary,l=this.real,m=this.imaginary,this.real=(l*y.real+m*y.imaginary)/v,this.imaginary=(m*y.real-l*y.imaginary)/v}return this},conj:function(){return this.imaginary*=-1,this}}),g.C={},g.C.add=function(y,v){var m=new g.Complex(y);return m.add(v),m},g.C.sub=function(y,v){var m=new g.Complex(y);return m.sub(v),m},g.C.mult=function(y,v){var m=new g.Complex(y);return m.mult(v),m},g.C.div=function(y,v){var m=new g.Complex(y);return m.div(v),m},g.C.conj=function(y){var v=new g.Complex(y);return v.conj(),v},g.C.abs=function(y){var v=new g.Complex(y);return v.conj(),v.mult(y),Math.sqrt(v.real)},g.Complex.C=g.C,g.Complex}),define("utils/color",["jxg","utils/type","math/math"],function(g,P,y){var v={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},m=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(l){return[parseInt(l[1],10),parseInt(l[2],10),parseInt(l[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1],10),parseInt(l[2],10),parseInt(l[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}];return g.rgbParser=function(l,c,h){var e,o,t,s,a,d,u,n,p,f,b=l;if(!P.exists(l))return[];if(P.exists(c)&&P.exists(h)&&(b=[l,c,h]),e=b,f=!1,P.isArray(e)){for(d=0;d<3;d++)f=f||/\./.test(b[d].toString());for(d=0;d<3;d++)f=f&&b[d]>=0&&b[d]<=1;return f?[Math.ceil(255*b[0]),Math.ceil(255*b[1]),Math.ceil(255*b[2])]:b}for(typeof b=="string"&&(e=b),e.charAt(0)==="#"&&(e=e.substr(1,6)),e=e.replace(/ /g,"").toLowerCase(),e=v[e]||e,d=0;d<m.length;d++)t=m[d].re,s=m[d].process,(a=t.exec(e))&&(u=(o=s(a))[0],n=o[1],p=o[2]);return isNaN(u)||isNaN(n)||isNaN(p)?[]:[u=u<0||isNaN(u)?0:u>255?255:u,n=n<0||isNaN(n)?0:n>255?255:n,p=p<0||isNaN(p)?0:p>255?255:p]},g.rgb2css=function(l,c,h){var e;return"rgb("+(e=g.rgbParser(l,c,h))[0]+", "+e[1]+", "+e[2]+")"},g.rgb2hex=function(l,c,h){var e,o,t;return o=(e=g.rgbParser(l,c,h))[1],t=e[2],e=(e=e[0]).toString(16),o=o.toString(16),t=t.toString(16),e.length===1&&(e="0"+e),o.length===1&&(o="0"+o),t.length===1&&(t="0"+t),"#"+e+o+t},g.hex2rgb=function(l){return g.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),g.rgb2css(l)},g.hsv2rgb=function(l,c,h){var e,o,t,s,a,d,u,n,p;if(l=(l%360+360)%360,c===0){if(!(isNaN(l)||l<y.eps))return"#ffffff";e=h,o=h,t=h}else switch(d=l>=360?0:l,u=h*(1-c),n=h*(1-c*(s=(d/=60)-(a=Math.floor(d)))),p=h*(1-c*(1-s)),a){case 0:e=h,o=p,t=u;break;case 1:e=n,o=h,t=u;break;case 2:e=u,o=h,t=p;break;case 3:e=u,o=n,t=h;break;case 4:e=p,o=u,t=h;break;case 5:e=h,o=u,t=n}return["#",e=(e=Math.round(255*e).toString(16)).length===2?e:e.length===1?"0"+e:"00",o=(o=Math.round(255*o).toString(16)).length===2?o:o.length===1?"0"+o:"00",t=(t=Math.round(255*t).toString(16)).length===2?t:t.length===1?"0"+t:"00"].join("")},g.rgb2hsv=function(l,c,h){var e,o,t,s,a,d,u,n,p,f,b,C,_;return o=(e=g.rgbParser(l,c,h))[1],t=e[2],s=(e=e[0])/255,a=o/255,d=t/255,C=Math.max(e,o,t),n=(_=Math.min(e,o,t))/255,f=0,(b=u=C/255)>0&&(f=(b-n)/b),p=1/(u-n),f>0&&(C===e?p*=a-d:p=C===o?2+(d-s)*p:4+(s-a)*p),(p*=60)<0&&(p+=360),C===_&&(p=0),[p,f,b]},g.rgb2LMS=function(l,c,h){var e,o,t,s,a,d,u,n=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return o=(e=g.rgbParser(l,c,h))[1],t=e[2],e=e[0],e=Math.pow(e,.476190476),o=Math.pow(o,.476190476),t=Math.pow(t,.476190476),(u=[s=e*n[0][0]+o*n[0][1]+t*n[0][2],a=e*n[1][0]+o*n[1][1]+t*n[1][2],d=e*n[2][0]+o*n[2][1]+t*n[2][2]]).l=s,u.m=a,u.s=d,u},g.LMS2rgb=function(l,c,h){var e,o,t,s,a=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],d=function(u){for(var n=127,p=64;p>0;){if(Math.pow(n,.476190476)>u)n-=p;else{if(Math.pow(n+1,.476190476)>u)return n;n+=p}p/=2}return n===254&&13.994955247<u?255:n};return e=l*a[0][0]+c*a[0][1]+h*a[0][2],o=l*a[1][0]+c*a[1][1]+h*a[1][2],t=l*a[2][0]+c*a[2][1]+h*a[2][2],(s=[e=d(e),o=d(o),t=d(t)]).r=e,s.g=o,s.b=t,s},g.rgba2rgbo=function(l){var c;return l.length===9&&l.charAt(0)==="#"?(c=parseInt(l.substr(7,2).toUpperCase(),16)/255,l=l.substr(0,7)):c=1,[l,c]},g.rgbo2rgba=function(l,c){var h;return l==="none"?l:((h=Math.round(255*c).toString(16)).length===1&&(h="0"+h),l+h)},g.rgb2bw=function(l){var c,h,e,o="0123456789ABCDEF";return l==="none"?l:(e=g.rgbParser(l),c=Math.floor(.3*e[0]+.59*e[1]+.11*e[2]),l="#"+(h=o.charAt(c>>4&15)+o.charAt(15&c))+h+h)},g.rgb2cb=function(l,c){var h,e,o,t,s,a,d,u,n,p,f,b="0123456789ABCDEF";if(l==="none")return l;switch(e=(s=g.rgb2LMS(l))[0],o=s[1],t=s[2],c=c.toLowerCase()){case"protanopia":a=-.06150039994295001,d=.08277001656812001,u=-.013200141220000003,n=.05858939668799999,p=-.07934519995360001,f=.013289415272000003,e=t/o<.6903216543277437?-(d*o+u*t)/a:-(p*o+f*t)/n;break;case"tritanopia":a=-.00058973116217,d=.007690316482,u=-.01011703519052,n=.025495080838999994,p=-.0422740347,f=.017005316784,t=o/e<.8349489908460004?-(a*e+d*o)/u:-(n*e+p*o)/f;break;default:a=-.06150039994295001,d=.08277001656812001,u=-.013200141220000003,n=.05858939668799999,p=-.07934519995360001,f=.013289415272000003,o=t/e<.5763833686400911?-(a*e+u*t)/d:-(n*e+f*t)/p}return h=g.LMS2rgb(e,o,t),l="#"+(b.charAt(h[0]>>4&15)+b.charAt(15&h[0])),l+=b.charAt(h[1]>>4&15)+b.charAt(15&h[1]),l+=b.charAt(h[2]>>4&15)+b.charAt(15&h[2])},g.autoHighlight=function(l){var c=g.rgba2rgbo(l),h=c[0],e=c[1];return l.charAt(0)==="#"?(e*=e<.3?1.8:.4,g.rgbo2rgba(h,e)):l},g.contrast=function(l,c,h,e){var o,t,s,a,d;return c=c||"#000000",h=h||"#ffffff",e=e||7,o=g.rgbParser(l),t=g.rgbParser("#000000"),d=(s=.2126*Math.pow(o[0]/255,2.2)+.7152*Math.pow(o[1]/255,2.2)+.0722*Math.pow(o[2]/255,2.2))>(a=.2126*Math.pow(t[0]/255,2.2)+.7152*Math.pow(t[1]/255,2.2)+.0722*Math.pow(t[2]/255,2.2))?Math.floor((s+.05)/(a+.05)):Math.floor((a+.05)/(s+.05)),(d-=1)>e?c:h},g.setClassicColors=function(){g.Options.elements.strokeColor="blue",g.Options.elements.fillColor="red",g.Options.hatch.strokeColor="blue",g.Options.angle.fillColor="#ff7f00",g.Options.angle.highlightFillColor="#ff7f00",g.Options.angle.strokeColor="#ff7f00",g.Options.angle.label.strokeColor="blue",g.Options.arc.strokeColor="blue",g.Options.circle.center.fillColor="red",g.Options.circle.center.strokeColor="blue",g.Options.circumcircle.strokeColor="blue",g.Options.circumcircle.center.fillColor="red",g.Options.circumcircle.center.strokeColor="blue",g.Options.circumcirclearc.strokeColor="blue",g.Options.circumcirclesector.strokeColor="blue",g.Options.circumcirclesector.fillColor="green",g.Options.circumcirclesector.highlightFillColor="green",g.Options.conic.strokeColor="blue",g.Options.curve.strokeColor="blue",g.Options.incircle.strokeColor="blue",g.Options.incircle.center.fillColor="red",g.Options.incircle.center.strokeColor="blue",g.Options.inequality.fillColor="red",g.Options.integral.fillColor="red",g.Options.integral.curveLeft.color="red",g.Options.integral.curveRight.color="red",g.Options.line.strokeColor="blue",g.Options.point.fillColor="red",g.Options.point.strokeColor="red",g.Options.polygon.fillColor="green",g.Options.polygon.highlightFillColor="green",g.Options.polygon.vertices.strokeColor="red",g.Options.polygon.vertices.fillColor="red",g.Options.regularpolygon.fillColor="green",g.Options.regularpolygon.highlightFillColor="green",g.Options.regularpolygon.vertices.strokeColor="red",g.Options.regularpolygon.vertices.fillColor="red",g.Options.riemannsum.fillColor="yellow",g.Options.sector.fillColor="green",g.Options.sector.highlightFillColor="green",g.Options.semicircle.center.fillColor="red",g.Options.semicircle.center.strokeColor="blue",g.Options.slopetriangle.fillColor="red",g.Options.slopetriangle.highlightFillColor="red",g.Options.turtle.arrow.strokeColor="blue"},g.extend(g,{paletteWong:{black:"#000000",orange:"#E69F00",skyblue:"#56B4E9",bluishgreen:"#009E73",yellow:"#F0E442",darkblue:"#0072B2",vermillion:"#D55E00",reddishpurple:"#CC79A7",blue:"#0072B2",red:"#D55E00",green:"#009E73",purple:"#CC79A7",white:"#ffffff"}}),g.palette=g.paletteWong,g}),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],function(g,P,y,v,m){return g.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],maxBoundingBox:[-1/0,1/0,1/0,-1/0],zoomFactor:1,zoomX:1,zoomY:1,title:"",description:"",showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"\u2318",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showFullscreen:!1,fullscreen:{symbol:"\u25A1",id:null},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,maxFrameRate:40,registerEvents:!0,minimizeReflow:"none",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},drag:{enabled:!0},keyboard:{enabled:!0,dx:10,dy:10,panShift:!0,panCtrl:!1},resize:{enabled:!0,throttle:10},moveTarget:null,selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1},showInfobox:!0},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",fillColor:v.palette.red,highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,gradient:null,gradientSecondColor:"#ffffff",gradientSecondOpacity:1,gradientStartOffset:0,gradientEndOffset:1,gradientAngle:0,gradientCX:.5,gradientCY:.5,gradientR:.5,gradientFX:.5,gradientFY:.5,gradientFR:0,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,precision:"inherit",draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1,tabindex:0},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},beautifulScientificTickLabels:!1,useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,digits:3,ticksDistance:1,face:"|",strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"none",highlightFillColor:"none",visible:"inherit",includeBoundaries:!1,type:"linear"},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",face:"|",strokeWidth:2,strokeColor:v.palette.blue,ticksDistance:.2},precision:{touch:30,touchMax:100,mouse:4,pen:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,unused9:19,unused8:18,unused7:17,unused6:16,unused5:15,unused4:14,unused3:13,unused2:12,unused1:11,unused0:10,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:"auto",type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:v.palette.orange,highlightFillColor:v.palette.orange,strokeColor:v.palette.orange,fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"#000000",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:v.palette.blue},arc:{visible:!1,fillColor:"none"}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",useDirection:!1,center:{},radiusPoint:{},anglePoint:{}},arrow:{firstArrow:!1,lastArrow:{type:1,highlightSize:6,size:6}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,highlightSize:8,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},tabindex:-1,label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"#000000"},line2:{strokeColor:"#000000"}},boxplot:{dir:"vertical",smallWidth:.5,strokeWidth:2,strokeColor:v.palette.blue,fillColor:v.palette.blue,fillOpacity:.2,highlightStrokeWidth:2,highlightStrokeColor:v.palette.blue,highlightFillColor:v.palette.blue,highlightFillOpacity:.1},button:{disabled:!1,display:"html"},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#c3d9ff","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1,display:"html"},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,withLabel:!1,fixed:!1,fillColor:v.palette.red,strokeColor:v.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,fixed:!1,withLabel:!1,fillColor:v.palette.red,strokeColor:v.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:v.palette.yellow,highlightFillColor:v.palette.yellow,fillOpacity:.3,highlightFillOpacity:.3,strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""},line:{visible:!1}},curve:{strokeWidth:1,strokeColor:v.palette.blue,fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:15,doAdvancedPlotOld:!1,plotVersion:2,label:{position:"lft"},firstArrow:!1,lastArrow:!1},foreignobject:{attractors:[],fixed:!0,visible:!0},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#c0c0c0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"#000000",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,fixed:!1,withLabel:!1,fillColor:v.palette.red,strokeColor:v.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""}},inequality:{fillColor:v.palette.red,fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:v.palette.red,fillOpacity:.3,highlightFillColor:v.palette.red,highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:v.palette.red,fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:v.palette.red,fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288,display:"html"},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"#000000",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"#000000",fixed:!0,position:"urt",offset:[10,10],autoPosition:!1},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#c3d9ff","#4096EE","#008C00"],rowHeight:20,strokeWidth:5},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:v.palette.blue,highlightStrokeColor:"#c3d9ff",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},metapostspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},mirrorelement:{fixed:!0,point:{},center:{},type:"Euclidean"},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",strokeWidth:2,fillColor:v.palette.red,strokeColor:v.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",zoom:!1,showInfobox:"inherit",infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,attractToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:v.palette.yellow,highlightFillColor:v.palette.yellow,fillOpacity:.3,highlightFillOpacity:.2,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:v.palette.red,fillColor:v.palette.red,fixed:!1,visible:"inherit"},label:{offset:[0,0]}},polygonalchain:{fillColor:"none",highlightFillColor:"none"},prescribedangle:{anglePoint:{size:2,visible:!1,withLabel:!1}},reflection:{fixed:!0,center:{},type:"Euclidean"},regularpolygon:{hasInnerPoints:!1,fillColor:v.palette.yellow,highlightFillColor:v.palette.yellow,fillOpacity:.3,highlightFillOpacity:.2,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:v.palette.red,fillColor:v.palette.red,fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:v.palette.yellow},sector:{fillColor:v.palette.yellow,highlightFillColor:v.palette.yellow,fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiusPoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglePoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,fillColor:v.palette.red,strokeColor:v.palette.red,highlightFillColor:"#eeeeee",highlightStrokeColor:v.palette.red,name:""}},slider:{snapWidth:-1,precision:2,digits:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,visible:"inherit",fixed:!0,scalable:!1,tabindex:null,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,digits:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,visible:"inherit",fixed:!0,tabindex:null,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{visible:"inherit",strokeColor:"#000000"},moveOnUp:!0},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:v.palette.red,fillOpacity:.4,highlightFillColor:v.palette.red,highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,digits:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,fontUnit:"px",digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"#000000",highlightStrokeColor:"#000000",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,useKatex:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:v.palette.red,lastArrow:!0}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},g.Validator=function(){var l,c=function(d){return m.isString(d)},h=function(d){return Math.abs(d-Math.round(d))<y.eps},e=function(d){return h(d)&&d>0},o=function(d){return d>0},t=function(d){return d>=0},s={},a={attractorDistance:t,color:c,defaultDistance:m.isNumber,display:function(d){return d==="html"||d==="internal"},doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:function(d){return m.exists(g.normalizePointFace(d))},factor:m.isNumber,fillColor:c,fillOpacity:m.isNumber,firstArrow:!1,fontSize:h,dash:h,gridX:m.isNumber,gridY:m.isNumber,hasGrid:!1,highlightFillColor:c,highlightFillOpacity:m.isNumber,highlightStrokeColor:c,highlightStrokeOpacity:m.isNumber,insertTicks:!1,lastArrow:!1,layer:function(d){return h(d)&&d>=0},majorHeight:h,minorHeight:h,minorTicks:t,minTicksDistance:e,numberPointsHigh:e,numberPointsLow:e,opacity:m.isNumber,radius:m.isNumber,RDPsmoothing:!1,renderer:function(d){return d==="vml"||d==="svg"||d==="canvas"||d==="no"},right:function(d){return/^[0-9]+px$/.test(d)},showCopyright:!1,showInfobox:!1,showNavigation:!1,size:t,snapSizeX:o,snapSizeY:o,snapWidth:m.isNumber,snapToGrid:!1,snatchDistance:t,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:c,strokeOpacity:m.isNumber,strokeWidth:t,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(l in a)a.hasOwnProperty(l)&&(s[l.toLowerCase()]=a[l]);return s}(),g.normalizePointFace=function(l){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[l]},g.useStandardOptions=function(l){var c,h,e,o,t=g.Options,s=l.hasGrid;for(c in l.options.grid.hasGrid=t.grid.hasGrid,l.options.grid.gridX=t.grid.gridX,l.options.grid.gridY=t.grid.gridY,l.options.grid.gridColor=t.grid.gridColor,l.options.grid.gridOpacity=t.grid.gridOpacity,l.options.grid.gridDash=t.grid.gridDash,l.options.grid.snapToGrid=t.grid.snapToGrid,l.options.grid.snapSizeX=t.grid.SnapSizeX,l.options.grid.snapSizeY=t.grid.SnapSizeY,l.takeSizeFromFile=t.takeSizeFromFile,o=function(a,d){a.visProp.fillcolor=d.fillColor,a.visProp.highlightfillcolor=d.highlightFillColor,a.visProp.strokecolor=d.strokeColor,a.visProp.highlightstrokecolor=d.highlightStrokeColor},l.objects)if(l.objects.hasOwnProperty(c))if((e=l.objects[c]).elementClass===P.OBJECT_CLASS_POINT)o(e,t.point);else if(e.elementClass===P.OBJECT_CLASS_LINE)for(o(e,t.line),h=0;h<e.ticks.length;h++)e.ticks[h].majorTicks=t.line.ticks.majorTicks,e.ticks[h].minTicksDistance=t.line.ticks.minTicksDistance,e.ticks[h].visProp.minorheight=t.line.ticks.minorHeight,e.ticks[h].visProp.majorheight=t.line.ticks.majorHeight;else e.elementClass===P.OBJECT_CLASS_CIRCLE?o(e,t.circle):e.type===P.OBJECT_TYPE_ANGLE?o(e,t.angle):e.type===P.OBJECT_TYPE_ARC?o(e,t.arc):e.type===P.OBJECT_TYPE_POLYGON?o(e,t.polygon):e.type===P.OBJECT_TYPE_CONIC?o(e,t.conic):e.type===P.OBJECT_TYPE_CURVE?o(e,t.curve):e.type===P.OBJECT_TYPE_SECTOR&&(e.arc.visProp.fillcolor=t.sector.fillColor,e.arc.visProp.highlightfillcolor=t.sector.highlightFillColor,e.arc.visProp.fillopacity=t.sector.fillOpacity,e.arc.visProp.highlightfillopacity=t.sector.highlightFillOpacity);l.fullUpdate(),s&&!l.hasGrid?l.removeGrids(l):!s&&l.hasGrid&&l.create("grid",[])},g.useBlackWhiteOptions=function(l){var c=g.Options;c.point.fillColor=v.rgb2bw(c.point.fillColor),c.point.highlightFillColor=v.rgb2bw(c.point.highlightFillColor),c.point.strokeColor=v.rgb2bw(c.point.strokeColor),c.point.highlightStrokeColor=v.rgb2bw(c.point.highlightStrokeColor),c.line.fillColor=v.rgb2bw(c.line.fillColor),c.line.highlightFillColor=v.rgb2bw(c.line.highlightFillColor),c.line.strokeColor=v.rgb2bw(c.line.strokeColor),c.line.highlightStrokeColor=v.rgb2bw(c.line.highlightStrokeColor),c.circle.fillColor=v.rgb2bw(c.circle.fillColor),c.circle.highlightFillColor=v.rgb2bw(c.circle.highlightFillColor),c.circle.strokeColor=v.rgb2bw(c.circle.strokeColor),c.circle.highlightStrokeColor=v.rgb2bw(c.circle.highlightStrokeColor),c.arc.fillColor=v.rgb2bw(c.arc.fillColor),c.arc.highlightFillColor=v.rgb2bw(c.arc.highlightFillColor),c.arc.strokeColor=v.rgb2bw(c.arc.strokeColor),c.arc.highlightStrokeColor=v.rgb2bw(c.arc.highlightStrokeColor),c.polygon.fillColor=v.rgb2bw(c.polygon.fillColor),c.polygon.highlightFillColor=v.rgb2bw(c.polygon.highlightFillColor),c.sector.fillColor=v.rgb2bw(c.sector.fillColor),c.sector.highlightFillColor=v.rgb2bw(c.sector.highlightFillColor),c.curve.strokeColor=v.rgb2bw(c.curve.strokeColor),c.grid.gridColor=v.rgb2bw(c.grid.gridColor),g.useStandardOptions(l)},g.Options.normalizePointFace=g.normalizePointFace,g.Options}),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],function(g,P,y,v,m,l,c,h){return g.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},g.extend(g.AbstractRenderer.prototype,{_updateVisual:function(e,o,t){(t||this.enhancedRendering)&&(o=o||{},this.setObjectTransition(e),c.evaluate(e.visProp.draft)?this.setDraft(e):(o.stroke||(e.highlighted?(this.setObjectStrokeColor(e,e.visProp.highlightstrokecolor,e.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(e,e.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(e,e.visProp.strokecolor,e.visProp.strokeopacity),this.setObjectStrokeWidth(e,e.visProp.strokewidth))),o.fill||(e.highlighted?this.setObjectFillColor(e,e.visProp.highlightfillcolor,e.visProp.highlightfillopacity):this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity)),o.dash||this.setDashStyle(e,e.visProp),o.shadow||this.setShadow(e),o.gradient||this.setShadow(e),o.tabindex||this.setTabindex(e)))},_getHighlighted:function(e){var o=!1;return c.exists(e.board)&&c.exists(e.board.highlightedObjects)||(o=!0),!o&&c.exists(e.board.highlightedObjects[e.id])?"highlight":""},drawPoint:function(e){var o,t=P.normalizePointFace(c.evaluate(e.visProp.face));o=t==="o"?"ellipse":t==="[]"?"rect":"path",e.rendNode=this.appendChildPrim(this.createPrim(o,e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,o),this._updateVisual(e,{dash:!0,shadow:!0},!0),this.updatePoint(e)},updatePoint:function(e){var o,t=c.evaluate(e.visProp.size),s=P.normalizePointFace(c.evaluate(e.visProp.face)),a=c.evaluate(e.visProp.sizeunit),d=c.evaluate(e.visProp.zoom);isNaN(e.coords.scrCoords[2]+e.coords.scrCoords[1])||(a==="user"&&(t*=Math.sqrt(e.board.unitX*e.board.unitY)),o=(t*=e.board&&d?Math.sqrt(e.board.zoomX*e.board.zoomY):1)===0?0:t+1,s==="o"?this.updateEllipsePrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2],o,o):s==="[]"?this.updateRectPrim(e.rendNode,e.coords.scrCoords[1]-t,e.coords.scrCoords[2]-t,2*t,2*t):this.updatePathPrim(e.rendNode,this.updatePathStringPoint(e,t,s),e.board),this._updateVisual(e,{dash:!1,shadow:!1}),this.setShadow(e))},changePointStyle:function(e){var o=this.getElementById(e.id);c.exists(o)&&this.remove(o),this.drawPoint(e),c.clearVisPropOld(e),e.visPropCalc.visible||this.display(e,!1),c.evaluate(e.visProp.draft)&&this.setDraft(e)},drawLine:function(e){e.rendNode=this.appendChildPrim(this.createPrim("line",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"lines"),this.updateLine(e)},updateLine:function(e){this._updateVisual(e),this.updatePathWithArrowHeads(e),this.setLineCap(e)},drawCurve:function(e){e.rendNode=this.appendChildPrim(this.createPrim("path",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"path"),this.updateCurve(e)},updateCurve:function(e){this._updateVisual(e),this.updatePathWithArrowHeads(e),this.setLineCap(e)},updatePathWithArrowHeads:function(e,o){var t,s,a=e.visProp,d=o?"highlight":"";t=o&&a.highlightstrokewidth?Math.max(c.evaluate(a.highlightstrokewidth),c.evaluate(a.strokewidth)):c.evaluate(a.strokewidth),s=this.getArrowHeadData(e,t,d),this.makeArrows(e,s),e.elementClass===v.OBJECT_CLASS_LINE?this.updateLineWithEndings(e,s):e.elementClass===v.OBJECT_CLASS_CURVE&&this.updatePath(e),this.setArrowSize(e,s)},getArrowHeadData:function(e,o,t){var s,a,d,u,n=m.eps,p=0,f=0,b=0,C=0,_=c.evaluate(e.visProp.firstarrow),E=c.evaluate(e.visProp.lastarrow);return(_||E)&&(s=c.exists(_.type)?c.evaluate(_.type):e.elementClass===v.OBJECT_CLASS_LINE?1:7,a=c.exists(E.type)?c.evaluate(E.type):e.elementClass===v.OBJECT_CLASS_LINE?1:7,_&&(u=6,c.exists(_.size)&&(u=c.evaluate(_.size)),t!==""&&c.exists(_[t+"size"])&&(u=c.evaluate(_[t+"size"])),d=o*u,s===2?(d*=.5,n+=o*u):s===3?(d=o*u/3,n+=o):s===4||s===5||s===6?(d=o*u/1.5,n+=o*u):s===7?(d=0,u=10,n+=o):n+=o*u,p+=d,b=u),E&&(u=6,c.exists(E.size)&&(u=c.evaluate(E.size)),t!==""&&c.exists(E[t+"size"])&&(u=c.evaluate(E[t+"size"])),d=o*u,a===2?(d*=.5,n+=o*u):a===3?(d=o*u/3,n+=o):a===4||a===5||a===6?(d=o*u/1.5,n+=o*u):a===7?(d=0,u=10,n+=o):n+=o*u,f+=d,C=u)),e.visPropCalc.typeFirst=s,e.visPropCalc.typeLast=a,{evFirst:_,evLast:E,typeFirst:s,typeLast:a,offFirst:p,offLast:f,sizeFirst:b,sizeLast:C,showFirst:1,showLast:1,minLen:n,strokeWidth:o}},updateLineWithEndings:function(e,o){var t,s,a;return t=new y(v.COORDS_BY_USER,e.point1.coords.usrCoords,e.board),s=new y(v.COORDS_BY_USER,e.point2.coords.usrCoords,e.board),a=c.evaluate(e.visProp.margin),l.calcStraight(e,t,s,a),this.handleTouchpoints(e,t,s,o),this.getPositionArrowHead(e,t,s,o),this.updateLinePrim(e.rendNode,t.scrCoords[1],t.scrCoords[2],s.scrCoords[1],s.scrCoords[2],e.board),this},updatePath:function(e){return c.evaluate(e.visProp.handdrawing)?this.updatePathPrim(e.rendNode,this.updatePathStringBezierPrim(e),e.board):this.updatePathPrim(e.rendNode,this.updatePathStringPrim(e),e.board),this},getPositionArrowHead:function(e,o,t,s){var a,d,u,n,p;return(s.evFirst||s.evLast)&&(d=u=n=p=0,a=o.distance(v.COORDS_BY_SCREEN,t),s.evFirst&&e.board.renderer.type!=="vml"&&(a>=s.minLen?(d=(t.scrCoords[1]-o.scrCoords[1])*s.offFirst/a,u=(t.scrCoords[2]-o.scrCoords[2])*s.offFirst/a):s.showFirst=0),s.evLast&&e.board.renderer.type!=="vml"&&(a>=s.minLen?(n=(t.scrCoords[1]-o.scrCoords[1])*s.offLast/a,p=(t.scrCoords[2]-o.scrCoords[2])*s.offLast/a):s.showLast=0),o.setCoordinates(v.COORDS_BY_SCREEN,[o.scrCoords[1]+d,o.scrCoords[2]+u],!1,!0),t.setCoordinates(v.COORDS_BY_SCREEN,[t.scrCoords[1]-n,t.scrCoords[2]-p],!1,!0)),this},handleTouchpoints:function(e,o,t,s){var a,d,u,n,p,f,b;return(s.evFirst||s.evLast)&&(u=n=p=f=b=0,a=c.evaluate(e.point1.visProp.size)+c.evaluate(e.point1.visProp.strokewidth),d=c.evaluate(e.point2.visProp.size)+c.evaluate(e.point2.visProp.strokewidth),s.evFirst&&c.evaluate(e.visProp.touchfirstpoint)&&(u=o.distance(v.COORDS_BY_SCREEN,t),n=(t.scrCoords[1]-o.scrCoords[1])*a/u,p=(t.scrCoords[2]-o.scrCoords[2])*a/u),s.evLast&&c.evaluate(e.visProp.touchlastpoint)&&(u=o.distance(v.COORDS_BY_SCREEN,t),f=(t.scrCoords[1]-o.scrCoords[1])*d/u,b=(t.scrCoords[2]-o.scrCoords[2])*d/u),o.setCoordinates(v.COORDS_BY_SCREEN,[o.scrCoords[1]+n,o.scrCoords[2]+p],!1,!0),t.setCoordinates(v.COORDS_BY_SCREEN,[t.scrCoords[1]-f,t.scrCoords[2]-b],!1,!0)),this},setArrowSize:function(e,o){return o.evFirst&&this._setArrowWidth(e.rendNodeTriangleStart,o.showFirst*o.strokeWidth,e.rendNode,o.sizeFirst),o.evLast&&this._setArrowWidth(e.rendNodeTriangleEnd,o.showLast*o.strokeWidth,e.rendNode,o.sizeLast),this},setLineCap:function(e){},drawTicks:function(e){e.rendNode=this.appendChildPrim(this.createPrim("path",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"path")},updateTicks:function(e){},drawEllipse:function(e){e.rendNode=this.appendChildPrim(this.createPrim("ellipse",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"ellipse"),this.updateEllipse(e)},updateEllipse:function(e){this._updateVisual(e);var o=e.Radius();o>0&&Math.abs(e.center.coords.usrCoords[0])>m.eps&&!isNaN(o+e.center.coords.scrCoords[1]+e.center.coords.scrCoords[2])&&o*e.board.unitX<2e6&&this.updateEllipsePrim(e.rendNode,e.center.coords.scrCoords[1],e.center.coords.scrCoords[2],o*e.board.unitX,o*e.board.unitY)},drawPolygon:function(e){e.rendNode=this.appendChildPrim(this.createPrim("polygon",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"polygon"),this.updatePolygon(e)},updatePolygon:function(e){this._updateVisual(e,{stroke:!0,dash:!0}),this.updatePolygonPrim(e.rendNode,e)},displayCopyright:function(e,o){},drawInternalText:function(e){},updateInternalText:function(e){},drawText:function(e){var o,t,s,a;c.evaluate(e.visProp.display)==="html"&&h.isBrowser&&this.type!=="no"?((o=this.container.ownerDocument.createElement("div")).style.position="absolute",o.className=c.evaluate(e.visProp.cssclass),s=c.evaluate(e.visProp.layer),c.exists(s)||(s=0),t=this.container.style.zIndex===""?0:parseInt(this.container.style.zIndex,10),o.style.zIndex=t+s,this.container.appendChild(o),o.setAttribute("id",this.container.id+"_"+e.id)):o=this.drawInternalText(e),e.rendNode=o,e.htmlStr="",e.visProp.islabel&&c.exists(e.visProp.anchor)?(a=c.evaluate(e.visProp.anchor.visProp.visible),e.prepareUpdate().updateVisibility(a)):e.prepareUpdate().updateVisibility(),this.updateText(e)},updateText:function(e){var o,t,s,a,d,u,n,p,f,b=e.plaintext;if(e.visPropCalc.visible)if(this.updateTextStyle(e,!1),c.evaluate(e.visProp.display)==="html"&&this.type!=="no"){if(isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||(t=e.coords.scrCoords[1],t=Math.abs(t)<1e6?t:1e6,o=(p=e.getAnchorX())==="right"?e.board.canvasWidth-t:p==="middle"?t-.5*e.size[0]:t,e.visPropOld.left!==p+o&&(p==="right"?(e.rendNode.style.right=o+"px",e.rendNode.style.left="auto"):(e.rendNode.style.left=o+"px",e.rendNode.style.right="auto"),e.visPropOld.left=p+o),t=e.coords.scrCoords[2]+this.vOffsetText,t=Math.abs(t)<1e6?t:1e6,o=(f=e.getAnchorY())==="bottom"?e.board.canvasHeight-t:f==="middle"?t-.5*e.size[1]:t,e.visPropOld.top!==f+o&&(f==="bottom"?(e.rendNode.style.top="auto",e.rendNode.style.bottom=o+"px"):(e.rendNode.style.bottom="auto",e.rendNode.style.top=o+"px"),e.visPropOld.top=f+o)),e.htmlStr!==b){try{e.type===c.OBJECT_TYPE_BUTTON?e.rendNodeButton.innerHTML=b:e.type===c.OBJECT_TYPE_CHECKBOX||e.type===c.OBJECT_TYPE_INPUT?e.rendNodeLabel.innerHTML=b:e.rendNode.innerHTML=b}catch{s=e.rendNode.parentNode,e.rendNode.parentNode.removeChild(e.rendNode),e.rendNode.innerHTML=b,s.appendChild(e.rendNode)}if(e.htmlStr=b,c.evaluate(e.visProp.usemathjax))try{MathJax.typeset?MathJax.typeset([e.rendNode]):MathJax.Hub.Queue(["Typeset",MathJax.Hub,e.rendNode]),n="fullscreenwrap_"+(u=e.board.container),document.getElementById(n)&&(a=e.board.containerObj._cssFullscreenStore.scale,d=e.board.containerObj._cssFullscreenStore.vshift,h.scaleJSXGraphDiv("#"+n,"#"+u,a,d))}catch{g.debug("MathJax (not yet) loaded")}else if(c.evaluate(e.visProp.usekatex))try{katex.render(b,e.rendNode,{throwOnError:!1})}catch{g.debug("KaTeX (not yet) loaded")}else if(c.evaluate(e.visProp.useasciimathml))try{AMprocessNode(e.rendNode,!1)}catch{g.debug("AsciiMathML (not yet) loaded")}}this.transformImage(e,e.transformations)}else this.updateInternalText(e)},_css2js:function(e){var o,t,s,a,d,u=[],n=c.trim(e).replace(/;$/,"").split(";");for(t=n.length,o=0;o<t;++o)c.trim(n[o])!==""&&(d=n[o].split(":"),s=c.trim(d[0].replace(/-([a-z])/gi,function(p,f){return f.toUpperCase()})),a=c.trim(d[1]),u.push({key:s,val:a}));return u},updateTextStyle:function(e,o){var t,s,a,d,u,n,p,f,b,C=e.visProp,_=h.isBrowser?C.display:"internal",E=["rendNode","rendNodeTag","rendNodeLabel"],x=E.length,S=c.evaluate(C.fontunit),O=["cssdefaultstyle","cssstyle"],w=O.length;if(o?(a=C.highlightstrokecolor,s=C.highlightstrokeopacity,d=C.highlightcssclass):(a=C.strokecolor,s=C.strokeopacity,d=C.cssclass),this.type!=="no"&&(_==="html"||this.type!=="canvas")){for(f=0;f<w;f++)if((b=c.evaluate(C[(o?"highlight":"")+O[f]]))!==""&&e.visPropOld[O[f]]!==b){for(n=this._css2js(b),u=0;u<x;u++)if(c.exists(e[E[u]]))for(p in n)n.hasOwnProperty(p)&&(e[E[u]].style[n[p].key]=n[p].val);e.visPropOld[O[f]]=b}if(t=c.evaluate(C.fontsize),e.visPropOld.fontsize!==t){e.needsSizeUpdate=!0;try{for(u=0;u<x;u++)c.exists(e[E[u]])&&(e[E[u]].style.fontSize=t+S)}catch{for(u=0;u<x;u++)c.exists(e[E[u]])&&(e[E[u]].style.fontSize=t)}e.visPropOld.fontsize=t}}return this.setObjectTransition(e),_==="html"&&this.type!=="no"?(e.visPropOld.cssclass!==d&&(e.rendNode.className=d,e.visPropOld.cssclass=d,e.needsSizeUpdate=!0),this.setObjectStrokeColor(e,a,s)):this.updateInternalTextStyle(e,a,s),this},updateInternalTextStyle:function(e,o,t){this.setObjectStrokeColor(e,o,t)},drawImage:function(e){},updateImage:function(e){this.updateRectPrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1],e.size[0],e.size[1]),this.updateImageURL(e),this.transformImage(e,e.transformations),this._updateVisual(e,{stroke:!0,dash:!0},!0)},joinTransforms:function(e,o){var t,s=e.board.origin.scrCoords[1],a=e.board.origin.scrCoords[2],d=e.board.unitX,u=e.board.unitY,n=o.length,p=[[1,0,0],[-s/d,1/d,0],[a/u,0,-1/u]];for(t=0;t<n;t++)p=m.matMatMult(o[t].matrix,p);return p=m.matMatMult([[1,0,0],[s,d,0],[a,0,-u]],p)},transformImage:function(e,o){},updateImageURL:function(e){},updateImageStyle:function(e,o){e.rendNode.className=c.evaluate(o?e.visProp.highlightcssclass:e.visProp.cssclass)},drawForeignObject:function(e){},updateForeignObject:function(e){},appendChildPrim:function(e,o){},appendNodesToElement:function(e,o){},createPrim:function(e,o){return null},remove:function(e){},makeArrows:function(e,o){},_setArrowWidth:function(e,o,t){},updateEllipsePrim:function(e,o,t,s,a){},updateLinePrim:function(e,o,t,s,a,d){},updatePathPrim:function(e,o,t){},updatePathStringPoint:function(e,o,t){},updatePathStringPrim:function(e){},updatePathStringBezierPrim:function(e){},updatePolygonPrim:function(e,o){},updateRectPrim:function(e,o,t,s,a){},setPropertyPrim:function(e,o,t){},setTabindex:function(e){var o;e.board.attr.keyboard.enabled&&c.exists(e.rendNode)&&(o=c.evaluate(e.visProp.tabindex),e.visPropCalc.visible&&!c.evaluate(e.visProp.fixed)||(o=null),o!==e.visPropOld.tabindex&&(e.rendNode.setAttribute("tabindex",o),e.visPropOld.tabindex=o))},display:function(e,o){e&&(e.visPropOld.visible=o)},show:function(e){},hide:function(e){},setBuffering:function(e,o){},setDashStyle:function(e){},setDraft:function(e){if(c.evaluate(e.visProp.draft)){var o=e.board.options.elements.draft.color,t=e.board.options.elements.draft.opacity;this.setObjectTransition(e),e.type===v.OBJECT_TYPE_POLYGON?this.setObjectFillColor(e,o,t):(e.elementClass===v.OBJECT_CLASS_POINT?this.setObjectFillColor(e,o,t):this.setObjectFillColor(e,"none",0),this.setObjectStrokeColor(e,o,t),this.setObjectStrokeWidth(e,e.board.options.elements.draft.strokeWidth))}},removeDraft:function(e){this.setObjectTransition(e),e.type===v.OBJECT_TYPE_POLYGON?this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity):(e.type===v.OBJECT_CLASS_POINT&&this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity),this.setObjectStrokeColor(e,e.visProp.strokecolor,e.visProp.strokeopacity),this.setObjectStrokeWidth(e,e.visProp.strokewidth))},setGradient:function(e){},updateGradient:function(e){},setObjectTransition:function(e,o){},setObjectFillColor:function(e,o,t){},setObjectStrokeColor:function(e,o,t){},setObjectStrokeWidth:function(e,o){},setShadow:function(e){},highlight:function(e){var o,t,s=e.visProp;if(this.setObjectTransition(e),!s.draft){if(e.type===v.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(e,s.highlightfillcolor,s.highlightfillopacity),o=0;o<e.borders.length;o++)this.setObjectStrokeColor(e.borders[o],e.borders[o].visProp.highlightstrokecolor,e.borders[o].visProp.highlightstrokeopacity);else e.elementClass===v.OBJECT_CLASS_TEXT?this.updateTextStyle(e,!0):e.type===v.OBJECT_TYPE_IMAGE?(this.updateImageStyle(e,!0),this.setObjectFillColor(e,s.highlightfillcolor,s.highlightfillopacity)):(this.setObjectStrokeColor(e,s.highlightstrokecolor,s.highlightstrokeopacity),this.setObjectFillColor(e,s.highlightfillcolor,s.highlightfillopacity));s.highlightstrokewidth&&(t=Math.max(c.evaluate(s.highlightstrokewidth),c.evaluate(s.strokewidth)),this.setObjectStrokeWidth(e,t),e.elementClass!==v.OBJECT_CLASS_LINE&&e.elementClass!==v.OBJECT_CLASS_CURVE||this.updatePathWithArrowHeads(e,!0))}return this},noHighlight:function(e){var o,t,s=e.visProp;if(this.setObjectTransition(e),!c.evaluate(e.visProp.draft)){if(e.type===v.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(e,s.fillcolor,s.fillopacity),o=0;o<e.borders.length;o++)this.setObjectStrokeColor(e.borders[o],e.borders[o].visProp.strokecolor,e.borders[o].visProp.strokeopacity);else e.elementClass===v.OBJECT_CLASS_TEXT?this.updateTextStyle(e,!1):e.type===v.OBJECT_TYPE_IMAGE?(this.updateImageStyle(e,!1),this.setObjectFillColor(e,s.fillcolor,s.fillopacity)):(this.setObjectStrokeColor(e,s.strokecolor,s.strokeopacity),this.setObjectFillColor(e,s.fillcolor,s.fillopacity));t=c.evaluate(s.strokewidth),this.setObjectStrokeWidth(e,t),e.elementClass!==v.OBJECT_CLASS_LINE&&e.elementClass!==v.OBJECT_CLASS_CURVE||this.updatePathWithArrowHeads(e,!1)}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(e,o){var t,s,a=function(u){u||(u=window.event),u.stopPropagation?u.stopPropagation():u.cancelBubble=!0},d=function(u,n){var p;p=t.createElement("span"),s.appendChild(p),p.appendChild(t.createTextNode(u)),p.style.paddingLeft="7px",p.style.paddingRight="7px",p.classList!==void 0&&p.classList.add("JXG_navigation_button"),h.addEvent(p,"click",function(f){return c.bind(n,e)(),!1},e),h.addEvent(p,"mouseup",a,e),h.addEvent(p,"mousedown",a,e),h.addEvent(p,"touchend",a,e),h.addEvent(p,"touchstart",a,e)};h.isBrowser&&this.type!=="no"&&(t=e.containerObj.ownerDocument,(s=t.createElement("div")).setAttribute("id",e.containerObj.id+"_navigationbar"),s.style.color=o.strokecolor,s.style.backgroundColor=o.fillcolor,s.style.padding=o.padding,s.style.position=o.position,s.style.fontSize=o.fontsize,s.style.cursor=o.cursor,s.style.zIndex=o.zindex,e.containerObj.appendChild(s),s.style.right=o.right,s.style.bottom=o.bottom,s.classList!==void 0&&s.classList.add("JXG_navigation"),e.attr.showfullscreen&&d(e.attr.fullscreen.symbol,function(){e.toFullscreen(e.attr.fullscreen.id)}),e.attr.showscreenshot&&d(e.attr.screenshot.symbol,function(){window.setTimeout(function(){e.renderer.screenshot(e,"",!1)},330)}),e.attr.showreload&&d("\u21BB",function(){e.reload()}),e.attr.showcleartraces&&d("\u2297",function(){e.clearTraces()}),e.attr.shownavigation&&(e.attr.showzoom&&(d("\u2013",e.zoomOut),d("o",e.zoom100),d("+",e.zoomIn)),d("\u2190",e.clickLeftArrow),d("\u2193",e.clickUpArrow),d("\u2191",e.clickDownArrow),d("\u2192",e.clickRightArrow)))},getElementById:function(e){return c.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+e):""},removeToInsertLater:function(e){var o=e.parentNode,t=e.nextSibling;if(o!==null)return o.removeChild(e),function(){t?o.insertBefore(e,t):o.appendChild(e)}},resize:function(e,o){},createTouchpoints:function(e){},showTouchpoint:function(e){},hideTouchpoint:function(e){},updateTouchpoint:function(e,o){},dumpToDataURI:function(e){},dumpToCanvas:function(e,o,t,s){},screenshot:function(e){},setLayer:function(e,o){}}),g.AbstractRenderer}),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],function(g,P,y,v,m){return g.FileReader={handleRemoteFile:function(l,c,h,e,o,t){var s=!1;try{s=new XMLHttpRequest,h.toLowerCase()==="raw"?s.overrideMimeType("text/plain; charset="+o):s.overrideMimeType("text/xml; charset="+o)}catch{try{s=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{s=new ActiveXObject("Microsoft.XMLHTTP")}catch{s=!1}}}if(s){s.open("GET",l,e),h.toLowerCase()==="raw"?this.cbp=function(){var a=s;a.readyState===4&&c(a.responseText)}:this.cbp=function(){var a=s,d="";a.readyState===4&&(d=!y.exists(a.responseStream)||a.responseText.slice(0,2)!=="PK"&&v.asciiCharCodeAt(a.responseText.slice(0,1),0)!==31?a.responseText:m.decode(jxgBinFileReader(a)),this.parseString(d,c,h,t))},this.cb=y.bind(this.cbp,this),s.onreadystatechange=this.cb;try{s.send(null)}catch{throw new Error("JSXGraph: A problem occurred while trying to read remote file '"+l+"'.")}}else g.debug("AJAX not activated!")},handleLocalFile:function(l,c,h,e,o,t){y.exists(e)||(e=!0),h.toLowerCase()==="raw"?this.cbp=function(a){c(a.target.result)}:this.cbp=function(a){var d=a.target.result;this.parseString(d,c,h,t)},this.cb=y.bind(this.cbp,this);var s=new FileReader;s.onload=this.cb,h.toLowerCase()==="raw"?s.readAsText(l):s.readAsText(l,o)},parseFileContent:function(l,c,h,e,o,t){y.isString(l)||FileReader===void 0?this.handleRemoteFile(l,c,h,e,o,t):this.handleLocalFile(l,c,h,e,o,t)},parseString:function(l,c,h,e){var o;if(h=h.toLowerCase(),o=g.readers[h],y.exists(o))new o(c,l).read();else if(h!=="jessiecode")throw new Error("JSXGraph: There is no reader available for '"+h+"'.");y.isFunction(e)&&e(c)}},!P.isMetroApp()&&P.isBrowser&&typeof navigator=="object"&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write(`<script type="text/vbscript">
Function Base64Encode(inData)
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim cOut, sOut, I
  For I = 1 To LenB(inData) Step 3
    Dim nGroup, pOut, sGroup
    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _
      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))
    nGroup = Oct(nGroup)
    nGroup = String(8 - Len(nGroup), "0") & nGroup
    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)
    sOut = sOut + pOut
  Next
  Select Case LenB(inData) Mod 3
    Case 1: '8 bit final
      sOut = Left(sOut, Len(sOut) - 2) + "=="
    Case 2: '16 bit final
      sOut = Left(sOut, Len(sOut) - 1) + "="
  End Select
  Base64Encode = sOut
End Function

Function MyASC(OneChar)
  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)
End Function

Function jxgBinFileReader(xhr)
    Dim byteString
    Dim b64String
    Dim i
    byteString = xhr.responseBody
    ReDim byteArray(LenB(byteString))
    For i = 1 To LenB(byteString)
        byteArray(i-1) = AscB(MidB(byteString, i, 1))
    Next
    b64String = Base64Encode(byteString)
    jxgBinFileReader = b64String
End Function
<\/script>
`),g.FileReader}),define("parser/geonext",["jxg","base/constants","utils/type"],function(g,P,y){return g.GeonextParser={replacePow:function(v){var m,l,c,h,e,o,t,s,a,d,u,n;for(d=(v=v.replace(/(\s*)\^(\s*)/g,"^")).indexOf("^"),h=-1;d>=0&&d<v.length-1;){if(h===d)throw new Error("JSXGraph: Error while parsing expression '"+v+"'");if(h=d,a=v.slice(0,d),u=v.slice(d+1),a.charAt(a.length-1)===")"){for(m=1,l=a.length-2;l>=0&&m>0;)(c=a.charAt(l))===")"?m++:c==="("&&(m-=1),l-=1;if(m!==0)throw new Error("JSXGraph: Missing '(' in expression");for(e="",t=a.substring(0,l+1),s=l;s>=0&&t.substr(s,1).match(/([\w.]+)/);)e=RegExp.$1+e,s-=1;e=(e+=a.substring(l+1,a.length)).replace(/([()+*%^\-/\][])/g,"\\$1")}else e="[\\w\\.]+";if(u.match(/^([\w.]*\()/)){for(m=1,l=RegExp.$1.length;l<u.length&&m>0;)(c=u.charAt(l))===")"?m-=1:c==="("&&(m+=1),l+=1;if(m!==0)throw new Error("JSXGraph: Missing ')' in expression");o=(o=u.substring(0,l)).replace(/([()+*%^\-/[\]])/g,"\\$1")}else o="[\\w\\.]+";n=new RegExp("("+e+")\\^("+o+")"),d=(v=v.replace(n,"pow($1,$2)")).indexOf("^")}return v},replaceIf:function(v){var m,l,c,h,e,o,t,s,a,d="",u=null,n=null,p=null;if((c=v.indexOf("If("))<0)return v;for(v=v.replace(/""/g,"0");c>=0;){for(m=v.slice(0,c),l=v.slice(c+3),e=1,h=0,o=-1,t=-1;h<l.length&&e>0;)(s=l.charAt(h))===")"?e-=1:s==="("?e+=1:s===","&&e===1&&(o<0?o=h:t=h),h+=1;if(a=l.slice(0,h-1),l=l.slice(h),o<0||t<0)return"";u=a.slice(0,o),n=a.slice(o+1,t),p=a.slice(t+1),d+=m+"(("+(u=this.replaceIf(u))+")?("+(n=this.replaceIf(n))+"):("+(p=this.replaceIf(p))+"))",u=null,n=null,c=(v=l).indexOf("If(")}return d+=l},replaceNameById:function(v,m,l){var c,h,e,o,t=0,s=["X","Y","L","V"],a=function(d){return l?"$('"+d+"')":d};for(o=0;o<s.length;o++)for(t=v.indexOf(s[o]+"(");t>=0;)t>=0&&(c=v.indexOf(")",t+2))>=0&&(h=(h=v.slice(t+2,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[h])&&(v=v.slice(0,t+2)+(l?"$('":"")+a(e.id)+v.slice(c))),c=v.indexOf(")",t+2),t=v.indexOf(s[o]+"(",c);for(t=v.indexOf("Dist(");t>=0;)t>=0&&(c=v.indexOf(",",t+5))>=0&&(h=(h=v.slice(t+5,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[h])&&(v=v.slice(0,t+5)+a(e.id)+v.slice(c))),c=v.indexOf(",",t+5),t=v.indexOf(",",c),(c=v.indexOf(")",t+1))>=0&&(h=(h=v.slice(t+1,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[h])&&(v=v.slice(0,t+1)+a(e.id)+v.slice(c))),c=v.indexOf(")",t+1),t=v.indexOf("Dist(",c);for(s=["Deg","Rad"],o=0;o<s.length;o++)for(t=v.indexOf(s[o]+"(");t>=0;)t>=0&&(c=v.indexOf(",",t+4))>=0&&(h=(h=v.slice(t+4,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[h])&&(v=v.slice(0,t+4)+a(e.id)+v.slice(c))),c=v.indexOf(",",t+4),t=v.indexOf(",",c),(c=v.indexOf(",",t+1))>=0&&(h=(h=v.slice(t+1,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[h])&&(v=v.slice(0,t+1)+a(e.id)+v.slice(c))),c=v.indexOf(",",t+1),t=v.indexOf(",",c),(c=v.indexOf(")",t+1))>=0&&(h=(h=v.slice(t+1,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[h])&&(v=v.slice(0,t+1)+a(e.id)+v.slice(c))),c=v.indexOf(")",t+1),t=v.indexOf(s[o]+"(",c);return v},replaceIdByObj:function(v){var m=/(X|Y|L)\(([\w_]+)\)/g;return v=v.replace(m,"$('$2').$1()"),m=/(V)\(([\w_]+)\)/g,v=v.replace(m,"$('$2').Value()"),m=/(Dist)\(([\w_]+),([\w_]+)\)/g,v=v.replace(m,"dist($('$2'), $('$3'))"),m=/(Deg)\(([\w_]+),([ \w[\w_]+),([\w_]+)\)/g,v=v.replace(m,"deg($('$2'),$('$3'),$('$4'))"),m=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,v=v.replace(m,"rad($('$1'),$('$2'),$('$3'))"),m=/N\((.+)\)/g,v=v.replace(m,"($1)")},geonext2JS:function(v,m){var l,c,h,e=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],o=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(c=v=(v=(v=v.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),c=this.replaceNameById(c,m),c=this.replaceIf(c),c=this.replacePow(c),c=this.replaceIdByObj(c),h=0;h<e.length;h++)l=new RegExp(["(\\W|^)(",e[h],")"].join(""),"ig"),c=c.replace(l,["$1",o[h]].join(""));return c=(c=(c=(c=(c=c.replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")).replace(/Pi/g,"PI")).replace(/"/g,"'")},findDependencies:function(v,m,l){var c,h,e,o;for(h in y.exists(l)||(l=v.board),c=l.elementsByName)c.hasOwnProperty(h)&&h!==v.name&&(c[h].elementClass===P.OBJECT_CLASS_TEXT&&y.evaluate(c[h].visProp.islabel)||(o=(o=h.replace(/\[/g,"\\[")).replace(/\]/g,"\\]"),e=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+o+")(,[\\w\\[\\]'_ ]+)*\\)","g"),m.search(e)>=0&&c[h].addChild(v)))},gxt2jc:function(v,m){var l;return l=v=(v=(v=v.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),l=(l=(l=(l=this.replaceNameById(l,m,!0)).replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")}},g.GeonextParser}),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","utils/event","utils/color","utils/type"],function(g,P,y,v,m,l,c,h,e){return g.GeometryElement=function(o,t,s,a){var d,u,n;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},c.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){for(u in this.board=o,this.type=s,this._org_type=s,this.elementClass=a||P.OBJECT_CLASS_OTHER,this.id=t.id,d=t.name,e.exists(d)||(d=this.board.generateName(this)),d!==""&&(this.board.elementsByName[d]=this),this.name=d,this.needsRegularUpdate=t.needsregularupdate,e.clearVisPropOld(this),n=this.resolveShortcuts(t))n.hasOwnProperty(u)&&this._set(u,n[u]);this.visProp.draft=n.draft&&n.draft.draft}},g.extend(g.GeometryElement.prototype,{addChild:function(o){var t,s;for(t in this.childElements[o.id]=o,this.addDescendants(o),o.ancestors[this.id]=this,this.descendants)if(this.descendants.hasOwnProperty(t))for(s in this.descendants[t].ancestors[this.id]=this,this.ancestors)this.ancestors.hasOwnProperty(s)&&(this.descendants[t].ancestors[this.ancestors[s].id]=this.ancestors[s]);for(t in this.ancestors)if(this.ancestors.hasOwnProperty(t))for(s in this.descendants)this.descendants.hasOwnProperty(s)&&(this.ancestors[t].descendants[this.descendants[s].id]=this.descendants[s]);return this},addDescendants:function(o){var t;for(t in this.descendants[o.id]=o,o.childElements)o.childElements.hasOwnProperty(t)&&this.addDescendants(o.childElements[t]);return this},addParents:function(o){var t,s,a;for(s=(a=e.isArray(o)?o:arguments).length,t=0;t<s;++t)e.exists(a[t])&&(e.isId(this.board,a[t])?this.parents.push(a[t]):e.exists(a[t].id)&&this.parents.push(a[t].id));this.parents=e.uniqueArray(this.parents)},setParents:function(o){this.parents=[],this.addParents(o)},removeChild:function(o){return delete this.childElements[o.id],this.removeDescendants(o),delete o.ancestors[this.id],this},removeDescendants:function(o){var t;for(t in delete this.descendants[o.id],o.childElements)o.childElements.hasOwnProperty(t)&&this.removeDescendants(o.childElements[t]);return this},countChildren:function(){var o,t,s=0;for(o in t=this.childElements)t.hasOwnProperty(o)&&o.indexOf("Label")<0&&s++;return s},getName:function(){return this.name},addTransform:function(o){return this},draggable:function(){return this.isDraggable&&!e.evaluate(this.visProp.fixed)&&this.type!==P.OBJECT_TYPE_GLIDER},setPosition:function(o,t){var s,a,d,u,n=[];if(!e.exists(this.parents))return this;for(d=this.parents.length,a=0;a<d;++a)if(s=this.board.select(this.parents[a]),e.isPoint(s)){if(!s.draggable())return this;n.push(s)}for(t.length===3&&(t=t.slice(1)),u=this.board.create("transform",t,{type:"translate"}),(d=n.length)>0?u.applyOnce(n):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(u):this.addTransform(u),a=0;a<d;++a)n[a].type===P.OBJECT_TYPE_GLIDER&&n[a].updateGlider();return this},setPositionDirectly:function(o,t,s){var a=new y(o,t,this.board,!1),d=new y(o,s,this.board,!1),u=m.subtract(a.usrCoords,d.usrCoords);return this.setPosition(P.COORDS_BY_USER,u),this},generatePolynomial:function(){return[]},animate:function(o,t,s){s=s||{};var a,d,u,n=this.board.attr.animationdelay,p=Math.ceil(t/n),f=this,b=function(_,E,x){var S,O,w,T,M;for(S=h.rgb2hsv(_),w=((O=h.rgb2hsv(E))[0]-S[0])/p,T=(O[1]-S[1])/p,M=(O[2]-S[2])/p,f.animationData[x]=[],u=0;u<p;u++)f.animationData[x][p-u-1]=h.hsv2rgb(S[0]+(u+1)*w,S[1]+(u+1)*T,S[2]+(u+1)*M)},C=function(_,E,x,S){var O,w;if(_=parseFloat(_),E=parseFloat(E),!isNaN(_)&&!isNaN(E))for(w=(E-_)/p,f.animationData[x]=[],u=0;u<p;u++)O=_+(u+1)*w,f.animationData[x][p-u-1]=S?Math.floor(O):O};for(a in this.animationData={},o)if(o.hasOwnProperty(a))switch(d=a.toLowerCase()){case"strokecolor":case"fillcolor":b(this.visProp[d],o[a],d);break;case"size":if(!e.isPoint(this))break;C(this.visProp[d],o[a],d,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":C(this.visProp[d],o[a],d,!1)}return this.animationCallback=s.callback,this.board.addAnimation(this),this},update:function(){return e.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(o){return this.prepareUpdate().update().updateVisibility(o).updateRenderer()},setDisplayRendNode:function(o){var t,s,a,d,u;if(o===void 0&&(o=this.visPropCalc.visible),o===this.visPropOld.visible)return this;for(this.board.renderer.display(this,o),s=this.inherits.length,a=0;a<s;a++)if(u=this.inherits[a],e.isArray(u))for(d=u.length,t=0;t<d;t++)e.exists(u[t])&&e.exists(u[t].rendNode)&&e.evaluate(u[t].visProp.visible)==="inherit"&&u[t].setDisplayRendNode(o);else e.exists(u)&&e.exists(u.rendNode)&&e.evaluate(u.visProp.visible)==="inherit"&&u.setDisplayRendNode(o);return this.hasLabel&&e.exists(this.label)&&e.exists(this.label.rendNode)&&e.evaluate(this.label.visProp.visible)==="inherit"&&this.label.setDisplayRendNode(o),this},hide:function(){return this.setAttribute({visible:!1}),this},hideElement:function(){return this.hide(),this},show:function(){return this.setAttribute({visible:!0}),this},showElement:function(){return this.show(),this},updateVisibility:function(o){var t,s,a,d,u,n;if(this.needsUpdate){for(o!==void 0?this.visPropCalc.visible=o:(n=e.evaluate(this.visProp.visible),e.exists(this.hiddenByParent)&&this.hiddenByParent&&(n=!1),n!=="inherit"&&(this.visPropCalc.visible=n)),s=this.inherits.length,a=0;a<s;a++)if(u=this.inherits[a],e.isArray(u))for(d=u.length,t=0;t<d;t++)e.exists(u[t])&&e.evaluate(u[t].visProp.visible)==="inherit"&&u[t].prepareUpdate().updateVisibility(this.visPropCalc.visible);else e.exists(u)&&e.evaluate(u.visProp.visible)==="inherit"&&u.prepareUpdate().updateVisibility(this.visPropCalc.visible);e.exists(this.label)&&e.exists(this.label.visProp)&&e.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(o,t){var s;if(o=o.toLocaleLowerCase(),this.visProp.hasOwnProperty(o)&&o.indexOf("color")>=0&&e.isString(t)&&t.length===9&&t.charAt(0)==="#")t=h.rgba2rgbo(t),this.visProp[o]=t[0],this.visProp[o.replace("color","opacity")]=t[1];else if(t===null||!e.isObject(t)||e.exists(t.id)||e.exists(t.name))this.visProp[o]=t;else for(s in this.visProp[o]={},t)t.hasOwnProperty(s)&&(this.visProp[o][s.toLocaleLowerCase()]=t[s])},resolveShortcuts:function(o){var t,s,a,d=["traceattributes","traceAttributes"];for(t in l.shortcuts)if(l.shortcuts.hasOwnProperty(t)){if(e.exists(o[t]))for(s=0;s<l.shortcuts[t].length;s++)e.exists(o[l.shortcuts[t][s]])||(o[l.shortcuts[t][s]]=o[t]);for(a=0;a<d.length;a++)e.isObject(o[d[a]])&&(o[d[a]]=this.resolveShortcuts(o[d[a]]))}return o},setLabel:function(o){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(o)},setLabelText:function(o){return e.exists(this.label)&&(o=o.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(o)),this},setName:function(o){o=o.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.elType!=="slider"&&this.setLabelText(o),this.setAttribute({name:o})},setProperty:function(){g.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(o){var t,s,a,d,u,n,p,f,b,C={};for(t=0;t<arguments.length;t++)n=arguments[t],e.isString(n)?(f=n.split(":"),C[e.trim(f[0])]=e.trim(f[1])):e.isArray(n)?C[n[0]]=n[1]:g.extend(C,n);for(t in C=this.resolveShortcuts(C))if(C.hasOwnProperty(t)){if(d=t.replace(/\s+/g,"").toLowerCase(),u=C[t],e.isObject(u)&&e.exists(this.visProp[d])){if(this.visProp[d]=e.merge(this.visProp[d],u),this.type===P.OBJECT_TYPE_TICKS&&e.exists(this.labels))for(a=this.labels.length,s=0;s<a;s++)this.labels[s].setAttribute(u);else if(e.exists(this[d]))if(e.isArray(this[d]))for(s=0;s<this[d].length;s++)this[d][s].setAttribute(u);else this[d].setAttribute(u);continue}switch(b=this.visProp[d],d){case"name":b=this.name,delete this.board.elementsByName[this.name],this.name=u,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!(u==="false"||u===!1),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":p=(u=h.rgba2rgbo(u))[1],u=u[0],p===0&&e.exists(this.label)&&this.hasLabel&&this.label.hideElement(),e.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=u,this.board.renderer.setObjectStrokeColor(this.label,u,p)),this.elementClass===P.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=u,this.visProp.strokeopacity=p,this.board.renderer.setObjectStrokeColor(this,u,p));break;case"infoboxtext":e.isString(u)?this.infoboxText=u:this.infoboxText=!1;break;case"visible":this.visProp.visible=u!=="false"&&(u==="true"||u),this.setDisplayRendNode(e.evaluate(this.visProp.visible)),e.evaluate(this.visProp.visible)&&e.exists(this.updateSize)&&this.updateSize();break;case"face":e.isPoint(this)&&(this.visProp.face=u,this.board.renderer.changePointStyle(this));break;case"trace":u==="false"||u===!1?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=u!=="pause";break;case"gradient":this.visProp.gradient=u,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":u=h.rgba2rgbo(u),this.visProp.gradientsecondcolor=u[0],this.visProp.gradientsecondopacity=u[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=u,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=u,e.evaluate(u)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=u;break;case"radius":this.type!==P.OBJECT_TYPE_ANGLE&&this.type!==P.OBJECT_TYPE_SECTOR||this.setRadius(u);break;case"rotate":(this.elementClass===P.OBJECT_CLASS_TEXT&&e.evaluate(this.visProp.display)==="internal"||this.type===P.OBJECT_TYPE_IMAGE)&&this.addRotation(u);break;case"ticksdistance":this.type===P.OBJECT_TYPE_TICKS&&e.isNumber(u)&&(this.ticksFunction=this.makeTicksFunction(u));break;case"generatelabelvalue":this.type===P.OBJECT_TYPE_TICKS&&e.isFunction(u)&&(this.generateLabelValue=u);break;case"onpolygon":this.type===P.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!u);break;case"disabled":e.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!u);break;case"checked":e.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!u);break;case"maxlength":e.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!u);break;case"layer":this.board.renderer.setLayer(this,e.evaluate(u)),this._set(d,u);break;case"tabindex":e.exists(this.rendNode)&&(this.rendNode.setAttribute("tabindex",u),this._set(d,u));break;default:e.exists(this.visProp[d])&&(!g.Validator[d]||g.Validator[d]&&g.Validator[d](u)||g.Validator[d]&&e.isFunction(u)&&g.Validator[d](u()))&&(u=(!u.toLowerCase||u.toLowerCase()!=="false")&&u,this._set(d,u))}this.triggerEventHandlers(["attribute:"+d],[b,u,this])}return this.triggerEventHandlers(["attribute"],[C,this]),e.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){g.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(o){var t;switch(o=o.toLowerCase()){case"needsregularupdate":t=this.needsRegularUpdate;break;case"labelcolor":t=this.label.visProp.strokecolor;break;case"infoboxtext":t=this.infoboxText;break;case"withlabel":t=this.hasLabel;break;default:t=this.visProp[o]}return t},setDash:function(o){return this.setAttribute({dash:o}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new y(P.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new y(P.COORDS_BY_USER,[0,0],this.board)},setArrow:function(o,t){return this.visProp.firstarrow=o,this.visProp.lastarrow=t,t&&(this.type=P.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var o=e.evaluate(this.visProp.gradient);o!=="linear"&&o!=="radial"||this.board.renderer.setGradient(this)},createLabel:function(){var o,t=this;return g.elements.text?((o=e.deepCopy(this.visProp.label,null)).id=this.id+"Label",o.isLabel=!0,o.anchor=this,o.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=g.elements.text(this.board,[0,0,function(){return e.isFunction(t.name)?t.name():t.name}],o),this.label.needsUpdate=!0,this.label.dump=!1,this.label.fullUpdate(),this.hasLabel=!0)):g.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(o){return o=e.def(o,!1),!e.evaluate(this.visProp.highlight)||this.highlighted&&!o||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var o;for(o in this.traces)this.traces.hasOwnProperty(o)&&this.board.renderer.remove(this.traces[o]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=v.normalize(this.stdform),this},toJSON:function(){var o,t,s=['{"name":',this.name];for(t in s.push(', "id":'+this.id),o=[],this.visProp)this.visProp.hasOwnProperty(t)&&e.exists(this.visProp[t])&&o.push('"'+t+'":'+this.visProp[t]);return s.push(', "visProp":{'+o.toString()+"}"),s.push("}"),s.join("")},addRotation:function(o){var t,s,a,d,u,n=this;return(this.elementClass===P.OBJECT_CLASS_TEXT&&e.evaluate(this.visProp.display)==="internal"||this.type===P.OBJECT_TYPE_IMAGE)&&o!==0&&(t=this.board.create("transform",[function(){return-n.X()},function(){return-n.Y()}],{type:"translate"}),s=this.board.create("transform",[function(){return n.X()},function(){return n.Y()}],{type:"translate"}),a=this.board.create("transform",[function(){return n.board.unitX/n.board.unitY},function(){return 1}],{type:"scale"}),d=this.board.create("transform",[function(){return n.board.unitY/n.board.unitX},function(){return 1}],{type:"scale"}),u=this.board.create("transform",[function(){return e.evaluate(o)*Math.PI/180}],{type:"rotate"}),t.bindTo(this),a.bindTo(this),u.bindTo(this),d.bindTo(this),s.bindTo(this)),this},highlightStrokeColor:function(o){return g.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:o}),this},strokeColor:function(o){return g.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:o}),this},strokeWidth:function(o){return g.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:o}),this},fillColor:function(o){return g.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:o}),this},highlightFillColor:function(o){return g.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:o}),this},labelColor:function(o){return g.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:o}),this},dash:function(o){return g.deprecated("dash()","setAttribute()"),this.setAttribute({dash:o}),this},visible:function(o){return g.deprecated("visible()","setAttribute()"),this.setAttribute({visible:o}),this},shadow:function(o){return g.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:o}),this},getType:function(){return this.elType},getParents:function(){return e.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var o,t=e.deepCopy(this.visProp),s=[],a=s.length;for(t.id=this.id,t.name=this.name,o=0;o<a;o++)delete t[s[o]];return t},hasPoint:function(o,t){return!1},addTicks:function(o){return o.id!==""&&e.exists(o.id)||(o.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(o),this.ticks.push(o),o.id},removeAllTicks:function(){var o;if(e.exists(this.ticks)){for(o=this.ticks.length-1;o>=0;o--)this.removeTicks(this.ticks[o]);this.ticks=[],this.board.update()}},removeTicks:function(o){var t,s;if(e.exists(this.defaultTicks)&&this.defaultTicks===o&&(this.defaultTicks=null),e.exists(this.ticks)){for(t=this.ticks.length-1;t>=0;t--)if(this.ticks[t]===o){if(this.board.removeObject(this.ticks[t]),this.ticks[t].ticks)for(s=0;s<this.ticks[t].ticks.length;s++)e.exists(this.ticks[t].labels[s])&&this.board.removeObject(this.ticks[t].labels[s]);delete this.ticks[t];break}}},getSnapSizes:function(){var o,t,s;return o=e.evaluate(this.visProp.snapsizex),t=e.evaluate(this.visProp.snapsizey),o<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(o=(s=this.board.defaultAxes.x.defaultTicks).ticksDelta*(e.evaluate(s.visProp.minorticks)+1)),t<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(t=(s=this.board.defaultAxes.y.defaultTicks).ticksDelta*(e.evaluate(s.visProp.minorticks)+1)),[o,t]},handleSnapToGrid:function(o,t){var s,a,d,u,n,p,f,b,C,_=e.evaluate(this.visProp.attracttogrid),E=e.evaluate(this.visProp.attractorunit),x=e.evaluate(this.visProp.attractordistance);return!e.exists(this.coords)||e.evaluate(this.visProp.fixed)||(e.evaluate(this.visProp.snaptogrid)||_||o===!0)&&(s=this.coords.usrCoords[1],a=this.coords.usrCoords[2],b=(f=this.getSnapSizes())[0],C=f[1],b>0&&C>0&&(p=this.board.getBoundingBox(),d=Math.round(s/b)*b,u=Math.round(a/C)*C,n=new g.Coords(P.COORDS_BY_USER,[d,u],this.board),(!_||n.distance(E==="screen"?P.COORDS_BY_SCREEN:P.COORDS_BY_USER,this.coords)<x)&&(s=d,a=u,t||(s<p[0]?s+=b:s>p[2]&&(s-=b),a<p[3]?a+=C:a>p[1]&&(a-=C)),this.coords.setCoordinates(P.COORDS_BY_USER,[s,a])))),this},getBoundingBox:function(){var o,t,s,a,d,u=[1/0,1/0,-1/0,-1/0];if(this.type===P.OBJECT_TYPE_POLYGON){if((t=this.vertices.length-1)<=0)return u;for(o=0;o<t;o++)s=this.vertices[o].X(),u[0]=s<u[0]?s:u[0],u[2]=s>u[2]?s:u[2],s=this.vertices[o].Y(),u[1]=s<u[1]?s:u[1],u[3]=s>u[3]?s:u[3]}else if(this.elementClass===P.OBJECT_CLASS_CIRCLE)a=this.center.X(),d=this.center.Y(),u=[a-this.radius,d+this.radius,a+this.radius,d-this.radius];else if(this.elementClass===P.OBJECT_CLASS_CURVE){if((t=this.vertices.length)===0)return u;for(o=0;o<t;o++)s=this.points[o].coords.usrCoords[1],u[0]=s<u[0]?s:u[0],u[2]=s>u[2]?s:u[2],s=this.points[o].coords.usrCoords[1],u[1]=s<u[1]?s:u[1],u[3]=s>u[3]?s:u[3]}return u},addEvent:g.shortcut(g.GeometryElement.prototype,"on"),removeEvent:g.shortcut(g.GeometryElement.prototype,"off"),__evt__over:function(o){},__evt__mouseover:function(o){},__evt__out:function(o){},__evt__mouseout:function(o){},__evt__move:function(o){},__evt__mousemove:function(o){},__evt__drag:function(o){},__evt__mousedrag:function(o){},__evt__pendrag:function(o){},__evt__touchdrag:function(o){},__evt__down:function(o){},__evt__mousedown:function(o){},__evt__pendown:function(o){},__evt__touchdown:function(o){},__evt__up:function(o){},__evt__mouseup:function(o){},__evt__penup:function(o){},__evt__touchup:function(o){},__evt__attribute:function(o,t){},__evt__attribute_:function(o,t,s){},__evt:function(){}}),g.GeometryElement}),define("base/coordselement",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","utils/type"],function(g,P,y,v,m,l,c,h){return g.CoordsElement=function(e,o){var t;for(h.exists(e)||(e=[1,0,0]),t=0;t<e.length;++t)e[t]=parseFloat(e[t]);this.coords=new l(c.COORDS_BY_USER,e,this.board),this.initialCoords=new l(c.COORDS_BY_USER,e,this.board),this.position=null,this.isConstrained=!1,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=h.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),h.exists(this.element)&&this.addAnchor(e,o),this.isDraggable=!0},g.extend(g.CoordsElement.prototype,{updateConstraint:function(){return this},updateCoords:function(e){return this.needsUpdate?(h.exists(e)||(e=!1),h.evaluate(this.visProp.frozen)||this.updateConstraint(),this.type===c.OBJECT_TYPE_GLIDER&&(this.isConstrained&&(e=!1),e?this.updateGliderFromParent():this.updateGlider()),this.updateTransform(e),this):this},updateGlider:function(){var e,o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M=2*Math.PI,N=!1,A=this.slideObject,R=[];if(this.needsUpdateFromParent=!1,A.elementClass===c.OBJECT_CLASS_CIRCLE)h.evaluate(this.visProp.isgeonext)&&(M=1),E=y.projectPointToCircle(this,A,this.board),x=y.rad([A.center.X()+1,A.center.Y()],A.center,this)/M;else if(A.elementClass===c.OBJECT_CLASS_LINE){if(this.onPolygon){if(o=A.point1.coords.usrCoords,s=(t=A.point2.coords.usrCoords)[e=1]-o[e],Math.abs(s)<P.eps&&(s=t[e=2]-o[e]),u=(y.projectPointToLine(this,A,this.board).usrCoords[e]-o[e])/s,d=A.parentPolygon,u<0){for(e=0;e<d.borders.length;e++)if(A===d.borders[e]){A=d.borders[(e-1+d.borders.length)%d.borders.length];break}}else if(u>1){for(e=0;e<d.borders.length;e++)if(A===d.borders[e]){A=d.borders[(e+1+d.borders.length)%d.borders.length];break}}A.id!==this.slideObject.id&&(this.slideObject=A)}o=A.point1.coords,t=A.point2.coords,(s=o.distance(c.COORDS_BY_USER,t))<P.eps?(E=o,N=!0,x=0):(E=y.projectPointToLine(this,A,this.board),o=o.usrCoords.slice(0),t=t.usrCoords.slice(0),Math.abs(t[0])<P.eps?(s=t[e=1],Math.abs(s)<P.eps&&(s=t[e=2]),x=((s=(E.usrCoords[e]-o[e])/s)>=0?1:-1)*(s=Math.abs(s))/(s+1)):Math.abs(o[0])<P.eps?(s=o[e=1],Math.abs(s)<P.eps&&(s=o[e=2]),x=(s=(E.usrCoords[e]-t[e])/s)<0?(1-2*s)/(1-s):1/(s+1)):(s=t[e=1]-o[e],Math.abs(s)<P.eps&&(s=t[e=2]-o[e]),x=(E.usrCoords[e]-o[e])/s)),S=h.evaluate(this.visProp.snapwidth),h.evaluate(S)>0&&Math.abs(this._smax-this._smin)>=P.eps&&(a=(x=Math.max(Math.min(x,1),0))*(this._smax-this._smin)+this._smin,x=((a=Math.round(a/S)*S)-this._smin)/(this._smax-this._smin),this.update(!0)),o=A.point1.coords,!h.evaluate(A.visProp.straightfirst)&&Math.abs(o.usrCoords[0])>P.eps&&x<0&&(E=o,N=!0,x=0),t=A.point2.coords,!h.evaluate(A.visProp.straightlast)&&Math.abs(t.usrCoords[0])>P.eps&&x>1&&(E=t,N=!0,x=1)}else if(A.type===c.OBJECT_TYPE_TURTLE)this.updateConstraint(),E=(O=y.projectPointToTurtle(this,A,this.board))[0],x=O[1];else if(A.elementClass===c.OBJECT_CLASS_CURVE)if(A.type===c.OBJECT_TYPE_ARC||A.type===c.OBJECT_TYPE_SECTOR)E=y.projectPointToCircle(this,A,this.board),f=y.rad(A.radiuspoint,A.center,this),n=0,p=y.rad(A.radiuspoint,A.center,A.anglepoint),x=f,((S=h.evaluate(A.visProp.selection))==="minor"&&p>Math.PI||S==="major"&&p<Math.PI)&&(n=p,p=2*Math.PI),(f<n||f>p)&&(x=p,(f<n&&f>.5*n||f>p&&f>.5*p+Math.PI)&&(x=n),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),M=p-n,this.visProp.isgeonext&&(M=1),Math.abs(M)>P.eps&&(x/=M);else if(this.updateConstraint(),A.transformations.length>0){for(T=!1,(O=A.getTransformationSource())[0]&&(T=O[0],R.push(A),R.push(O[1]));O[0]&&h.exists(O[1]._transformationSource);)O=O[1].getTransformationSource(),R.push(O[1]);if(w=this.coords.usrCoords,T){for(e=0;e<R.length;e++)R[e].updateTransformMatrix(),_=P.inverse(R[e].transformMat),w=P.matVecMult(_,w);for(b=new l(c.COORDS_BY_USER,w,this.board).usrCoords,w=(C=y.projectCoordsToCurve(b[1],b[2],this.position||0,R[R.length-1],this.board))[0].usrCoords,e=R.length-2;e>=0;e--)w=P.matVecMult(R[e].transformMat,w);C[0]=new l(c.COORDS_BY_USER,w,this.board)}else A.updateTransformMatrix(),_=P.inverse(A.transformMat),w=P.matVecMult(_,w),b=new l(c.COORDS_BY_USER,w,this.board).usrCoords,C=y.projectCoordsToCurve(b[1],b[2],this.position||0,A,this.board);E=C[0],x=C[1]}else E=(O=y.projectPointToCurve(this,A,this.board))[0],x=O[1];else h.isPoint(A)&&(E=y.projectPointToPoint(this,A,this.board),x=this.position);this.coords.setCoordinates(c.COORDS_BY_USER,E.usrCoords,N),this.position=x},updateGliderFromParent:function(){var e,o,t,s,a,d,u,n,p,f,b,C,_=this.slideObject,E=[],x=2*Math.PI;if(this.needsUpdateFromParent){if(_.elementClass===c.OBJECT_CLASS_CIRCLE)t=_.Radius(),h.evaluate(this.visProp.isgeonext)&&(x=1),a=[_.center.X()+t*Math.cos(this.position*x),_.center.Y()+t*Math.sin(this.position*x)];else if(_.elementClass===c.OBJECT_CLASS_LINE)e=_.point1.coords.usrCoords,o=_.point2.coords.usrCoords,e[0]===0&&e[1]===0&&e[2]===0||o[0]===0&&o[1]===0&&o[2]===0?a=[0,0,0]:Math.abs(o[0])<P.eps?(s=Math.min(Math.abs(this.position),1-P.eps),s/=1-s,this.position<0&&(s=-s),a=[e[0]+s*o[0],e[1]+s*o[1],e[2]+s*o[2]]):Math.abs(e[0])<P.eps?(s=Math.max(this.position,P.eps),s=(s=Math.min(s,2-P.eps))>1?(s-1)/(s-2):(1-s)/s,a=[o[0]+s*e[0],o[1]+s*e[1],o[2]+s*e[2]]):(s=this.position,a=[e[0]+s*(o[0]-e[0]),e[1]+s*(o[1]-e[1]),e[2]+s*(o[2]-e[2])]);else if(_.type===c.OBJECT_TYPE_TURTLE)this.coords.setCoordinates(c.COORDS_BY_USER,[_.Z(this.position),_.X(this.position),_.Y(this.position)]),this.updateConstraint(),a=y.projectPointToTurtle(this,_,this.board)[0].usrCoords;else if(_.elementClass===c.OBJECT_CLASS_CURVE){for(n=!1,(d=_.getTransformationSource())[0]&&(n=d[0],E.push(_),E.push(d[1]));d[0]&&h.exists(d[1]._transformationSource);)d=d[1].getTransformationSource(),E.push(d[1]);if(n?this.coords.setCoordinates(c.COORDS_BY_USER,[E[E.length-1].Z(this.position),E[E.length-1].X(this.position),E[E.length-1].Y(this.position)]):this.coords.setCoordinates(c.COORDS_BY_USER,[_.Z(this.position),_.X(this.position),_.Y(this.position)]),_.type===c.OBJECT_TYPE_ARC||_.type===c.OBJECT_TYPE_SECTOR)p=y.rad([_.center.X()+1,_.center.Y()],_.center,_.radiuspoint),f=0,C=y.rad(_.radiuspoint,_.center,_.anglepoint),(_.visProp.selection==="minor"&&C>Math.PI||_.visProp.selection==="major"&&C<Math.PI)&&(f=C,C=2*Math.PI),x=C-f,h.evaluate(this.visProp.isgeonext)&&(x=1),((b=this.position*x)<f||b>C)&&(((b=C)<f&&b>.5*f||b>C&&b>.5*C+Math.PI)&&(b=f),this.position=b,Math.abs(x)>P.eps&&(this.position/=x)),t=_.Radius(),a=[_.center.X()+t*Math.cos(this.position*x+p),_.center.Y()+t*Math.sin(this.position*x+p)];else if(this.updateConstraint(),n)for(a=y.projectPointToCurve(this,E[E.length-1],this.board)[0].usrCoords,u=E.length-2;u>=0;u--)a=new l(c.COORDS_BY_USER,P.matVecMult(E[u].transformMat,a),this.board).usrCoords;else a=y.projectPointToCurve(this,_,this.board)[0].usrCoords}else h.isPoint(_)&&(a=y.projectPointToPoint(this,_,this.board).usrCoords);this.coords.setCoordinates(c.COORDS_BY_USER,a,!1)}else this.needsUpdateFromParent=!0},updateRendererGeneric:function(e){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>P.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[e](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(e){return this.isReal&&e.isReal?this.coords.distance(c.COORDS_BY_USER,e.coords):NaN},snapToGrid:function(e){return this.handleSnapToGrid(e)},handleSnapToPoints:function(e){var o,t,s,a,d,u,n,p,f=0,b=1/0,C=null,_=h.evaluate(this.visProp.ignoredsnaptopoints),E=!1;if(a=this.board.objectsList.length,_&&(n=_.length),h.evaluate(this.visProp.snaptopoints)||e){for(d=h.evaluate(this.visProp.attractorunit),u=h.evaluate(this.visProp.attractordistance),o=0;o<a;o++){if(t=this.board.objectsList[o],_){for(E=!1,p=0;p<n;p++)if(t===this.board.select(_[p])){E=!0;break}if(E)continue}h.isPoint(t)&&t!==this&&t.visPropCalc.visible&&(s=y.projectPointToPoint(this,t,this.board),(f=d==="screen"?s.distance(c.COORDS_BY_SCREEN,this.coords):s.distance(c.COORDS_BY_USER,this.coords))<u&&f<b&&(b=f,C=s))}C!==null&&this.coords.setCoordinates(c.COORDS_BY_USER,C.usrCoords)}return this},snapToPoints:function(e){return this.handleSnapToPoints(e)},handleAttractors:function(){var e,o,t,s,a=0,d=h.evaluate(this.visProp.attractorunit),u=h.evaluate(this.visProp.attractordistance),n=h.evaluate(this.visProp.snatchdistance),p=h.evaluate(this.visProp.attractors),f=p.length;if(u!==0){for(e=0;e<f;e++)if(o=this.board.select(p[e]),h.exists(o)&&o!==this){if(h.isPoint(o)?t=y.projectPointToPoint(this,o,this.board):o.elementClass===c.OBJECT_CLASS_LINE?(s=y.projectCoordsToSegment(this.coords.usrCoords,o.point1.coords.usrCoords,o.point2.coords.usrCoords),t=!h.evaluate(o.visProp.straightfirst)&&s[1]<0?o.point1.coords:!h.evaluate(o.visProp.straightlast)&&s[1]>1?o.point2.coords:new l(c.COORDS_BY_USER,s[0],this.board)):o.elementClass===c.OBJECT_CLASS_CIRCLE?t=y.projectPointToCircle(this,o,this.board):o.elementClass===c.OBJECT_CLASS_CURVE?t=y.projectPointToCurve(this,o,this.board)[0]:o.type===c.OBJECT_TYPE_TURTLE?t=y.projectPointToTurtle(this,o,this.board)[0]:o.type===c.OBJECT_TYPE_POLYGON&&(t=new l(c.COORDS_BY_USER,y.projectCoordsToPolygon(this.coords.usrCoords,o),this.board)),(a=d==="screen"?t.distance(c.COORDS_BY_SCREEN,this.coords):t.distance(c.COORDS_BY_USER,this.coords))<u){this.type===c.OBJECT_TYPE_GLIDER&&(o===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===o)||this.makeGlider(o);break}a>=n&&(o===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===o)&&this.popSlideObject()}return this}},setPositionDirectly:function(e,o){var t,s,a,d,u=this.coords;if(this.relativeCoords)return s=new l(e,o,this.board),h.evaluate(this.visProp.islabel)?(a=m.subtract(s.scrCoords,u.scrCoords),this.relativeCoords.scrCoords[1]+=a[1],this.relativeCoords.scrCoords[2]+=a[2]):(a=m.subtract(s.usrCoords,u.usrCoords),this.relativeCoords.usrCoords[1]+=a[1],this.relativeCoords.usrCoords[2]+=a[2]),this;for(this.coords.setCoordinates(e,o),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),t=this.transformations.length-1;t>=0;t--)e===c.COORDS_BY_SCREEN?d=new l(e,o,this.board).usrCoords:(o.length===2&&(o=[1].concat(o)),d=o),this.initialCoords.setCoordinates(c.COORDS_BY_USER,P.matVecMult(P.inverse(this.transformations[t].matrix),d));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===c.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(e,o){var t;return o=new l(e,o,this.board),t=this.board.create("transform",o.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(t):this.addTransform(this,t),this.prepareUpdate().update(),this},setPosition:function(e,o){return this.setPositionDirectly(e,o)},setGliderPosition:function(e){return this.type===c.OBJECT_TYPE_GLIDER&&(this.position=e,this.board.update()),this},makeGlider:function(e){var o,t,s,a=this.board.select(e),d=!1;if(a.type===c.OBJECT_TYPE_POLYGON){for(o=Number.MAX_VALUE,t=0;t<a.borders.length;t++)(s=g.Math.Geometry.distPointLine(this.coords.usrCoords,a.borders[t].stdform))<o&&(o=s,e=a.borders[t]);a=this.board.select(e),d=!0}if(!h.exists(a))throw new Error("JSXGraph: slide object undefined.");if(a.type===c.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(e),this.slideObjects.push(this.slideObject),this.addParents(e),this.type=c.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=d,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),this.slideObjects.length===0?(this.type=this._org_type,this.type===c.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===c.OBJECT_CLASS_TEXT?this.elType="text":this.type===c.OBJECT_TYPE_IMAGE?this.elType="image":this.type===c.OBJECT_TYPE_FOREIGNOBJECT&&(this.elType="foreignobject"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var e,o;if(this.type!==c.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,delete this.updateConstraint,this.isConstrained=!1,this.isDraggable)return;this.isDraggable=!0,this.elementClass===c.OBJECT_CLASS_POINT&&(this.type=c.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(e in this.board.objects)this.board.objects.hasOwnProperty(e)&&(o=this.board.objects[e]).descendants&&(delete o.descendants[this.id],delete o.childElements[this.id],this.hasLabel&&(delete o.descendants[this.label.id],delete o.childElements[this.label.id]));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===c.OBJECT_CLASS_POINT?(this.type=c.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===c.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===c.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(e){var o,t,s=[],a=["X","Y"],d=function(n){return function(){return n}},u=function(n){return function(){return n.Value()}};for(this.elementClass===c.OBJECT_CLASS_POINT&&(this.type=c.OBJECT_TYPE_CAS),this.isDraggable=!1,o=0;o<e.length;o++)t=e[o],h.isString(t)?(s[o]=this.board.jc.snippet(t,!0,null,!0),e.length===2&&(this[a[o]+"jc"]=e[o])):h.isFunction(t)?s[o]=t:h.isNumber(t)?s[o]=d(t):h.isObject(t)&&h.isFunction(t.Value)&&(s[o]=u(t)),s[o].origin=t;return e.length===1?this.updateConstraint=function(){var n=s[0]();return h.isArray(n)?this.coords.setCoordinates(c.COORDS_BY_USER,n):this.coords=n,this}:e.length===2?(this.XEval=s[0],this.YEval=s[1],this.setParents([s[0].origin,s[1].origin]),this.updateConstraint=function(){return this.coords.setCoordinates(c.COORDS_BY_USER,[this.XEval(),this.YEval()]),this}):(this.ZEval=s[0],this.XEval=s[1],this.YEval=s[2],this.setParents([s[0].origin,s[1].origin,s[2].origin]),this.updateConstraint=function(){return this.coords.setCoordinates(c.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()]),this}),this.isConstrained=!0,this.prepareUpdate().update(),this.board.isSuspendedUpdate||(this.updateVisibility().updateRenderer(),this.hasLabel&&this.label.fullUpdate()),this},addAnchor:function(e,o){this.relativeCoords=o?new l(c.COORDS_BY_SCREEN,e.slice(0,2),this.board):new l(c.COORDS_BY_USER,e,this.board),this.element.addChild(this),o&&this.addParents(this.element),this.XEval=function(){var t,s,a;return h.evaluate(this.visProp.islabel)?(a=h.evaluate(this.visProp.offset),t=parseFloat(a[0]),s=this.element.getLabelAnchor(),new l(c.COORDS_BY_SCREEN,[t+this.relativeCoords.scrCoords[1]+s.scrCoords[1],0],this.board).usrCoords[1]):(s=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+s.usrCoords[1])},this.YEval=function(){var t,s,a;return h.evaluate(this.visProp.islabel)?(a=h.evaluate(this.visProp.offset),t=-parseFloat(a[1]),s=this.element.getLabelAnchor(),new l(c.COORDS_BY_SCREEN,[0,t+this.relativeCoords.scrCoords[2]+s.scrCoords[2]],this.board).usrCoords[2]):(s=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+s.usrCoords[2])},this.ZEval=h.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(c.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.isConstrained=!0,this.updateConstraint()},updateTransform:function(e){var o;if(this.transformations.length===0)return this;for(o=0;o<this.transformations.length;o++)this.transformations[o].update();return this},addTransform:function(e,o){var t,s=h.isArray(o)?o:[o],a=s.length;for(this.transformations.length===0&&(this.baseElement=e),t=0;t<a;t++)this.transformations.push(s[t]);return this},startAnimation:function(e,o,t){var s=this;return t=t||250,this.type!==c.OBJECT_TYPE_GLIDER||h.exists(this.intervalCode)||(this.intervalCode=window.setInterval(function(){s._anim(e,o)},t),h.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return h.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(e,o,t){t=t||{};var s,a,d,u,n,p=[],f=[],b=o/this.board.attr.animationdelay,C=function(_,E){return function(){return e[_][E]}};if(h.isArray(e)){for(d=e.length,s=0;s<d;s++)h.isPoint(e[s])?f[s]=e[s]:f[s]={elementClass:c.OBJECT_CLASS_POINT,X:C(s,0),Y:C(s,1)};if((o=o||0)===0)return this.setPosition(c.COORDS_BY_USER,[f[f.length-1].X(),f[f.length-1].Y()]),this.board.update(this);if(!h.exists(t.interpolate)||t.interpolate)for(a=v.Neville(f),s=0;s<b;s++)p[s]=[],p[s][0]=a[0]((b-s)/b*a[3]()),p[s][1]=a[1]((b-s)/b*a[3]());else{for(d=e.length-1,s=0;s<b;++s)n=s/b*d-(u=Math.floor(s/b*d)),p[s]=[],p[s][0]=(1-n)*f[u].X()+n*f[u+1].X(),p[s][1]=(1-n)*f[u].Y()+n*f[u+1].Y();p.push([f[d].X(),f[d].Y()]),p.reverse()}this.animationPath=p}else h.isFunction(e)&&(this.animationPath=e,this.animationStart=new Date().getTime());return this.animationCallback=t.callback,this.board.addAnimation(this),this},moveTo:function(e,o,t){t=t||{},e=new l(c.COORDS_BY_USER,e,this.board);var s,a=this.board.attr.animationdelay,d=Math.ceil(o/a),u=[],n=this.coords.usrCoords[1],p=this.coords.usrCoords[2],f=e.usrCoords[1]-n,b=e.usrCoords[2]-p,C=function(_){return t.effect&&t.effect==="<>"?Math.pow(Math.sin(_/d*Math.PI/2),2):_/d};if(!h.exists(o)||o===0||Math.abs(e.usrCoords[0]-this.coords.usrCoords[0])>P.eps)return this.setPosition(c.COORDS_BY_USER,e.usrCoords),this.board.update(this);if(!h.exists(t.callback)&&Math.abs(f)<P.eps&&Math.abs(b)<P.eps)return this;for(s=d;s>=0;s--)u[d-s]=[e.usrCoords[0],n+f*C(s),p+b*C(s)];return this.animationPath=u,this.animationCallback=t.callback,this.board.addAnimation(this),this},visit:function(e,o,t){e=new l(c.COORDS_BY_USER,e,this.board);var s,a,d,u=this.board.attr.animationdelay,n=[],p=this.coords.usrCoords[1],f=this.coords.usrCoords[2],b=e.usrCoords[1]-p,C=e.usrCoords[2]-f,_=function(E){var x=E<d/2?2*E/d:2*(d-E)/d;return t.effect&&t.effect==="<>"?Math.pow(Math.sin(x*Math.PI/2),2):x};for(h.isNumber(t)?t={repeat:t}:(t=t||{},h.exists(t.repeat)||(t.repeat=1)),d=Math.ceil(o/(u*t.repeat)),a=0;a<t.repeat;a++)for(s=d;s>=0;s--)n[a*(d+1)+d-s]=[e.usrCoords[0],p+b*_(s),f+C*_(s)];return this.animationPath=n,this.animationCallback=t.callback,this.board.addAnimation(this),this},_anim:function(e,o){var t,s,a,d,u,n,p,f,b;return this.intervalCount+=1,this.intervalCount>o&&(this.intervalCount=0),this.slideObject.elementClass===c.OBJECT_CLASS_LINE?(p=this.slideObject.point1.coords.scrCoords,f=this.slideObject.point2.coords.scrCoords,t=Math.round((f[1]-p[1])*this.intervalCount/o),s=Math.round((f[2]-p[2])*this.intervalCount/o),e>0?d=this.slideObject.point1:(d=this.slideObject.point2,t*=-1,s*=-1),this.coords.setCoordinates(c.COORDS_BY_SCREEN,[d.coords.scrCoords[1]+t,d.coords.scrCoords[2]+s])):this.slideObject.elementClass===c.OBJECT_CLASS_CURVE?(u=e>0?Math.round(this.intervalCount/o*this.board.canvasWidth):Math.round((o-this.intervalCount)/o*this.board.canvasWidth),this.coords.setCoordinates(c.COORDS_BY_SCREEN,[u,0]),b=y.projectPointToCurve(this,this.slideObject,this.board),this.coords=b[0],this.position=b[1]):this.slideObject.elementClass===c.OBJECT_CLASS_CIRCLE&&(a=2*Math.PI,a*=e<0?this.intervalCount/o:(o-this.intervalCount)/o,n=this.slideObject.Radius(),this.coords.setCoordinates(c.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+n*Math.cos(a),this.slideObject.center.coords.usrCoords[2]+n*Math.sin(a)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var e=[this.Z(),this.X(),this.Y()];return this.parents.length!==0&&(e=this.parents),this.type===c.OBJECT_TYPE_GLIDER&&(e=[this.X(),this.Y(),this.slideObject.id]),e}}),g.CoordsElement.create=function(e,o,t,s,a,d){var u,n,p=!1;for(n=0;n<t.length;n++)(h.isFunction(t[n])||h.isString(t[n]))&&(p=!0);if(p)(u=new e(o,[0,0],s,a,d)).addConstraint(t);else if(h.isNumber(t[0])&&h.isNumber(t[1]))u=new e(o,t,s,a,d),h.exists(s.slideobject)?u.makeGlider(s.slideobject):u.baseElement=u,u.isDraggable=!0;else{if(!h.isObject(t[0])||!h.isTransformationOrArray(t[1]))return!1;(u=new e(o,[0,0],s,a,d)).addTransform(t[0],t[1]),u.isDraggable=!1}return u.handleSnapToGrid(),u.handleSnapToPoints(),u.handleAttractors(),u.addParents(t),u},g.CoordsElement}),define("base/text",["jxg","base/constants","base/element","parser/geonext","utils/env","utils/type","math/math","base/coordselement"],function(g,P,y,v,m,l,c,h){var e=function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()};return g.Text=function(o,t,s,a){this.constructor(o,s,P.OBJECT_TYPE_TEXT,P.OBJECT_CLASS_TEXT),this.element=this.board.select(s.anchor),this.coordsConstructor(t,l.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this.board.renderer.drawText(this),this.board.finalizeAdding(this),this.setText(a),l.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=l.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},g.Text.prototype=new y,l.copyPrototypeMethods(g.Text,h,"coordsConstructor"),g.extend(g.Text.prototype,{hasPoint:function(o,t){var s,a,d,u,n,p,f,b;return l.isObject(l.evaluate(this.visProp.precision))?(f=this.board._inputDevice,b=l.evaluate(this.visProp.precision[f])):b=this.board.options.precision.hasPoint,this.transformations.length>0&&(o=(s=c.matVecMult(c.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,o,t]))[1],t=s[2]),a=(s=(n=this.getAnchorX())==="right"?this.coords.scrCoords[1]-this.size[0]:n==="middle"?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1])+this.size[0],d=(u=(p=this.getAnchorY())==="top"?this.coords.scrCoords[2]+this.size[1]:p==="middle"?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2])-this.size[1],l.evaluate(this.visProp.dragarea)==="all"?o>=s-b&&o<a+b&&t>=d-b&&t<=u+b:t>=d-b&&t<=u+b&&(o>=s-b&&o<=s+2*b||o>=a-2*b&&o<=a+b)},_createFctUpdateText:function(o){var t,s,a=l.evaluate(this.visProp.parse),d=l.evaluate(this.visProp.usemathjax),u=l.evaluate(this.visProp.usekatex);this.orgText=o,l.isFunction(o)?this.updateText=function(){s=o().toString(),this.plaintext=!a||d||u?s:this.replaceSub(this.replaceSup(this.convertGeonextAndSketchometry2CSS(s)))}:l.isString(o)&&!a?this.updateText=function(){this.plaintext=o}:(l.isNumber(o)?this.content=l.toFixed(o,l.evaluate(this.visProp.digits)):l.evaluate(this.visProp.useasciimathml)?this.content="'`"+o+"`'":this.content=d||u?"'"+o+"'":this.generateTerm(o,!0,!0),t=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=t()})},_setText:function(o){return this._createFctUpdateText(o),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(o){var t;return this.visProp.castext=o,t=l.isFunction(o)?function(){return l.sanitizeHTML(o())}:l.isNumber(o)?o:l.sanitizeHTML(o),this._setText(t)},setText:function(o){return this._setText(o)},updateSize:function(){var o,t,s,a=l.evaluate(this.visProp.display);return m.isBrowser&&this.board.renderer.type!=="no"?(s=this.rendNode,a==="html"||this.board.renderer.type==="vml"?l.exists(s.offsetWidth)?(t=this,window.setTimeout(function(){t.size=[s.offsetWidth,s.offsetHeight],t.needsUpdate=!0,t.updateRenderer()},0)):this.size=this.crudeSizeEstimate():a==="internal"&&(this.board.renderer.type==="svg"?(t=this,window.setTimeout(function(){try{o=s.getBBox(),t.size=[o.width,o.height],t.needsUpdate=!0,t.updateRenderer()}catch{}},0)):this.board.renderer.type==="canvas"&&(this.size=this.crudeSizeEstimate())),this):this},crudeSizeEstimate:function(){var o=parseFloat(l.evaluate(this.visProp.fontsize));return[o*this.plaintext.length*.45,.9*o]},utf8_decode:function(o){return o.replace(/&#x(\w+);/g,function(t,s){return String.fromCharCode(parseInt(s,16))})},replaceSub:function(o){if(!o.indexOf)return o;for(var t,s=o.indexOf("_{");s>=0;)(t=(o=o.substr(0,s)+o.substr(s).replace(/_\{/,"<sub>")).substr(s).indexOf("}"))>=0&&(o=o.substr(0,t)+o.substr(t).replace(/\}/,"</sub>")),s=o.indexOf("_{");for(s=o.indexOf("_");s>=0;)s=(o=o.substr(0,s)+o.substr(s).replace(/_(.?)/,"<sub>$1</sub>")).indexOf("_");return o},replaceSup:function(o){if(!o.indexOf)return o;for(var t,s=o.indexOf("^{");s>=0;)(t=(o=o.substr(0,s)+o.substr(s).replace(/\^\{/,"<sup>")).substr(s).indexOf("}"))>=0&&(o=o.substr(0,t)+o.substr(t).replace(/\}/,"</sup>")),s=o.indexOf("^{");for(s=o.indexOf("^");s>=0;)s=(o=o.substr(0,s)+o.substr(s).replace(/\^(.?)/,"<sup>$1</sup>")).indexOf("^");return o},getSize:function(){return this.size},setCoords:function(o,t){var s,a,d;return l.isArray(o)&&o.length>1&&(t=o[1],o=o[0]),l.evaluate(this.visProp.islabel)&&l.exists(this.element)?(a=(o-(s=this.element.getLabelAnchor()).usrCoords[1])*this.board.unitX,d=-(t-s.usrCoords[2])*this.board.unitY,this.relativeCoords.setCoordinates(P.COORDS_BY_SCREEN,[a,d])):this.coords.setCoordinates(P.COORDS_BY_USER,[o,t]),this.fullUpdate(),this},update:function(o){return this.needsUpdate?(this.updateCoords(o),this.updateText(),l.evaluate(this.visProp.display)==="internal"&&l.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return l.evaluate(this.visProp.autoposition)&&this.setAutoPosition().updateConstraint(),this.updateRendererGeneric("updateText")},expandShortMath:function(o){return o.replace(/([)0-9.])\s*([(a-zA-Z_])/g,"$1*$2")},generateTerm:function(o,t,s){var a,d,u,n,p='""';if(u=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=o||"").replace(/\r/g,"")).replace(/\n/g,"")).replace(/"/g,"'")).replace(/'/g,"\\'")).replace(/&amp;arc;/g,"&ang;")).replace(/<arc\s*\/>/g,"&ang;")).replace(/&lt;arc\s*\/&gt;/g,"&ang;")).replace(/&lt;sqrt\s*\/&gt;/g,"&radic;")).replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>")).indexOf("<value>"),n=o.indexOf("</value>"),u>=0)for(;u>=0;)p+=' + "'+this.replaceSub(this.replaceSup(o.slice(0,u)))+'"',d=(d=o.slice(u+7,n)).replace(/\s+/g,""),t===!0&&(d=this.expandShortMath(d)),(a=(a=(a=s?d:v.geonext2JS(d,this.board)).replace(/\\"/g,"'")).replace(/\\'/g,"'")).indexOf("toFixed")<0&&l.isNumber(l.bind(this.board.jc.snippet(a,!0,"",!1),this)())?p+="+("+a+").toFixed("+l.evaluate(this.visProp.digits)+")":p+="+("+a+")",u=(o=o.slice(n+8)).indexOf("<value>"),n=o.indexOf("</value>");return p+=' + "'+this.replaceSub(this.replaceSup(o))+'"',p=(p=(p=this.convertGeonextAndSketchometry2CSS(p)).replace(/&amp;/g,"&")).replace(/"/g,"'")},convertGeonext2CSS:function(o){return l.isString(o)&&(o=(o=(o=(o=o.replace(/(<|&lt;)overline(>|&gt;)/g,"<span style=text-decoration:overline;>")).replace(/(<|&lt;)\/overline(>|&gt;)/g,"</span>")).replace(/(<|&lt;)arrow(>|&gt;)/g,"<span style=text-decoration:overline;>")).replace(/(<|&lt;)\/arrow(>|&gt;)/g,"</span>")),o},convertSketchometry2CSS:function(o){return l.isString(o)&&(o=(o=(o=(o=o.replace(/(<|&lt;)sketchofont(>|&gt;)/g,"<span style=font-family:sketchometry-light;font-weight:500;>")).replace(/(<|&lt;)\/sketchofont(>|&gt;)/g,"</span>")).replace(/(<|&lt;)sketchometry-light(>|&gt;)/g,"<span style=font-family:sketchometry-light;font-weight:500;>")).replace(/(<|&lt;)\/sketchometry-light(>|&gt;)/g,"</span>")),o},convertGeonextAndSketchometry2CSS:function(o){return o=this.convertGeonext2CSS(o),o=this.convertSketchometry2CSS(o)},notifyParents:function(o){var t,s=null;o=(o=o.replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>");do(s=(t=/<value>([\w\s*/^\-+()[\],<>=!]+)<\/value>/).exec(o))!==null&&(v.findDependencies(this,s[1],this.board),o=(o=o.substr(s.index)).replace(t,""));while(s!==null);return this},getParents:function(){var o;return o=this.relativeCoords!==void 0?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],this.parents.length!==0&&(o=this.parents),o},bounds:function(){var o=this.coords.usrCoords;return l.evaluate(this.visProp.islabel)||this.board.unitY===0||this.board.unitX===0?[0,0,0,0]:[o[1],o[2]+this.size[1]/this.board.unitY,o[1]+this.size[0]/this.board.unitX,o[2]]},getAnchorX:function(){var o=l.evaluate(this.visProp.anchorx);if(o==="auto")switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";default:return"right"}return o},getAnchorY:function(){var o=l.evaluate(this.visProp.anchory);if(o==="auto")switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";default:return"middle"}return o},getNumberofConflicts:function(o,t,s,a){var d,u,n,p,f=0;for(p=this.board.options.precision.hasPoint,this.board.options.precision.hasPoint=.25*(s+a),d=0,n=this.board.objectsList.length;d<n;d++)(u=this.board.objectsList[d]).visPropCalc.visible&&u.elType!=="axis"&&u.elType!=="ticks"&&u!==this.board.infobox&&u!==this&&u.hasPoint(o,t)&&f++;return this.board.options.precision.hasPoint=p,f},setAutoPosition:function(){var o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w=this.size[0],T=this.size[1],M={conflicts:1/0,angle:0,r:0},N=2*Math.PI/12;if(this===this.board.infobox||!this.visPropCalc.visible||!l.evaluate(this.visProp.islabel)||!this.element)return this;if(b=l.evaluate(this.visProp.offset),s=(d=this.element.getLabelAnchor()).scrCoords[1],a=d.scrCoords[2],E=b[0],x=b[1],(f=this.getNumberofConflicts(s+E,a-x,w,T))===0)return this;for(p=.2*(C=12),u=Math.atan2(x,E),M.conflicts=f,M.angle=u,M.r=C;M.conflicts>0&&C<28;){for(_=1,n=u+N;_<12&&M.conflicts>0&&(o=s+C*(S=Math.cos(n)),t=a-C*(O=Math.sin(n)),(f=this.getNumberofConflicts(o,t,w,T))<M.conflicts&&(M.conflicts=f,M.angle=n,M.r=C),M.conflicts!==0);_++)n+=N;C+=p}return C=M.r,S=Math.cos(M.angle),O=Math.sin(M.angle),this.visProp.offset=[C*S,C*O],this.visProp.anchorx=S<-.2?"right":S>.2?"left":"middle",this}}),g.createText=function(o,t,s){var a,d=l.copyAttributes(s,o.options,"text"),u=t.slice(0,-1),n=t[t.length-1];if(d.anchor=d.parent||d.anchor,!(a=h.create(g.Text,o,u,d,n)))throw new Error("JSXGraph: Can't create text with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return d.rotate!==0&&d.display==="internal"&&a.addRotation(d.rotate),a},g.registerElement("text",g.createText),g.createHTMLSlider=function(o,t,s){var a,d,u=l.copyAttributes(s,o.options,"htmlslider");if(t.length!==2||t[0].length!==2||t[1].length!==3)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parents are: [[x,y], [min, start, max]]`);u.anchor=u.parent||u.anchor,u.fixed=u.fixed||!0,d=[t[0][0],t[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],(a=g.createText(o,d,u)).type=l.OBJECT_TYPE_HTMLSLIDER,a.rendNodeForm=a.rendNode.childNodes[0],a.rendNodeRange=a.rendNodeForm.childNodes[0],a.rendNodeRange.min=t[1][0],a.rendNodeRange.max=t[1][2],a.rendNodeRange.step=u.step,a.rendNodeRange.value=t[1][1],a.rendNodeLabel=a.rendNodeForm.childNodes[1],a.rendNodeLabel.id=a.rendNode.id+"_label",u.withlabel&&(a.rendNodeLabel.innerHTML=a.name+"="),a.rendNodeOut=a.rendNodeForm.childNodes[2],a.rendNodeOut.value=t[1][1];try{a.rendNodeForm.id=a.rendNode.id+"_form",a.rendNodeRange.id=a.rendNode.id+"_range",a.rendNodeOut.id=a.rendNode.id+"_out"}catch(n){g.debug(n)}return a.rendNodeRange.style.width=u.widthrange+"px",a.rendNodeRange.style.verticalAlign="middle",a.rendNodeOut.style.width=u.widthout+"px",a._val=t[1][1],g.supportsVML()?m.addEvent(a.rendNodeForm,"change",e,a):m.addEvent(a.rendNodeForm,"input",e,a),a.Value=function(){return this._val},a},g.registerElement("htmlslider",g.createHTMLSlider),{Text:g.Text,createText:g.createText,createHTMLSlider:g.createHTMLSlider}}),define("utils/uuid",["jxg"],function(g){var P="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return g.Util=g.Util||{},g.Util.genUUID=function(y){var v,m,l=[],c=0;for((y=y||"")!==""&&y.substr(y.length-1)!=="-"&&(y+="-"),m=0;m<36;m++)m===8||m===13||m===18||m===23?l[m]="-":m===14?l[m]="4":(c<=2&&(c=33554432+16777216*Math.random()|0),v=15&c,c>>=4,l[m]=P[m===19?3&v|8:v]);return y+l.join("")},g.Util}),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/ia","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],function(JXG,Const,Text,Mat,Interval,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(g,P){if(typeof g!="object"&&typeof g!="function")throw new TypeError("Object prototype may only be an Object: "+g);if(g===null)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(P!==void 0)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");function y(){}return y.prototype=g,new y});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}},r,_ccache;JXG.JessieCode=function(g,P){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.operands=this.getPossibleOperands(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="",typeof g=="string"&&this.parse(g,P)},JXG.extend(JXG.JessieCode.prototype,{node:function(g,P,y){return{type:g,value:P,children:y}},createNode:function(g,P,y){var v,m=this.node(g,P,[]);for(v=2;v<arguments.length;v++)m.children.push(arguments[v]);return m.type=="node_const"&&Type.isNumber(m.value)&&(m.isMath=!0),m.line=this.parCurLine,m.col=this.parCurColumn,m},pushScope:function(g){var P={args:g,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=P,P.id=this.scopes.push(P)-1,P},popScope:function(){var g=this.scope.previous;return this.scope=g!==null?g:this.scope,this.scope},getElementById:function(g){return this.board.objects[g]},log:function(){this.$log.push(arguments),typeof console=="object"&&console.log&&console.log.apply(console,arguments)},creator:(_ccache={},(r=function(g){var P,y;return typeof _ccache[this.board.id+g]=="function"?P=_ccache[this.board.id+g]:(y=this,(P=function(v,m){var l;return(l=Type.exists(m)?m:{}).name===void 0&&l.id===void 0&&(l.name=y.lhs[y.scope.id]!==0?y.lhs[y.scope.id]:""),y.board.create(g,v,l)}).creator=!0,_ccache[this.board.id+g]=P),P}).clearCache=function(){_ccache={}},r),letvar:function(g,P){this.builtIn[g]&&this._warn('"'+g+'" is a predefined value.'),this.scope.locals[g]=P},isLocalVariable:function(g){for(var P=this.scope;P!==null;){if(Type.exists(P.locals[g]))return P;P=P.previous}return null},isParameter:function(g){for(var P=this.scope;P!==null;){if(Type.indexOf(P.args,g)>-1)return P;P=P.previous}return null},isCreator:function(g){return!!JXG.elements[g]},isMathMethod:function(g){return g!=="E"&&!!Math[g]},isBuiltIn:function(g){return!!this.builtIn[g]},getvar:function(g,P,y){var v;if(P=Type.def(P,!1),(v=this.isLocalVariable(g))!==null)return v.locals[g];if(g==="$board"||g==="EULER"||g==="PI")return this.builtIn[g];if(y){if(this.isBuiltIn(g))return this.builtIn[g];if(this.isMathMethod(g))return Math[g];if(this.isCreator(g))return this.creator(g)}return P||(v=this.board.select(g))===g?void 0:v},resolve:function(g){for(var P=this.scope;P!==null;){if(Type.exists(P.locals[g]))return P.locals[g];P=P.previous}},getvarJS:function(g,P,y){var v,m="";return P=Type.def(P,!1),y=Type.def(y,!1),this.isParameter(g)!==null?g:this.isLocalVariable(g)===null||y?this.isCreator(g)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(y?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+g+"'].concat([a, props])); })":(y&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(g)?(m=this.builtIn[g].src||this.builtIn[g],Type.isNumber(m)||m.match(/board\.select/)?m:(g=m.split(".").pop(),Type.exists(this.board.mathLib)&&(v=new RegExp("^Math."+g)).exec(m)!==null?m.replace(v,"$jc$.board.mathLib."+g):Type.exists(this.board.mathLibJXG)&&(v=new RegExp("^JXG.Math.")).exec(m)!==null?m.replace(v,"$jc$.board.mathLibJXG."):m)):this.isMathMethod(g)?"$jc$.board.mathLib."+g:P?"":(Type.isId(this.board,g)?(m="$jc$.board.objects['"+g+"']",this.board.objects[g].elType==="slider"&&(m+=".Value()")):Type.isName(this.board,g)?(m="$jc$.board.elementsByName['"+g+"']",this.board.elementsByName[g].elType==="slider"&&(m+=".Value()")):Type.isGroup(this.board,g)&&(m="$jc$.board.groups['"+g+"']"),m)):"$jc$.resolve('"+g+"')"},makeMap:function(g){return g.isMap=!0,g},functionCodeJS:function(g){var P=g.children[0].join(", "),y="",v="";return g.value==="op_map"&&(y="{ return  ",v=" }"),"function ("+P+`) {
var $oldscope$ = $jc$.scope;
$jc$.scope = $jc$.scopes[`+this.scope.id+`];
var r = (function () `+y+this.compile(g.children[1],!0)+v+`)();
$jc$.scope = $oldscope$;
return r;
}`},defineFunction:function(node){var fun,i,that=this,list=node.children[0],scope=this.pushScope(list),_that;if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{for(fun=eval(str),scope.argtypes=[],i=0;i<list.length;i++)scope.argtypes.push(that.resolveType(list[i],node));return fun}catch(g){return $jc$._warn(`error compiling function

`+str+`

`+g.toString()),function(){}}}(this),this.popScope()}else fun=function(g,P,y){return function(){var v,m;for(m=P.scope,P.scope=P.scopes[y],v=0;v<g.length;v++)P.scope.locals[g[v]]=arguments[v];return v=P.execute(node.children[1]),P.scope=m,v}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=(_that=this,function(){return _that.compile(_that.replaceIDs(Type.deepCopy(node)))}),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(g){var P,y={};for(P=0;P<arguments.length;P++)y=Type.deepCopy(y,arguments[P],!0);return y},setProp:function(g,P,y){var v,m,l={};g.elementClass!==Const.OBJECT_CLASS_POINT||P!=="X"&&P!=="Y"?g.elementClass!==Const.OBJECT_CLASS_TEXT||P!=="X"&&P!=="Y"?g.type&&g.elementClass&&g.visProp?Type.exists(g[g.methodMap[P]])&&typeof g[g.methodMap[P]]!="function"?g[g.methodMap[P]]=y:(l[P]=y,g.setAttribute(l)):g[P]=y:(typeof y=="number"?g[P]=function(){return y}:typeof y=="function"?(g.isDraggable=!1,g[P]=y):typeof y=="string"&&(g.isDraggable=!1,g[P]=Type.createFunction(y,this.board,null,!0),g[P+"jc"]=y),g[P].origin=y,this.board.update()):(P=P.toLowerCase(),g.isDraggable&&typeof y=="number"?(v=P==="x"?y:g.X(),m=P==="y"?y:g.Y(),g.setPosition(Const.COORDS_BY_USER,[v,m])):!g.isDraggable||typeof y!="function"&&typeof y!="string"?g.isDraggable||(v=P==="x"?y:g.XEval.origin,m=P==="y"?y:g.YEval.origin,g.addConstraint([v,m])):(v=P==="x"?y:g.coords.usrCoords[1],m=P==="y"?y:g.coords.usrCoords[2],g.addConstraint([v,m])),this.board.update())},_genericParse:function(g,P,y,v){var m,l,c,h,e=g.replace(/\r\n/g,`
`).split(`
`),o=[];v||(this.code+=g+`
`),Text&&(l=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(y)||(y=!1),m=0;m<e.length;m++)y&&(e[m]=JXG.GeonextParser.geonext2JS(e[m],this.board)),o.push(e[m]);switch(g=o.join(`
`),c=parser.parse(g),this.CA&&(c=this.CA.expandDerivatives(c,null,c),c=this.CA.removeTrivialNodes(c)),P){case"parse":h=this.execute(c);break;case"manipulate":h=this.compile(c);break;case"getAst":h=c;break;default:h=!1}}catch(t){throw t}finally{Text&&(Text.Text.prototype.setText=l)}return h},parse:function(g,P,y){return this._genericParse(g,"parse",P,y)},manipulate:function(g,P,y){return this._genericParse(g,"manipulate",P,y)},getAST:function(g,P,y){return this._genericParse(g,"getAst",P,y)},snippet:function(g,P,y,v){var m;return P=Type.def(P,!0),y=Type.def(y,""),v=Type.def(v,!1),m=(P?" function ("+y+") { return ":"")+g+(P?"; }":"")+";",this.parse(m,v,!0)},replaceIDs:function(g){var P,y;if(g.replaced&&(y=this.board.objects[g.children[1][0].value],Type.exists(y)&&y.name!==""&&(g.type="node_var",g.value=y.name,g.children.length=0,delete g.replaced)),Type.isArray(g))for(P=0;P<g.length;P++)g[P]=this.replaceIDs(g[P]);if(g.children)for(P=g.children.length;P>0;P--)Type.exists(g.children[P-1])&&(g.children[P-1]=this.replaceIDs(g.children[P-1]));return g},replaceNames:function(g){var P,y;if(y=g.value,g.type==="node_op"&&y==="op_lhs"&&g.children.length===1?this.isLHS=!0:g.type==="node_var"&&(this.isLHS?this.letvar(y,!0):!Type.exists(this.getvar(y,!0))&&Type.exists(this.board.elementsByName[y])&&(g=this.createReplacementNode(g))),Type.isArray(g))for(P=0;P<g.length;P++)g[P]=this.replaceNames(g[P]);if(g.children)for(P=g.children.length;P>0;P--)Type.exists(g.children[P-1])&&(g.children[P-1]=this.replaceNames(g.children[P-1]));return g.type==="node_op"&&g.value==="op_lhs"&&g.children.length===1&&(this.isLHS=!1),g},createReplacementNode:function(g){var P=g.value,y=this.board.elementsByName[P];return(g=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",y.id)])).replaced=!0,g},collectDependencies:function(g,P){var y,v,m,l;if(Type.isArray(g))for(l=g.length,y=0;y<l;y++)this.collectDependencies(g[y],P);else if(v=g.value,g.type==="node_var"&&(m=this.getvar(v))&&m.visProp&&m.type&&m.elementClass&&m.id&&(P[m.id]=m),g.type==="node_op"&&g.value==="op_execfun"&&g.children.length>1&&g.children[0].value==="$"&&g.children[1].length>0&&(P[m=g.children[1][0].value]=this.board.objects[m]),g.children)for(y=g.children.length;y>0;y--)Type.exists(g.children[y-1])&&this.collectDependencies(g.children[y-1],P)},resolveProperty:function(g,P,y){return y=Type.def(y,!1),g&&g.methodMap&&(Type.exists(g.subs)&&Type.exists(g.subs[P])?g=g.subs:Type.exists(g.methodMap[P])?P=g.methodMap[P]:(g=g.visProp,P=P.toLowerCase())),Type.isFunction(g)&&this._error("Accessing function properties is not allowed."),Type.exists(g)||this._error(g+" is not an object"),Type.exists(g[P])||this._error("unknown property "+P),y&&typeof g[P]=="function"?function(){return g[P].apply(g,arguments)}:g[P]},resolveType:function(g,P){var y,v;if(Type.isArray(P)){for(y=0;y<P.length;y++)if((v=this.resolveType(g,P[y]))!=="any")return v}if(P.type==="node_op"&&P.value==="op_execfun"&&P.children[0].type==="node_var"&&P.children[0].value===g)return"function";if(P.type==="node_op"){for(y=0;y<P.children.length;y++)if(P.children[0].type==="node_var"&&P.children[0].value===g&&(P.value==="op_add"||P.value==="op_sub"||P.value==="op_mul"||P.value==="op_div"||P.value==="op_mod"||P.value==="op_exp"||P.value==="op_neg"))return"any";for(y=0;y<P.children.length;y++)if((v=this.resolveType(g,P.children[y]))!=="any")return v}return"any"},getLHS:function(g){var P;if(g.type==="node_var")P={o:this.scope.locals,what:g.value};else if(g.type==="node_op"&&g.value==="op_property")P={o:this.execute(g.children[0]),what:g.children[1]};else{if(g.type!=="node_op"||g.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");P={o:this.execute(g.children[0]),what:this.execute(g.children[1])}}return P},getLHSCompiler:function(g,P){var y;if(g.type==="node_var")y=g.value;else if(g.type==="node_op"&&g.value==="op_property")y=[this.compile(g.children[0],P),"'"+g.children[1]+"'"];else{if(g.type!=="node_op"||g.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");y=[this.compile(g.children[0],P),g.children[1].type==="node_const"?g.children[1].value:this.compile(g.children[1],P)]}return y},execute:function(g){var P,y,v,m,l,c,h,e,o,t,s=[];if(P=0,!g)return P;switch(this.line=g.line,this.col=g.col,g.type){case"node_op":switch(g.value){case"op_none":g.children[0]&&this.execute(g.children[0]),g.children[1]&&(P=this.execute(g.children[1]));break;case"op_assign":y=this.getLHS(g.children[0]),this.lhs[this.scope.id]=y.what,y.o.type&&y.o.elementClass&&y.o.methodMap&&y.what==="label"&&this._error("Left-hand side of assignment is read-only."),P=this.execute(g.children[1]),y.o!==this.scope.locals||Type.isArray(y.o)&&typeof y.what=="number"?this.setProp(y.o,y.what,P):this.letvar(y.what,P),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(g.children[0])&&(P=this.execute(g.children[1]));break;case"op_conditional":case"op_if_else":P=this.execute(g.children[0])?this.execute(g.children[1]):this.execute(g.children[2]);break;case"op_while":for(;this.execute(g.children[0]);)this.execute(g.children[1]);break;case"op_do":do this.execute(g.children[0]);while(this.execute(g.children[1]));break;case"op_for":for(this.execute(g.children[0]);this.execute(g.children[1]);this.execute(g.children[2]))this.execute(g.children[3]);break;case"op_proplst":g.children[0]&&this.execute(g.children[0]),g.children[1]&&this.execute(g.children[1]);break;case"op_emptyobject":P={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(g.children[0]),P=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][g.children[0]]=this.execute(g.children[1]);break;case"op_array":for(P=[],l=g.children[0].length,v=0;v<l;v++)P.push(this.execute(g.children[0][v]));break;case"op_extvalue":P=this.execute(g.children[0]),P=typeof(v=this.execute(g.children[1]))=="number"&&Math.abs(Math.round(v)-v)<Mat.eps?P[v]:void 0;break;case"op_return":if(this.scope!==0)return this.execute(g.children[0]);this._error("Unexpected return.");break;case"op_map":g.children[1].isMath||g.children[1].type==="node_var"||this._error("execute: In a map only function calls and mathematical expressions are allowed."),(e=this.defineFunction(g)).isMap=!0,P=e;break;case"op_function":(e=this.defineFunction(g)).isMap=!1,P=e;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,c=g.children[1],Type.exists(g.children[2]))if(g.children[3])for(h=g.children[2],o={},v=0;v<h.length;v++)o=Type.deepCopy(o,this.execute(h[v]),!0);else o=this.execute(g.children[2]);for(g.children[0]._isFunctionName=!0,e=this.execute(g.children[0]),delete g.children[0]._isFunctionName,t=e&&e.sc?e.sc:this,!e.creator&&Type.exists(g.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),v=0;v<c.length;v++)Type.exists(e.scope)&&Type.exists(e.scope.argtypes)&&e.scope.argtypes[v]==="function"?(c[v]._isFunctionName=!0,s[v]=this.execute(c[v]),delete c[v]._isFunctionName):s[v]=this.execute(c[v]),this.dpstack[this.pscope].push({line:g.children[1][v].line,col:g.children[1][v].ecol});if(typeof e!="function"||e.creator)if(typeof e=="function"&&e.creator){m=this.line;try{for((P=e(s,o)).jcLineStart=m,P.jcLineEnd=g.eline,v=m;v<=g.line;v++)this.lineToElement[v]=P;P.debugParents=this.dpstack[this.pscope]}catch(a){this._error(a.toString())}}else this._error("Function '"+e+"' is undefined.");else P=e.apply(t,s);this.dpstack.pop(),this.pscope--;break;case"op_property":m=this.execute(g.children[0]),y=g.children[1],P=this.resolveProperty(m,y,!1),Type.exists(P)&&(P.sc=m);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(g.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),y=this.getvar(g.children[0]),P=this.del(y);break;case"op_eq":P=this.execute(g.children[0])==this.execute(g.children[1]);break;case"op_neq":P=this.execute(g.children[0])!=this.execute(g.children[1]);break;case"op_approx":P=Math.abs(this.execute(g.children[0])-this.execute(g.children[1]))<Mat.eps;break;case"op_gt":P=this.execute(g.children[0])>this.execute(g.children[1]);break;case"op_lt":P=this.execute(g.children[0])<this.execute(g.children[1]);break;case"op_geq":P=this.execute(g.children[0])>=this.execute(g.children[1]);break;case"op_leq":P=this.execute(g.children[0])<=this.execute(g.children[1]);break;case"op_or":P=this.execute(g.children[0])||this.execute(g.children[1]);break;case"op_and":P=this.execute(g.children[0])&&this.execute(g.children[1]);break;case"op_not":P=!this.execute(g.children[0]);break;case"op_add":P=this.add(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_sub":P=this.sub(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_div":P=this.div(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_mod":P=this.mod(this.execute(g.children[0]),this.execute(g.children[1]),!0);break;case"op_mul":P=this.mul(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_exp":P=this.pow(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_neg":P=this.neg(this.execute(g.children[0]))}break;case"node_var":P=this.getvar(g.value,!1,g._isFunctionName);break;case"node_const":P=g.value===null?null:Number(g.value);break;case"node_const_bool":P=g.value;break;case"node_str":P=g.value.replace(/\\(.)/,"$1")}return P},compile:function(g,P){var y,v,m,l="";if(Type.exists(P)||(P=!1),!g)return l;switch(g.type){case"node_op":switch(g.value){case"op_none":g.children[0]&&(l=this.compile(g.children[0],P)),g.children[1]&&(l+=this.compile(g.children[1],P));break;case"op_assign":P?(y=this.getLHSCompiler(g.children[0],P),Type.isArray(y)?l="$jc$.setProp("+y[0]+", "+y[1]+", "+this.compile(g.children[1],P)+`);
`:(this.isLocalVariable(y)!==this.scope&&(this.scope.locals[y]=!0),l="$jc$.scopes["+this.scope.id+"].locals['"+y+"'] = "+this.compile(g.children[1],P)+`;
`)):l=(y=this.compile(g.children[0]))+" = "+this.compile(g.children[1],P)+`;
`;break;case"op_if":l=" if ("+this.compile(g.children[0],P)+") "+this.compile(g.children[1],P);break;case"op_if_else":l=" if ("+this.compile(g.children[0],P)+")"+this.compile(g.children[1],P),l+=" else "+this.compile(g.children[2],P);break;case"op_conditional":l="(("+this.compile(g.children[0],P)+")?("+this.compile(g.children[1],P),l+="):("+this.compile(g.children[2],P)+"))";break;case"op_while":l=" while ("+this.compile(g.children[0],P)+`) {
`+this.compile(g.children[1],P)+`}
`;break;case"op_do":l=` do {
`+this.compile(g.children[0],P)+"} while ("+this.compile(g.children[1],P)+`);
`;break;case"op_for":l=" for ("+this.compile(g.children[0],P)+this.compile(g.children[1],P)+"; "+this.compile(g.children[2],P).slice(0,-2)+`) {
`+this.compile(g.children[3],P)+`
}
`;break;case"op_proplst":g.children[0]&&(l=this.compile(g.children[0],P)+", "),l+=this.compile(g.children[1],P);break;case"op_prop":l=g.children[0]+": "+this.compile(g.children[1],P);break;case"op_emptyobject":l=P?"{}":"<< >>";break;case"op_proplst_val":l=this.compile(g.children[0],P);break;case"op_array":for(m=[],v=0;v<g.children[0].length;v++)m.push(this.compile(g.children[0][v],P));l="["+m.join(", ")+"]";break;case"op_extvalue":l=this.compile(g.children[0],P)+"["+this.compile(g.children[1],P)+"]";break;case"op_return":l=" return "+this.compile(g.children[0],P)+`;
`;break;case"op_map":g.children[1].isMath||g.children[1].type==="node_var"||this._error("compile: In a map only function calls and mathematical expressions are allowed."),m=g.children[0],l=P?" $jc$.makeMap(function ("+m.join(", ")+") { return "+this.compile(g.children[1],P)+"; })":"map ("+m.join(", ")+") -> "+this.compile(g.children[1],P);break;case"op_function":m=g.children[0],this.pushScope(m),l=P?this.functionCodeJS(g):" function ("+m.join(", ")+") "+this.compile(g.children[1],P),this.popScope();break;case"op_execfunmath":console.log("op_execfunmath: TODO"),l="-1";break;case"op_execfun":if(g.children[2]){for(m=[],v=0;v<g.children[2].length;v++)m.push(this.compile(g.children[2][v],P));P&&(y="$jc$.mergeAttributes("+m.join(", ")+")")}for(g.children[0].withProps=!!g.children[2],m=[],v=0;v<g.children[1].length;v++)m.push(this.compile(g.children[1][v],P));l=this.compile(g.children[0],P)+"("+m.join(", ")+(g.children[2]&&P?", "+y:"")+")"+(g.children[2]&&!P?y:""),P&&(l+=`
`),P&&g.children[0].value==="$"&&(l="$jc$.board.objects["+this.compile(g.children[1][0],P)+"]");break;case"op_property":l=P&&g.children[1]!=="X"&&g.children[1]!=="Y"?"$jc$.resolveProperty("+this.compile(g.children[0],P)+", '"+g.children[1]+"', true)":this.compile(g.children[0],P)+"."+g.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),l=P?"$jc$.use('":"use('",l+=g.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),l=P?"$jc$.del(":"remove(",l+=this.compile(g.children[0],P)+")";break;case"op_eq":l="("+this.compile(g.children[0],P)+" === "+this.compile(g.children[1],P)+")";break;case"op_neq":l="("+this.compile(g.children[0],P)+" !== "+this.compile(g.children[1],P)+")";break;case"op_approx":l="("+this.compile(g.children[0],P)+" ~= "+this.compile(g.children[1],P)+")";break;case"op_gt":l=P?"$jc$.gt("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+" > "+this.compile(g.children[1],P)+")";break;case"op_lt":l=P?"$jc$.lt("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+" < "+this.compile(g.children[1],P)+")";break;case"op_geq":l=P?"$jc$.geq("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+" >= "+this.compile(g.children[1],P)+")";break;case"op_leq":l=P?"$jc$.leq("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+" <= "+this.compile(g.children[1],P)+")";break;case"op_or":l="("+this.compile(g.children[0],P)+" || "+this.compile(g.children[1],P)+")";break;case"op_and":l="("+this.compile(g.children[0],P)+" && "+this.compile(g.children[1],P)+")";break;case"op_not":l="!("+this.compile(g.children[0],P)+")";break;case"op_add":l=P?"$jc$.add("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+" + "+this.compile(g.children[1],P)+")";break;case"op_sub":l=P?"$jc$.sub("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+" - "+this.compile(g.children[1],P)+")";break;case"op_div":l=P?"$jc$.div("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+" / "+this.compile(g.children[1],P)+")";break;case"op_mod":l=P?"$jc$.mod("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+", true)":"("+this.compile(g.children[0],P)+" % "+this.compile(g.children[1],P)+")";break;case"op_mul":l=P?"$jc$.mul("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+" * "+this.compile(g.children[1],P)+")";break;case"op_exp":l=P?"$jc$.pow("+this.compile(g.children[0],P)+", "+this.compile(g.children[1],P)+")":"("+this.compile(g.children[0],P)+"^"+this.compile(g.children[1],P)+")";break;case"op_neg":l=P?"$jc$.neg("+this.compile(g.children[0],P)+")":"(-"+this.compile(g.children[0],P)+")"}break;case"node_var":l=P?this.getvarJS(g.value,!1,g.withProps):g.value;break;case"node_const":case"node_const_bool":l=g.value;break;case"node_str":l="'"+g.value+"'"}return g.needsBrackets&&(l=`{
`+l+`
}
`),l},getName:function(g,P){var y="";return Type.exists(g)&&Type.exists(g.getName)?(y=g.getName(),Type.exists(y)&&y!==""||!P||(y=g.id)):P&&(y=g.id),y},X:function(g){return g.X()},Y:function(g){return g.Y()},V:function(g){return g.Value()},L:function(g){return g.L()},area:function(g){return Type.exists(g)&&Type.exists(g.Area)||this._error("Error: Can't calculate area."),g.Area()},dist:function(g,P){return Type.exists(g)&&Type.exists(g.Dist)||this._error("Error: Can't calculate distance."),g.Dist(P)},radius:function(g){return Type.exists(g)&&Type.exists(g.Radius)||this._error("Error: Can't calculate radius."),g.Radius()},add:function(g,P){var y,v,m;if(g=Type.evalSlider(g),P=Type.evalSlider(P),Interval.isInterval(g)||Interval.isInterval(P))m=Interval.add(g,P);else if(Type.isArray(g)&&Type.isArray(P))for(v=Math.min(g.length,P.length),m=[],y=0;y<v;y++)m[y]=g[y]+P[y];else Type.isNumber(g)&&Type.isNumber(P)?m=g+P:Type.isString(g)||Type.isString(P)?m=g.toString()+P.toString():this._error("Operation + not defined on operands "+typeof g+" and "+typeof P);return m},sub:function(g,P){var y,v,m;if(g=Type.evalSlider(g),P=Type.evalSlider(P),Interval.isInterval(g)||Interval.isInterval(P))m=Interval.sub(g,P);else if(Type.isArray(g)&&Type.isArray(P))for(v=Math.min(g.length,P.length),m=[],y=0;y<v;y++)m[y]=g[y]-P[y];else Type.isNumber(g)&&Type.isNumber(P)?m=g-P:this._error("Operation - not defined on operands "+typeof g+" and "+typeof P);return m},neg:function(g){var P,y,v;if(g=Type.evalSlider(g),Interval.isInterval(g))v=Interval.negative(g);else if(Type.isArray(g))for(y=g.length,v=[],P=0;P<y;P++)v[P]=-g[P];else Type.isNumber(g)?v=-g:this._error("Unary operation - not defined on operand "+typeof g);return v},mul:function(g,P){var y,v,m;if(g=Type.evalSlider(g),P=Type.evalSlider(P),Type.isArray(g)&&Type.isNumber(P)&&(y=g,P=g=P),Interval.isInterval(g)||Interval.isInterval(P))m=Interval.mul(g,P);else if(Type.isArray(g)&&Type.isArray(P))v=Math.min(g.length,P.length),m=Mat.innerProduct(g,P,v);else if(Type.isNumber(g)&&Type.isArray(P))for(v=P.length,m=[],y=0;y<v;y++)m[y]=g*P[y];else Type.isNumber(g)&&Type.isNumber(P)?m=g*P:this._error("Operation * not defined on operands "+typeof g+" and "+typeof P);return m},div:function(g,P){var y,v,m;if(g=Type.evalSlider(g),P=Type.evalSlider(P),Interval.isInterval(g)||Interval.isInterval(P))m=Interval.div(g,P);else if(Type.isArray(g)&&Type.isNumber(P))for(v=g.length,m=[],y=0;y<v;y++)m[y]=g[y]/P;else Type.isNumber(g)&&Type.isNumber(P)?m=g/P:this._error("Operation * not defined on operands "+typeof g+" and "+typeof P);return m},mod:function(g,P){var y,v,m;if(g=Type.evalSlider(g),P=Type.evalSlider(P),Interval.isInterval(g)||Interval.isInterval(P))return Interval.fmod(g,P);if(Type.isArray(g)&&Type.isNumber(P))for(v=g.length,m=[],y=0;y<v;y++)m[y]=Mat.mod(g[y],P,!0);else Type.isNumber(g)&&Type.isNumber(P)?m=Mat.mod(g,P,!0):this._error("Operation * not defined on operands "+typeof g+" and "+typeof P);return m},pow:function(g,P){return g=Type.evalSlider(g),P=Type.evalSlider(P),Interval.isInterval(g)||Interval.isInterval(P)?Interval.pow(g,P):Mat.pow(g,P)},lt:function(g,P){return Interval.isInterval(g)||Interval.isInterval(P)?Interval.lt(g,P):g<P},leq:function(g,P){return Interval.isInterval(g)||Interval.isInterval(P)?Interval.leq(g,P):g<=P},gt:function(g,P){return Interval.isInterval(g)||Interval.isInterval(P)?Interval.gt(g,P):g>P},geq:function(g,P){return Interval.isInterval(g)||Interval.isInterval(P)?Intervalt.geq(g,P):g>=P},randint:function(g,P,y){return Type.exists(y)||(y=1),Math.round(Math.random()*(P-g)/y)*y+g},DDD:function(g){console.log("Dummy derivative function. This should never appear!")},ifthen:function(g,P,y){return g?P:y},del:function(g){typeof g=="object"&&JXG.exists(g.type)&&JXG.exists(g.elementClass)&&this.board.removeObject(g)},use:function(g){var P,y,v=!1;if(typeof g=="string"){for(P in JXG.boards)if(JXG.boards.hasOwnProperty(P)&&JXG.boards[P].container===g){y=JXG.boards[P],v=!0;break}}else y=g,v=!0;v?(this.board=y,this.builtIn.$board=y,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+g+"' not found!")},findSymbol:function(g,P){var y,v;for(v=(P=Type.def(P,-1))===-1?this.scope:this.scopes[P];v!==null;){for(y in v.locals)if(v.locals.hasOwnProperty(y)&&v.locals[y]===g)return[y,v];v=v.previous}return[]},importModule:function(g){return priv.modules[g.toLowerCase()]},defineBuiltIn:function(){var g=this,P={PI:Math.PI,EULER:Math.E,D:g.DDD,X:g.X,Y:g.Y,V:g.V,L:g.L,acosh:Mat.acosh,acot:Mat.acot,asinh:Mat.asinh,binomial:Mat.binomial,cbrt:Mat.cbrt,cosh:Mat.cosh,cot:Mat.cot,deg:Geometry.trueAngle,A:g.area,area:g.area,dist:g.dist,R:g.radius,radius:g.radius,erf:Mat.erf,erfc:Mat.erfc,erfi:Mat.erfi,factorial:Mat.factorial,gcd:Mat.gcd,lb:Mat.log2,lcm:Mat.lcm,ld:Mat.log2,lg:Mat.log10,ln:Math.log,log:Mat.log,log10:Mat.log10,log2:Mat.log2,ndtr:Mat.ndtr,ndtri:Mat.ndtri,nthroot:Mat.nthroot,pow:Mat.pow,rad:Geometry.rad,ratpow:Mat.ratpow,trunc:Type.trunc,sinh:Mat.sinh,randint:g.randint,IfThen:g.ifthen,import:g.importModule,use:g.use,remove:g.del,$:g.getElementById,getName:g.getName,name:g.getName,$board:g.board,$log:g.log};return P.rad.sc=Geometry,P.deg.sc=Geometry,P.factorial.sc=Mat,P.X.src="$jc$.X",P.Y.src="$jc$.Y",P.V.src="$jc$.V",P.L.src="$jc$.L",P.acosh.src="JXG.Math.acosh",P.acot.src="JXG.Math.acot",P.asinh.src="JXG.Math.asinh",P.binomial.src="JXG.Math.binomial",P.cbrt.src="JXG.Math.cbrt",P.cot.src="JXG.Math.cot",P.cosh.src="JXG.Math.cosh",P.deg.src="JXG.Math.Geometry.trueAngle",P.erf.src="JXG.Math.erf",P.erfc.src="JXG.Math.erfc",P.erfi.src="JXG.Math.erfi",P.A.src="$jc$.area",P.area.src="$jc$.area",P.dist.src="$jc$.dist",P.R.src="$jc$.radius",P.radius.src="$jc$.radius",P.factorial.src="JXG.Math.factorial",P.gcd.src="JXG.Math.gcd",P.lb.src="JXG.Math.log2",P.lcm.src="JXG.Math.lcm",P.ld.src="JXG.Math.log2",P.lg.src="JXG.Math.log10",P.ln.src="Math.log",P.log.src="JXG.Math.log",P.log10.src="JXG.Math.log10",P.log2.src="JXG.Math.log2",P.ndtr.src="JXG.Math.ndtr",P.ndtri.src="JXG.Math.ndtri",P.nthroot.src="JXG.Math.nthroot",P.pow.src="JXG.Math.pow",P.rad.src="JXG.Math.Geometry.rad",P.ratpow.src="JXG.Math.ratpow",P.trunc.src="JXG.trunc",P.sinh.src="JXG.Math.sinh",P.randint.src="$jc$.randint",P.import.src="$jc$.importModule",P.use.src="$jc$.use",P.remove.src="$jc$.del",P.IfThen.src="$jc$.ifthen",P.$.src="(function (n) { return $jc$.board.select(n); })",P.getName.src="$jc$.getName",P.name.src="$jc$.getName",P.$board&&(P.$board.src="$jc$.board"),P.$log.src="$jc$.log",P},getPossibleOperands:function(){var g,P,y,v,m,l,c,h,e,o,t,s,a,d,u=["E"],n=this.defineBuiltIn(),p=Math;for(a=function(f,b){return f.toLowerCase().localeCompare(b.toLowerCase())},d=function(f,b){var C=null;if(b==="jc")C=n[f];else{if(b!=="Math")return;C=p[f]}if(!u.includes(f))return JXG.isFunction(C)?{name:f,type:"function",numParams:C.length,origin:b}:JXG.isNumber(C)?{name:f,type:"constant",value:C,origin:b}:void(C!==void 0&&console.error("undefined type",C))},g=Object.getOwnPropertyNames(n).sort(a),P=Object.getOwnPropertyNames(p).sort(a),y=[],v=0,m=0;v<g.length||m<P.length;)g[v]===P[m]?(l=d(P[m],"Math"),JXG.exists(l)&&y.push(l),v++,m++):!JXG.exists(P[m])||g[v].toLowerCase().localeCompare(P[m].toLowerCase())<0?(l=d(g[v],"jc"),JXG.exists(l)&&y.push(l),v++):(l=d(P[m],"Math"),JXG.exists(l)&&y.push(l),m++);for(e=[],o=[],t=[],s={},c=y.length,v=0;v<c;v++){switch((h=y[v]).type){case"function":e.push(h.name),h.origin==="jc"&&o.push(h.name);break;case"constant":t.push(h.name)}s[h.name]=h}return{all:s,list:y,functions:e,functions_jessiecode:o,constants:t}},_debug:function(g){typeof console=="object"?console.log(g):Env.isBrowser&&document&&document.getElementById("debug")!==null&&(document.getElementById("debug").innerHTML+=g+"<br />")},_error:function(g){var P=new Error("Error("+this.line+"): "+g);throw P.line=this.line,P},_warn:function(g){typeof console=="object"?console.log("Warning("+this.line+"): "+g):Env.isBrowser&&document&&document.getElementById(this.warnLog)!==null&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+g+"<br />")},_log:function(g){typeof window!="object"&&typeof self=="object"&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+g.toString()}):console.log("Log: ",arguments)}});var parser=function(){var g=function(pe,$,ie,ae){for(ie=ie||{},ae=pe.length;ae--;ie[pe[ae]]=$);return ie},P=[2,14],y=[1,13],v=[1,37],m=[1,14],l=[1,15],c=[1,21],h=[1,16],e=[1,17],o=[1,33],t=[1,18],s=[1,19],a=[1,12],d=[1,59],u=[1,60],n=[1,58],p=[1,46],f=[1,48],b=[1,49],C=[1,50],_=[1,51],E=[1,52],x=[1,53],S=[1,54],O=[1,45],w=[1,38],T=[1,39],M=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],N=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],A=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],R=[2,48],L=[1,72],D=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],k=[1,78],B=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],I=[1,82],Y=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],q=[1,83],V=[1,84],W=[1,85],X=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],Q=[1,89],G=[1,90],F=[1,91],U=[1,92],z=[1,97],re=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],te=[1,103],le=[1,104],oe=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],he=[1,105],H=[1,106],ce=[1,107],de=[1,126],ne=[1,139],ge=[83,86],fe=[1,150],ye=[10,66,86],Ce=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],ue=[1,167],Pe=[10,86],Ee={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,5],[63,6],[92,1],[92,3]],performAction:function(pe,$,ie,ae,se,J,Z){var j=J.length-1;switch(se){case 1:return J[j-1];case 2:this.$=ee.createNode(K(Z[j-4]),"node_op","op_if",J[j-2],J[j]);break;case 3:this.$=ee.createNode(K(Z[j-6]),"node_op","op_if_else",J[j-4],J[j-2],J[j]);break;case 4:this.$=ee.createNode(K(Z[j-4]),"node_op","op_while",J[j-2],J[j]);break;case 5:this.$=ee.createNode(K(Z[j-8]),"node_op","op_for",J[j-6],J[j-4],J[j-2],J[j]);break;case 6:this.$=ee.createNode(K(Z[j-6]),"node_op","op_do",J[j-5],J[j-2]);break;case 7:this.$=ee.createNode(K(Z[j-1]),"node_op","op_use",J[j]);break;case 8:this.$=ee.createNode(K(Z[j-1]),"node_op","op_delete",J[j]);break;case 9:this.$=ee.createNode(K(Z[j-1]),"node_op","op_return",void 0);break;case 10:this.$=ee.createNode(K(Z[j-2]),"node_op","op_return",J[j-1]);break;case 11:case 14:this.$=ee.createNode(K(Z[j]),"node_op","op_none");break;case 12:this.$=J[j-1],this.$.needsBrackets=!0;break;case 13:this.$=ee.createNode(K(Z[j-1]),"node_op","op_none",J[j-1],J[j]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=J[j];break;case 22:case 65:case 93:this.$=J[j-1];break;case 25:this.$=ee.createNode(K(Z[j-2]),"node_op","op_assign",J[j-2],J[j]),this.$.isMath=!1;break;case 27:this.$=ee.createNode(K(Z[j-4]),"node_op","op_conditional",J[j-4],J[j-2],J[j]),this.$.isMath=!1;break;case 29:this.$=ee.createNode(K(Z[j-2]),"node_op","op_or",J[j-2],J[j]),this.$.isMath=!1;break;case 31:this.$=ee.createNode(K(Z[j-2]),"node_op","op_and",J[j-2],J[j]),this.$.isMath=!1;break;case 33:this.$=ee.createNode(K(Z[j-2]),"node_op","op_eq",J[j-2],J[j]),this.$.isMath=!1;break;case 34:this.$=ee.createNode(K(Z[j-2]),"node_op","op_neq",J[j-2],J[j]),this.$.isMath=!1;break;case 35:this.$=ee.createNode(K(Z[j-2]),"node_op","op_approx",J[j-2],J[j]),this.$.isMath=!1;break;case 37:this.$=ee.createNode(K(Z[j-2]),"node_op","op_lt",J[j-2],J[j]),this.$.isMath=!1;break;case 38:this.$=ee.createNode(K(Z[j-2]),"node_op","op_gt",J[j-2],J[j]),this.$.isMath=!1;break;case 39:this.$=ee.createNode(K(Z[j-2]),"node_op","op_leq",J[j-2],J[j]),this.$.isMath=!1;break;case 40:this.$=ee.createNode(K(Z[j-2]),"node_op","op_geq",J[j-2],J[j]),this.$.isMath=!1;break;case 42:this.$=ee.createNode(K(Z[j-2]),"node_op","op_add",J[j-2],J[j]),this.$.isMath=!0;break;case 43:this.$=ee.createNode(K(Z[j-2]),"node_op","op_sub",J[j-2],J[j]),this.$.isMath=!0;break;case 45:this.$=ee.createNode(K(Z[j-2]),"node_op","op_mul",J[j-2],J[j]),this.$.isMath=!0;break;case 46:this.$=ee.createNode(K(Z[j-2]),"node_op","op_div",J[j-2],J[j]),this.$.isMath=!0;break;case 47:this.$=ee.createNode(K(Z[j-2]),"node_op","op_mod",J[j-2],J[j]),this.$.isMath=!0;break;case 49:this.$=ee.createNode(K(Z[j-2]),"node_op","op_exp",J[j-2],J[j]),this.$.isMath=!0;break;case 51:this.$=ee.createNode(K(Z[j-1]),"node_op","op_not",J[j]),this.$.isMath=!1;break;case 53:this.$=ee.createNode(K(Z[j-1]),"node_op","op_neg",J[j]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=J[j],this.$.isMath=!1;break;case 59:case 91:this.$=ee.createNode(K(Z[j-2]),"node_op","op_property",J[j-2],J[j]),this.$.isMath=!0;break;case 60:case 90:this.$=ee.createNode(K(Z[j-3]),"node_op","op_extvalue",J[j-3],J[j-1]),this.$.isMath=!0;break;case 61:this.$=ee.createNode(K(Z[j]),"node_var",J[j]);break;case 69:this.$=J[j],this.$.isMath=!0;break;case 70:this.$=ee.createNode(K(Z[j]),"node_const",null);break;case 71:this.$=ee.createNode(K(Z[j]),"node_const_bool",!0);break;case 72:this.$=ee.createNode(K(Z[j]),"node_const_bool",!1);break;case 73:this.$=ee.createNode(K(Z[j]),"node_str",J[j].substring(1,J[j].length-1));break;case 74:this.$=ee.createNode(K(Z[j]),"node_const",parseFloat(J[j]));break;case 75:this.$=ee.createNode(K(Z[j]),"node_const",NaN);break;case 76:this.$=ee.createNode(K(Z[j]),"node_const",1/0);break;case 77:this.$=ee.createNode(K(Z[j-1]),"node_op","op_array",[]);break;case 78:this.$=ee.createNode(K(Z[j-2]),"node_op","op_array",J[j-1]);break;case 79:this.$=ee.createNode(K(Z[j-1]),"node_op","op_emptyobject",{}),this.$.needsBrackets=!0;break;case 80:this.$=ee.createNode(K(Z[j-2]),"node_op","op_proplst_val",J[j-1]),this.$.needsBrackets=!0;break;case 82:this.$=ee.createNode(K(Z[j-2]),"node_op","op_proplst",J[j-2],J[j]);break;case 83:this.$=ee.createNode(K(Z[j-2]),"node_op","op_prop",J[j-2],J[j]);break;case 87:case 89:this.$=ee.createNode(K(Z[j-1]),"node_op","op_execfun",J[j-1],J[j]),this.$.isMath=!0;break;case 88:this.$=ee.createNode(K(Z[j-2]),"node_op","op_execfun",J[j-2],J[j-1],J[j],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 104:this.$=[J[j]];break;case 95:case 99:case 105:this.$=J[j-2].concat(J[j]);break;case 96:this.$=ee.createNode(K(Z[j]),"node_var",J[j]),this.$.isMath=!0;break;case 100:this.$=ee.createNode(K(Z[j-3]),"node_op","op_function",[],J[j]),this.$.isMath=!1;break;case 101:this.$=ee.createNode(K(Z[j-4]),"node_op","op_function",J[j-2],J[j]),this.$.isMath=!1;break;case 102:this.$=ee.createNode(K(Z[j-4]),"node_op","op_map",[],J[j]);break;case 103:this.$=ee.createNode(K(Z[j-5]),"node_op","op_map",J[j-3],J[j])}},table:[g([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],P,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:y,8:v,9:20,11:4,13:7,14:m,15:l,16:c,17:h,18:8,19:e,20:o,21:t,22:9,23:s,24:11,25:5,26:a,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{1:[2,1]},g(M,[2,13]),g(N,[2,15]),g(N,[2,16]),g(N,[2,17]),g(N,[2,18]),g(N,[2,19]),g(N,[2,20]),g(N,[2,21]),g([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],P,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:y,8:v,9:20,11:65,13:7,14:m,15:l,16:c,17:h,18:8,19:e,20:o,21:t,22:9,23:s,24:11,25:5,26:a,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{20:[1,66]},{20:[1,67]},{8:v,9:69,16:[1,68],20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{16:[1,70]},g(N,[2,11]),g(A,[2,23]),g(A,[2,24]),g([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],R,{32:[1,71],57:L}),g([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),g(D,[2,54],{88:77,8:k,64:[1,75],65:[1,76]}),g(D,[2,55],{88:79,8:k,64:[1,81],65:[1,80]}),g(B,[2,28],{39:I}),g(A,[2,56]),g(A,[2,57]),g(A,[2,58]),g(Y,[2,30],{41:q,42:V,43:W}),g(A,[2,61]),g(A,[2,62]),g(A,[2,63]),g(A,[2,64]),{8:v,9:86,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:[1,87]},{8:[1,88]},g(X,[2,32],{45:Q,46:G,47:F,48:U}),g(A,[2,66]),g(A,[2,67]),g(A,[2,68]),g(A,[2,69]),{20:z,72:98,73:99,77:_,78:E,79:x,80:S,83:[1,93],84:94,85:95,87:96},{8:v,20:o,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,81:101,82:O,91:w,93:T},g(re,[2,36],{50:te,51:le}),g(A,[2,70]),g(A,[2,71]),g(A,[2,72]),g(A,[2,73]),g(A,[2,74]),g(A,[2,75]),g(A,[2,76]),g(oe,[2,41],{53:he,54:H,55:ce}),g(A,[2,44]),g(A,[2,50]),{8:v,20:o,31:109,50:d,51:u,52:108,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,50:d,51:u,52:110,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,50:d,51:u,52:111,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{6:6,7:y,8:v,9:20,11:4,13:7,14:m,15:l,16:c,17:h,18:8,19:e,20:o,21:t,22:9,23:s,24:11,25:5,26:a,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,9:113,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,9:114,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,9:115,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{14:[1,116]},g(N,[2,7]),g(N,[2,8]),g(N,[2,9]),{16:[1,117]},g(N,[2,22]),{8:v,20:o,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,50:d,51:u,52:119,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,36:121,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{20:[1,122]},{8:v,9:123,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},g(A,[2,87],{89:124,90:125,68:127,20:de,82:O}),{8:v,10:[1,128],20:o,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,81:129,82:O,91:w,93:T},g(A,[2,89]),{8:v,9:130,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{20:[1,131]},{8:v,20:o,31:109,38:132,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,40:133,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,40:134,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,40:135,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{10:[1,136]},{10:[1,137],20:ne,92:138},{10:[1,140],20:ne,92:141},{8:v,20:o,31:109,44:142,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,44:143,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,44:144,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,44:145,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},g(A,[2,79]),{83:[1,146],86:[1,147]},g(ge,[2,81]),{35:[1,148]},{35:[2,84]},{35:[2,85]},{35:[2,86]},g(A,[2,77]),{66:[1,149],86:fe},g(ye,[2,98]),{8:v,20:o,31:109,49:151,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,49:152,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,50:d,51:u,52:153,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,50:d,51:u,52:154,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,31:109,50:d,51:u,52:155,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},g(A,[2,51]),g([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],R,{57:L}),g(A,[2,52]),g(A,[2,53]),g([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,156]},{10:[1,157]},{16:[1,158]},{8:[1,159]},g(N,[2,10]),g(A,[2,25]),g(A,[2,49]),{35:[1,160]},g(B,[2,29],{39:I}),g(A,[2,59]),{66:[1,161]},g([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,162]}),g(A,[2,94]),g(A,[2,96]),g(A,[2,97]),g(Ce,[2,92]),{10:[1,163],86:fe},{66:[1,164]},g(A,[2,91]),g(Y,[2,31],{41:q,42:V,43:W}),g(X,[2,33],{45:Q,46:G,47:F,48:U}),g(X,[2,34],{45:Q,46:G,47:F,48:U}),g(X,[2,35],{45:Q,46:G,47:F,48:U}),g(A,[2,65]),{25:165,26:a},{10:[1,166],86:ue},g(Pe,[2,104]),{94:[1,168]},{10:[1,169],86:ue},g(re,[2,37],{50:te,51:le}),g(re,[2,38],{50:te,51:le}),g(re,[2,39],{50:te,51:le}),g(re,[2,40],{50:te,51:le}),g(A,[2,80]),{20:z,72:98,73:99,77:_,78:E,79:x,80:S,85:170,87:96},{8:v,20:o,29:171,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},g(A,[2,78]),{8:v,20:o,29:172,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},g(oe,[2,42],{53:he,54:H,55:ce}),g(oe,[2,43],{53:he,54:H,55:ce}),g(A,[2,45]),g(A,[2,46]),g(A,[2,47]),{6:6,7:y,8:v,9:20,11:173,13:7,14:m,15:l,16:c,17:h,18:8,19:e,20:o,21:t,22:9,23:s,24:11,25:5,26:a,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{6:6,7:y,8:v,9:20,11:174,13:7,14:m,15:l,16:c,17:h,18:8,19:e,20:o,21:t,22:9,23:s,24:11,25:5,26:a,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,9:175,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,9:176,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,20:o,29:177,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},g(A,[2,60]),{20:de,68:127,82:O,90:178},g(Ce,[2,93]),g(A,[2,90]),g(A,[2,100]),{25:179,26:a},{20:[1,180]},{8:v,9:181,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{94:[1,182]},g(ge,[2,82]),g(ge,[2,83]),g(ye,[2,99]),g(M,[2,2],{12:[1,183]}),g(N,[2,4]),{16:[1,184]},{10:[1,185]},g(A,[2,27]),g(A,[2,95]),g(A,[2,101]),g(Pe,[2,105]),g(A,[2,102]),{8:v,9:186,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{6:6,7:y,8:v,9:20,11:187,13:7,14:m,15:l,16:c,17:h,18:8,19:e,20:o,21:t,22:9,23:s,24:11,25:5,26:a,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{8:v,9:188,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},{16:[1,189]},g(A,[2,103]),g(N,[2,3]),{10:[1,190]},g(N,[2,6]),{6:6,7:y,8:v,9:20,11:191,13:7,14:m,15:l,16:c,17:h,18:8,19:e,20:o,21:t,22:9,23:s,24:11,25:5,26:a,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:d,51:u,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:b,76:C,77:_,78:E,79:x,80:S,82:O,91:w,93:T},g(N,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(pe,$){if(!$.recoverable){var ie=new Error(pe);throw ie.hash=$,ie}this.trace(pe)},parse:function(pe){var $=this,ie=[0],ae=[null],se=[],J=this.table,Z="",j=0,De=0,Xe=0,Fe=2,Be=1,Ue=se.slice.call(arguments,1),me=Object.create(this.lexer),xe={yy:{}};for(var Re in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Re)&&(xe.yy[Re]=this.yy[Re]);me.setInput(pe,xe.yy),xe.yy.lexer=me,xe.yy.parser=this,me.yylloc===void 0&&(me.yylloc={});var Le=me.yylloc;se.push(Le);var Je=me.options&&me.options.ranges;typeof xe.yy.parseError=="function"?this.parseError=xe.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var be,ke,Se,ve,Ie,Ne,_e,Ye,Me,Ge=function(){var Te;return typeof(Te=me.lex()||Be)!="number"&&(Te=$.symbols_[Te]||Te),Te},we={};;){if(Se=ie[ie.length-1],this.defaultActions[Se]?ve=this.defaultActions[Se]:(be==null&&(be=Ge()),ve=J[Se]&&J[Se][be]),ve===void 0||!ve.length||!ve[0]){var je="";for(Ne in Me=[],J[Se])this.terminals_[Ne]&&Ne>Fe&&Me.push("'"+this.terminals_[Ne]+"'");je=me.showPosition?"Parse error on line "+(j+1)+`:
`+me.showPosition()+`
Expecting `+Me.join(", ")+", got '"+(this.terminals_[be]||be)+"'":"Parse error on line "+(j+1)+": Unexpected "+(be==Be?"end of input":"'"+(this.terminals_[be]||be)+"'"),this.parseError(je,{text:me.match,token:this.terminals_[be]||be,line:me.yylineno,loc:Le,expected:Me})}if(ve[0]instanceof Array&&ve.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Se+", token: "+be);switch(ve[0]){case 1:ie.push(be),ae.push(me.yytext),se.push(me.yylloc),ie.push(ve[1]),be=null,ke?(be=ke,ke=null):(De=me.yyleng,Z=me.yytext,j=me.yylineno,Le=me.yylloc,Xe>0);break;case 2:if(_e=this.productions_[ve[1]][1],we.$=ae[ae.length-_e],we._$={first_line:se[se.length-(_e||1)].first_line,last_line:se[se.length-1].last_line,first_column:se[se.length-(_e||1)].first_column,last_column:se[se.length-1].last_column},Je&&(we._$.range=[se[se.length-(_e||1)].range[0],se[se.length-1].range[1]]),(Ie=this.performAction.apply(we,[Z,De,j,xe.yy,ve[1],ae,se].concat(Ue)))!==void 0)return Ie;_e&&(ie=ie.slice(0,-1*_e*2),ae=ae.slice(0,-1*_e),se=se.slice(0,-1*_e)),ie.push(this.productions_[ve[1]][0]),ae.push(we.$),se.push(we._$),Ye=J[ie[ie.length-2]][ie[ie.length-1]],ie.push(Ye);break;case 3:return!0}}return!0}},ee={node:function(pe,$,ie){return{type:pe,value:$,children:ie}},createNode:function(pe,$,ie,ae){var se,J=this.node($,ie,[]);for(se=3;se<arguments.length;se++)J.children.push(arguments[se]);return J.line=pe[0],J.col=pe[1],J.eline=pe[2],J.ecol=pe[3],J}},K=function(pe){return[pe.first_line,pe.first_column,pe.last_line,pe.last_column]},Ae=function(){var pe={EOF:1,parseError:function($,ie){if(!this.yy.parser)throw new Error($);this.yy.parser.parseError($,ie)},setInput:function($,ie){return this.yy=ie||this.yy||{},this._input=$,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var $=this._input[0];return this.yytext+=$,this.yyleng++,this.offset++,this.match+=$,this.matched+=$,$.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),$},unput:function($){var ie=$.length,ae=$.split(/(?:\r\n?|\n)/g);this._input=$+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-ie),this.offset-=ie;var se=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),ae.length-1&&(this.yylineno-=ae.length-1);var J=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ae?(ae.length===se.length?this.yylloc.first_column:0)+se[se.length-ae.length].length-ae[0].length:this.yylloc.first_column-ie},this.options.ranges&&(this.yylloc.range=[J[0],J[0]+this.yyleng-ie]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function($){this.unput(this.match.slice($))},pastInput:function(){var $=this.matched.substr(0,this.matched.length-this.match.length);return($.length>20?"...":"")+$.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var $=this.match;return $.length<20&&($+=this._input.substr(0,20-$.length)),($.substr(0,20)+($.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var $=this.pastInput(),ie=new Array($.length+1).join("-");return $+this.upcomingInput()+`
`+ie+"^"},test_match:function($,ie){var ae,se,J;if(this.options.backtrack_lexer&&(J={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(J.yylloc.range=this.yylloc.range.slice(0))),(se=$[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=se.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:se?se[se.length-1].length-se[se.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+$[0].length},this.yytext+=$[0],this.match+=$[0],this.matches=$,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice($[0].length),this.matched+=$[0],ae=this.performAction.call(this,this.yy,this,ie,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),ae)return ae;if(this._backtrack){for(var Z in J)this[Z]=J[Z];return!1}return!1},next:function(){if(this.done)return this.EOF;var $,ie,ae,se;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var J=this._currentRules(),Z=0;Z<J.length;Z++)if((ae=this._input.match(this.rules[J[Z]]))&&(!ie||ae[0].length>ie[0].length)){if(ie=ae,se=Z,this.options.backtrack_lexer){if(($=this.test_match(ae,J[Z]))!==!1)return $;if(this._backtrack){ie=!1;continue}return!1}if(!this.options.flex)break}return ie?($=this.test_match(ie,J[se]))!==!1&&$:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var $=this.next();return $||this.lex()},begin:function($){this.conditionStack.push($)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function($){return($=this.conditionStack.length-1-Math.abs($||0))>=0?this.conditionStack[$]:"INITIAL"},pushState:function($){this.begin($)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function($,ie,ae,se){switch(ae){case 0:case 5:case 6:break;case 1:case 2:return 78;case 3:case 4:return 77;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:case 22:return 94;case 23:return 82;case 24:return 83;case 25:return 26;case 26:return 27;case 27:return 16;case 28:return"#";case 29:return 34;case 30:return 35;case 31:return 79;case 32:return 64;case 33:return 65;case 34:return 66;case 35:return 8;case 36:return 10;case 37:return 58;case 38:return 57;case 39:return 53;case 40:return 54;case 41:return 55;case 42:return 50;case 43:return 51;case 44:return 47;case 45:return 45;case 46:return 48;case 47:return 46;case 48:return 41;case 49:return 43;case 50:return 42;case 51:return 39;case 52:return 37;case 53:return 32;case 54:return 86;case 55:return 5;case 56:return 20;case 57:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:=>)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],inclusive:!0}}};return pe}();function Oe(){this.yy={}}return Ee.lexer=Ae,Oe.prototype=Ee,Ee.Parser=Oe,new Oe}();return require!==void 0&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(g){g[1]||(console.log("Usage: "+g[0]+" FILE"),process.exit(1));var P=require("fs").readFileSync(require("path").normalize(g[1]),"utf8");return exports.parser.parse(P)},require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode}),define("base/composition",["jxg","utils/type"],function(g,P){return g.Composition=function(y){var v,m=this,l=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"],c=function(h){return function(){var e;for(e in m.elements)m.elements.hasOwnProperty(e)&&P.exists(m.elements[e][h])&&m.elements[e][h].apply(m.elements[e],arguments);return m}};for(v=0;v<l.length;v++)this[l[v]]=c(l[v]);for(v in this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"},y)y.hasOwnProperty(v)&&this.add(v,y[v]);this.dump=!0,this.subs={}},g.extend(g.Composition.prototype,{add:function(y,v){return!(P.exists(this[y])||!P.exists(v))&&(P.exists(v.id)?this.elements[v.id]=v:this.elements[y]=v,P.exists(v.name)&&(this.elementsByName[v.name]=v),v.on("attribute:name",this.nameListener,this),this.objectsList.push(v),this[y]=v,this.methodMap[y]=v,!0)},remove:function(y){var v,m=!1;for(v in this.elements)if(this.elements.hasOwnProperty(v)&&this.elements[v].id===this[y].id){m=!0;break}return m&&(delete this.elements[this[y].id],delete this[y]),m},nameListener:function(y,v,m){delete this.elementsByName[y],this.elementsByName[v]=m},select:function(y){return P.exists(g.Board)?g.Board.prototype.select.call(this,y):new g.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var y,v={};for(y in this.subs)this.subs.hasOwnProperty(y)&&(v[y]=this.subs[y].visProp);return this.attr}}),g.Composition}),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","utils/color","utils/type","utils/event","utils/env","base/composition"],function(g,P,y,v,m,l,c,h,e,o,t,s,a,d,u){return g.Board=function(n,p,f,b,C,_,E,x,S,O,w){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_MODE_ZOOM=17,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,s.exists(w.document)&&w.document!==!1?this.document=w.document:document!==void 0&&s.isObject(document)&&(this.document=document),this.container=n,this.containerObj=d.isBrowser?this.document.getElementById(this.container):null,d.isBrowser&&p.type!=="no"&&this.containerObj===null)throw new Error(`
JSXGraph: HTML container element '`+n+"' not found.");this.renderer=p,this.grids=[],this.options=s.deepCopy(v),this.attr=w,this.dimension=2,this.jc=new o,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,b[0],b[1]],this.zoomX=C,this.zoomY=_,this.unitX=E*this.zoomX,this.unitY=x*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=S,this.canvasHeight=O,s.exists(f)&&f!==""&&d.isBrowser&&!s.exists(this.document.getElementById(f))?this.id=f:this.id=this.generateId(),a.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.touchMoveLast=0,this.touchMoveLastId=1/0,this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(P.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._inputDevice="mouse",this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this._isScrolling=!1,this._isResizing=!1,this.selectingBox=[[0,0],[0,0]],this.mathLib=Math,this.mathLibJXG=g.Math,this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},g.extend(g.Board.prototype,{generateName:function(n){var p,f,b=this.attr.maxnamelength,C="",_="",E=[],x="";if(n.type===P.OBJECT_TYPE_TICKS)return"";for(p=s.isPoint(n)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:n.type===P.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],s.isPoint(n)||n.elementClass===P.OBJECT_CLASS_LINE||n.type===P.OBJECT_TYPE_ANGLE||(C=n.type===P.OBJECT_TYPE_POLYGON?"P_{":n.elementClass===P.OBJECT_CLASS_CIRCLE?"k_{":n.elementClass===P.OBJECT_CLASS_TEXT?"t_{":"s_{",_="}"),f=0;f<b;f++)E[f]=0;for(;E[b-1]<p.length;){for(E[0]=1;E[0]<p.length;E[0]++){for(x=C,f=b;f>0;f--)x+=p[E[f-1]];if(!s.exists(this.elementsByName[x+_]))return x+_}for(E[0]=p.length,f=1;f<b;f++)E[f-1]===p.length&&(E[f-1]=1,E[f]+=1)}return""},generateId:function(){for(var n=1;s.exists(g.boards["jxgBoard"+n]);)n=Math.round(65535*Math.random());return"jxgBoard"+n},setId:function(n,p){var f,b=this.numObjects,C=n.id;if(this.numObjects+=1,C===""||!s.exists(C))for(C=this.id+p+b;s.exists(this.objects[C]);)f=Math.round(65535*Math.random()),C=this.id+p+b+"-"+f;return n.id=C,this.objects[C]=n,n._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=n,C},finalizeAdding:function(n){s.evaluate(n.visProp.visible)===!1&&this.renderer.display(n,!1)},finalizeLabel:function(n){n.hasLabel&&!s.evaluate(n.label.visProp.islabel)&&s.evaluate(n.label.visProp.visible)===!1&&this.renderer.display(n.label,!1)},checkFrameRate:function(n){var p=!1,f=new Date().getTime();return s.exists(n.pointerId)&&this.touchMoveLastId!==n.pointerId&&(p=!0,this.touchMoveLastId=n.pointerId),!p&&(f-this.touchMoveLast)*this.attr.maxframerate>=1e3&&(p=!0),p&&(this.touchMoveLast=f),p},getCoordsTopLeftCorner:function(){var n,p,f,b,C,_=this.document.documentElement||this.document.body.parentNode,E=this.document.body,x=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||new Date().getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=new Date().getTime(),x.getBoundingClientRect){for(f=x.getBoundingClientRect(),b=1,C=x;C&&s.exists(C.parentNode);)s.exists(C.style)&&s.exists(C.style.zoom)&&C.style.zoom!==""&&(b*=parseFloat(C.style.zoom)),C=C.parentNode;return(n=[f.left*b,f.top*b])[0]+=d.getProp(x,"border-left-width"),n[1]+=d.getProp(x,"border-top-width"),this.renderer.type!=="vml"&&(n[0]+=d.getProp(x,"padding-left"),n[1]+=d.getProp(x,"padding-top")),this.cPos=n.slice(),this.cPos}return n=d.getOffset(x),p=this.document.documentElement.ownerDocument,!this.containerObj.currentStyle&&p.defaultView&&(n[0]+=d.getProp(_,"margin-left"),n[1]+=d.getProp(_,"margin-top"),n[0]+=d.getProp(_,"border-left-width"),n[1]+=d.getProp(_,"border-top-width"),n[0]+=d.getProp(_,"padding-left"),n[1]+=d.getProp(_,"padding-top")),E&&(n[0]+=d.getProp(E,"left"),n[1]+=d.getProp(E,"top")),typeof google=="object"&&google.translate&&(n[0]+=10,n[1]+=25),n[0]+=d.getProp(x,"border-left-width"),n[1]+=d.getProp(x,"border-top-width"),this.renderer.type!=="vml"&&(n[0]+=d.getProp(x,"padding-left"),n[1]+=d.getProp(x,"padding-top")),n[0]+=this.attr.offsetx,n[1]+=this.attr.offsety,this.cPos=n.slice(),this.cPos},getMousePosition:function(n,p){var f,b,C=this.getCoordsTopLeftCorner();return f=d.getPosition(n,p,this.document),s.exists(this.cssTransMat)||this.updateCSSTransforms(),b=[1,f[0]-C[0],f[1]-C[1]],(b=l.matVecMult(this.cssTransMat,b))[1]/=b[0],b[2]/=b[0],[b[1],b[2]]},initMoveOrigin:function(n,p){this.drag_dx=n-this.origin.scrCoords[1],this.drag_dy=p-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(n,p,f,b){var C,_,E,x=[],S=[],O=this.objectsList.length,w={visProp:{layer:-1e4}};for(_=0;_<O;_++)E=(C=this.objectsList[_]).hasPoint&&C.hasPoint(n,p),C.visPropCalc.visible&&E&&(C.triggerEventHandlers([b+"down","down"],[f]),this.downObjects.push(C)),E&&C.isDraggable&&C.visPropCalc.visible&&(this.geonextCompatibilityMode&&(s.isPoint(C)||C.elementClass===P.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&!s.evaluate(C.visProp.fixed)&&(C.visProp.layer>w.visProp.layer||C.visProp.layer===w.visProp.layer&&C.lastDragTime.getTime()>=w.lastDragTime.getTime())&&(this.attr.ignorelabels&&s.exists(w.label)&&C===w.label||(w=C,x.push(w),s.exists(w.coords)?S.push(e.subtract(w.coords.scrCoords.slice(1),[n,p])):S.push([0,0])));return this.attr.drag.enabled&&x.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(x.length=1,this._drag_offset=S[0]):(x=x.slice(-1),this._drag_offset=S[S.length-1]),this._drag_offset||(this._drag_offset=[0,0]),this.renderer.type==="svg"&&s.exists(x[0])&&s.evaluate(x[0].visProp.dragtotopoflayer)&&x.length===1&&s.exists(x[0].rendNode)&&x[0].rendNode.parentNode.appendChild(x[0].rendNode),this.previousRotation=0,this.previousScale=1,x.length>=1&&(x[0].highlight(!0),this.triggerEventHandlers(["mousehit","hit"],[f,x[0]])),x},moveObject:function(n,p,f,b,C){var _,E,x,S=new y(P.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(n,p),this);f&&f.obj&&((_=f.obj).coords&&(E=_.coords.scrCoords.slice()),this.drag_position=[S.scrCoords[1],S.scrCoords[2]],this.drag_position=e.add(this.drag_position,this._drag_offset),s.exists(_.coords)?_.setPositionDirectly(P.COORDS_BY_SCREEN,this.drag_position):(this.displayInfobox(!1),isNaN(f.targets[0].Xprev+f.targets[0].Yprev)||_.setPositionDirectly(P.COORDS_BY_SCREEN,[S.scrCoords[1],S.scrCoords[2]],[f.targets[0].Xprev,f.targets[0].Yprev]),f.targets[0].Xprev=S.scrCoords[1],f.targets[0].Yprev=S.scrCoords[2]),s.exists(_.coords)&&(_.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(_),_.prepareUpdate().update(!0).updateRenderer()),_.coords&&(x=_.coords.scrCoords),_.coords&&E[1]===x[1]&&E[2]===x[2]||(_.triggerEventHandlers([C+"drag","drag"],[b]),this.update()),_.highlight(!0),this.triggerEventHandlers(["mousehit","hit"],[b,_]),_.lastDragTime=new Date)},twoFingerMove:function(n,p,f){var b;s.exists(n)&&s.exists(n.obj)&&((b=n.obj).elementClass===P.OBJECT_CLASS_LINE||b.type===P.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(n.targets,b,p):b.elementClass===P.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(n.targets,b,p),f&&b.triggerEventHandlers(["touchdrag","drag"],[f]))},twoFingerTouchObject:function(n,p,f){var b,C,_,E,x,S,O,w,T,M,N,A,R,L,D,k,B;if(s.exists(n[0])&&s.exists(n[1])&&!isNaN(n[0].Xprev+n[0].Yprev+n[1].Xprev+n[1].Yprev)){if(f===n[0].num?(D=n[1],k=n[0]):(D=n[0],k=n[1]),B=new y(P.COORDS_BY_SCREEN,[D.Xprev,D.Yprev],this).usrCoords,C=new y(P.COORDS_BY_SCREEN,[k.Xprev,k.Yprev],this).usrCoords,b=new y(P.COORDS_BY_SCREEN,[k.X,k.Y],this).usrCoords,E=l.crossProduct(B,C),_=l.crossProduct(B,b),O=l.crossProduct(E,_),Math.abs(O[0])<l.eps)return;if(S=c.rad(C.slice(1),B.slice(1),b.slice(1)),(w=this.create("transform",[S,[B[1],B[2]]],{type:"rotate"})).update(),s.evaluate(p.visProp.scalable)&&(x=c.distance(b,B)/c.distance(C,B),T=this.create("transform",[-B[1],-B[2]],{type:"translate"}),M=this.create("transform",[x,x],{type:"scale"}),N=this.create("transform",[B[1],B[2]],{type:"translate"}),w.melt(T).melt(M).melt(N)),p.elementClass===P.OBJECT_CLASS_LINE)A=[],p.point1.draggable()&&A.push(p.point1),p.point2.draggable()&&A.push(p.point2),w.applyOnce(A);else if(p.type===P.OBJECT_TYPE_POLYGON){for(A=[],L=p.vertices.length-1,R=0;R<L;++R)p.vertices[R].draggable()&&A.push(p.vertices[R]);w.applyOnce(A)}this.update(),p.highlight(!0)}},twoFingerTouchCircle:function(n,p,f){var b,C,_,E,x,S,O,w,T,M,N;p.method!=="pointCircle"&&p.method!=="pointLine"&&s.exists(n[0])&&s.exists(n[1])&&!isNaN(n[0].Xprev+n[0].Yprev+n[1].Xprev+n[1].Yprev)&&(f===n[0].num?(b=n[1],C=n[0]):(b=n[0],C=n[1]),x=new y(P.COORDS_BY_SCREEN,[b.Xprev,b.Yprev],this).usrCoords,E=new y(P.COORDS_BY_SCREEN,[C.Xprev,C.Yprev],this).usrCoords,_=new y(P.COORDS_BY_SCREEN,[C.X,C.Y],this).usrCoords,O=c.rad(E.slice(1),x.slice(1),_.slice(1)),w=this.create("transform",[-x[1],-x[2]],{type:"translate"}),T=this.create("transform",[O],{type:"rotate"}),w.melt(T),s.evaluate(p.visProp.scalable)&&(S=c.distance(x,_)/c.distance(x,E),M=this.create("transform",[S,S],{type:"scale"}),w.melt(M)),N=this.create("transform",[x[1],x[2]],{type:"translate"}),w.melt(N),p.center.draggable()&&w.applyOnce([p.center]),p.method==="twoPoints"?p.point2.draggable()&&w.applyOnce([p.point2]):p.method==="pointRadius"&&s.isNumber(p.updateRadius.origin)&&p.setRadius(p.radius*S),this.update(p.center),p.highlight(!0))},highlightElements:function(n,p,f,b){var C,_,E,x={},S=this.objectsList.length;for(C=0;C<S;C++)E=(_=this.objectsList[C]).id,s.exists(_.hasPoint)&&_.visPropCalc.visible&&_.hasPoint(n,p)&&(this.updateInfobox(_),s.exists(this.highlightedObjects[E])||(x[E]=_,_.highlight(),this.triggerEventHandlers(["mousehit","hit"],[f,_,b])),_.mouseover?_.triggerEventHandlers(["mousemove","move"],[f]):(_.triggerEventHandlers(["mouseover","over"],[f]),_.mouseover=!0));for(C=0;C<S;C++)E=(_=this.objectsList[C]).id,_.mouseover&&(x[E]||(_.triggerEventHandlers(["mouseout","out"],[f]),_.mouseover=!1))},saveStartPos:function(n,p){var f,b,C=[];if(n.type===P.OBJECT_TYPE_TICKS)C.push([1,NaN,NaN]);else if(n.elementClass===P.OBJECT_CLASS_LINE)C.push(n.point1.coords.usrCoords),C.push(n.point2.coords.usrCoords);else if(n.elementClass===P.OBJECT_CLASS_CIRCLE)C.push(n.center.coords.usrCoords),n.method==="twoPoints"&&C.push(n.point2.coords.usrCoords);else if(n.type===P.OBJECT_TYPE_POLYGON)for(b=n.vertices.length-1,f=0;f<b;f++)C.push(n.vertices[f].coords.usrCoords);else if(n.type===P.OBJECT_TYPE_SECTOR)C.push(n.point1.coords.usrCoords),C.push(n.point2.coords.usrCoords),C.push(n.point3.coords.usrCoords);else if(s.isPoint(n)||n.type===P.OBJECT_TYPE_GLIDER)C.push(n.coords.usrCoords);else if(n.elementClass===P.OBJECT_CLASS_CURVE)n.points.length>0&&C.push(n.points[0].usrCoords);else try{C.push(n.coords.usrCoords)}catch(_){g.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+_)}for(b=C.length,f=0;f<b;f++)p.Zstart.push(C[f][0]),p.Xstart.push(C[f][1]),p.Ystart.push(C[f][2])},mouseOriginMoveStart:function(n){var p,f;return(p=this._isRequiredKeyPressed(n,"pan"))&&(f=this.getMousePosition(n),this.initMoveOrigin(f[0],f[1])),p},mouseOriginMove:function(n){var p,f=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return f&&(p=this.getMousePosition(n),this.moveOrigin(p[0],p[1],!0)),f},touchStartMoveOriginOneFinger:function(n){var p,f,b=n[g.touchProperty];return(p=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&b.length===1)&&(f=this.getMousePosition(n,0),this.initMoveOrigin(f[0],f[1])),p},touchOriginMove:function(n){var p,f=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return f&&(p=this.getMousePosition(n,0),this.moveOrigin(p[0],p[1],!0)),f},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){if(d.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),this.containerObj!==null&&(this.containerObj.oncontextmenu=function(n){return s.exists(n)&&n.preventDefault(),!1}),this.addFullscreenEventHandlers(),this.addKeyboardEventHandlers(),d.isBrowser){try{this.startResizeObserver()}catch{d.addEvent(window,"resize",this.resizeListener,this),this.startIntersectionObserver()}d.addEvent(window,"scroll",this.scrollListener,this)}},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers(),this.removeFullscreenEventHandlers(),this.removeKeyboardEventHandlers(),d.isBrowser&&(s.exists(this.resizeObserver)?this.stopResizeObserver():(d.removeEvent(window,"resize",this.resizeListener,this),this.stopIntersectionObserver()),d.removeEvent(window,"scroll",this.scrollListener,this))},addPointerEventHandlers:function(){if(!this.hasPointerHandlers&&d.isBrowser){var n=this.attr.movetarget||this.containerObj;window.navigator.msPointerEnabled?(d.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),d.addEvent(n,"MSPointerMove",this.pointerMoveListener,this)):(d.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),d.addEvent(n,"pointermove",this.pointerMoveListener,this)),d.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),d.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.containerObj!==null&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0}},addMouseEventHandlers:function(){if(!this.hasMouseHandlers&&d.isBrowser){var n=this.attr.movetarget||this.containerObj;d.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),d.addEvent(n,"mousemove",this.mouseMoveListener,this),d.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),d.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0}},addTouchEventHandlers:function(n){if(!this.hasTouchHandlers&&d.isBrowser){var p=this.attr.movetarget||this.containerObj;d.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),d.addEvent(p,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0}},addFullscreenEventHandlers:function(){var n,p=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"],f=p.length;if(!this.hasFullsceenEventHandlers&&d.isBrowser){for(n=0;n<f;n++)d.addEvent(this.document,p[n],this.fullscreenListener,this);this.hasFullsceenEventHandlers=!0}},addKeyboardEventHandlers:function(){this.attr.keyboard.enabled&&!this.hasKeyboardHandlers&&d.isBrowser&&(d.addEvent(this.containerObj,"keydown",this.keyDownListener,this),d.addEvent(this.containerObj,"focusin",this.keyFocusInListener,this),d.addEvent(this.containerObj,"focusout",this.keyFocusOutListener,this),this.hasKeyboardHandlers=!0)},removeKeyboardEventHandlers:function(){this.hasKeyboardHandlers&&d.isBrowser&&(d.removeEvent(this.containerObj,"keydown",this.keyDownListener,this),d.removeEvent(this.containerObj,"focusin",this.keyFocusInListener,this),d.removeEvent(this.containerObj,"focusout",this.keyFocusOutListener,this),this.hasKeyboardHandlers=!1)},removeFullscreenEventHandlers:function(){var n,p=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"],f=p.length;if(this.hasFullsceenEventHandlers&&d.isBrowser){for(n=0;n<f;n++)d.removeEvent(this.document,p[n],this.fullscreenListener,this);this.hasFullsceenEventHandlers=!1}},removePointerEventHandlers:function(){if(this.hasPointerHandlers&&d.isBrowser){var n=this.attr.movetarget||this.containerObj;window.navigator.msPointerEnabled?(d.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),d.removeEvent(n,"MSPointerMove",this.pointerMoveListener,this)):(d.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),d.removeEvent(n,"pointermove",this.pointerMoveListener,this)),d.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),d.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?d.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(d.removeEvent(this.document,"pointerup",this.pointerUpListener,this),d.removeEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!1),this.hasPointerHandlers=!1}},removeMouseEventHandlers:function(){if(this.hasMouseHandlers&&d.isBrowser){var n=this.attr.movetarget||this.containerObj;d.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),d.removeEvent(n,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(d.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),d.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),d.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1}},removeTouchEventHandlers:function(){if(this.hasTouchHandlers&&d.isBrowser){var n=this.attr.movetarget||this.containerObj;d.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),d.removeEvent(n,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(d.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1}},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(n){var p,f,b,C,_,E,x,S,O,w,T,M,N=!1,A=this.attr.zoom.factorx,R=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(n.preventDefault(),E=c.distance([n.touches[0].clientX,n.touches[0].clientY],[n.touches[1].clientX,n.touches[1].clientY],2),n.scale===void 0&&(n.scale=E/this.prevDist),!!s.exists(this.prevCoords)&&(f=[n.touches[0].clientX-this.prevCoords[0][0],n.touches[0].clientY-this.prevCoords[0][1]],b=[n.touches[1].clientX-this.prevCoords[1][0],n.touches[1].clientY-this.prevCoords[1][1]],f[0]*f[0]+f[1]*f[1]<100&&b[0]*b[0]+b[1]*b[1]<100||(C=c.rad(f,[0,0],b),this.isPreviousGesture!=="pan"&&Math.abs(C)>.2*Math.PI&&Math.abs(C)<1.8*Math.PI&&(N=!0),this.isPreviousGesture==="pan"||N||(Math.abs(n.scale)<.77||Math.abs(n.scale)>1.3)&&(N=!0),_=n.scale/this.prevScale,this.prevScale=n.scale,this.prevCoords=[[n.touches[0].clientX,n.touches[0].clientY],[n.touches[1].clientX,n.touches[1].clientY]],p=new y(P.COORDS_BY_SCREEN,this.getMousePosition(n,0),this),this.attr.pan.enabled&&this.attr.pan.needtwofingers&&!N?(this.isPreviousGesture="pan",this.moveOrigin(p.scrCoords[1],p.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(_-1)<.5&&((this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(x=Math.abs(n.touches[0].clientX-n.touches[1].clientX),S=Math.abs(n.touches[0].clientY-n.touches[1].clientY),O=Math.abs(Math.atan2(S,x)),M=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&O<M?(this.attr.zoom.factorx=_,this.attr.zoom.factory=1,w=0,T=0):this.attr.zoom.pinchvertical&&Math.abs(O-.5*Math.PI)<M?(this.attr.zoom.factorx=1,this.attr.zoom.factory=_,w=0,T=0):(this.attr.zoom.factorx=_,this.attr.zoom.factory=_,w=p.usrCoords[1],T=p.usrCoords[2]),this.zoomIn(w,T),this.attr.zoom.factorx=A,this.attr.zoom.factory=R)),!1))},gestureStartListener:function(n){var p;return n.preventDefault(),this.prevScale=1,this.prevDist=c.distance([n.touches[0].clientX,n.touches[0].clientY],[n.touches[1].clientX,n.touches[1].clientY],2),this.prevCoords=[[n.touches[0].clientX,n.touches[0].clientY],[n.touches[1].clientX,n.touches[1].clientY]],this.isPreviousGesture="none",p=this.getMousePosition(n,0),this.initMoveOrigin(p[0],p[1]),this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(n,p){var f=this.attr[p];return!!f.enabled&&!(!(f.needshift&&n.shiftKey||!f.needshift&&!n.shiftKey)||!(f.needctrl&&n.ctrlKey||!f.needctrl&&!n.ctrlKey))},_isPointerRegistered:function(n){var p,f=this._board_touches.length;for(p=0;p<f;p++)if(this._board_touches[p].pointerId===n.pointerId)return!0;return!1},_pointerStorePosition:function(n){var p,f;for(p=0,f=!1;p<this._board_touches.length;p++)if(this._board_touches[p].pointerId===n.pointerId){this._board_touches[p].clientX=n.clientX,this._board_touches[p].clientY=n.clientY,f=!0;break}return!f&&this._board_touches.length<2&&this._board_touches.push({pointerId:n.pointerId,clientX:n.clientX,clientY:n.clientY}),this},_pointerRemoveTouches:function(n){var p;for(p=0;p<this._board_touches.length;p++)if(this._board_touches[p].pointerId===n.pointerId){this._board_touches.splice(p,1);break}return this},_pointerClearTouches:function(){this._board_touches.length>0&&this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this._board_touches=[],this.touches=[]},_getPointerInputDevice:function(n){if(d.isBrowser){if(n.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)return"touch";if(n.pointerType==="mouse")return"mouse";if(n.pointerType==="pen")return"pen"}return"mouse"},pointerDownListener:function(n,p){var f,b,C,_,E,x,S,O,w,T;if(!p&&this._isPointerRegistered(n))return!1;if(!p&&n.isPrimary&&this._pointerClearTouches(),this.hasPointerUp||(window.navigator.msPointerEnabled?d.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(d.addEvent(this.document,"pointerup",this.pointerUpListener,this),d.addEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&s.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(x=window.getSelection()).removeAllRanges)try{x.removeAllRanges()}catch{}if(this._inputDevice=this._getPointerInputDevice(n),O=this._inputDevice,this.options.precision.hasPoint=this.options.precision[O],_=this.getMousePosition(n),this._testForSelection(n),this.selectingMode)return this._startSelecting(_),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[n]);if(this.attr.drag.enabled&&p?(E=[p],this.mode=this.BOARD_MODE_DRAG):E=this.initMoveObject(_[0],_[1],n,O),S={num:n.pointerId,X:_[0],Y:_[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},E.length>0){for(T=E[E.length-1],w=!1,f=0;f<this.touches.length;f++)if(this.touches[f].obj===T){b=f,C=this.touches[f].targets.push(S)-1,w=!0;break}w||(C=0,b=this.touches.push({obj:T,targets:[S]})-1),this.dehighlightAll(),T.highlight(!0),this.saveStartPos(T,this.touches[b].targets[C]),n&&n.preventDefault?n.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(n.preventDefault(),n.stopPropagation()),!!d.isBrowser&&(this._getPointerInputDevice(n)!=="touch"?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(n):(this._pointerStorePosition(n),n.touches=this._board_touches,n.touches.length===1&&this.mode===this.BOARD_MODE_NONE&&this.touchStartMoveOriginOneFinger(n)||n.touches.length!==2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(n))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[n]),!1)},pointerMoveListener:function(n){var p,f,b,C,_;if(this._getPointerInputDevice(n)==="touch"&&!this._isPointerRegistered(n))return this.BOARD_MODE_NONE;if(!this.checkFrameRate(n))return!1;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(n.preventDefault(),n.stopPropagation()),this.updateQuality=this.BOARD_QUALITY_LOW,this._inputDevice=this._getPointerInputDevice(n),_=this._inputDevice,this.options.precision.hasPoint=this.options.precision[_],this.selectingMode)b=this.getMousePosition(n),this._moveSelecting(b),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[n,this.mode]);else if(!this.mouseOriginMove(n))if(this.mode===this.BOARD_MODE_DRAG){for(p=0;p<this.touches.length;p++)for(C=this.touches[p].targets,f=0;f<C.length;f++)if(C[f].num===n.pointerId){b=this.getMousePosition(n),C[f].X=b[0],C[f].Y=b[1],C.length===1?this.moveObject(b[0],b[1],this.touches[p],n,_):C.length===2&&(this.twoFingerMove(this.touches[p],n.pointerId,n),C[f].Xprev=b[0],C[f].Yprev=b[1]);break}}else this._getPointerInputDevice(n)==="touch"&&(this._pointerStorePosition(n),this._board_touches.length===2&&(n.touches=this._board_touches,this.gestureChangeListener(n))),b=this.getMousePosition(n),this.highlightElements(b[0],b[1],n,-1);return this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[n,this.mode]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(n){var p,f,b,C;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[n]),this.displayInfobox(!1),n){for(p=0;p<this.touches.length;p++)for(C=this.touches[p].targets,f=0;f<C.length;f++)if(C[f].num===n.pointerId){C.splice(f,1),C.length===0&&this.touches.splice(p,1);break}}if(this.originMoveEnd(),this.update(),this.selectingMode)this._stopSelecting(n),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[n]),this.stopSelectionMode();else for(p=this.downObjects.length-1;p>-1;p--){for(b=!1,f=0;f<this.touches.length;f++)this.touches[f].obj.id===this.downObjects[p].id&&(b=!0);b||(this.downObjects[p].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[n]),this.downObjects.splice(p,1))}return this.hasPointerUp&&(window.navigator.msPointerEnabled?d.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(d.removeEvent(this.document,"pointerup",this.pointerUpListener,this),d.removeEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!1),this._pointerClearTouches(),!0},touchStartListener:function(n){var p,f,b,C,_,E,x,S,O,w,T=this.options.precision.touch,M=n[g.touchProperty];for(this.hasTouchEnd||(d.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&s.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this._inputDevice="touch",this.options.precision.hasPoint=this.options.precision.touch,p=0;p<M.length;p++)M[p].jxg_isused=!1;for(p=0;p<this.touches.length;p++)for(w=this.touches[p].targets,C=0;C<w.length;C++){w[C].num=-1,T=this.options.precision.touch;do{for(_=0;_<M.length;_++)if(Math.abs(Math.pow(M[_].screenX-w[C].X,2)+Math.pow(M[_].screenY-w[C].Y,2))<T*T){w[C].num=_,w[C].X=M[_].screenX,w[C].Y=M[_].screenY,M[_].jxg_isused=!0;break}T*=2}while(w[C].num===-1&&T<this.options.precision.touchMax);w[C].num===-1&&(g.debug("i couldn't find a targettouches for target no "+C+" on "+this.touches[p].obj.name+" ("+this.touches[p].obj.id+"). Removed the target."),g.debug("eps = "+T+", touchMax = "+v.precision.touchMax),w.splice(p,1))}for(p=0;p<M.length;p++)if(!M[p].jxg_isused){if(f=this.getMousePosition(n,p),this.selectingMode)return this._startSelecting(f),this.triggerEventHandlers(["touchstartselecting","startselecting"],[n]),n.preventDefault(),n.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if((b=this.initMoveObject(f[0],f[1],n,"touch")).length!==0){if(E=b[b.length-1],O={num:p,X:M[p].screenX,Y:M[p].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},s.isPoint(E)||E.elementClass===P.OBJECT_CLASS_TEXT||E.type===P.OBJECT_TYPE_TICKS||E.type===P.OBJECT_TYPE_IMAGE)S=[O],this.saveStartPos(E,S[0]),this.touches.push({obj:E,targets:S}),E.highlight(!0);else if(E.elementClass===P.OBJECT_CLASS_LINE||E.elementClass===P.OBJECT_CLASS_CIRCLE||E.elementClass===P.OBJECT_CLASS_CURVE||E.type===P.OBJECT_TYPE_POLYGON){for(x=!1,C=0;C<this.touches.length;C++)E.id===this.touches[C].obj.id&&(x=!0,this.touches[C].targets.length===1&&(this.saveStartPos(E,O),this.touches[C].targets.push(O)),M[p].jxg_isused=!0);x||(S=[O],this.saveStartPos(E,S[0]),this.touches.push({obj:E,targets:S}),E.highlight(!0))}}M[p].jxg_isused=!0}return this.touches.length>0&&(n.preventDefault(),n.stopPropagation()),M.length===1&&this.mode===this.BOARD_MODE_NONE&&this.touchStartMoveOriginOneFinger(n)||M.length!==2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(n)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[n]),!1},touchMoveListener:function(n){var p,f,b,C,_=n[g.touchProperty];if(!this.checkFrameRate(n))return!1;if(this.mode!==this.BOARD_MODE_NONE&&(n.preventDefault(),n.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this._inputDevice="touch",this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(p=0;p<_.length;p++)if(!_[p].jxg_isused){f=this.getMousePosition(n,p),this._moveSelecting(f),this.triggerEventHandlers(["touchmoves","moveselecting"],[n,this.mode]);break}}else if(!this.touchOriginMove(n))if(this.mode===this.BOARD_MODE_DRAG){for(p=0;p<this.touches.length;p++)if((C=this.touches[p].targets).length===1){if(_[C[0].num]){if((f=this.getMousePosition(n,C[0].num))[0]<0||f[0]>this.canvasWidth||f[1]<0||f[1]>this.canvasHeight)return;C[0].X=f[0],C[0].Y=f[1],this.moveObject(f[0],f[1],this.touches[p],n,"touch")}}else if(C.length===2&&C[0].num>-1&&C[1].num>-1&&_[C[0].num]&&_[C[1].num]){if(f=this.getMousePosition(n,C[0].num),b=this.getMousePosition(n,C[1].num),f[0]<0||f[0]>this.canvasWidth||f[1]<0||f[1]>this.canvasHeight||b[0]<0||b[0]>this.canvasWidth||b[1]<0||b[1]>this.canvasHeight)return;C[0].X=f[0],C[0].Y=f[1],C[1].X=b[0],C[1].Y=b[1],this.twoFingerMove(this.touches[p],C[0].num,n),this.twoFingerMove(this.touches[p],C[1].num),C[0].Xprev=f[0],C[0].Yprev=f[1],C[1].Xprev=b[0],C[1].Yprev=b[1]}}else _.length===2&&this.gestureChangeListener(n),f=this.getMousePosition(n,0),this.highlightElements(f[0],f[1],n,-1);return this.mode!==this.BOARD_MODE_DRAG&&this.displayInfobox(!1),this.triggerEventHandlers(["touchmove","move"],[n,this.mode]),this.options.precision.hasPoint=this.options.precision.mouse,this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode===this.BOARD_MODE_NONE},touchEndListener:function(n){var p,f,b,C,_,E,x=this.options.precision.touch,S=[],O=n&&n[g.touchProperty];if(this.triggerEventHandlers(["touchend","up"],[n]),this.displayInfobox(!1),this.selectingMode)this._stopSelecting(n),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[n]),this.stopSelectionMode();else if(O&&O.length>0){for(p=0;p<this.touches.length;p++)S[p]=this.touches[p];for(this.touches.length=0,p=0;p<O.length;p++)O[p].jxg_isused=!1;for(p=0;p<S.length;p++){for(C=!1,_=0,E=S[p].targets,f=0;f<E.length;f++)for(E[f].found=!1,b=0;b<O.length;b++)if(Math.abs(Math.pow(O[b].screenX-E[f].X,2)+Math.pow(O[b].screenY-E[f].Y,2))<x*x){E[f].found=!0,E[f].num=b,E[f].X=O[b].screenX,E[f].Y=O[b].screenY,_+=1;break}if(s.isPoint(S[p].obj)?C=E[0]&&E[0].found:S[p].obj.elementClass===P.OBJECT_CLASS_LINE?C=E[0]&&E[0].found||E[1]&&E[1].found:S[p].obj.elementClass===P.OBJECT_CLASS_CIRCLE&&(C=_===1||_===3),C)for(this.touches.push({obj:S[p].obj,targets:[]}),f=0;f<E.length;f++)E[f].found&&this.touches[this.touches.length-1].targets.push({num:E[f].num,X:E[f].screenX,Y:E[f].screenY,Xprev:NaN,Yprev:NaN,Xstart:E[f].Xstart,Ystart:E[f].Ystart,Zstart:E[f].Zstart});else S[p].obj.noHighlight()}}else this.touches.length=0;for(p=this.downObjects.length-1;p>-1;p--){for(C=!1,f=0;f<this.touches.length;f++)this.touches[f].obj.id===this.downObjects[p].id&&(C=!0);C||(this.downObjects[p].triggerEventHandlers(["touchup","up"],[n]),this.downObjects.splice(p,1))}return O&&O.length!==0||(this.hasTouchEnd&&(d.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(n){var p,f,b;if(this.document.selection&&s.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return d.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,this._inputDevice="mouse",this.options.precision.hasPoint=this.options.precision.mouse,p=this.getMousePosition(n),this._testForSelection(n),this.selectingMode?(this._startSelecting(p),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[n])):((f=this.initMoveObject(p[0],p[1],n,"mouse")).length===0?(this.mode=this.BOARD_MODE_NONE,b=!0):(this.mouse={obj:null,targets:[{X:p[0],Y:p[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=f[f.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),n&&n.preventDefault?n.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(b=this.mouseOriginMoveStart(n)),this.triggerEventHandlers(["mousedown","down"],[n]),b)},mouseMoveListener:function(n){var p;if(!this.checkFrameRate(n))return!1;p=this.getMousePosition(n),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this.selectingMode?(this._moveSelecting(p),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[n,this.mode])):this.mouseOriginMove(n)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(p[0],p[1],this.mouse,n,"mouse"):this.highlightElements(p[0],p[1],n,-1),this.triggerEventHandlers(["mousemove","move"],[n,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(n){var p;if(this.selectingMode===!1&&this.triggerEventHandlers(["mouseup","up"],[n]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(n),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[n]),this.stopSelectionMode();else for(p=0;p<this.downObjects.length;p++)this.downObjects[p].triggerEventHandlers(["mouseup","up"],[n]);this.downObjects.length=0,this.hasMouseUp&&(d.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(n){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(n,"zoom"))return!0;var p=(n=n||window.event).detail?-n.detail:n.wheelDelta/40,f=new y(P.COORDS_BY_SCREEN,this.getMousePosition(n),this);return p>0?this.zoomIn(f.usrCoords[1],f.usrCoords[2]):this.zoomOut(f.usrCoords[1],f.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[n]),n.preventDefault(),!1},keyDownListener:function(n){var p,f,b,C,_,E=n.target.id,x=0,S=0,O=s.evaluate(this.attr.keyboard.dx)/this.unitX,w=s.evaluate(this.attr.keyboard.dy)/this.unitY,T=!1,M=!0;return!(!this.attr.keyboard.enabled||E==="")&&(p=E.replace(this.containerObj.id+"_",""),f=this.select(p),s.exists(f.coords)&&(_=f.coords.usrCoords.slice(1)),(s.evaluate(this.attr.keyboard.panshift)||s.evaluate(this.attr.keyboard.panctrl))&&(T=!0),s.evaluate(this.attr.keyboard.panshift)&&n.shiftKey||s.evaluate(this.attr.keyboard.panctrl)&&n.ctrlKey?n.keyCode===38?this.clickUpArrow():n.keyCode===40?this.clickDownArrow():n.keyCode===37?this.clickLeftArrow():n.keyCode===39?this.clickRightArrow():M=!1:(s.exists(f.visProp)&&(s.exists(f.visProp.snaptogrid)&&f.visProp.snaptogrid&&s.evaluate(f.visProp.snapsizex)&&s.evaluate(f.visProp.snapsizey)?(x=(b=f.getSnapSizes())[0],S=b[1],O=Math.max(x,O),w=Math.max(S,w)):s.exists(f.visProp.attracttogrid)&&f.visProp.attracttogrid&&s.evaluate(f.visProp.attractordistance)&&s.evaluate(f.visProp.attractorunit)&&(S=x=1.1*s.evaluate(f.visProp.attractordistance),s.evaluate(f.visProp.attractorunit)==="screen"&&(x/=this.unitX,S/=this.unitX),O=Math.max(x,O),w=Math.max(S,w))),n.keyCode===38?C=[0,w]:n.keyCode===40?C=[0,-w]:n.keyCode===37?C=[-O,0]:n.keyCode===39?C=[O,0]:T&&n.key==="+"?this.zoomIn():T&&n.key==="-"?this.zoomOut():T&&n.key==="o"?this.zoom100():M=!1,C&&f.isDraggable&&f.visPropCalc.visible&&(this.geonextCompatibilityMode&&(s.isPoint(f)||f.elementClass===P.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&!s.evaluate(f.visProp.fixed)&&(s.exists(f.coords)&&(C[0]+=_[0],C[1]+=_[1]),f.setPosition(g.COORDS_BY_USER,C),s.exists(f.coords)&&this.updateInfobox(f),this.triggerEventHandlers(["hit"],[n,f]))),this.update(),M&&s.exists(n.preventDefault)&&n.preventDefault(),!0)},keyFocusInListener:function(n){var p,f,b=n.target.id;if(!this.attr.keyboard.enabled||b==="")return!1;p=b.replace(this.containerObj.id+"_",""),f=this.select(p),s.exists(f.highlight)&&f.highlight(!0),s.exists(f.coords)&&this.updateInfobox(f),this.triggerEventHandlers(["hit"],[n,f])},keyFocusOutListener:function(n){if(!this.attr.keyboard.enabled)return!1;this.dehighlightAll(),this.displayInfobox(!1)},updateContainerDims:function(){var n,p,f,b;n=(f=this.containerObj.getBoundingClientRect()).width,p=f.height,window&&window.getComputedStyle&&(b=window.getComputedStyle(this.containerObj,null),n-=parseFloat(b.getPropertyValue("border-left-width"))+parseFloat(b.getPropertyValue("border-right-width")),p-=parseFloat(b.getPropertyValue("border-top-width"))+parseFloat(b.getPropertyValue("border-bottom-width"))),n<=0||p<=0||(isNaN(this.getBoundingBox()[0])&&this.setBoundingBox(this.attr.boundingbox,this.keepaspectratio,"keep"),s.exists(this._prevDim)&&this._prevDim.w===n&&this._prevDim.h===p||(this.resizeContainer(n,p,!0),this._prevDim={w:n,h:p}))},startResizeObserver:function(){var n=this;d.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&(this.resizeObserver=new ResizeObserver(function(p){n._isResizing||(n._isResizing=!0,window.setTimeout(function(){try{n.updateContainerDims()}catch{n.stopResizeObserver()}finally{n._isResizing=!1}},n.attr.resize.throttle))}),this.resizeObserver.observe(this.containerObj))},stopResizeObserver:function(){d.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&s.exists(this.resizeObserver)&&this.resizeObserver.unobserve(this.containerObj)},resizeListener:function(){var n=this;d.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&(this._isScrolling||this._isResizing||(this._isResizing=!0,window.setTimeout(function(){n.updateContainerDims(),n._isResizing=!1},this.attr.resize.throttle)))},scrollListener:function(n){var p=this;d.isBrowser&&(this._isScrolling||(this._isScrolling=!0,window.setTimeout(function(){p._isScrolling=!1},66)))},startIntersectionObserver:function(){var n=this;try{this.intersectionObserver=new IntersectionObserver(function(p){isNaN(n.getBoundingBox()[0])&&n.updateContainerDims()},{root:null,rootMargin:"0px",threshold:.8}),this.intersectionObserver.observe(n.containerObj)}catch{console.log("JSXGraph: IntersectionObserver not available in this browser.")}},stopIntersectionObserver:function(){s.exists(this.intersectionObserver)&&this.intersectionObserver.unobserve(this.containerObj)},initInfobox:function(){var n=s.copyAttributes({},this.options,"infobox");return n.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],n),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.displayInfobox(!1),this},updateInfobox:function(n){var p,f,b,C,_,E=s.evaluate(n.visProp.showinfobox);return!s.evaluate(this.attr.showinfobox)&&E==="inherit"||!E||s.isPoint(n)&&(b=n.coords.usrCoords[1],C=n.coords.usrCoords[2],_=s.evaluate(n.visProp.infoboxdigits),this.infobox.setCoords(b+this.infobox.distanceX/this.unitX,C+this.infobox.distanceY/this.unitY),typeof n.infoboxText!="string"?(_==="auto"?(p=s.autoDigits(b),f=s.autoDigits(C)):s.isNumber(_)?(p=s.toFixed(b,_),f=s.toFixed(C,_)):(p=b,f=C),this.highlightInfobox(p,f,n)):this.highlightCustomInfobox(n.infoboxText,n),this.displayInfobox(!0)),this},displayInfobox:function(n){return this.infobox.hiddenByParent===n&&(this.infobox.hiddenByParent=!n,this.infobox.prepareUpdate().updateVisibility(n).updateRenderer()),this},showInfobox:function(n){return this.displayInfobox(n)},highlightInfobox:function(n,p,f){return this.highlightCustomInfobox("("+n+", "+p+")",f),this},highlightCustomInfobox:function(n,p){return this.infobox.setText(n),this},dehighlightAll:function(){var n,p,f=!1;for(n in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(n)&&(p=this.highlightedObjects[n],(this.hasMouseHandlers||this.hasPointerHandlers)&&p.noHighlight(),f=!0);return this.highlightedObjects={},this.renderer.type==="canvas"&&f&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(n,p){return[n,p]},getUsrCoordsOfMouse:function(n){var p=this.getCoordsTopLeftCorner(),f=d.getPosition(n,null,this.document),b=f[0]-p[0],C=f[1]-p[1];return new y(P.COORDS_BY_SCREEN,[b,C],this).usrCoords.slice(1)},getAllUnderMouse:function(n){var p=this.getAllObjectsUnderMouse(n);return p.push(this.getUsrCoordsOfMouse(n)),p},getAllObjectsUnderMouse:function(n){var p,f,b=this.getCoordsTopLeftCorner(),C=d.getPosition(n,null,this.document),_=C[0]-b[0],E=C[1]-b[1],x=[],S=this.objectsList.length;for(p=0;p<S;p++)(f=this.objectsList[p]).visPropCalc.visible&&f.hasPoint&&f.hasPoint(_,E)&&(x[x.length]=f);return x},updateCoords:function(){var n,p,f=this.objectsList.length;for(p=0;p<f;p++)n=this.objectsList[p],s.exists(n.coords)&&(s.evaluate(n.visProp.frozen)?n.coords.screen2usr():n.coords.usr2screen());return this},moveOrigin:function(n,p,f){var b,C,_,E;return s.exists(n)&&s.exists(p)&&(b=this.origin.scrCoords[1],C=this.origin.scrCoords[2],this.origin.scrCoords[1]=n,this.origin.scrCoords[2]=p,f&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy),_=new y(P.COORDS_BY_SCREEN,[0,0],this).usrCoords,E=new y(P.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this).usrCoords,(_[1]<this.maxboundingbox[0]||_[2]>this.maxboundingbox[1]||E[1]>this.maxboundingbox[2]||E[2]<this.maxboundingbox[3])&&(this.origin.scrCoords[1]=b,this.origin.scrCoords[2]=C)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(n){var p,f,b,C,_,E,x,S=[],O=n.indexOf("<data>"),w=n.indexOf("</data>"),T=function(L,D,k,B){return function(){var I,Y;Y=(I=L.select(D.id)).coords.usrCoords[B],B===2?I.setPositionDirectly(P.COORDS_BY_USER,[k(),Y]):I.setPositionDirectly(P.COORDS_BY_USER,[Y,k()]),I.prepareUpdate().update()}},M=function(L,D,k){return function(){var B,I;B=L.select(D.id),I=k(),B.setAttribute({visible:I})}},N=function(L,D,k,B){return function(){var I,Y;I=L.select(D.id),Y=k(),B==="strokewidth"?I.visProp.strokewidth=Y:(Y=t.rgba2rgbo(Y),I.visProp[B+"color"]=Y[0],I.visProp[B+"opacity"]=Y[1])}},A=function(L,D,k){return function(){L.select(D.id).position=k()}},R=function(L,D,k){return function(){L.select(D.id).setStyle(k())}};if(!(O<0)){for(;O>=0;){if(f=(p=n.slice(O+6,w)).indexOf("="),b=p.slice(0,f),C=p.slice(f+1),f=b.indexOf("."),_=b.slice(0,f),E=this.elementsByName[s.unescapeHTML(_)],x=b.slice(f+1).replace(/\s+/g,"").toLowerCase(),C=s.createFunction(C,this,"",!0),s.exists(this.elementsByName[_]))switch(x){case"x":S.push(T(this,E,C,2));break;case"y":S.push(T(this,E,C,1));break;case"visible":S.push(M(this,E,C));break;case"position":S.push(A(this,E,C));break;case"stroke":S.push(N(this,E,C,"stroke"));break;case"style":S.push(R(this,E,C));break;case"strokewidth":S.push(N(this,E,C,"strokewidth"));break;case"fill":S.push(N(this,E,C,"fill"));break;case"label":break;default:g.debug("property '"+x+"' in conditions not yet implemented:"+C)}else g.debug("debug conditions: |"+_+"| undefined");O=(n=n.slice(w+7)).indexOf("<data>"),w=n.indexOf("</data>")}this.updateConditions=function(){var L;for(L=0;L<S.length;L++)S[L]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var n=new y(P.COORDS_BY_USER,[0,0],this),p=new y(P.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),f=n.scrCoords[1]-p.scrCoords[1],b=n.scrCoords[2]-p.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(f)>25;)this.options.grid.snapSizeX*=2,f/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(b)>25;)this.options.grid.snapSizeY*=2,b/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(n,p){var f=this.getBoundingBox(),b=this.attr.zoom.factorx,C=this.attr.zoom.factory,_=(f[2]-f[0])*(1-1/b),E=(f[1]-f[3])*(1-1/C),x=.5,S=.5,O=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&b>1||this.zoomY>this.attr.zoom.max&&C>1||this.zoomX<O&&b<1||this.zoomY<O&&C<1?this:(s.isNumber(n)&&s.isNumber(p)&&(x=(n-f[0])/(f[2]-f[0]),S=(f[1]-p)/(f[1]-f[3])),this.setBoundingBox([f[0]+_*x,f[1]-E*S,f[2]-_*(1-x),f[3]+E*(1-S)],this.keepaspectratio,"update"),this.applyZoom())},zoomOut:function(n,p){var f=this.getBoundingBox(),b=this.attr.zoom.factorx,C=this.attr.zoom.factory,_=(f[2]-f[0])*(1-b),E=(f[1]-f[3])*(1-C),x=.5,S=.5,O=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<O||this.zoomY<O?this:(s.isNumber(n)&&s.isNumber(p)&&(x=(n-f[0])/(f[2]-f[0]),S=(f[1]-p)/(f[1]-f[3])),this.setBoundingBox([f[0]+_*x,f[1]-E*S,f[2]-_*(1-x),f[3]+E*(1-S)],this.keepaspectratio,"update"),this.applyZoom())},zoom100:function(){var n,p,f;return s.exists(this.attr.boundingbox)?this.setBoundingBox(this.attr.boundingbox,this.keepaspectratio,"reset"):(p=((n=this.getBoundingBox())[2]-n[0])*(1-this.zoomX)*.5,f=(n[1]-n[3])*(1-this.zoomY)*.5,this.setBoundingBox([n[0]+p,n[1]-f,n[2]-p,n[3]+f],this.keepaspectratio,"reset")),this.applyZoom()},zoomAllPoints:function(){var n,p,f,b,C=0,_=0,E=0,x=0,S=this.objectsList.length;for(n=0;n<S;n++)b=this.objectsList[n],s.isPoint(b)&&b.visPropCalc.visible&&(b.coords.usrCoords[1]<C?C=b.coords.usrCoords[1]:b.coords.usrCoords[1]>_&&(_=b.coords.usrCoords[1]),b.coords.usrCoords[2]>x?x=b.coords.usrCoords[2]:b.coords.usrCoords[2]<E&&(E=b.coords.usrCoords[2]));return p=50/this.unitX,f=50/this.unitY,this.setBoundingBox([C-p,x+f,_+p,E-f],this.keepaspectratio,"update"),this.applyZoom()},zoomElements:function(n){var p,f,b,C,_,E,x,S=[1/0,-1/0,-1/0,1/0];if(!s.isArray(n)||n.length===0)return this;for(p=0;p<n.length;p++)f=this.select(n[p]).bounds(),s.isArray(f)&&(f[0]<S[0]&&(S[0]=f[0]),f[1]>S[1]&&(S[1]=f[1]),f[2]>S[2]&&(S[2]=f[2]),f[3]<S[3]&&(S[3]=f[3]));return s.isArray(S)&&(b=.5*(S[0]+S[2]),C=.5*(S[1]+S[3]),_=1.5*(S[2]-S[0])*.5,E=1.5*(S[1]-S[3])*.5,x=Math.max(_,E),this.setBoundingBox([b-x,C+x,b+x,C-x],this.keepaspectratio,"update")),this},setZoom:function(n,p){var f=this.attr.zoom.factorx,b=this.attr.zoom.factory;return this.attr.zoom.factorx=n/this.zoomX,this.attr.zoom.factory=p/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=f,this.attr.zoom.factory=b,this},removeObject:function(n,p){var f,b;if(s.isArray(n)){for(b=0;b<n.length;b++)this.removeObject(n[b]);return this}if(n=this.select(n),!s.exists(n)||s.isString(n))return this;try{for(f in n.childElements)n.childElements.hasOwnProperty(f)&&n.childElements[f].board.removeObject(n.childElements[f]);for(f in n.objects)n.objects.hasOwnProperty(f)&&n.objects[f].board.removeObject(n.objects[f]);if(p)for(f in this.objects)this.objects.hasOwnProperty(f)&&s.exists(this.objects[f].childElements)&&s.exists(this.objects[f].childElements.hasOwnProperty(n.id))&&(delete this.objects[f].childElements[n.id],delete this.objects[f].descendants[n.id]);else if(s.exists(n.ancestors))for(f in n.ancestors)n.ancestors.hasOwnProperty(f)&&s.exists(n.ancestors[f].childElements)&&s.exists(n.ancestors[f].childElements.hasOwnProperty(n.id))&&(delete n.ancestors[f].childElements[n.id],delete n.ancestors[f].descendants[n.id]);if(n._pos>-1)for(this.objectsList.splice(n._pos,1),f=n._pos;f<this.objectsList.length;f++)this.objectsList[f]._pos--;else n.type!==P.OBJECT_TYPE_TURTLE&&g.debug("Board.removeObject: object "+n.id+" not found in list.");delete this.objects[n.id],delete this.elementsByName[n.name],n.visProp&&s.evaluate(n.visProp.trace)&&n.clearTrace(),s.exists(n.remove)&&n.remove()}catch(C){g.debug(n.id+": Could not be removed: "+C)}return this.update(),this},removeAncestors:function(n){var p;for(p in n.ancestors)n.ancestors.hasOwnProperty(p)&&this.removeAncestors(n.ancestors[p]);return this.removeObject(n),this},initGeonextBoard:function(){var n,p,f;return n=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),p=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),f=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[n,p],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[n,f],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(n,p,f,b){var C;return b||(C=this.getBoundingBox()),this.canvasWidth=parseFloat(n),this.canvasHeight=parseFloat(p),f||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),b||this.setBoundingBox(C,this.keepaspectratio,"keep"),this},showDependencies:function(){var n,p,f,b,C;for(n in p=`<p>
`,this.objects)if(this.objects.hasOwnProperty(n)){for(f in C=0,this.objects[n].childElements)this.objects[n].childElements.hasOwnProperty(f)&&(C+=1);for(f in C>=0&&(p+="<strong>"+this.objects[n].id+":</strong> "),this.objects[n].childElements)this.objects[n].childElements.hasOwnProperty(f)&&(p+=this.objects[n].childElements[f].id+"("+this.objects[n].childElements[f].name+"), ");p+=`<p>
`}return p+=`</p>
`,(b=window.open()).document.open(),b.document.write(p),b.document.close(),this},showXML:function(){var n=window.open("");return n.document.open(),n.document.write("<pre>"+s.escapeHTML(this.xmlString)+"</pre>"),n.document.close(),this},prepareUpdate:function(){var n,p,f=this.objectsList.length;for(n=0;n<f;n++)(p=this.objectsList[n]).needsUpdate=p.needsRegularUpdate||this.needsFullUpdate;for(n in this.groups)this.groups.hasOwnProperty(n)&&((p=this.groups[n]).needsUpdate=p.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(n){var p,f;for(n=this.select(n),p=0;p<this.objectsList.length;p++)f=this.objectsList[p],this.needsFullUpdate&&f.elementClass===P.OBJECT_CLASS_TEXT&&f.updateSize(),f.update(!s.exists(n)||f.id!==n.id).updateVisibility();for(p in this.groups)this.groups.hasOwnProperty(p)&&this.groups[p].update(n);return this},updateRenderer:function(){var n,p=this.objectsList.length;if(this.renderer.type==="canvas")this.updateRendererCanvas();else for(n=0;n<p;n++)this.objectsList[n].updateRenderer();return this},updateRendererCanvas:function(){var n,p,f,b,C,_=this.objectsList.length,E=this.options.layer,x=this.options.layer.numlayers,S=Number.NEGATIVE_INFINITY;for(f=0;f<x;f++){for(C in b=Number.POSITIVE_INFINITY,E)E.hasOwnProperty(C)&&E[C]>S&&E[C]<b&&(b=E[C]);for(S=b,n=0;n<_;n++)(p=this.objectsList[n]).visProp.layer===b&&p.prepareUpdate().updateRenderer()}return this},addHook:function(n,p,f){return g.deprecated("Board.addHook()","Board.on()"),p=s.def(p,"update"),f=s.def(f,this),this.hooks.push([p,n]),this.on(p,n,f),this.hooks.length-1},addEvent:g.shortcut(g.Board.prototype,"on"),removeHook:function(n){return g.deprecated("Board.removeHook()","Board.off()"),this.hooks[n]&&(this.off(this.hooks[n][0],this.hooks[n][1]),this.hooks[n]=null),this},removeEvent:g.shortcut(g.Board.prototype,"off"),updateHooks:function(n){var p=Array.prototype.slice.call(arguments,0);return g.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),p[0]=s.def(p[0],"update"),this.triggerEventHandlers([p[0]],arguments),this},addChild:function(n){return s.exists(n)&&s.exists(n.containerObj)&&(this.dependentBoards.push(n),this.update()),this},removeChild:function(n){var p;for(p=this.dependentBoards.length-1;p>=0;p--)this.dependentBoards[p]===n&&this.dependentBoards.splice(p,1);return this},update:function(n){var p,f,b,C,_;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,this.attr.minimizereflow==="all"&&this.containerObj&&this.renderer.type!=="vml"&&(_=document.activeElement,C=this.renderer.removeToInsertLater(this.containerObj)),this.attr.minimizereflow==="svg"&&this.renderer.type==="svg"&&(_=document.activeElement,C=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(n).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),C&&(C(),_.focus()),f=this.dependentBoards.length,p=0;p<f;p++)b=this.dependentBoards[p],s.exists(b)&&b!==this&&(b.updateQuality=this.updateQuality,b.prepareUpdate().updateElements().updateConditions(),b.renderer.suspendRedraw(),b.updateRenderer(),b.renderer.unsuspendRedraw(),b.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var n;for(n=0;n<this.grids.length;n++)this.removeObject(this.grids[n]);return this.grids.length=0,this.update(),this},create:function(n,p,f){var b,C;for(n=n.toLowerCase(),s.exists(p)||(p=[]),s.exists(f)||(f={}),C=0;C<p.length;C++)!s.isString(p[C])||n==="text"&&C===2||n==="solidofrevolution3d"&&C===2||!(n!=="input"&&n!=="checkbox"&&n!=="button"||C!==2&&C!==3)||n==="curve"&&C>0||(p[C]=this.select(p[C]));if(!s.isFunction(g.elements[n]))throw new Error("JSXGraph: create: Unknown element type given: "+n);return b=g.elements[n](this,p,f),s.exists(b)?(b.prepareUpdate&&b.update&&b.updateRenderer&&b.fullUpdate(),b):(g.debug("JSXGraph: create: failure creating "+n),b)},createElement:function(){return g.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var n;for(n=0;n<this.objectsList.length;n++)this.objectsList[n].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(n,p,f){var b,C,_,E,x=0,S=0,O=d.getDimensions(this.container,this.document);return s.isArray(n)?(n[0]<this.maxboundingbox[0]||n[1]>this.maxboundingbox[1]||n[2]>this.maxboundingbox[2]||n[3]<this.maxboundingbox[3]||(s.exists(f)||(f="reset"),_=this.unitX,E=this.unitY,this.canvasWidth=parseInt(O.width,10),this.canvasHeight=parseInt(O.height,10),C=this.canvasWidth,b=this.canvasHeight,p?(this.unitX=C/(n[2]-n[0]),this.unitY=b/(n[1]-n[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?(this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY),S=.5*(b/this.unitY-(n[1]-n[3]))):(this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),x=.5*(C/this.unitX-(n[2]-n[0]))),this.keepaspectratio=!0):(this.unitX=C/(n[2]-n[0]),this.unitY=b/(n[1]-n[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*(n[0]-x),this.unitY*(n[1]+S)),f==="update"?(this.zoomX*=this.unitX/_,this.zoomY*=this.unitY/E):f==="reset"&&(this.zoomX=s.exists(this.attr.zoomx)?this.attr.zoomx:1,this.zoomY=s.exists(this.attr.zoomy)?this.attr.zoomy:1)),this):this},getBoundingBox:function(){var n=new y(P.COORDS_BY_SCREEN,[0,0],this).usrCoords,p=new y(P.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this).usrCoords;return[n[1],n[2],p[1],p[2]]},addAnimation:function(n){var p=this;return this.animationObjects[n.id]=n,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval(function(){p.animate()},n.board.attr.animationdelay)),this},stopAllAnimation:function(){var n;for(n in this.animationObjects)this.animationObjects.hasOwnProperty(n)&&s.exists(this.animationObjects[n])&&(this.animationObjects[n]=null,delete this.animationObjects[n]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var n,p,f,b,C,_,E,x,S=0,O=null;for(p in this.animationObjects)if(this.animationObjects.hasOwnProperty(p)&&s.exists(this.animationObjects[p])){if(S+=1,(f=this.animationObjects[p]).animationPath&&(b=s.isFunction(f.animationPath)?f.animationPath(new Date().getTime()-f.animationStart):f.animationPath.pop(),!s.exists(b)||!s.isArray(b)&&isNaN(b)?delete f.animationPath:(f.setPositionDirectly(P.COORDS_BY_USER,b),f.fullUpdate(),O=f)),f.animationData){for(C in E=0,f.animationData)f.animationData.hasOwnProperty(C)&&(_=f.animationData[C].pop(),s.exists(_)?(E+=1,(n={})[C]=_,f.setAttribute(n)):delete f.animationData[_]);E===0&&delete f.animationData}s.exists(f.animationData)||s.exists(f.animationPath)||(this.animationObjects[p]=null,delete this.animationObjects[p],s.exists(f.animationCallback)&&(x=f.animationCallback,f.animationCallback=null,x()))}return S===0?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(O),this},migratePoint:function(n,p,f){var b,C,_,E,x,S,O=!1;for(C in n=this.select(n),p=this.select(p),s.exists(n.label)&&(S=n.label.id,O=!0,this.removeObject(n.label)),n.childElements)if(n.childElements.hasOwnProperty(C)){for(_ in E=!1,b=n.childElements[C])b.hasOwnProperty(_)&&b[_]===n&&(b[_]=p,E=!0);for(E&&delete n.childElements[C],x=0;x<b.parents.length;x++)b.parents[x]===n.id&&(b.parents[x]=p.id);p.addChild(b)}return f&&(O&&(delete p.childElements[S],delete p.descendants[S]),p.label&&this.removeObject(p.label),delete this.elementsByName[p.name],p.name=n.name,O&&p.createLabel()),this.removeObject(n),s.exists(p.name)&&p.name!==""&&(this.elementsByName[p.name]=p),this.fullUpdate(),this},emulateColorblindness:function(n){var p,f;if(s.exists(n)||(n="none"),this.currentCBDef===n)return this;for(p in this.objects)this.objects.hasOwnProperty(p)&&(f=this.objects[p],n!=="none"?(this.currentCBDef==="none"&&(f.visPropOriginal={strokecolor:f.visProp.strokecolor,fillcolor:f.visProp.fillcolor,highlightstrokecolor:f.visProp.highlightstrokecolor,highlightfillcolor:f.visProp.highlightfillcolor}),f.setAttribute({strokecolor:t.rgb2cb(s.evaluate(f.visPropOriginal.strokecolor),n),fillcolor:t.rgb2cb(s.evaluate(f.visPropOriginal.fillcolor),n),highlightstrokecolor:t.rgb2cb(s.evaluate(f.visPropOriginal.highlightstrokecolor),n),highlightfillcolor:t.rgb2cb(s.evaluate(f.visPropOriginal.highlightfillcolor),n)})):s.exists(f.visPropOriginal)&&g.extend(f.visProp,f.visPropOriginal));return this.currentCBDef=n,this.update(),this},select:function(n,p){var f,b,C,_,E=n;if(E===null)return E;if(s.isString(E)&&E!=="")s.exists(this.objects[E])?E=this.objects[E]:s.exists(this.elementsByName[E])?E=this.elementsByName[E]:s.exists(this.groups[E])&&(E=this.groups[E]);else if(!p&&(s.isFunction(E)||s.isObject(E)&&!s.isFunction(E.setAttribute))){for(b={},_=(f=s.filterElements(this.objectsList,E)).length,C=0;C<_;C++)b[f[C].id]=f[C];E=new u(b)}else s.isObject(E)&&s.exists(E.id)&&!s.exists(this.objects[E.id])&&(E=null);return E},hasPoint:function(n,p){var f=n,b=p,C=this.getBoundingBox();return s.exists(n)&&s.isArray(n.usrCoords)&&(f=n.usrCoords[1],b=n.usrCoords[2]),!!(s.isNumber(f)&&s.isNumber(b)&&C[0]<f&&f<C[2]&&C[1]>b&&b>C[3])},updateCSSTransforms:function(){var n=this.containerObj,p=n,f=n;for(this.cssTransMat=d.getCSSTransformMatrix(p),p=p.offsetParent;p;){for(this.cssTransMat=l.matMatMult(d.getCSSTransformMatrix(p),this.cssTransMat),f=f.parentNode;f!==p;)this.cssTransMat=l.matMatMult(d.getCSSTransformMatrix(p),this.cssTransMat),f=f.parentNode;p=p.offsetParent}return this.cssTransMat=l.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(n){this.isSelecting=!0,this.selectingBox=[[n[0],n[1]],[n[0],n[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(n){this.isSelecting&&(this.selectingBox[1]=[n[0],n[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(n){var p=this.getMousePosition(n);this.isSelecting=!1,this.selectingBox[1]=[p[0],p[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var n=this.selectingBox[0],p=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(g.COORDS_BY_SCREEN,[n[0],n[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(g.COORDS_BY_SCREEN,[n[0],p[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(g.COORDS_BY_SCREEN,[p[0],p[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(g.COORDS_BY_SCREEN,[p[0],n[1]])},_testForSelection:function(n){this._isRequiredKeyPressed(n,"selection")&&(s.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(n){var p;return s.exists(this.selectionPolygon)||(p=s.copyAttributes(n,v,"board","selection")).enabled===!0&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],p)),this},__evt__down:function(n){},__evt__mousedown:function(n){},__evt__pendown:function(n){},__evt__pointerdown:function(n){},__evt__touchstart:function(n){},__evt__up:function(n){},__evt__mouseup:function(n){},__evt__pointerup:function(n){},__evt__touchend:function(n){},__evt__move:function(n,p){},__evt__mousemove:function(n,p){},__evt__penmove:function(n,p){},__evt__pointermove:function(n,p){},__evt__touchmove:function(n,p){},__evt__hit:function(n,p,f){},__evt__mousehit:function(n,p,f){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},toFullscreen:function(n){var p,f,b;return n=n||this.container,this._fullscreen_inner_id=n,b=document.getElementById(n),p="fullscreenwrap_"+n,this.document.getElementById(p)?f=this.document.getElementById(p):((f=document.createElement("div")).classList.add("JXG_wrap_private"),f.setAttribute("id",p),b.parentNode.insertBefore(f,b),f.appendChild(b)),this._fullscreen_res=d._getScaleFactors(b),f.requestFullscreen=f.requestFullscreen||f.webkitRequestFullscreen||f.mozRequestFullScreen||f.msRequestFullscreen,f.requestFullscreen&&f.requestFullscreen(),this},fullscreenListener:function(n){var p,f,b;if(f=this._fullscreen_inner_id,s.exists(f)){if(document.fullscreenElement=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullscreenElement||document.msFullscreenElement,b=document.getElementById(f),document.fullscreenElement)p=this._fullscreen_res,b._cssFullscreenStore={id:document.fullscreenElement.id,isFullscreen:!0,margin:b.style.margin,width:b.style.width,scale:p.scale,vshift:p.vshift},b.style.margin="",b.style.width=p.width+"px",d.scaleJSXGraphDiv(document.fullscreenElement.id,f,p.scale,p.vshift),document.fullscreenElement=null;else if(s.exists(b._cssFullscreenStore)){try{document.styleSheets[document.styleSheets.length-1].deleteRule(0)}catch{console.log("JSXGraph: Could not remove CSS rules for full screen mode")}b._cssFullscreenStore.isFullscreen=!1,b.style.margin=b._cssFullscreenStore.margin,b.style.width=b._cssFullscreenStore.width}this.updateCSSTransforms()}},createRoulette:function(n,p,f,b,C,_,E){var x=this;return new function(){var S,O=0,w=0,T=0,M=f,N=m.root(function(W){var X=n.X(M),Q=n.Y(M),G=p.X(W),F=p.Y(W);return(X-G)*(X-G)+(Q-F)*(Q-F)},[0,2*Math.PI]),A=0,R=0,L=x.create("transform",[function(){return O}],{type:"rotate"}),D=x.create("transform",[function(){return O},function(){return n.X(M)},function(){return n.Y(M)}],{type:"rotate"}),k=x.create("transform",[function(){return w},function(){return T}],{type:"translate"}),B=function(W,X,Q){var G=m.D(W.X)(X),F=m.D(W.Y)(X),U=m.D(W.X)(Q),z=m.D(W.Y)(Q),re=m.D(W.X)(.5*(X+Q)),te=m.D(W.Y)(.5*(X+Q)),le=Math.sqrt(G*G+F*F),oe=Math.sqrt(U*U+z*z);return(le+4*Math.sqrt(re*re+te*te)+oe)*(Q-X)/6},I=function(W){return S-B(p,N,W)},Y=Math.PI/18,q=9*Y,V=null;return this.rolling=function(){var W,X,Q,G,F;S=B(n,M,A=M+C*b),R=m.root(I,N),W=new h(n.X(A),n.Y(A)),X=new h(p.X(R),p.Y(R)),Q=new h(m.D(n.X)(A),m.D(n.Y)(A)),G=new h(m.D(p.X)(R),m.D(p.Y)(R)),F=h.C.div(Q,G),O=Math.atan2(F.imaginary,F.real),F.div(h.C.abs(F)),F.mult(X),w=W.real-F.real,T=W.imaginary-F.imaginary,O<-Y&&O>-q?(O=-Y,D.applyOnce(E)):O>Y&&O<q?(O=Y,D.applyOnce(E)):(L.applyOnce(E),k.applyOnce(E),M=A,N=R),x.update()},this.start=function(){return _>0&&(V=window.setInterval(this.rolling,_)),this},this.stop=function(){return window.clearInterval(V),this},this}}}),g.Board}),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/color","utils/base64","math/numerics"],function(g,P,y,v,m,l,c,h){return g.SVGRenderer=function(e,o){var t;for(this.type="svg",this.isIE=navigator.appVersion.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=e,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.svgRoot.style.display="block",this.resize(o.width,o.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],t=0;t<P.layer.numlayers;t++)this.layer[t]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[t]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("display","none"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},g.SVGRenderer.prototype=new y,g.extend(g.SVGRenderer.prototype,{_createArrowHead:function(e,o,t){var s,a,d,u,n=e.id+"Triangle";return m.exists(o)&&(n+=o),(s=this.createPrim("marker",n)).setAttributeNS(null,"stroke",m.evaluate(e.visProp.strokecolor)),s.setAttributeNS(null,"stroke-opacity",m.evaluate(e.visProp.strokeopacity)),s.setAttributeNS(null,"fill",m.evaluate(e.visProp.strokecolor)),s.setAttributeNS(null,"fill-opacity",m.evaluate(e.visProp.strokeopacity)),s.setAttributeNS(null,"stroke-width",0),s.setAttributeNS(null,"orient","auto"),s.setAttributeNS(null,"markerUnits","strokeWidth"),a=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),u=5,o==="End"?(d=0,t===2?a.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z"):t===3?a.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z"):t===4?(u=3.31,a.setAttributeNS(null,"d","M 0.00,3.31 C 3.53,3.84 7.13,4.50 10.00,6.63 C 9.33,5.52 8.67,4.42 8.00,3.31 C 8.67,2.21 9.33,1.10 10.00,0.00 C 7.13,2.13 3.53,2.79 0.00,3.31")):t===5?(u=3.28,a.setAttributeNS(null,"d","M 0.00,3.28 C 3.39,4.19 6.81,5.07 10.00,6.55 C 9.38,5.56 9.00,4.44 9.00,3.28 C 9.00,2.11 9.38,0.99 10.00,0.00 C 6.81,1.49 3.39,2.37 0.00,3.28")):t===6?(u=2.84,a.setAttributeNS(null,"d","M 0.00,2.84 C 3.39,3.59 6.79,4.35 10.00,5.68 C 9.67,4.73 9.33,3.78 9.00,2.84 C 9.33,1.89 9.67,0.95 10.00,0.00 C 6.79,1.33 3.39,2.09 0.00,2.84")):t===7?(u=5.2,a.setAttributeNS(null,"d","M 0.00,5.20 C 4.04,5.20 7.99,6.92 10.00,10.39 M 10.00,0.00 C 7.99,3.47 4.04,5.20 0.00,5.20")):a.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"),e.elementClass===v.OBJECT_CLASS_LINE&&(d=t===2?4.9:t===3?3.3:t===4||t===5||t===6?6.66:t===7?0:10)):(d=10,t===2?a.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z"):t===3?(d=3.3,a.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):t===4?(u=3.31,a.setAttributeNS(null,"d","M 10.00,3.31 C 6.47,3.84 2.87,4.50 0.00,6.63 C 0.67,5.52 1.33,4.42 2.00,3.31 C 1.33,2.21 0.67,1.10 0.00,0.00 C 2.87,2.13 6.47,2.79 10.00,3.31")):t===5?(u=3.28,a.setAttributeNS(null,"d","M 10.00,3.28 C 6.61,4.19 3.19,5.07 0.00,6.55 C 0.62,5.56 1.00,4.44 1.00,3.28 C 1.00,2.11 0.62,0.99 0.00,0.00 C 3.19,1.49 6.61,2.37 10.00,3.28")):t===6?(u=2.84,a.setAttributeNS(null,"d","M 10.00,2.84 C 6.61,3.59 3.21,4.35 0.00,5.68 C 0.33,4.73 0.67,3.78 1.00,2.84 C 0.67,1.89 0.33,0.95 0.00,0.00 C 3.21,1.33 6.61,2.09 10.00,2.84")):t===7?(u=5.2,a.setAttributeNS(null,"d","M 10.00,5.20 C 5.96,5.20 2.01,6.92 0.00,10.39 M 0.00,0.00 C 2.01,3.47 5.96,5.20 10.00,5.20")):a.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"),e.elementClass===v.OBJECT_CLASS_LINE&&(d=t===2?5.1:t===3?.02:t===4||t===5||t===6?3.33:t===7?10:.05)),t===7&&(s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"stroke-width",1)),s.setAttributeNS(null,"refY",u),s.setAttributeNS(null,"refX",d),s.appendChild(a),s},_setArrowColor:function(e,o,t,s,a){e&&(m.isString(o)&&(a!==7?this._setAttribute(function(){e.setAttributeNS(null,"stroke",o),e.setAttributeNS(null,"fill",o),e.setAttributeNS(null,"stroke-opacity",t),e.setAttributeNS(null,"fill-opacity",t)},s.visPropOld.fillcolor):this._setAttribute(function(){e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke",o),e.setAttributeNS(null,"stroke-opacity",t)},s.visPropOld.fillcolor)),this.isIE&&s.rendNode.parentNode.insertBefore(s.rendNode,s.rendNode))},_setArrowWidth:function(e,o,t,s){var a,d;e&&(d=(a=o)*s,e.setAttributeNS(null,"viewBox","0 0 "+10*a+" "+10*a),e.setAttributeNS(null,"markerHeight",d),e.setAttributeNS(null,"markerWidth",d),e.setAttributeNS(null,"display","inherit"),this.isIE&&t.parentNode.insertBefore(t,t))},updateTicks:function(e){var o,t,s,a,d,u,n,p,f="",b=e.ticks.length,C=!0;for(o=0;o<b;o++){for(d=(s=e.ticks[o])[0],u=s[1],n=d.length,p=" M "+d[0]+" "+u[0],m.isNumber(d[0])||(C=!1),t=1;C&&t<n;++t)m.isNumber(d[t])?p+=" L "+d[t]+" "+u[t]:C=!1;C&&(f+=p)}a=e.rendNode,m.exists(a)||(a=this.createPrim("path",e.id),this.appendChildPrim(a,m.evaluate(e.visProp.layer)),e.rendNode=a),a.setAttributeNS(null,"stroke",m.evaluate(e.visProp.strokecolor)),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"stroke-opacity",m.evaluate(e.visProp.strokeopacity)),a.setAttributeNS(null,"stroke-width",m.evaluate(e.visProp.strokewidth)),this.updatePathPrim(a,f,e.board)},displayCopyright:function(e,o){var t,s=this.createPrim("text","licenseText");s.setAttributeNS(null,"x","20px"),s.setAttributeNS(null,"y",2+o+"px"),s.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+o+"px; fill:#356AA0;  opacity:0.3;"),t=this.container.ownerDocument.createTextNode(e),s.appendChild(t),this.appendChildPrim(s,0)},drawInternalText:function(e){var o=this.createPrim("text",e.id);return o.style.whiteSpace="nowrap",e.rendNodeText=this.container.ownerDocument.createTextNode(""),o.appendChild(e.rendNodeText),this.appendChildPrim(o,m.evaluate(e.visProp.layer)),o},updateInternalText:function(e){var o,t=e.plaintext,s=e.getAnchorX(),a=e.getAnchorY();e.rendNode.getAttributeNS(null,"class")!==e.visProp.cssclass&&(e.rendNode.setAttributeNS(null,"class",m.evaluate(e.visProp.cssclass)),e.needsSizeUpdate=!0),isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||(o=e.coords.scrCoords[1],e.visPropOld.left!==s+o&&(e.rendNode.setAttributeNS(null,"x",o+"px"),s==="left"?e.rendNode.setAttributeNS(null,"text-anchor","start"):s==="right"?e.rendNode.setAttributeNS(null,"text-anchor","end"):s==="middle"&&e.rendNode.setAttributeNS(null,"text-anchor","middle"),e.visPropOld.left=s+o),o=e.coords.scrCoords[2],e.visPropOld.top!==a+o&&(e.rendNode.setAttributeNS(null,"y",o+.5*this.vOffsetText+"px"),a==="bottom"?e.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):a==="top"?e.rendNode.setAttributeNS(null,"dy","1.6ex"):a==="middle"&&e.rendNode.setAttributeNS(null,"dy","0.6ex"),e.visPropOld.top=a+o)),e.htmlStr!==t&&(e.rendNodeText.data=t,e.htmlStr=t),this.transformImage(e,e.transformations)},updateInternalTextStyle:function(e,o,t,s){this.setObjectFillColor(e,o,t)},drawImage:function(e){var o=this.createPrim("image",e.id);o.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(o,m.evaluate(e.visProp.layer)),e.rendNode=o,this.updateImage(e)},transformImage:function(e,o){var t,s=e.rendNode,a="";o.length>0&&(a+=" matrix("+[(t=this.joinTransforms(e,o))[1][1],t[2][1],t[1][2],t[2][2],t[1][0],t[2][0]].join(",")+") ",s.setAttributeNS(null,"transform",a))},updateImageURL:function(e){var o=m.evaluate(e.url);return e._src!==o&&(e.imgIsLoaded=!1,e.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",o),e._src=o,!0)},updateImageStyle:function(e,o){var t=m.evaluate(o?e.visProp.highlightcssclass:e.visProp.cssclass);e.rendNode.setAttributeNS(null,"class",t)},drawForeignObject:function(e){e.rendNode=this.appendChildPrim(this.createPrim("foreignObject",e.id),m.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"foreignObject"),this.updateForeignObject(e)},updateForeignObject:function(e){e._useUserSize?e.rendNode.style.overflow="hidden":e.rendNode.style.overflow="visible",this.updateRectPrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1],e.size[0],e.size[1]),e.rendNode.innerHTML=e.content,this._updateVisual(e,{stroke:!0,dash:!0},!0)},appendChildPrim:function(e,o){return m.exists(o)?o>=P.layer.numlayers&&(o=P.layer.numlayers-1):o=0,this.layer[o].appendChild(e),e},createPrim:function(e,o){var t=this.container.ownerDocument.createElementNS(this.svgNamespace,e);return t.setAttributeNS(null,"id",this.container.id+"_"+o),t.style.position="absolute",e==="path"&&(t.setAttributeNS(null,"stroke-linecap","round"),t.setAttributeNS(null,"stroke-linejoin","round"),t.setAttributeNS(null,"fill-rule","evenodd")),t},remove:function(e){m.exists(e)&&m.exists(e.parentNode)&&e.parentNode.removeChild(e)},setLayer:function(e,o){m.exists(o)?o>=P.layer.numlayers&&(o=P.layer.numlayers-1):o=0,this.layer[o].appendChild(e.rendNode)},makeArrows:function(e,o){var t,s=o.evFirst,a=o.evLast;e.visPropOld.firstarrow!==s||e.visPropOld.lastarrow!==a?(s?(t=e.rendNodeTriangleStart,m.exists(t)?this.defs.appendChild(t):(t=this._createArrowHead(e,"End",o.typeFirst),this.defs.appendChild(t),e.rendNodeTriangleStart=t,e.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+e.id+"TriangleEnd)"))):(t=e.rendNodeTriangleStart,m.exists(t)&&this.remove(t)),a?(t=e.rendNodeTriangleEnd,m.exists(t)?this.defs.appendChild(t):(t=this._createArrowHead(e,"Start",o.typeLast),this.defs.appendChild(t),e.rendNodeTriangleEnd=t,e.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+e.id+"TriangleStart)"))):(t=e.rendNodeTriangleEnd,m.exists(t)&&this.remove(t)),e.visPropOld.firstarrow=s,e.visPropOld.lastarrow=a):this.isIE&&e.visPropCalc.visible&&(s||a)&&e.rendNode.parentNode.insertBefore(e.rendNode,e.rendNode)},updateEllipsePrim:function(e,o,t,s,a){var d;d=2e5,o=Math.abs(o)<d?o:d*o/Math.abs(o),t=Math.abs(t)<d?t:d*t/Math.abs(t),s=Math.abs(s)<d?s:d*s/Math.abs(s),a=Math.abs(a)<d?a:d*a/Math.abs(a),e.setAttributeNS(null,"cx",o),e.setAttributeNS(null,"cy",t),e.setAttributeNS(null,"rx",Math.abs(s)),e.setAttributeNS(null,"ry",Math.abs(a))},updateLinePrim:function(e,o,t,s,a){var d;d=2e5,isNaN(o+t+s+a)||(o=Math.abs(o)<d?o:d*o/Math.abs(o),t=Math.abs(t)<d?t:d*t/Math.abs(t),s=Math.abs(s)<d?s:d*s/Math.abs(s),a=Math.abs(a)<d?a:d*a/Math.abs(a),e.setAttributeNS(null,"x1",o),e.setAttributeNS(null,"y1",t),e.setAttributeNS(null,"x2",s),e.setAttributeNS(null,"y2",a))},updatePathPrim:function(e,o){o===""&&(o="M 0 0"),e.setAttributeNS(null,"d",o)},updatePathStringPoint:function(e,o,t){var s="",a=e.coords.scrCoords,d=o*Math.sqrt(3)*.5,u=.5*o;return t==="x"?s=" M "+(a[1]-o)+" "+(a[2]-o)+" L "+(a[1]+o)+" "+(a[2]+o)+" M "+(a[1]+o)+" "+(a[2]-o)+" L "+(a[1]-o)+" "+(a[2]+o):t==="+"?s=" M "+(a[1]-o)+" "+a[2]+" L "+(a[1]+o)+" "+a[2]+" M "+a[1]+" "+(a[2]-o)+" L "+a[1]+" "+(a[2]+o):t==="<>"?s=" M "+(a[1]-o)+" "+a[2]+" L "+a[1]+" "+(a[2]+o)+" L "+(a[1]+o)+" "+a[2]+" L "+a[1]+" "+(a[2]-o)+" Z ":t==="^"?s=" M "+a[1]+" "+(a[2]-o)+" L "+(a[1]-d)+" "+(a[2]+u)+" L "+(a[1]+d)+" "+(a[2]+u)+" Z ":t==="v"?s=" M "+a[1]+" "+(a[2]+o)+" L "+(a[1]-d)+" "+(a[2]-u)+" L "+(a[1]+d)+" "+(a[2]-u)+" Z ":t===">"?s=" M "+(a[1]+o)+" "+a[2]+" L "+(a[1]-u)+" "+(a[2]-d)+" L "+(a[1]-u)+" "+(a[2]+d)+" Z ":t==="<"&&(s=" M "+(a[1]-o)+" "+a[2]+" L "+(a[1]+u)+" "+(a[2]-d)+" L "+(a[1]+u)+" "+(a[2]+d)+" Z "),s},updatePathStringPrim:function(e){var o,t,s,a=" M ",d=a,u=5e3,n="";if(e.numberPoints<=0)return"";if(s=Math.min(e.points.length,e.numberPoints),e.bezierDegree===1)for(o=0;o<s;o++)t=e.points[o].scrCoords,isNaN(t[1])||isNaN(t[2])?d=a:(t[1]=Math.max(Math.min(t[1],u),-5e3),t[2]=Math.max(Math.min(t[2],u),-5e3),n+=d+t[1]+" "+t[2],d=" L ");else if(e.bezierDegree===3)for(o=0;o<s;)t=e.points[o].scrCoords,isNaN(t[1])||isNaN(t[2])?d=a:(n+=d+t[1]+" "+t[2],d===" C "&&(o+=1,n+=" "+(t=e.points[o].scrCoords)[1]+" "+t[2],o+=1,n+=" "+(t=e.points[o].scrCoords)[1]+" "+t[2]),d=" C "),o+=1;return n},updatePathStringBezierPrim:function(e){var o,t,s,a,d,u,n,p=" M ",f=p,b=5e3,C="",_=m.evaluate(e.visProp.strokewidth),E=m.evaluate(e.visProp.curvetype)!=="plot";if(e.numberPoints<=0)return"";for(E&&e.board.options.curve.RDPsmoothing&&(e.points=h.RamerDouglasPeucker(e.points,.5)),n=Math.min(e.points.length,e.numberPoints),t=1;t<3;t++)for(f=p,o=0;o<n;o++)a=e.points[o].scrCoords,isNaN(a[1])||isNaN(a[2])?f=p:(a[1]=Math.max(Math.min(a[1],b),-5e3),a[2]=Math.max(Math.min(a[2],b),-5e3),f===p?C+=f+a[1]+" "+a[2]:(s=2*t,C+=[f,d+.333*(a[1]-d)+_*(s*Math.random()-t)," ",u+.333*(a[2]-u)+_*(s*Math.random()-t)," ",d+.666*(a[1]-d)+_*(s*Math.random()-t)," ",u+.666*(a[2]-u)+_*(s*Math.random()-t)," ",a[1]," ",a[2]].join("")),f=" C ",d=a[1],u=a[2]);return C},updatePolygonPrim:function(e,o){var t,s,a="",d=o.vertices.length;for(e.setAttributeNS(null,"stroke","none"),o.elType==="polygonalchain"&&d++,t=0;t<d-1;t++){if(!o.vertices[t].isReal)return void e.setAttributeNS(null,"points","");a=a+(s=o.vertices[t].coords.scrCoords)[1]+","+s[2],t<d-2&&(a+=" ")}a.indexOf("NaN")===-1&&e.setAttributeNS(null,"points",a)},updateRectPrim:function(e,o,t,s,a){e.setAttributeNS(null,"x",o),e.setAttributeNS(null,"y",t),e.setAttributeNS(null,"width",s),e.setAttributeNS(null,"height",a)},setPropertyPrim:function(e,o,t){o!=="stroked"&&e.setAttributeNS(null,o,t)},display:function(e,o){var t;e&&e.rendNode&&(e.visPropOld.visible=o,t=e.rendNode,o?(t.setAttributeNS(null,"display","inline"),t.style.visibility="inherit"):(t.setAttributeNS(null,"display","none"),t.style.visibility="hidden"))},show:function(e){g.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(e,!0)},hide:function(e){g.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(e,!1)},setBuffering:function(e,o){e.rendNode.setAttribute("buffered-rendering",o)},setDashStyle:function(e){var o=m.evaluate(e.visProp.dash),t=e.rendNode;o>0?t.setAttributeNS(null,"stroke-dasharray",this.dashArray[o-1]):t.hasAttributeNS(null,"stroke-dasharray")&&t.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(e){var o,t,s,a=e.rendNode,d=m.evaluate(e.visProp.gradient);d==="linear"||d==="radial"?(o=this.createPrim(d+"Gradient",e.id+"_gradient"),t=this.createPrim("stop",e.id+"_gradient1"),s=this.createPrim("stop",e.id+"_gradient2"),o.appendChild(t),o.appendChild(s),this.defs.appendChild(o),a.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+e.id+"_gradient)"),e.gradNode1=t,e.gradNode2=s,e.gradNode=o):a.removeAttributeNS(null,"style")},updateGradientAngle:function(e,o){var t=1,s=Math.cos(o),a=Math.sin(o);Math.abs(s)>Math.abs(a)?t/=Math.abs(s):t/=Math.abs(a),s>=0?(e.setAttributeNS(null,"x1",0),e.setAttributeNS(null,"x2",s*t)):(e.setAttributeNS(null,"x1",-s*t),e.setAttributeNS(null,"x2",0)),a>=0?(e.setAttributeNS(null,"y1",0),e.setAttributeNS(null,"y2",a*t)):(e.setAttributeNS(null,"y1",-a*t),e.setAttributeNS(null,"y2",0))},updateGradientCircle:function(e,o,t,s,a,d,u){e.setAttributeNS(null,"cx",100*o+"%"),e.setAttributeNS(null,"cy",100*t+"%"),e.setAttributeNS(null,"r",100*s+"%"),e.setAttributeNS(null,"fx",100*a+"%"),e.setAttributeNS(null,"fy",100*d+"%"),e.setAttributeNS(null,"fr",100*u+"%")},updateGradient:function(e){var o,t,s=e.gradNode1,a=e.gradNode2,d=m.evaluate(e.visProp.gradient);m.exists(s)&&m.exists(a)&&(t=(t=m.evaluate(e.visProp.fillopacity))>0?t:0,o=m.evaluate(e.visProp.fillcolor),s.setAttributeNS(null,"style","stop-color:"+o+";stop-opacity:"+t),a.setAttributeNS(null,"style","stop-color:"+m.evaluate(e.visProp.gradientsecondcolor)+";stop-opacity:"+m.evaluate(e.visProp.gradientsecondopacity)),s.setAttributeNS(null,"offset",100*m.evaluate(e.visProp.gradientstartoffset)+"%"),a.setAttributeNS(null,"offset",100*m.evaluate(e.visProp.gradientendoffset)+"%"),d==="linear"?this.updateGradientAngle(e.gradNode,m.evaluate(e.visProp.gradientangle)):d==="radial"&&this.updateGradientCircle(e.gradNode,m.evaluate(e.visProp.gradientcx),m.evaluate(e.visProp.gradientcy),m.evaluate(e.visProp.gradientr),m.evaluate(e.visProp.gradientfx),m.evaluate(e.visProp.gradientfy),m.evaluate(e.visProp.gradientfr)))},setObjectTransition:function(e,o){var t,s,a,d=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(o===void 0&&(o=m.evaluate(e.visProp.transitionduration)),o!==e.visPropOld.transitionduration){for(t=e.elementClass===v.OBJECT_CLASS_TEXT&&m.evaluate(e.visProp.display)==="html"?" color "+o+"ms, opacity "+o+"ms":" fill "+o+"ms, fill-opacity "+o+"ms, stroke "+o+"ms, stroke-opacity "+o+"ms",a=d.length,s=0;s<a;++s)e[d[s]]&&(e[d[s]].style.transition=t);e.visPropOld.transitionduration=o}},_setAttribute:function(e,o){o===""?e():window.setTimeout(e,1)},setObjectFillColor:function(e,o,t,s){var a,d,u,n,p=m.evaluate(o),f=m.evaluate(t),b=m.evaluate(e.visProp.gradient);f=f>0?f:0,e.visPropOld.fillcolor===p&&e.visPropOld.fillopacity===f&&b===null||(m.exists(p)&&p!==!1&&(p.length!==9?(d=p,n=f):(u=l.rgba2rgbo(p),d=u[0],n=f*u[1]),a=s===void 0?e.rendNode:s,d!=="none"&&this._setAttribute(function(){a.setAttributeNS(null,"fill",d)},e.visPropOld.fillcolor),e.type===g.OBJECT_TYPE_IMAGE?this._setAttribute(function(){a.setAttributeNS(null,"opacity",n)},e.visPropOld.fillopacity):(d==="none"?(n=0,a.setAttributeNS(null,"pointer-events","visibleStroke")):a.setAttributeNS(null,"pointer-events","visiblePainted"),this._setAttribute(function(){a.setAttributeNS(null,"fill-opacity",n)},e.visPropOld.fillopacity)),b!=="linear"&&b!=="radial"||this.updateGradient(e)),e.visPropOld.fillcolor=p,e.visPropOld.fillopacity=f)},setObjectStrokeColor:function(e,o,t){var s,a,d,u,n=m.evaluate(o),p=m.evaluate(t);p=p>0?p:0,e.visPropOld.strokecolor===n&&e.visPropOld.strokeopacity===p||(m.exists(n)&&n!==!1&&(n.length!==9?(s=n,d=p):(a=l.rgba2rgbo(n),s=a[0],d=p*a[1]),u=e.rendNode,e.elementClass===v.OBJECT_CLASS_TEXT?m.evaluate(e.visProp.display)==="html"?this._setAttribute(function(){u.style.color=s,u.style.opacity=d},e.visPropOld.strokecolor):this._setAttribute(function(){u.setAttributeNS(null,"style","fill:"+s),u.setAttributeNS(null,"style","fill-opacity:"+d)},e.visPropOld.strokecolor):this._setAttribute(function(){u.setAttributeNS(null,"stroke",s),u.setAttributeNS(null,"stroke-opacity",d)},e.visPropOld.strokecolor),e.elementClass!==v.OBJECT_CLASS_CURVE&&e.elementClass!==v.OBJECT_CLASS_LINE||(m.evaluate(e.visProp.firstarrow)&&this._setArrowColor(e.rendNodeTriangleStart,s,d,e,e.visPropCalc.typeFirst),m.evaluate(e.visProp.lastarrow)&&this._setArrowColor(e.rendNodeTriangleEnd,s,d,e,e.visPropCalc.typeLast))),e.visPropOld.strokecolor=n,e.visPropOld.strokeopacity=p)},setObjectStrokeWidth:function(e,o){var t,s=m.evaluate(o);isNaN(s)||e.visPropOld.strokewidth===s||(t=e.rendNode,this.setPropertyPrim(t,"stroked","true"),m.exists(s)&&this.setPropertyPrim(t,"stroke-width",s+"px"),e.visPropOld.strokewidth=s)},setLineCap:function(e){var o=m.evaluate(e.visProp.linecap);o!==void 0&&o!==""&&e.visPropOld.linecap!==o&&m.exists(e.rendNode)&&(this.setPropertyPrim(e.rendNode,"stroke-linecap",o),e.visPropOld.linecap=o)},setShadow:function(e){var o=m.evaluate(e.visProp.shadow);e.visPropOld.shadow!==o&&(m.exists(e.rendNode)&&(o?e.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):e.rendNode.removeAttributeNS(null,"filter")),e.visPropOld.shadow=o)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(e,o){this.svgRoot.setAttribute("width",parseFloat(e)),this.svgRoot.setAttribute("height",parseFloat(o))},createTouchpoints:function(e){var o,t,s,a;for(this.touchpoints=[],o=0;o<e;o++)t="touchpoint1_"+o,a=this.createPrim("path",t),this.appendChildPrim(a,19),a.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(a),this.setPropertyPrim(a,"stroked","true"),this.setPropertyPrim(a,"stroke-width","1px"),a.setAttributeNS(null,"stroke","#000000"),a.setAttributeNS(null,"stroke-opacity",1),a.setAttributeNS(null,"display","none"),s="touchpoint2_"+o,a=this.createPrim("ellipse",s),this.appendChildPrim(a,19),this.updateEllipsePrim(a,0,0,0,0),this.touchpoints.push(a),this.setPropertyPrim(a,"stroked","true"),this.setPropertyPrim(a,"stroke-width","1px"),a.setAttributeNS(null,"stroke","#000000"),a.setAttributeNS(null,"stroke-opacity",1),a.setAttributeNS(null,"fill","#ffffff"),a.setAttributeNS(null,"fill-opacity",0),a.setAttributeNS(null,"display","none")},showTouchpoint:function(e){this.touchpoints&&e>=0&&2*e<this.touchpoints.length&&(this.touchpoints[2*e].setAttributeNS(null,"display","inline"),this.touchpoints[2*e+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(e){this.touchpoints&&e>=0&&2*e<this.touchpoints.length&&(this.touchpoints[2*e].setAttributeNS(null,"display","none"),this.touchpoints[2*e+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(e,o){var t,s;this.touchpoints&&e>=0&&2*e<this.touchpoints.length&&(t=o[0],s=o[1],this.touchpoints[2*e].setAttributeNS(null,"d","M "+(t-37)+" "+s+" L "+(t+37)+" "+s+" M "+t+" "+(s-37)+" L "+t+" "+(s+37)),this.updateEllipsePrim(this.touchpoints[2*e+1],o[0],o[1],25,25))},_getValuesOfDOMElements:function(e){var o=[];if(e.nodeType===1)for(e=e.firstChild;e;)e.id!==void 0&&e.value!==void 0&&o.push([e.id,e.value]),o=o.concat(this._getValuesOfDOMElements(e)),e=e.nextSibling;return o},_getDataUri:function(e,o){var t=new Image;t.onload=function(){var s=document.createElement("canvas");s.width=this.naturalWidth,s.height=this.naturalHeight,s.getContext("2d").drawImage(this,0,0),o(s.toDataURL("image/png")),s.remove()},t.src=e},_getImgDataURL:function(e){var o,t,s,a,d,u;if((t=(o=e.getElementsByTagName("image")).length)>0)for(s=document.createElement("canvas"),u=0;u<t;u++){o[u].setAttribute("crossorigin","anonymous"),a=s.getContext("2d"),s.width=o[u].getAttribute("width"),s.height=o[u].getAttribute("height");try{a.drawImage(o[u],0,0,s.width,s.height),d=s.toDataURL(),o[u].setAttribute("xlink:href",d)}catch(n){console.log("CORS problem! Image can not be used",n)}}return!0},dumpToDataURI:function(e){var o,t,s,a=this.svgRoot,d=window.btoa||c.encode,u=[];if(this.container.hasChildNodes()&&m.exists(this.foreignObjLayer))for(e||this.foreignObjLayer.setAttribute("display","inline");a.nextSibling;)u=u.concat(this._getValuesOfDOMElements(a.nextSibling)),this.foreignObjLayer.appendChild(a.nextSibling);if(this._getImgDataURL(a),a.setAttribute("xmlns","http://www.w3.org/2000/svg"),o=new XMLSerializer().serializeToString(a),e!==!0)for(s=u.length,t=0;t<s;t++)o=o.replace('id="'+u[t][0]+'"','id="'+u[t][0]+'" value="'+u[t][1]+'"');if((o.match(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g)||[]).length>1&&(o=o.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,"")),o=o.replace(/&nbsp;/g," "),m.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes()){for(;this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);this.foreignObjLayer.setAttribute("display","none")}return"data:image/svg+xml;base64,"+d(unescape(encodeURIComponent(o)))},dumpToCanvas:function(e,o,t,s){var a,d,u,n;return(u=document.getElementById(e)).width=u.width,n=u.getContext("2d"),o!==void 0&&t!==void 0&&(u.style.width=parseFloat(o)+"px",u.style.height=parseFloat(t)+"px",u.setAttribute("width",parseFloat(o)),u.setAttribute("height",parseFloat(t))),d=new Image,a=this.dumpToDataURI(s),d.src=a,"Promise"in window?new Promise(function(p,f){try{d.onload=function(){n.drawImage(d,0,0,o,t),p()}}catch(b){f(b)}}):(d.onload=function(){window.setTimeout(function(){try{n.drawImage(d,0,0,o,t)}catch{console.log("screenshots not longer supported on IE")}},200)},this)},screenshot:function(e,o,t){var s,a,d,u,n,p,f,b,C,_,E,x=this.container.ownerDocument,S=this.container.parentNode,O=e.attr.screenshot,w=!1;return this.type==="no"||(f=O.scale*this.container.getBoundingClientRect().width,b=O.scale*this.container.getBoundingClientRect().height,o===void 0||o===""?(w=!0,(u=new Image).style.width=f+"px",u.style.height=b+"px"):(w=!1,u=x.getElementById(o)),w&&((s=x.createElement("div")).style.cssText=O.css,s.style.width=f+"px",s.style.height=b+"px",s.style.zIndex=this.container.style.zIndex+120,s.style.position="absolute",s.style.top=this.container.offsetTop+"px",s.style.left=this.container.offsetLeft+"px"),a=x.createElement("canvas"),d=Math.random().toString(36).substr(2,5),a.setAttribute("id",d),a.setAttribute("width",f),a.setAttribute("height",b),a.style.width=f+"px",a.style.height=f+"px",a.style.display="none",S.appendChild(a),w&&(n=x.createElement("span"),p=x.createTextNode("\u2716"),n.style.cssText=O.cssButton,n.appendChild(p),n.onclick=function(){s.parentNode.removeChild(s)},s.appendChild(u),s.appendChild(n),S.insertBefore(s,this.container.nextSibling)),C=document.getElementById(this.container.id+"_navigationbar"),m.exists(C)&&(_=C.style.display,C.style.display="none"),E=function(){u.src=a.toDataURL("image/png"),S.removeChild(a)},"Promise"in window?this.dumpToCanvas(d,f,b,t).then(E):(this.dumpToCanvas(d,f,b,t),window.setTimeout(E,200)),m.exists(C)&&(C.style.display=_)),this}}),g.SVGRenderer}),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],function(g,P,y,v,m,l,c){return g.VMLRenderer=function(h){this.type="vml",this.container=h,this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,v.exists(g.vmlStylesheet)||(h.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),g.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),g.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{h.ownerDocument.namespaces.jxgvml||h.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(e){return h.ownerDocument.createElement("<jxgvml:"+e+' class="jxgvml">')}}catch{this.createNode=function(o){return h.ownerDocument.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},g.VMLRenderer.prototype=new P,g.extend(g.VMLRenderer.prototype,{_setAttr:function(h,e,o,t){try{this.container.ownerDocument.documentMode===8?h[e]=o:h.setAttribute(e,o,t)}catch{g.debug("_setAttr: "+e+" "+o+`<br>
`)}},updateTicks:function(h){var e,o,t,s,a,d=this.resolution,u=[];for(o=h.ticks.length,e=0;e<o;e++)s=(t=h.ticks[e])[0],a=t[1],v.isNumber(s[0])&&v.isNumber(s[1])&&u.push(" m "+Math.round(d*s[0])+", "+Math.round(d*a[0])+" l "+Math.round(d*s[1])+", "+Math.round(d*a[1])+" ");v.exists(h.rendNode)||(h.rendNode=this.createPrim("path",h.id),this.appendChildPrim(h.rendNode,v.evaluate(h.visProp.layer))),this._setAttr(h.rendNode,"stroked","true"),this._setAttr(h.rendNode,"strokecolor",v.evaluate(h.visProp.strokecolor),1),this._setAttr(h.rendNode,"strokeweight",v.evaluate(h.visProp.strokewidth)),this._setAttr(h.rendNodeStroke,"opacity",100*v.evaluate(h.visProp.strokeopacity)+"%"),this.updatePathPrim(h.rendNode,u,h.board)},displayCopyright:function(h,e){var o,t;(o=this.createNode("textbox")).style.position="absolute",this._setAttr(o,"id",this.container.id+"_licenseText"),o.style.left=20,o.style.top=2,o.style.fontSize=e,o.style.color="#356AA0",o.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(o,"opacity","30%"),o.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",t=this.container.ownerDocument.createTextNode(h),o.appendChild(t),this.appendChildPrim(o,0)},drawInternalText:function(h){var e;return(e=this.createNode("textbox")).style.position="absolute",h.rendNodeText=this.container.ownerDocument.createTextNode(""),e.appendChild(h.rendNodeText),this.appendChildPrim(e,9),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",e},updateInternalText:function(h){var e,o,t,s,a,d,u=h.plaintext,n=this.joinTransforms(h,h.transformations),p=[0,0],f=h.rendNode,b=[],C=h.getAnchorX(),_=h.getAnchorY();if(!isNaN(h.coords.scrCoords[1]+h.coords.scrCoords[2])){for(C==="right"?p[0]=1:C==="middle"&&(p[0]=.5),_==="bottom"?p[1]=1:_==="middle"&&(p[1]=.5),b[0]=l.matVecMult(n,[1,h.coords.scrCoords[1]-p[0]*h.size[0],h.coords.scrCoords[2]+(1-p[1])*h.size[1]+this.vOffsetText]),b[0][1]/=b[0][0],b[0][2]/=b[0][0],b[1]=l.matVecMult(n,[1,h.coords.scrCoords[1]+(1-p[0])*h.size[0],h.coords.scrCoords[2]+(1-p[1])*h.size[1]+this.vOffsetText]),b[1][1]/=b[1][0],b[1][2]/=b[1][0],b[2]=l.matVecMult(n,[1,h.coords.scrCoords[1]+(1-p[0])*h.size[0],h.coords.scrCoords[2]-p[1]*h.size[1]+this.vOffsetText]),b[2][1]/=b[2][0],b[2][2]/=b[2][0],b[3]=l.matVecMult(n,[1,h.coords.scrCoords[1]-p[0]*h.size[0],h.coords.scrCoords[2]-p[1]*h.size[1]+this.vOffsetText]),b[3][1]/=b[3][0],b[3][2]/=b[3][0],o=b[0][1],s=b[0][1],t=b[0][2],a=b[0][2],d=1;d<4;d++)o=Math.max(o,b[d][1]),s=Math.min(s,b[d][1]),t=Math.max(t,b[d][2]),a=Math.min(a,b[d][2]);e=p[0]===1?Math.floor(h.board.canvasWidth-o):Math.floor(s),h.visPropOld.left!==C+e&&(p[0]===1?(h.rendNode.style.right=e+"px",h.rendNode.style.left="auto"):(h.rendNode.style.left=e+"px",h.rendNode.style.right="auto"),h.visPropOld.left=C+e),e=p[1]===1?Math.floor(h.board.canvasHeight-t):Math.floor(a),h.visPropOld.top!==_+e&&(p[1]===1?(h.rendNode.style.bottom=e+"px",h.rendNode.style.top="auto"):(h.rendNode.style.top=e+"px",h.rendNode.style.bottom="auto"),h.visPropOld.top=_+e)}h.htmlStr!==u&&(h.rendNodeText.data=u,h.htmlStr=u),f.filters.item(0).M11=n[1][1],f.filters.item(0).M12=n[1][2],f.filters.item(0).M21=n[2][1],f.filters.item(0).M22=n[2][2],f.filters.item(0).enabled=!0},drawImage:function(h){var e;(e=this.container.ownerDocument.createElement("img")).style.position="absolute",this._setAttr(e,"id",this.container.id+"_"+h.id),this.container.appendChild(e),this.appendChildPrim(e,v.evaluate(h.visProp.layer)),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",h.rendNode=e,this.updateImage(h)},transformImage:function(h,e){var o,t,s,a,d,u,n=h.rendNode,p=[];if(e.length>0){for(o=this.joinTransforms(h,e),p[0]=l.matVecMult(o,h.coords.scrCoords),p[0][1]/=p[0][0],p[0][2]/=p[0][0],p[1]=l.matVecMult(o,[1,h.coords.scrCoords[1]+h.size[0],h.coords.scrCoords[2]]),p[1][1]/=p[1][0],p[1][2]/=p[1][0],p[2]=l.matVecMult(o,[1,h.coords.scrCoords[1]+h.size[0],h.coords.scrCoords[2]-h.size[1]]),p[2][1]/=p[2][0],p[2][2]/=p[2][0],p[3]=l.matVecMult(o,[1,h.coords.scrCoords[1],h.coords.scrCoords[2]-h.size[1]]),p[3][1]/=p[3][0],p[3][2]/=p[3][0],t=p[0][1],a=p[0][1],s=p[0][2],d=p[0][2],u=1;u<4;u++)t=Math.max(t,p[u][1]),a=Math.min(a,p[u][1]),s=Math.max(s,p[u][2]),d=Math.min(d,p[u][2]);n.style.left=Math.floor(a)+"px",n.style.top=Math.floor(d)+"px",n.filters.item(0).M11=o[1][1],n.filters.item(0).M12=o[1][2],n.filters.item(0).M21=o[2][1],n.filters.item(0).M22=o[2][2],n.filters.item(0).enabled=!0}},updateImageURL:function(h){var e=v.evaluate(h.url);this._setAttr(h.rendNode,"src",e)},appendChildPrim:function(h,e){return v.exists(e)||(e=0),h.style.zIndex=e,this.container.appendChild(h),h},appendNodesToElement:function(h,e){e!=="shape"&&e!=="path"&&e!=="polygon"||(h.rendNodePath=this.getElementById(h.id+"_path")),h.rendNodeFill=this.getElementById(h.id+"_fill"),h.rendNodeStroke=this.getElementById(h.id+"_stroke"),h.rendNodeShadow=this.getElementById(h.id+"_shadow"),h.rendNode=this.getElementById(h.id)},createPrim:function(h,e){var o,t,s=this.createNode("fill"),a=this.createNode("stroke"),d=this.createNode("shadow");return this._setAttr(s,"id",this.container.id+"_"+e+"_fill"),this._setAttr(a,"id",this.container.id+"_"+e+"_stroke"),this._setAttr(d,"id",this.container.id+"_"+e+"_shadow"),h==="circle"||h==="ellipse"?((o=this.createNode("oval")).appendChild(s),o.appendChild(a),o.appendChild(d)):h==="polygon"||h==="path"||h==="shape"||h==="line"?((o=this.createNode("shape")).appendChild(s),o.appendChild(a),o.appendChild(d),t=this.createNode("path"),this._setAttr(t,"id",this.container.id+"_"+e+"_path"),o.appendChild(t)):((o=this.createNode(h)).appendChild(s),o.appendChild(a),o.appendChild(d)),o.style.position="absolute",o.style.left="0px",o.style.top="0px",this._setAttr(o,"id",this.container.id+"_"+e),o},remove:function(h){v.exists(h)&&h.removeNode(!0)},makeArrows:function(h){var e,o=v.evaluate(h.visProp.firstarrow),t=v.evaluate(h.visProp.lastarrow);h.visPropOld.firstarrow===o&&h.visPropOld.lastarrow===t||(o?(e=h.rendNodeStroke,this._setAttr(e,"startarrow","block"),this._setAttr(e,"startarrowlength","long")):(e=h.rendNodeStroke,v.exists(e)&&this._setAttr(e,"startarrow","none")),t?(e=h.rendNodeStroke,this._setAttr(e,"id",this.container.id+"_"+h.id+"stroke"),this._setAttr(e,"endarrow","block"),this._setAttr(e,"endarrowlength","long")):(e=h.rendNodeStroke,v.exists(e)&&this._setAttr(e,"endarrow","none")),h.visPropOld.firstarrow=o,h.visPropOld.lastarrow=t)},updateEllipsePrim:function(h,e,o,t,s){h.style.left=Math.floor(e-t)+"px",h.style.top=Math.floor(o-s)+"px",h.style.width=Math.floor(2*Math.abs(t))+"px",h.style.height=Math.floor(2*Math.abs(s))+"px"},updateLinePrim:function(h,e,o,t,s,a){var d,u=this.resolution;isNaN(e+o+t+s)||(d=["m ",Math.floor(u*e),", ",Math.floor(u*o)," l ",Math.floor(u*t),", ",Math.floor(u*s)],this.updatePathPrim(h,d,a))},updatePathPrim:function(h,e,o){var t=o.canvasWidth,s=o.canvasHeight;e.length<=0&&(e=["m 0,0"]),h.style.width=t,h.style.height=s,this._setAttr(h,"coordsize",[Math.floor(this.resolution*t),Math.floor(this.resolution*s)].join(",")),this._setAttr(h,"path",e.join(""))},updatePathStringPoint:function(h,e,o){var t=[],s=Math.round,a=h.coords.scrCoords,d=e*Math.sqrt(3)*.5,u=.5*e,n=this.resolution;return o==="x"?t.push([" m ",s(n*(a[1]-e)),", ",s(n*(a[2]-e))," l ",s(n*(a[1]+e)),", ",s(n*(a[2]+e))," m ",s(n*(a[1]+e)),", ",s(n*(a[2]-e))," l ",s(n*(a[1]-e)),", ",s(n*(a[2]+e))].join("")):o==="+"?t.push([" m ",s(n*(a[1]-e)),", ",s(n*a[2])," l ",s(n*(a[1]+e)),", ",s(n*a[2])," m ",s(n*a[1]),", ",s(n*(a[2]-e))," l ",s(n*a[1]),", ",s(n*(a[2]+e))].join("")):o==="<>"?t.push([" m ",s(n*(a[1]-e)),", ",s(n*a[2])," l ",s(n*a[1]),", ",s(n*(a[2]+e))," l ",s(n*(a[1]+e)),", ",s(n*a[2])," l ",s(n*a[1]),", ",s(n*(a[2]-e))," x e "].join("")):o==="^"?t.push([" m ",s(n*a[1]),", ",s(n*(a[2]-e))," l ",s(n*(a[1]-d)),", ",s(n*(a[2]+u))," l ",s(n*(a[1]+d)),", ",s(n*(a[2]+u))," x e "].join("")):o==="v"?t.push([" m ",s(n*a[1]),", ",s(n*(a[2]+e))," l ",s(n*(a[1]-d)),", ",s(n*(a[2]-u))," l ",s(n*(a[1]+d)),", ",s(n*(a[2]-u))," x e "].join("")):o===">"?t.push([" m ",s(n*(a[1]+e)),", ",s(n*a[2])," l ",s(n*(a[1]-u)),", ",s(n*(a[2]-d))," l ",s(n*(a[1]-u)),", ",s(n*(a[2]+d))," l ",s(n*(a[1]+e)),", ",s(n*a[2])].join("")):o==="<"&&t.push([" m ",s(n*(a[1]-e)),", ",s(n*a[2])," l ",s(n*(a[1]+u)),", ",s(n*(a[2]-d))," l ",s(n*(a[1]+u)),", ",s(n*(a[2]+d))," x e "].join("")),t},updatePathStringPrim:function(h){var e,o,t=[],s=this.resolution,a=Math.round,d=" m ",u=d,n=Math.min(h.numberPoints,8192);if(h.numberPoints<=0)return"";if(n=Math.min(n,h.points.length),h.bezierDegree===1)for(e=0;e<n;e++)o=h.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?u=d:(o[1]>2e4?o[1]=2e4:o[1]<-2e4&&(o[1]=-2e4),o[2]>2e4?o[2]=2e4:o[2]<-2e4&&(o[2]=-2e4),t.push([u,a(s*o[1]),", ",a(s*o[2])].join("")),u=" l ");else if(h.bezierDegree===3)for(e=0;e<n;)o=h.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?u=d:(t.push([u,a(s*o[1]),", ",a(s*o[2])].join("")),u===" c "&&(e+=1,o=h.points[e].scrCoords,t.push([" ",a(s*o[1]),", ",a(s*o[2])].join("")),e+=1,o=h.points[e].scrCoords,t.push([" ",a(s*o[1]),", ",a(s*o[2])].join(""))),u=" c "),e+=1;return t.push(" e"),t},updatePathStringBezierPrim:function(h){var e,o,t,s,a,d,u=[],n=v.evaluate(h.visProp.strokewidth),p=this.resolution,f=Math.round,b=" m ",C=b,_=v.evaluate(h.visProp.curvetype)!=="plot",E=Math.min(h.numberPoints,8192);if(h.numberPoints<=0)return"";for(_&&h.board.options.curve.RDPsmoothing&&(h.points=c.RamerDouglasPeucker(h.points,1)),E=Math.min(E,h.points.length),o=1;o<3;o++)for(C=b,e=0;e<E;e++)s=h.points[e].scrCoords,isNaN(s[1])||isNaN(s[2])?C=b:(s[1]>2e4?s[1]=2e4:s[1]<-2e4&&(s[1]=-2e4),s[2]>2e4?s[2]=2e4:s[2]<-2e4&&(s[2]=-2e4),C===b?u.push([C,f(p*s[1])," ",f(p*s[2])].join("")):(t=2*o,u.push([C,f(p*(a+.333*(s[1]-a)+n*(t*Math.random()-o)))," ",f(p*(d+.333*(s[2]-d)+n*(t*Math.random()-o)))," ",f(p*(a+.666*(s[1]-a)+n*(t*Math.random()-o)))," ",f(p*(d+.666*(s[2]-d)+n*(t*Math.random()-o)))," ",f(p*s[1])," ",f(p*s[2])].join(""))),C=" c ",a=s[1],d=s[2]);return u.push(" e"),u},updatePolygonPrim:function(h,e){var o,t,s=e.vertices.length,a=this.resolution,d=[];if(this._setAttr(h,"stroked","false"),t=e.vertices[0].coords.scrCoords,!isNaN(t[1]+t[2])){for(d.push(["m ",Math.floor(a*t[1]),",",Math.floor(a*t[2])," l "].join("")),o=1;o<s-1;o++){if(!e.vertices[o].isReal)return void this.updatePathPrim(h,"",e.board);if(t=e.vertices[o].coords.scrCoords,isNaN(t[1]+t[2]))return;d.push(Math.floor(a*t[1])+","+Math.floor(a*t[2])),o<s-2&&d.push(", ")}d.push(" x e"),this.updatePathPrim(h,d,e.board)}},updateRectPrim:function(h,e,o,t,s){h.style.left=Math.floor(e)+"px",h.style.top=Math.floor(o)+"px",t>=0&&(h.style.width=t+"px"),s>=0&&(h.style.height=s+"px")},setPropertyPrim:function(h,e,o){var t,s="";switch(e){case"stroke":s="strokecolor";break;case"stroke-width":s="strokeweight";break;case"stroke-dasharray":s="dashstyle"}s!==""&&(t=v.evaluate(o),this._setAttr(h,s,t))},display:function(h,e){h&&h.rendNode&&(h.visPropOld.visible=e,h.rendNode.style.visibility=e?"inherit":"hidden")},show:function(h){g.deprecated("Board.renderer.show()","Board.renderer.display()"),h&&h.rendNode&&(h.rendNode.style.visibility="inherit")},hide:function(h){g.deprecated("Board.renderer.hide()","Board.renderer.display()"),h&&h.rendNode&&(h.rendNode.style.visibility="hidden")},setDashStyle:function(h,e){var o;e.dash>=0&&(o=h.rendNodeStroke,this._setAttr(o,"dashstyle",this.dashArray[e.dash]))},setGradient:function(h){var e=h.rendNodeFill,o=v.evaluate(h.visProp.gradient);o==="linear"?(this._setAttr(e,"type","gradient"),this._setAttr(e,"color2",v.evaluate(h.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",v.evaluate(h.visProp.gradientsecondopacity)),this._setAttr(e,"angle",v.evaluate(h.visProp.gradientangle))):o==="radial"?(this._setAttr(e,"type","gradientradial"),this._setAttr(e,"color2",v.evaluate(h.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",v.evaluate(h.visProp.gradientsecondopacity)),this._setAttr(e,"focusposition",100*v.evaluate(h.visProp.gradientpositionx)+"%,"+100*v.evaluate(h.visProp.gradientpositiony)+"%"),this._setAttr(e,"focussize","0,0")):this._setAttr(e,"type","solid")},setObjectFillColor:function(h,e,o){var t,s,a,d=v.evaluate(e),u=v.evaluate(o),n=h.rendNode;u=u>0?u:0,h.visPropOld.fillcolor===d&&h.visPropOld.fillopacity===u||(v.exists(d)&&d!==!1&&(d.length!==9?(t=d,a=u):(t=(s=m.rgba2rgbo(d))[0],a=u*s[1]),t==="none"||t===!1?this._setAttr(h.rendNode,"filled","false"):(this._setAttr(h.rendNode,"filled","true"),this._setAttr(h.rendNode,"fillcolor",t),v.exists(a)&&h.rendNodeFill&&this._setAttr(h.rendNodeFill,"opacity",100*a+"%")),h.type===y.OBJECT_TYPE_IMAGE&&n.filters.length>1&&(n.filters.item(1).opacity=Math.round(100*a),n.filters.item(1).enabled=!0)),h.visPropOld.fillcolor=d,h.visPropOld.fillopacity=u)},setObjectStrokeColor:function(h,e,o){var t,s,a,d,u=v.evaluate(e),n=v.evaluate(o),p=h.rendNode;n=n>0?n:0,h.visPropOld.strokecolor===u&&h.visPropOld.strokeopacity===n||(v.exists(u)&&u!==!1&&(u.length!==9?(t=u,a=n):(t=(s=e.rgba2rgbo(u))[0],a=n*s[1]),h.elementClass===y.OBJECT_CLASS_TEXT?(p.filters.length>1&&(p.filters.item(1).opacity=Math.round(100*a),p.filters.item(1).enabled=!0),p.style.color=t):(t!==!1&&(this._setAttr(p,"stroked","true"),this._setAttr(p,"strokecolor",t)),d=h.rendNodeStroke,v.exists(a)&&h.type!==y.OBJECT_TYPE_IMAGE&&this._setAttr(d,"opacity",100*a+"%"))),h.visPropOld.strokecolor=u,h.visPropOld.strokeopacity=n)},setObjectStrokeWidth:function(h,e){var o,t=v.evaluate(e);isNaN(t)||h.visPropOld.strokewidth===t||(o=h.rendNode,this.setPropertyPrim(o,"stroked","true"),v.exists(t)&&(this.setPropertyPrim(o,"stroke-width",t),t===0&&v.exists(h.rendNodeStroke)&&this._setAttr(o,"stroked","false")),h.visPropOld.strokewidth=t)},setShadow:function(h){var e=h.rendNodeShadow,o=v.evaluate(h.visProp.shadow);e&&h.visPropOld.shadow!==o&&(o?(this._setAttr(e,"On","True"),this._setAttr(e,"Offset","3pt,3pt"),this._setAttr(e,"Opacity","60%"),this._setAttr(e,"Color","#aaaaaa")):this._setAttr(e,"On","False"),h.visPropOld.shadow=o)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),g.VMLRenderer}),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],function(g,P,y,v,m,l,c,h,e,o,t){return g.CanvasRenderer=function(s,a){if(this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=l.genUUID(),this.canvasNamespace=null,v.isBrowser)this.container=s,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',a.width,'px" height="',a.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.canvasRoot.style.display="block",this.context=this.canvasRoot.getContext("2d");else if(v.isNode())try{this.canvasId=module.require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")}catch{console.log("Warning: 'canvas' not found. You might need to call 'npm install canvas'")}this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},g.CanvasRenderer.prototype=new P,g.extend(g.CanvasRenderer.prototype,{_drawPolygon:function(s,a,d){var u,n=s.length,p=this.context;if(n>0){if(d&&(p.lineWidth=0),p.beginPath(),p.moveTo(s[0][0],s[0][1]),a===1)for(u=1;u<n;u++)p.lineTo(s[u][0],s[u][1]);else for(u=1;u<n;u+=3)p.bezierCurveTo(s[u][0],s[u][1],s[u+1][0],s[u+1][1],s[u+2][0],s[u+2][1]);d?(p.lineTo(s[0][0],s[0][1]),p.closePath(),p.fill()):p.stroke()}},_fill:function(s){var a=this.context;a.save(),this._setColor(s,"fill")&&a.fill(),a.restore()},_rotatePoint:function(s,a,d){return[a*Math.cos(s)-d*Math.sin(s),a*Math.sin(s)+d*Math.cos(s)]},_rotateShape:function(s,a){var d,u=[],n=s.length;if(n<=0)return s;for(d=0;d<n;d++)u.push(this._rotatePoint(a,s[d][0],s[d][1]));return u},updateGradientAngle:function(s,a){var d,u,n,p,f,b,C,_,E,x,S,O,w=1,T=Math.cos(-a),M=Math.sin(-a),N=s.getBoundingBox();return Math.abs(T)>Math.abs(M)?w/=Math.abs(T):w/=Math.abs(M),T>=0?(n=0,p=T*w):(n=-T*w,p=0),M>=0?(f=0,b=M*w):(f=-M*w,b=0),d=new h(y.COORDS_BY_USER,[N[0],N[1]],s.board),S=(u=new h(y.COORDS_BY_USER,[N[2],N[3]],s.board)).scrCoords[1]-d.scrCoords[1],O=u.scrCoords[2]-d.scrCoords[2],C=d.scrCoords[1]+S*n,E=d.scrCoords[2]+O*f,_=d.scrCoords[1]+S*p,x=d.scrCoords[2]+O*b,this.context.createLinearGradient(C,E,_,x)},updateGradientCircle:function(s,a,d,u,n,p,f){var b,C,_,E,x,S,O,w,T,M,N=s.getBoundingBox();return b=new h(y.COORDS_BY_USER,[N[0],N[1]],s.board),T=(C=new h(y.COORDS_BY_USER,[N[2],N[3]],s.board)).scrCoords[1]-b.scrCoords[1],M=b.scrCoords[2]-C.scrCoords[2],_=b.scrCoords[1]+T*a,E=C.scrCoords[2]+M*d,S=b.scrCoords[1]+T*n,O=C.scrCoords[2]+M*p,x=u*(T+M)*.5,w=f*(T+M)*.5,this.context.createRadialGradient(S,O,w,_,E,x)},updateGradient:function(s){var a,d,u,n=m.evaluate(s.visProp.gradient);return d=(d=m.evaluate(s.visProp.fillopacity))>0?d:0,a=m.evaluate(s.visProp.fillcolor),n==="linear"?u=this.updateGradientAngle(s,m.evaluate(s.visProp.gradientangle)):n==="radial"&&(u=this.updateGradientCircle(s,m.evaluate(s.visProp.gradientcx),m.evaluate(s.visProp.gradientcy),m.evaluate(s.visProp.gradientr),m.evaluate(s.visProp.gradientfx),m.evaluate(s.visProp.gradientfy),m.evaluate(s.visProp.gradientfr))),u.addColorStop(m.evaluate(s.visProp.gradientstartoffset),a),u.addColorStop(m.evaluate(s.visProp.gradientendoffset),m.evaluate(s.visProp.gradientsecondcolor)),u},_setColor:function(s,a,d){var u,n,p,f,b,C,_,E,x=!0,S=s.visProp;return a=a||"stroke",d=d||a,u=this._getHighlighted(s),(E=m.evaluate(s.visProp.gradient))==="linear"||E==="radial"?(this.context[d+"Style"]=this.updateGradient(s),x):((p=m.evaluate(S[u+a+"color"]))!=="none"&&p!==!1?(C=(C=m.evaluate(S[u+a+"opacity"]))>0?C:0,p.length!==9?(b=p,_=C):(b=(f=c.rgba2rgbo(p))[0],_=C*f[1]),this.context.globalAlpha=_,this.context[d+"Style"]=b):x=!1,n=parseFloat(m.evaluate(S[u+"strokewidth"])),a!=="stroke"||isNaN(n)||(n===0?this.context.globalAlpha=0:this.context.lineWidth=n),a==="stroke"&&S.linecap!==void 0&&S.linecap!==""&&(this.context.lineCap=S.linecap),x)},_stroke:function(s){var a=this.context,d=m.evaluate(s.visProp.dash);a.save(),d>0?a.setLineDash&&a.setLineDash(this.dashArray[d]):this.context.lineDashArray=[],this._setColor(s,"stroke")&&a.stroke(),a.restore()},_translateShape:function(s,a,d){var u,n=[],p=s.length;if(p<=0)return s;for(u=0;u<p;u++)n.push([s[u][0]+a,s[u][1]+d]);return n},drawPoint:function(s){var a=m.evaluate(s.visProp.face),d=m.evaluate(s.visProp.size),u=s.coords.scrCoords,n=d*Math.sqrt(3)*.5,p=.5*d,f=parseFloat(m.evaluate(s.visProp.strokewidth))/2,b=this.context;if(s.visPropCalc.visible)switch(a){case"cross":case"x":b.beginPath(),b.moveTo(u[1]-d,u[2]-d),b.lineTo(u[1]+d,u[2]+d),b.moveTo(u[1]+d,u[2]-d),b.lineTo(u[1]-d,u[2]+d),b.lineCap="round",b.lineJoin="round",b.closePath(),this._stroke(s);break;case"circle":case"o":b.beginPath(),b.arc(u[1],u[2],d+1+f,0,2*Math.PI,!1),b.closePath(),this._fill(s),this._stroke(s);break;case"square":case"[]":if(d<=0)break;b.save(),this._setColor(s,"stroke","fill")&&b.fillRect(u[1]-d-f,u[2]-d-f,2*d+3*f,2*d+3*f),b.restore(),b.save(),this._setColor(s,"fill"),b.fillRect(u[1]-d+f,u[2]-d+f,2*d-f,2*d-f),b.restore();break;case"plus":case"+":b.beginPath(),b.moveTo(u[1]-d,u[2]),b.lineTo(u[1]+d,u[2]),b.moveTo(u[1],u[2]-d),b.lineTo(u[1],u[2]+d),b.lineCap="round",b.lineJoin="round",b.closePath(),this._stroke(s);break;case"diamond":case"<>":b.beginPath(),b.moveTo(u[1]-d,u[2]),b.lineTo(u[1],u[2]+d),b.lineTo(u[1]+d,u[2]),b.lineTo(u[1],u[2]-d),b.closePath(),this._fill(s),this._stroke(s);break;case"triangleup":case"a":case"^":b.beginPath(),b.moveTo(u[1],u[2]-d),b.lineTo(u[1]-n,u[2]+p),b.lineTo(u[1]+n,u[2]+p),b.closePath(),this._fill(s),this._stroke(s);break;case"triangledown":case"v":b.beginPath(),b.moveTo(u[1],u[2]+d),b.lineTo(u[1]-n,u[2]-p),b.lineTo(u[1]+n,u[2]-p),b.closePath(),this._fill(s),this._stroke(s);break;case"triangleleft":case"<":b.beginPath(),b.moveTo(u[1]-d,u[2]),b.lineTo(u[1]+p,u[2]-n),b.lineTo(u[1]+p,u[2]+n),b.closePath(),this._fill(s),this._stroke(s);break;case"triangleright":case">":b.beginPath(),b.moveTo(u[1]+d,u[2]),b.lineTo(u[1]-p,u[2]-n),b.lineTo(u[1]-p,u[2]+n),b.closePath(),this._fill(s),this._stroke(s)}},updatePoint:function(s){this.drawPoint(s)},drawArrows:function(s,a,d,u,n){var p,f,b,C,_,E,x,S,O,w,T,M,N,A,R,L,D,k,B,I,Y=this.context,q=1,V=1,W=1,X=n.evFirst,Q=n.evLast;if(m.evaluate(s.visProp.strokecolor)!=="none"&&(X||Q)){if(s.elementClass===y.OBJECT_CLASS_LINE)p=a.scrCoords[1],f=a.scrCoords[2],b=d.scrCoords[1],C=d.scrCoords[2],B=I=Math.atan2(C-f,b-p);else{if(p=s.points[0].scrCoords[1],f=s.points[0].scrCoords[2],(k=s.points.length-1)<1)return;b=s.points[s.points.length-1].scrCoords[1],C=s.points[s.points.length-1].scrCoords[2],A=s.points[1].scrCoords[1]-s.points[0].scrCoords[1],R=s.points[1].scrCoords[2]-s.points[0].scrCoords[2],L=s.points[k].scrCoords[1]-s.points[k-1].scrCoords[1],D=s.points[k].scrCoords[2]-s.points[k-1].scrCoords[2],X&&(B=Math.atan2(R,A)),Q&&(I=Math.atan2(D,L))}if(_=m.evaluate(s.visProp[u+"strokewidth"]),X)if(E=_*n.sizeFirst,O=q=n.typeFirst,q===2)S=[[E,.5*-E],[0,0],[E,.5*E],[.5*E,0]];else if(q===3)S=[[E/3,.5*-E],[0,.5*-E],[0,.5*E],[E/3,.5*E]];else if(q===4)for(E/=10,V=3,N=(S=[[10,3.31],[6.47,3.84],[2.87,4.5],[0,6.63],[.67,5.52],[1.33,4.42],[2,3.31],[1.33,2.21],[.67,1.1],[0,0],[2.87,2.13],[6.47,2.79],[10,3.31]]).length,M=0;M<N;M++)S[M][0]*=-E,S[M][1]*=E,S[M][0]+=10*E,S[M][1]-=3.31*E;else if(q===5)for(E/=10,V=3,N=(S=[[10,3.28],[6.61,4.19],[3.19,5.07],[0,6.55],[.62,5.56],[1,4.44],[1,3.28],[1,2.11],[.62,.99],[0,0],[3.19,1.49],[6.61,2.37],[10,3.28]]).length,M=0;M<N;M++)S[M][0]*=-E,S[M][1]*=E,S[M][0]+=10*E,S[M][1]-=3.28*E;else if(q===6)for(E/=10,V=3,N=(S=[[10,2.84],[6.61,3.59],[3.21,4.35],[0,5.68],[.33,4.73],[.67,3.78],[1,2.84],[.67,1.89],[.33,.95],[0,0],[3.21,1.33],[6.61,2.09],[10,2.84]]).length,M=0;M<N;M++)S[M][0]*=-E,S[M][1]*=E,S[M][0]+=10*E,S[M][1]-=2.84*E;else if(q===7)for(E=_,V=3,N=(S=[[0,10.39],[2.01,6.92],[5.96,5.2],[10,5.2],[5.96,5.2],[2.01,3.47],[0,0]]).length,M=0;M<N;M++)S[M][0]*=-E,S[M][1]*=E,S[M][0]+=10*E,S[M][1]-=5.2*E;else S=[[E,.5*-E],[0,0],[E,.5*E]];if(Q)if(E=_*n.sizeLast,w=q=n.typeLast,q===2)x=[[-E,.5*-E],[0,0],[-E,.5*E],[.5*-E,0]];else if(q===3)x=[[-E/3,.5*-E],[0,.5*-E],[0,.5*E],[-E/3,.5*E]];else if(q===4)for(E/=10,W=3,N=(x=[[10,3.31],[6.47,3.84],[2.87,4.5],[0,6.63],[.67,5.52],[1.33,4.42],[2,3.31],[1.33,2.21],[.67,1.1],[0,0],[2.87,2.13],[6.47,2.79],[10,3.31]]).length,M=0;M<N;M++)x[M][0]*=E,x[M][1]*=E,x[M][0]-=10*E,x[M][1]-=3.31*E;else if(q===5)for(E/=10,W=3,N=(x=[[10,3.28],[6.61,4.19],[3.19,5.07],[0,6.55],[.62,5.56],[1,4.44],[1,3.28],[1,2.11],[.62,.99],[0,0],[3.19,1.49],[6.61,2.37],[10,3.28]]).length,M=0;M<N;M++)x[M][0]*=E,x[M][1]*=E,x[M][0]-=10*E,x[M][1]-=3.28*E;else if(q===6)for(E/=10,W=3,N=(x=[[10,2.84],[6.61,3.59],[3.21,4.35],[0,5.68],[.33,4.73],[.67,3.78],[1,2.84],[.67,1.89],[.33,.95],[0,0],[3.21,1.33],[6.61,2.09],[10,2.84]]).length,M=0;M<N;M++)x[M][0]*=E,x[M][1]*=E,x[M][0]-=10*E,x[M][1]-=2.84*E;else if(q===7)for(E=_,W=3,N=(x=[[0,10.39],[2.01,6.92],[5.96,5.2],[10,5.2],[5.96,5.2],[2.01,3.47],[0,0]]).length,M=0;M<N;M++)x[M][0]*=E,x[M][1]*=E,x[M][0]-=10*E,x[M][1]-=5.2*E;else x=[[-E,.5*-E],[0,0],[-E,.5*E]];Y.save(),this._setColor(s,"stroke","fill")&&(this._setColor(s,"stroke"),X&&(T=O!==7,this._drawPolygon(this._translateShape(this._rotateShape(S,B),p,f),V,T)),Q&&(T=w!==7,this._drawPolygon(this._translateShape(this._rotateShape(x,I),b,C),W,T))),Y.restore()}},drawLine:function(s){var a,d,u,n,p,f=new h(y.COORDS_BY_USER,s.point1.coords.usrCoords,s.board),b=new h(y.COORDS_BY_USER,s.point2.coords.usrCoords,s.board),C=null;s.visPropCalc.visible&&(u=this._getHighlighted(s),n=m.evaluate(s.visProp[u+"strokewidth"]),((p=this.getArrowHeadData(s,n,u)).evFirst||p.evLast)&&(C=-4),o.calcStraight(s,f,b,C),this.handleTouchpoints(s,f,b,p),a=new h(y.COORDS_BY_USER,f.usrCoords,s.board),d=new h(y.COORDS_BY_USER,b.usrCoords,s.board),this.getPositionArrowHead(s,f,b,p),this.context.beginPath(),this.context.moveTo(f.scrCoords[1],f.scrCoords[2]),this.context.lineTo(b.scrCoords[1],b.scrCoords[2]),this._stroke(s),(p.evFirst||p.evLast)&&this.drawArrows(s,a,d,u,p))},updateLine:function(s){this.drawLine(s)},drawTicks:function(){},updateTicks:function(s){var a,d,u,n,p,f,b=s.ticks.length,C=this.context;for(C.beginPath(),a=0;a<b;a++)for(u=(d=s.ticks[a])[0],n=d[1],p=u.length,C.moveTo(u[0],n[0]),f=1;f<p;++f)C.lineTo(u[f],n[f]);C.lineCap="round",this._stroke(s)},drawCurve:function(s){var a,d,u;m.evaluate(s.visProp.handdrawing)?this.updatePathStringBezierPrim(s):this.updatePathStringPrim(s),s.numberPoints>1&&(a=this._getHighlighted(s),d=m.evaluate(s.visProp[a+"strokewidth"]),((u=this.getArrowHeadData(s,d,a)).evFirst||u.evLast)&&this.drawArrows(s,null,null,a,u))},updateCurve:function(s){this.drawCurve(s)},drawEllipse:function(s){var a=s.center.coords.scrCoords[1],d=s.center.coords.scrCoords[2],u=s.board.unitX,n=s.board.unitY,p=2*s.Radius(),f=2*s.Radius(),b=p*u,C=f*n,_=a-b/2,E=d-C/2,x=b/2*.5522848,S=C/2*.5522848,O=_+b,w=E+C,T=_+b/2,M=E+C/2,N=this.context;p>0&&f>0&&!isNaN(a+d)&&(N.beginPath(),N.moveTo(_,M),N.bezierCurveTo(_,M-S,T-x,E,T,E),N.bezierCurveTo(T+x,E,O,M-S,O,M),N.bezierCurveTo(O,M+S,T+x,w,T,w),N.bezierCurveTo(T-x,w,_,M+S,_,M),N.closePath(),this._fill(s),this._stroke(s))},updateEllipse:function(s){return this.drawEllipse(s)},displayCopyright:function(s,a){var d=this.context;d.save(),d.font=a+"px Arial",d.fillStyle="#aaa",d.lineWidth=.5,d.fillText(s,10,2+a),d.restore()},drawInternalText:function(s){var a=m.evaluate(s.visProp.fontsize),d=m.evaluate(s.visProp.fontunit),u=s.getAnchorX(),n=s.getAnchorY(),p=this.context;return p.save(),this._setColor(s,"stroke","fill")&&!isNaN(s.coords.scrCoords[1]+s.coords.scrCoords[2])&&(p.font=(a>0?a:0)+d+" Arial",this.transformImage(s,s.transformations),u==="left"?p.textAlign="left":u==="right"?p.textAlign="right":u==="middle"&&(p.textAlign="center"),n==="bottom"?p.textBaseline="bottom":n==="top"?p.textBaseline="top":n==="middle"&&(p.textBaseline="middle"),p.fillText(s.plaintext,s.coords.scrCoords[1],s.coords.scrCoords[2])),p.restore(),null},updateInternalText:function(s){this.drawInternalText(s)},setObjectStrokeColor:function(s,a,d){var u,n,p,f,b=m.evaluate(a),C=m.evaluate(d);C=C>0?C:0,s.visPropOld.strokecolor===b&&s.visPropOld.strokeopacity===C||(m.exists(b)&&b!==!1&&(b.length!==9?(u=b,p=C):(u=(n=c.rgba2rgbo(b))[0],p=C*n[1]),f=s.rendNode,s.elementClass===y.OBJECT_CLASS_TEXT&&m.evaluate(s.visProp.display)==="html"&&(f.style.color=u,f.style.opacity=p)),s.visPropOld.strokecolor=b,s.visPropOld.strokeopacity=C)},drawImage:function(s){s.rendNode=new Image,s._src="",this.updateImage(s)},updateImage:function(s){var a=this.context,d=m.evaluate(s.visProp.fillopacity),u=m.bind(function(){s.imgIsLoaded=!0,s.size[0]<=0||s.size[1]<=0||(a.save(),a.globalAlpha=d,this.transformImage(s,s.transformations),a.drawImage(s.rendNode,s.coords.scrCoords[1],s.coords.scrCoords[2]-s.size[1],s.size[0],s.size[1]),a.restore())},this);this.updateImageURL(s)?s.rendNode.onload=u:s.imgIsLoaded&&u()},transformImage:function(s,a){var d,u=a.length,n=this.context;u>0&&(d=this.joinTransforms(s,a),Math.abs(t.det(d))>=e.eps&&n.transform(d[1][1],d[2][1],d[1][2],d[2][2],d[1][0],d[2][0]))},updateImageURL:function(s){var a;return a=m.evaluate(s.url),s._src!==a&&(s.imgIsLoaded=!1,s.rendNode.src=a,s._src=a,!0)},remove:function(s){m.exists(s)&&m.exists(s.parentNode)&&s.parentNode.removeChild(s)},updatePathStringPrim:function(s){var a,d,u,n,p,f="M",b=f,C=5e3,_=this.context;if(!(s.numberPoints<=0)){if(p=Math.min(s.points.length,s.numberPoints),_.beginPath(),s.bezierDegree===1)for(a=0;a<p;a++)d=s.points[a].scrCoords,isNaN(d[1])||isNaN(d[2])?b=f:(d[1]>C?d[1]=C:d[1]<-5e3&&(d[1]=-5e3),d[2]>C?d[2]=C:d[2]<-5e3&&(d[2]=-5e3),b===f?_.moveTo(d[1],d[2]):_.lineTo(d[1],d[2]),b="L");else if(s.bezierDegree===3)for(a=0;a<p;)d=s.points[a].scrCoords,isNaN(d[1])||isNaN(d[2])?b=f:(b===f?_.moveTo(d[1],d[2]):(a+=1,u=s.points[a].scrCoords,a+=1,n=s.points[a].scrCoords,_.bezierCurveTo(d[1],d[2],u[1],u[2],n[1],n[2])),b="C"),a+=1;_.lineCap="round",this._fill(s),this._stroke(s)}},updatePathStringBezierPrim:function(s){var a,d,u,n,p,f,b,C="M",_=C,E=5e3,x=m.evaluate(s.visProp.strokewidth),S=m.evaluate(s.visProp.curvetype)!=="plot",O=this.context;if(!(s.numberPoints<=0)){for(S&&s.board.options.curve.RDPsmoothing&&(s.points=t.RamerDouglasPeucker(s.points,.5)),b=Math.min(s.points.length,s.numberPoints),O.beginPath(),d=1;d<3;d++)for(_=C,a=0;a<b;a++)n=s.points[a].scrCoords,isNaN(n[1])||isNaN(n[2])?_=C:(n[1]>E?n[1]=E:n[1]<-5e3&&(n[1]=-5e3),n[2]>E?n[2]=E:n[2]<-5e3&&(n[2]=-5e3),_===C?O.moveTo(n[1],n[2]):(u=2*d,O.bezierCurveTo(p+.333*(n[1]-p)+x*(u*Math.random()-d),f+.333*(n[2]-f)+x*(u*Math.random()-d),p+.666*(n[1]-p)+x*(u*Math.random()-d),f+.666*(n[2]-f)+x*(u*Math.random()-d),n[1],n[2])),_="C",p=n[1],f=n[2]);O.lineCap="round",this._fill(s),this._stroke(s)}},updatePolygonPrim:function(s,a){var d,u,n,p=a.vertices.length,f=this.context,b=!0;if(!(p<=0)&&a.visPropCalc.visible){for(a.elType==="polygonalchain"&&p++,f.beginPath(),u=0;!a.vertices[u].isReal&&u<p-1;)u++,b=!1;for(d=a.vertices[u].coords.scrCoords,f.moveTo(d[1],d[2]),n=u;n<p-1;n++)a.vertices[n].isReal||(b=!1),d=a.vertices[n].coords.scrCoords,f.lineTo(d[1],d[2]);f.closePath(),b&&this._fill(a)}},display:function(s,a){s&&s.rendNode&&(s.visPropOld.visible=a,s.rendNode.style.visibility=a?"inherit":"hidden")},show:function(s){g.deprecated("Board.renderer.show()","Board.renderer.display()"),m.exists(s.rendNode)&&(s.rendNode.style.visibility="inherit")},hide:function(s){g.deprecated("Board.renderer.hide()","Board.renderer.display()"),m.exists(s.rendNode)&&(s.rendNode.style.visibility="hidden")},setGradient:function(s){var a;a=(a=m.evaluate(s.visProp.fillopacity))>0?a:0},setShadow:function(s){s.visPropOld.shadow!==s.visProp.shadow&&(s.visPropOld.shadow=s.visProp.shadow)},highlight:function(s){return s.elementClass===y.OBJECT_CLASS_TEXT&&m.evaluate(s.visProp.display)==="html"?this.updateTextStyle(s,!0):(s.board.prepareUpdate(),s.board.renderer.suspendRedraw(s.board),s.board.updateRenderer(),s.board.renderer.unsuspendRedraw()),this},noHighlight:function(s){return s.elementClass===y.OBJECT_CLASS_TEXT&&m.evaluate(s.visProp.display)==="html"?this.updateTextStyle(s,!1):(s.board.prepareUpdate(),s.board.renderer.suspendRedraw(s.board),s.board.updateRenderer(),s.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(s){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),s&&s.attr.showcopyright&&this.displayCopyright(g.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(s,a){this.container?(this.canvasRoot.style.width=parseFloat(s)+"px",this.canvasRoot.style.height=parseFloat(a)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(s)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(a)+"px")):(this.canvasRoot.width=2*parseFloat(s),this.canvasRoot.height=2*parseFloat(a)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),g.CanvasRenderer}),define("renderer/no",["jxg","renderer/abstract"],function(g,P){return g.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},g.extend(g.NoRenderer.prototype,{drawPoint:function(y){},updatePoint:function(y){},changePointStyle:function(y){},drawLine:function(y){},updateLine:function(y){},drawTicks:function(y){},updateTicks:function(y){},drawCurve:function(y){},updateCurve:function(y){},drawEllipse:function(y){},updateEllipse:function(y){},drawPolygon:function(y){},updatePolygon:function(y){},displayCopyright:function(y,v){},drawInternalText:function(y){},updateInternalText:function(y){},drawText:function(y){},updateText:function(y){},updateTextStyle:function(y,v){},updateInternalTextStyle:function(y,v,m){},drawImage:function(y){},updateImage:function(y){},transformImage:function(y,v){},updateImageURL:function(y){},appendChildPrim:function(y,v){},appendNodesToElement:function(y,v){},createPrim:function(y,v){return null},remove:function(y){},makeArrows:function(y){},updateEllipsePrim:function(y,v,m,l,c){},updateLinePrim:function(y,v,m,l,c,h){},updatePathPrim:function(y,v,m){},updatePathStringPoint:function(y,v,m){},updatePathStringPrim:function(y){},updatePathStringBezierPrim:function(y){},updatePolygonPrim:function(y,v){},updateRectPrim:function(y,v,m,l,c){},setPropertyPrim:function(y,v,m){},display:function(y,v){y&&(y.visPropOld.visible=v)},show:function(y){},hide:function(y){},setBuffering:function(y,v){},setDashStyle:function(y){},setDraft:function(y){},removeDraft:function(y){},setGradient:function(y){},updateGradient:function(y){},setObjectTransition:function(y,v){},setObjectFillColor:function(y,v,m){},setObjectStrokeColor:function(y,v,m){},setObjectStrokeWidth:function(y,v){},setShadow:function(y){},highlight:function(y){},noHighlight:function(y){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(y){},getElementById:function(y){return null},resize:function(y,v){},removeToInsertLater:function(){return function(){}}}),g.NoRenderer.prototype=new P,g.NoRenderer}),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],function(g,P,y,v,m,l,c,h,e,o){return g.JSXGraph={rendererType:(l.board.renderer="no",P.supportsVML()&&(l.board.renderer="vml",document.onmousemove=function(){var t;return document.body&&(t=document.body.scrollLeft,t+=document.body.scrollTop),t}),P.supportsCanvas()&&(l.board.renderer="canvas"),P.supportsSVG()&&(l.board.renderer="svg"),P.isNode()&&P.supportsCanvas()&&(l.board.renderer="canvas"),(P.isNode()||l.renderer==="no")&&(l.text.display="internal",l.infobox.display="internal"),l.board.renderer),initRenderer:function(t,s,a,d){var u;if(y.exists(a)&&a!==!1||typeof document!="object"||(a=document),typeof a=="object"&&t!==null)for(u=a.getElementById(t);u.firstChild;)u.removeChild(u.firstChild);else u=t;return d!==void 0&&d!=="auto"||(d=this.rendererType),d==="svg"?new c(u,s):d==="vml"?new h(u):d==="canvas"?new e(u,s):new o},_setAttributes:function(t){var s=y.copyAttributes(t,l,"board");return s.zoom=y.copyAttributes(s,l,"board","zoom"),s.pan=y.copyAttributes(s,l,"board","pan"),s.drag=y.copyAttributes(s,l,"board","drag"),s.keyboard=y.copyAttributes(s,l,"board","keyboard"),s.selection=y.copyAttributes(s,l,"board","selection"),s.navbar=y.copyAttributes(s.navbar,l,"navbar"),s.screenshot=y.copyAttributes(s,l,"board","screenshot"),s.resize=y.copyAttributes(s,l,"board","resize"),s.fullscreen=y.copyAttributes(s,l,"board","fullscreen"),s.movetarget=t.moveTarget||t.movetarget||l.board.moveTarget,s},_fillBoard:function(t,s,a){t.initInfobox(),t.maxboundingbox=s.maxboundingbox,t.resizeContainer(a.width,a.height,!0,!0),t._createSelectionPolygon(s),t.renderer.drawZoomBar(t,s.navbar),g.boards[t.id]=t},_setARIA:function(t,s){var a,d,u,n,p,f=s.document||document;typeof f=="object"&&(u=(a=f.getElementById(t)).parentNode,n=t+"_ARIAlabel",p=t+"_ARIAdescription",(d=f.createElement("div")).innerHTML=s.title,d.setAttribute("id",n),d.style.display="none",u.insertBefore(d,a),(d=f.createElement("div")).innerHTML=s.description,d.setAttribute("id",p),d.style.display="none",u.insertBefore(d,a),a.setAttribute("aria-labelledby",n),a.setAttribute("aria-describedby",p))},_removeARIANodes:function(t){var s,a;typeof(t.document||document)=="object"&&(a=t.containerObj.getAttribute("aria-labelledby"),(s=document.getElementById(a))&&s.parentNode&&s.parentNode.removeChild(s),a=t.containerObj.getAttribute("aria-describedby"),(s=document.getElementById(a))&&s.parentNode&&s.parentNode.removeChild(s))},initBoard:function(t,s){var a,d,u,n,p,f,b,C,_,E,x,S,O,w,T=0,M=0;return s=s||{},E=this._setAttributes(s),C=P.getDimensions(t,E.document),E.unitx||E.unity?(a=y.def(E.originx,150),d=y.def(E.originy,150),u=y.def(E.unitx,50),n=y.def(E.unity,50)):((_=E.boundingbox)[0]<E.maxboundingbox[0]&&(_[0]=E.maxboundingbox[0]),_[1]>E.maxboundingbox[1]&&(_[1]=E.maxboundingbox[1]),_[2]>E.maxboundingbox[2]&&(_[2]=E.maxboundingbox[2]),_[3]<E.maxboundingbox[3]&&(_[3]=E.maxboundingbox[3]),f=parseInt(C.width,10),b=parseInt(C.height,10),y.exists(_)&&E.keepaspectratio?(u=f/(_[2]-_[0]),n=b/(_[1]-_[3]),Math.abs(u)<Math.abs(n)?M=.5*(b/(n=Math.abs(u)*n/Math.abs(n))-(_[1]-_[3])):T=.5*(f/(u=Math.abs(n)*u/Math.abs(u))-(_[2]-_[0]))):(u=f/(_[2]-_[0]),n=b/(_[1]-_[3])),a=-u*(_[0]-T),d=n*(_[1]+M)),p=this.initRenderer(t,C,E.document,E.renderer),this._setARIA(t,E),(w=new v(t,p,E.id,[a,d],E.zoomfactor*E.zoomx,E.zoomfactor*E.zoomy,u,n,C.width,C.height,E)).keepaspectratio=E.keepaspectratio,this._fillBoard(w,E,C),w.suspendUpdate(),E.axis&&(x=typeof E.axis=="object"?E.axis:{},S=y.deepCopy(l.board.defaultAxes.x,x),O=y.deepCopy(l.board.defaultAxes.y,x),E.defaultaxes.x&&(S=y.deepCopy(S,E.defaultaxes.x)),E.defaultaxes.y&&(O=y.deepCopy(O,E.defaultaxes.y)),w.defaultAxes={},w.defaultAxes.x=w.create("axis",[[0,0],[1,0]],S),w.defaultAxes.y=w.create("axis",[[0,0],[0,1]],O)),E.grid&&w.create("grid",[],typeof E.grid=="object"?E.grid:{}),w.unsuspendUpdate(),w},loadBoardFromFile:function(t,s,a,d,u){var n,p,f,b,C;return d=d||{},n=this._setAttributes(d),b=P.getDimensions(t,n.document),p=this.initRenderer(t,b,n.document,n.renderer),this._setARIA(t,n),f=new v(t,p,"",[150,150],1,1,50,50,b.width,b.height,n),this._fillBoard(f,n,b),C=n.encoding||"iso-8859-1",m.parseFileContent(s,f,a,!0,C,u),f},loadBoardFromString:function(t,s,a,d,u){var n,p,f,b;return d=d||{},n=this._setAttributes(d),b=P.getDimensions(t,n.document),p=this.initRenderer(t,b,n.document),this._setARIA(t,n),f=new v(t,p,"",[150,150],1,1,50,50,b.width,b.height,n),this._fillBoard(f,n,b),m.parseString(s,f,a,!0,u),f},freeBoard:function(t){var s;for(s in typeof t=="string"&&(t=g.boards[t]),this._removeARIANodes(t),t.removeEventHandlers(),t.suspendUpdate(),t.objects)t.objects.hasOwnProperty(s)&&t.objects[s].remove();for(;t.containerObj.firstChild;)t.containerObj.removeChild(t.containerObj.firstChild);for(s in t.objects)t.objects.hasOwnProperty(s)&&delete t.objects[s];delete t.renderer,t.jc.creator.clearCache(),delete t.jc,delete g.boards[t.id]},registerElement:function(t,s){g.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),g.registerElement(t,s)}},P.isBrowser&&typeof window=="object"&&typeof document=="object"&&P.addEvent(window,"load",function(){var t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M,N=!1,A=document.getElementsByTagName("script"),R=function(D,k,B){var I=g.JSXGraph.initBoard(u,{boundingbox:B,keepaspectratio:!0,grid:O,axis:S,showReload:!0});if(k.toLowerCase().indexOf("script")>-1)I.construct(D);else try{I.jc.parse(D)}catch(Y){g.debug(Y)}return I},L=function(D,k,B,I){return function(){var Y;g.JSXGraph.freeBoard(D),(Y=R(k,B,I)).reload=L(Y,k,B,I)}};for(s=0;s<A.length;s++)if(t=A[s].getAttribute("type",!1),y.exists(t)&&(t.toLowerCase()==="text/jessiescript"||t.toLowerCase()==="jessiescript"||t.toLowerCase()==="text/jessiecode"||t.toLowerCase()==="jessiecode")){if(E=A[s].getAttribute("class",!1)||"",f=A[s].getAttribute("width",!1)||"",b=A[s].getAttribute("height",!1)||"",C=A[s].getAttribute("maxwidth",!1)||"100%",_=A[s].getAttribute("aspectratio",!1)||"1/1",x=A[s].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",u=A[s].getAttribute("container",!1),T=A[s].getAttribute("src",!1),(x=x.split(",")).length!==4)x=[-5,5,5,-5];else for(a=0;a<x.length;a++)x[a]=parseFloat(x[a]);if(S=y.str2Bool(A[s].getAttribute("axis",!1)||"false"),O=y.str2Bool(A[s].getAttribute("grid",!1)||"false"),y.exists(u))d=document.getElementById(u);else{u="jessiescript_autgen_jxg_"+s,(d=document.createElement("div")).setAttribute("id",u),p=f!==""?"width:"+f+";":"",p+=b!==""?"height:"+b+";":"",p+=C!==""?"max-width:"+C+";":"",p+=_!==""?"aspect-ratio:"+_+";":"",d.setAttribute("style",p),d.setAttribute("class","jxgbox "+E);try{document.body.insertBefore(d,A[s])}catch{typeof jQuery=="object"&&jQuery(d).insertBefore(A[s])}}w="",y.exists(T)?(N=!0,(M=new XMLHttpRequest).open("GET",T),M.overrideMimeType("text/plain; charset=x-user-defined"),M.addEventListener("load",function(){if(!(this.status<400))throw new Error(`
JSXGraph: failed to load file`,T,":",this.responseText);w=this.responseText+`
`+w,(n=R(w,t,x)).reload=L(n,w,t,x)}),M.addEventListener("error",function(D){throw new Error(`
JSXGraph: failed to load file`,T,":",D)}),M.send()):N=!1,document.getElementById(u)?(w=(w=A[s].innerHTML).replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),A[s].innerHTML=w,N||((n=R(w,t,x)).reload=L(n,w,t,x))):g.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),g.JSXGraph}),define("base/point",["jxg","options","math/math","math/geometry","base/constants","base/element","utils/type","base/coordselement"],function(g,P,y,v,m,l,c,h){return g.Point=function(e,o,t){this.constructor(e,t,m.OBJECT_TYPE_POINT,m.OBJECT_CLASS_POINT),this.element=this.board.select(t.anchor),this.coordsConstructor(o),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createGradient(),this.createLabel()},g.Point.prototype=new l,c.copyPrototypeMethods(g.Point,h,"coordsConstructor"),g.extend(g.Point.prototype,{hasPoint:function(e,o){var t,s,a,d=this.coords.scrCoords,u=c.evaluate(this.visProp.sizeunit);return c.isObject(c.evaluate(this.visProp.precision))?(a=this.board._inputDevice,s=c.evaluate(this.visProp.precision[a])):s=this.board.options.precision.hasPoint,t=parseFloat(c.evaluate(this.visProp.size)),u==="user"&&(t*=Math.sqrt(this.board.unitX*this.board.unitY)),(t+=.5*parseFloat(c.evaluate(this.visProp.strokewidth)))<s&&(t=s),Math.abs(d[1]-e)<t+2&&Math.abs(d[2]-o)<t+2},update:function(e){return this.needsUpdate?(this.updateCoords(e),c.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(e){var o,t;if(this.transformations.length===0||this.baseElement===null)return this;for(this===this.baseElement?(o=this.transformations[0].apply(this.baseElement,"self"),this.coords.setCoordinates(m.COORDS_BY_USER,o)):o=this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(m.COORDS_BY_USER,o),t=1;t<this.transformations.length;t++)this.coords.setCoordinates(m.COORDS_BY_USER,this.transformations[t].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(e,o,t,s){var a;e=this.board.select(e),o=this.board.select(o),a=v.intersectionFunction(this.board,e,o,t,s,c.evaluate(this.visProp.alwaysintersect)),this.addConstraint([a]);try{e.addChild(this),o.addChild(this)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof e+"' and '"+typeof o+"'.")}this.type=m.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[e.id,o.id,t,s],this.generatePolynomial=function(){var d=e.generatePolynomial(this),u=o.generatePolynomial(this);return d.length===0||u.length===0?[]:[d[0],u[0]]},this.prepareUpdate().update()},setStyle:function(e){return this.visProp.face=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"][e],this.visProp.size=[2,3,4,1,2,3,4,2,3,4,2,3,4][e],this.board.renderer.changePointStyle(this),this},normalizeFace:function(e){return g.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),P.normalizePointFace(e)},face:function(e){g.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:e})},size:function(e){g.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:e})},isOn:function(e,o){var t,s;return o=o||y.eps,c.isPoint(e)?this.Dist(e)<o:e.elementClass===m.OBJECT_CLASS_LINE?(e.elType!=="segment"||c.evaluate(this.visProp.alwaysintersect)||(t=g.Math.Geometry.projectCoordsToSegment(this.coords.usrCoords,e.point1.coords.usrCoords,e.point2.coords.usrCoords))[1]>=0&&t[1]<=1)&&v.distPointLine(this.coords.usrCoords,e.stdform)<o:e.elementClass===m.OBJECT_CLASS_CIRCLE?c.evaluate(e.visProp.hasinnerpoints)?this.Dist(e.center)<e.Radius()+o:Math.abs(this.Dist(e.center)-e.Radius())<o:e.elementClass===m.OBJECT_CLASS_CURVE?(s=v.projectPointToCurve(this,e,this.board)[0],v.distance(this.coords.usrCoords,s.usrCoords,3)<o):e.type===m.OBJECT_TYPE_POLYGON?!(!c.evaluate(e.visProp.hasinnerpoints)||!e.pnpoly(this.coords.usrCoords[1],this.coords.usrCoords[2],g.COORDS_BY_USER))||(t=v.projectCoordsToPolygon(this.coords.usrCoords,e),v.distance(this.coords.usrCoords,t,3)<o):e.type===m.OBJECT_TYPE_TURTLE&&(s=v.projectPointToTurtle(this,e,this.board),v.distance(this.coords.usrCoords,s.usrCoords,3)<o)},cloneToBackground:function(){var e={};return e.id=this.id+"T"+this.numTraces,this.numTraces+=1,e.coords=this.coords,e.visProp=c.deepCopy(this.visProp,this.visProp.traceattributes,!0),e.visProp.layer=this.board.options.layer.trace,e.elementClass=m.OBJECT_CLASS_POINT,e.board=this.board,c.clearVisPropOld(e),e.visPropCalc={visible:c.evaluate(e.visProp.visible)},this.board.renderer.drawPoint(e),this.traces[e.id]=e.rendNode,this}}),g.createPoint=function(e,o,t){var s,a;if(a=c.copyAttributes(t,e.options,"point"),!(s=h.create(g.Point,e,o,a)))throw new Error("JSXGraph: Can't create point with parent types '"+typeof o[0]+"' and '"+typeof o[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return s},g.createGlider=function(e,o,t){var s,a,d=c.copyAttributes(t,e.options,"glider");return a=o.length===1?[0,0]:o.slice(0,2),(s=e.create("point",a,d)).makeGlider(o[o.length-1]),s},g.createIntersectionPoint=function(e,o,t){var s,a,d,u,n,p,f=c.copyAttributes(t,e.options,"intersection");o.push(0,0),a=e.select(o[0]),d=e.select(o[1]),n=o[2]||0,p=o[3]||0,s=e.create("point",[0,0,0],f),u=v.intersectionFunction(e,a,d,n,p,s.visProp.alwaysintersect),s.addConstraint([u]);try{a.addChild(s),d.addChild(s)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof o[0]+"' and '"+typeof o[1]+"'.")}return s.type=m.OBJECT_TYPE_INTERSECTION,s.elType="intersection",s.setParents([a.id,d.id]),s.intersectionNumbers=[n,p],s.getParents=function(){return this.parents.concat(this.intersectionNumbers)},s.generatePolynomial=function(){var b=a.generatePolynomial(s),C=d.generatePolynomial(s);return b.length===0||C.length===0?[]:[b[0],C[0]]},s},g.createOtherIntersectionPoint=function(e,o,t){var s,a,d,u;if(o.length!==3||!c.isPoint(o[2])||o[0].elementClass!==m.OBJECT_CLASS_LINE&&o[0].elementClass!==m.OBJECT_CLASS_CIRCLE||o[1].elementClass!==m.OBJECT_CLASS_LINE&&o[1].elementClass!==m.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof o[0]+"',  '"+typeof o[1]+"'and  '"+typeof o[2]+`'.
Possible parent types: [circle|line,circle|line,point]`);return a=e.select(o[0]),d=e.select(o[1]),u=e.select(o[2]),(s=e.create("point",[function(){var n=v.meet(a.stdform,d.stdform,0,a.board);return Math.abs(u.X()-n.usrCoords[1])>y.eps||Math.abs(u.Y()-n.usrCoords[2])>y.eps||Math.abs(u.Z()-n.usrCoords[0])>y.eps?n:v.meet(a.stdform,d.stdform,1,a.board)}],t)).type=m.OBJECT_TYPE_INTERSECTION,s.elType="otherintersection",s.setParents([a.id,d.id,u]),a.addChild(s),d.addChild(s),s.generatePolynomial=function(){var n=a.generatePolynomial(s),p=d.generatePolynomial(s);return n.length===0||p.length===0?[]:[n[0],p[0]]},s},g.createPolePoint=function(e,o,t){var s,a,d,u,n,p,f;if(o.length>1&&(u=o[0].type===m.OBJECT_TYPE_CONIC||o[0].elementClass===m.OBJECT_CLASS_CIRCLE,n=o[1].type===m.OBJECT_TYPE_CONIC||o[1].elementClass===m.OBJECT_CLASS_CIRCLE,p=o[0].elementClass===m.OBJECT_CLASS_LINE,f=o[1].elementClass===m.OBJECT_CLASS_LINE),o.length!==2||!(u&&f||p&&n))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof o[0]+"' and '"+typeof o[1]+`'.
Possible parent type: [conic|circle,line], [line,conic|circle]`);return f?(a=e.select(o[0]),d=e.select(o[1])):(a=e.select(o[1]),d=e.select(o[0])),(s=e.create("point",[function(){var b=a.quadraticform,C=d.stdform.slice(0,3);return[g.Math.Numerics.det([C,b[1],b[2]]),g.Math.Numerics.det([b[0],C,b[2]]),g.Math.Numerics.det([b[0],b[1],C])]}],t)).elType="polepoint",s.setParents([a.id,d.id]),a.addChild(s),d.addChild(s),s},g.registerElement("point",g.createPoint),g.registerElement("glider",g.createGlider),g.registerElement("intersection",g.createIntersectionPoint),g.registerElement("otherintersection",g.createOtherIntersectionPoint),g.registerElement("polepoint",g.createPolePoint),{Point:g.Point,createPoint:g.createPoint,createGlider:g.createGlider,createIntersection:g.createIntersectionPoint,createOtherIntersection:g.createOtherIntersectionPoint,createPolePoint:g.createPolePoint}}),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],function(g,P,y,v,m,l,c,h,e,o){return g.Line=function(t,s,a,d){this.constructor(t,d,l.OBJECT_TYPE_LINE,l.OBJECT_CLASS_LINE),this.point1=this.board.select(s),this.point2=this.board.select(a),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1._is_new?(this.addChild(this.point1),delete this.point1._is_new):this.point1.addChild(this),this.point2._is_new?(this.addChild(this.point2),delete this.point2._is_new):this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=g.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L"})},g.Line.prototype=new h,g.extend(g.Line.prototype,{hasPoint:function(t,s){var a,d,u,n,p,f,b,C,_,E=[],x=[1,t,s],S=e.evaluate(this.visProp.strokewidth);return e.isObject(e.evaluate(this.visProp.precision))?(_=this.board._inputDevice,C=e.evaluate(this.visProp.precision[_])):C=this.board.options.precision.hasPoint,C+=.5*S,E[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,E[1]=this.stdform[1]/this.board.unitX,E[2]=this.stdform[2]/-this.board.unitY,a=y.distPointLine(x,E),!(isNaN(a)||a>C)&&(!(!e.evaluate(this.visProp.straightfirst)||!e.evaluate(this.visProp.straightlast))||(u=this.point1.coords,n=this.point2.coords,d=[0,E[1],E[2]],d=P.crossProduct(d,x),(d=P.crossProduct(d,E))[1]/=d[0],d[2]/=d[0],d[0]=1,d=new c(l.COORDS_BY_SCREEN,d.slice(1),this.board).usrCoords,p=u.distance(l.COORDS_BY_USER,n),u=u.usrCoords.slice(0),n=n.usrCoords.slice(0),p<P.eps?f=0:(p===Number.POSITIVE_INFINITY&&(p=1/P.eps,Math.abs(n[0])<P.eps?(p/=y.distance([0,0,0],n),n=[1,u[1]+n[1]*p,u[2]+n[2]*p]):(p/=y.distance([0,0,0],u),u=[1,n[1]+u[1]*p,n[2]+u[2]*p])),p=n[b=1]-u[b],Math.abs(p)<P.eps&&(p=n[b=2]-u[b]),f=(d[b]-u[b])/p),!(!e.evaluate(this.visProp.straightfirst)&&f<0)&&!(!e.evaluate(this.visProp.straightlast)&&f>1)))},update:function(){var t;return this.needsUpdate?(this.constrained&&(e.isFunction(this.funps)?(t=this.funps())&&t.length&&t.length===2&&(this.point1=t[0],this.point2=t[1]):(e.isFunction(this.funp1)&&(t=this.funp1(),e.isPoint(t)?this.point1=t:t&&t.length&&t.length===2&&this.point1.setPositionDirectly(l.COORDS_BY_USER,t)),e.isFunction(this.funp2)&&(t=this.funp2(),e.isPoint(t)?this.point2=t:t&&t.length&&t.length===2&&this.point2.setPositionDirectly(l.COORDS_BY_USER,t)))),this.updateSegmentFixedLength(),this.updateStdform(),e.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var t,s,a,d,u,n,p,f;return this.hasFixedLength?(t=this.point1.Dist(this.point2),s=this.fixedLength(),a=this.fixedLengthOldCoords[0].distance(l.COORDS_BY_USER,this.point1.coords),d=this.fixedLengthOldCoords[1].distance(l.COORDS_BY_USER,this.point2.coords),(a>P.eps||d>P.eps||t!==s)&&(u=this.point1.isDraggable&&this.point1.type!==l.OBJECT_TYPE_GLIDER&&!e.evaluate(this.point1.visProp.fixed),n=this.point2.isDraggable&&this.point2.type!==l.OBJECT_TYPE_GLIDER&&!e.evaluate(this.point2.visProp.fixed),t>P.eps?a>d&&n||a<=d&&n&&!u?(this.point2.setPositionDirectly(l.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*s/t,this.point1.Y()+(this.point2.Y()-this.point1.Y())*s/t]),this.point2.fullUpdate()):(a<=d&&u||a>d&&u&&!n)&&(this.point1.setPositionDirectly(l.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*s/t,this.point2.Y()+(this.point1.Y()-this.point2.Y())*s/t]),this.point1.fullUpdate()):(p=Math.random()-.5,f=Math.random()-.5,t=Math.sqrt(p*p+f*f),n?(this.point2.setPositionDirectly(l.COORDS_BY_USER,[this.point1.X()+p*s/t,this.point1.Y()+f*s/t]),this.point2.fullUpdate()):u&&(this.point1.setPositionDirectly(l.COORDS_BY_USER,[this.point2.X()+p*s/t,this.point2.Y()+f*s/t]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(l.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(l.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var t=P.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=t[0],this.stdform[1]=t[1],this.stdform[2]=t[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&P.innerProduct(this.stdform,this.stdform,3)>=P.eps*P.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(t){var s=this.point1.symbolic.x,a=this.point1.symbolic.y,d=this.point2.symbolic.x,u=this.point2.symbolic.y,n=t.symbolic.x,p=t.symbolic.y;return[["(",a,")*(",n,")-(",a,")*(",d,")+(",p,")*(",d,")-(",s,")*(",p,")+(",s,")*(",u,")-(",n,")*(",u,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=P.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=P.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(t,s){return this.visProp.straightfirst=t,this.visProp.straightlast=s,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new c(l.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(t){e.exists(this.label)&&(this.label.relativeCoords=new c(l.COORDS_BY_SCREEN,[t[0],-t[1]],this.board))},getLabelAnchor:function(){var t,s,a=0,d=new c(l.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),u=new c(l.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),n=e.evaluate(this.visProp.straightfirst),p=e.evaluate(this.visProp.straightlast);if((n||p)&&y.calcStraight(this,d,u,0),d=d.scrCoords,u=u.scrCoords,!e.exists(this.label))return new c(l.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(e.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":d[1]<=u[1]?(t=d[1],s=d[2]):(t=u[1],s=u[2]);break;case"rt":case"lrt":case"urt":d[1]>u[1]?(t=d[1],s=d[2]):(t=u[1],s=u[2]);break;default:t=.5*(d[1]+u[1]),s=.5*(d[2]+u[2])}return(n||p)&&(e.exists(this.label)&&(a=e.evaluate(this.label.visProp.fontsize)),Math.abs(t)<P.eps?t=a:this.board.canvasWidth+P.eps>t&&t>this.board.canvasWidth-a-P.eps&&(t=this.board.canvasWidth-a),P.eps+a>s&&s>-P.eps?s=a:this.board.canvasHeight+P.eps>s&&s>this.board.canvasHeight-a-P.eps&&(s=this.board.canvasHeight-a)),new c(l.COORDS_BY_SCREEN,[t,s],this.board)},cloneToBackground:function(){var t,s,a,d={};return d.id=this.id+"T"+this.numTraces,d.elementClass=l.OBJECT_CLASS_LINE,this.numTraces++,d.point1=this.point1,d.point2=this.point2,d.stdform=this.stdform,d.board=this.board,d.visProp=e.deepCopy(this.visProp,this.visProp.traceattributes,!0),d.visProp.layer=this.board.options.layer.trace,e.clearVisPropOld(d),d.visPropCalc={visible:e.evaluate(d.visProp.visible)},s=this.getSlope(),t=this.getRise(),d.getSlope=function(){return s},d.getRise=function(){return t},a=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(d),this.board.renderer.enhancedRendering=a,this.traces[d.id]=d.rendNode,this},addTransform:function(t){var s,a=e.isArray(t)?t:[t],d=a.length;for(s=0;s<d;s++)this.point1.transformations.push(a[s]),this.point2.transformations.push(a[s]);return this},snapToGrid:function(t){var s,a,d,u,n,p,f,b;return e.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):e.exists(t)&&(f=e.evaluate(this.visProp.snapsizex),b=e.evaluate(this.visProp.snapsizey),n=(s=new c(l.COORDS_BY_SCREEN,[t.Xprev,t.Yprev],this.board)).usrCoords[1],p=s.usrCoords[2],f<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(f=(u=this.board.defaultAxes.x.defaultTicks).ticksDelta*(e.evaluate(u.visProp.minorticks)+1)),b<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(b=(u=this.board.defaultAxes.y.defaultTicks).ticksDelta*(e.evaluate(u.visProp.minorticks)+1)),f>0&&b>0&&(a=y.projectPointToLine({coords:s},this,this.board),d=m.subtract([1,Math.round(n/f)*f,Math.round(p/b)*b],a.usrCoords),this.board.create("transform",d.slice(1),{type:"translate"}).applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var t=e.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(t),this.point2.handleSnapToPoints(t)),this},X:function(t){var s,a=this.stdform[2];return s=Math.abs(this.point1.coords.usrCoords[0])>P.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],t=2*(t-.5),(1-Math.abs(t))*s-t*a},Y:function(t){var s,a=this.stdform[1];return s=Math.abs(this.point1.coords.usrCoords[0])>P.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],t=2*(t-.5),(1-Math.abs(t))*s+t*a},Z:function(t){var s=Math.abs(this.point1.coords.usrCoords[0])>P.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return t=2*(t-.5),(1-Math.abs(t))*s},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var t=this.point1.coords.usrCoords,s=this.point2.coords.usrCoords;return[Math.min(t[1],s[1]),Math.max(t[2],s[2]),Math.max(t[1],s[1]),Math.min(t[2],s[2])]},remove:function(){this.removeAllTicks(),h.prototype.remove.call(this)}}),g.createLine=function(t,s,a){var d,u,n,p,f,b,C,_=[],E=!1,x=!1;if(s.length===2){if(e.isArray(s[0])&&s[0].length>1)b=e.copyAttributes(a,t.options,"line","point1"),n=t.create("point",s[0],b);else if(e.isString(s[0])||e.isPoint(s[0]))n=t.select(s[0]);else if(e.isFunction(s[0])&&e.isPoint(s[0]()))n=s[0](),x=!0;else if(e.isFunction(s[0])&&s[0]().length&&s[0]().length>=2)b=e.copyAttributes(a,t.options,"line","point1"),n=o.createPoint(t,s[0](),b),x=!0;else{if(!e.isObject(s[0])||!e.isTransformationOrArray(s[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);E=!0,b=e.copyAttributes(a,t.options,"line","point1"),n=t.create("point",[s[0].point1,s[1]],b)}if(E)b=e.copyAttributes(a,t.options,"line","point2"),p=t.create("point",[s[0].point2,s[1]],b);else if(e.isArray(s[1])&&s[1].length>1)b=e.copyAttributes(a,t.options,"line","point2"),p=t.create("point",s[1],b);else if(e.isString(s[1])||e.isPoint(s[1]))p=t.select(s[1]);else if(e.isFunction(s[1])&&e.isPoint(s[1]()))p=s[1](),x=!0;else{if(!(e.isFunction(s[1])&&s[1]().length&&s[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);b=e.copyAttributes(a,t.options,"line","point2"),p=o.createPoint(t,s[1](),b),x=!0}b=e.copyAttributes(a,t.options,"line"),u=new g.Line(t,n,p,b),x?(u.constrained=!0,u.funp1=s[0],u.funp2=s[1]):E||(u.isDraggable=!0),u.setParents([n.id,p.id])}else if(s.length===3){for(C=!0,f=0;f<3;f++)if(e.isNumber(s[f]))_[f]=e.createFunction(s[f]);else{if(!e.isFunction(s[f]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"' and '"+typeof s[2]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);_[f]=s[f],C=!1}b=e.copyAttributes(a,t.options,"line","point1"),n=C?t.create("point",[_[2]()*_[2]()+_[1]()*_[1](),_[2]()-_[1]()*_[0]()+_[2](),-_[1]()-_[2]()*_[0]()-_[1]()],b):t.create("point",[function(){return .5*(_[2]()*_[2]()+_[1]()*_[1]())},function(){return .5*(_[2]()-_[1]()*_[0]()+_[2]())},function(){return .5*(-_[1]()-_[2]()*_[0]()-_[1]())}],b),b=e.copyAttributes(a,t.options,"line","point2"),p=C?t.create("point",[_[2]()*_[2]()+_[1]()*_[1](),-_[1]()*_[0]()+_[2](),-_[2]()*_[0]()-_[1]()],b):t.create("point",[function(){return _[2]()*_[2]()+_[1]()*_[1]()},function(){return-_[1]()*_[0]()+_[2]()},function(){return-_[2]()*_[0]()-_[1]()}],b),n.prepareUpdate().update(),p.prepareUpdate().update(),b=e.copyAttributes(a,t.options,"line"),(u=new g.Line(t,n,p,b)).isDraggable=C,u.setParents([n,p])}else if(s.length===1&&e.isFunction(s[0])&&s[0]().length===2&&e.isPoint(s[0]()[0])&&e.isPoint(s[0]()[1]))d=s[0](),b=e.copyAttributes(a,t.options,"line"),(u=new g.Line(t,d[0],d[1],b)).constrained=!0,u.funps=s[0],u.setParents(d);else{if(!(s.length===1&&e.isFunction(s[0])&&s[0]().length===3&&e.isNumber(s[0]()[0])&&e.isNumber(s[0]()[1])&&e.isNumber(s[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);d=s[0],b=e.copyAttributes(a,t.options,"line","point1"),n=t.create("point",[function(){var S=d();return[.5*(S[2]*S[2]+S[1]*S[1]),.5*(S[2]-S[1]*S[0]+S[2]),.5*(-S[1]-S[2]*S[0]-S[1])]}],b),b=e.copyAttributes(a,t.options,"line","point2"),p=t.create("point",[function(){var S=d();return[S[2]*S[2]+S[1]*S[1],-S[1]*S[0]+S[2],-S[2]*S[0]-S[1]]}],b),b=e.copyAttributes(a,t.options,"line"),(u=new g.Line(t,n,p,b)).constrained=!0,u.funps=s[0],u.setParents([n,p])}return u},g.registerElement("line",g.createLine),g.createSegment=function(t,s,a){var d,u;if(a.straightFirst=!1,a.straightLast=!1,u=e.copyAttributes(a,t.options,"segment"),d=t.create("line",s.slice(0,2),u),s.length===3){if(d.hasFixedLength=!0,e.isNumber(s[2]))d.fixedLength=function(){return s[2]};else{if(!e.isFunction(s[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof s[2]+`'.
Possible third parent types: number or function`);d.fixedLength=s[2]}d.getParents=function(){return this.parents.concat(this.fixedLength())},d.fixedLengthOldCoords=[],d.fixedLengthOldCoords[0]=new c(l.COORDS_BY_USER,d.point1.coords.usrCoords.slice(1,3),t),d.fixedLengthOldCoords[1]=new c(l.COORDS_BY_USER,d.point2.coords.usrCoords.slice(1,3),t)}return d.elType="segment",d},g.registerElement("segment",g.createSegment),g.createArrow=function(t,s,a){var d,u;return a.straightFirst=!1,a.straightLast=!1,u=e.copyAttributes(a,t.options,"arrow"),(d=t.create("line",s,u)).type=l.OBJECT_TYPE_VECTOR,d.elType="arrow",d},g.registerElement("arrow",g.createArrow),g.createAxis=function(t,s,a){var d,u,n,p,f;if(!e.isArray(s[0])&&!e.isPoint(s[0])||!e.isArray(s[1])&&!e.isPoint(s[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);for(p in d=e.copyAttributes(a,t.options,"axis"),(n=t.create("line",s,d)).type=l.OBJECT_TYPE_AXIS,n.isDraggable=!1,n.point1.isDraggable=!1,n.point2.isDraggable=!1,n.ancestors)n.ancestors.hasOwnProperty(p)&&(n.ancestors[p].type=l.OBJECT_TYPE_AXISPOINT);return u=e.copyAttributes(a,t.options,"axis","ticks"),f=e.exists(u.ticksdistance)?u.ticksdistance:e.isArray(u.ticks)?u.ticks:1,n.defaultTicks=t.create("ticks",[n,f],u),n.defaultTicks.dump=!1,n.elType="axis",n.subs={ticks:n.defaultTicks},n.inherits.push(n.defaultTicks),n},g.registerElement("axis",g.createAxis),g.createTangent=function(t,s,a){var d,u,n,p,f;if(s.length===1)d=s[0],u=d.slideObject;else{if(s.length!==2)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);if(e.isPoint(s[0]))d=s[0],u=s[1];else{if(!e.isPoint(s[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);u=s[0],d=s[1]}}if(u.elementClass===l.OBJECT_CLASS_LINE?(f=t.create("line",[u.point1,u.point2],a)).glider=d:u.elementClass===l.OBJECT_CLASS_CURVE&&u.type!==l.OBJECT_TYPE_CONIC?e.evaluate(u.visProp.curvetype)!=="plot"?(f=t.create("line",[function(){var b=u.X,C=u.Y;return-d.X()*v.D(C)(d.position)+d.Y()*v.D(b)(d.position)},function(){return v.D(u.Y)(d.position)},function(){return-v.D(u.X)(d.position)}],a),d.addChild(f),f.glider=d):(f=t.create("line",[function(){var b,C,_,E,x,S,O,w,T,M,N=Math.floor(d.position);if(u.bezierDegree===1)N===u.numberPoints-1&&N--;else{if(u.bezierDegree!==3)return 0;N=3*Math.floor(d.position*(u.numberPoints-1)/3),_=(d.position*(u.numberPoints-1)-N)/3,N>=u.numberPoints-1&&(N=u.numberPoints-4,_=1)}return N<0?1:(u.bezierDegree===1?(b=u.points[N].usrCoords,C=u.points[N+1].usrCoords):(E=u.points[N].usrCoords,x=u.points[N+1].usrCoords,S=u.points[N+2].usrCoords,O=u.points[N+3].usrCoords,w=(1-_)*(1-_)*(x[1]-E[1])+2*(1-_)*_*(S[1]-x[1])+_*_*(O[1]-S[1]),T=(1-_)*(1-_)*(x[2]-E[2])+2*(1-_)*_*(S[2]-x[2])+_*_*(O[2]-S[2]),w/=M=Math.sqrt(w*w+T*T),T/=M,C=[1,(b=d.coords.usrCoords)[1]+w,b[2]+T]),b[2]*C[1]-b[1]*C[2])},function(){var b,C,_,E,x,S,O,w,T,M,N=Math.floor(d.position);if(u.bezierDegree===1)N===u.numberPoints-1&&N--;else{if(u.bezierDegree!==3)return 0;N=3*Math.floor(d.position*(u.numberPoints-1)/3),_=(d.position*(u.numberPoints-1)-N)/3,N>=u.numberPoints-1&&(N=u.numberPoints-4,_=1)}return N<0?0:(u.bezierDegree===1?(b=u.points[N].usrCoords,C=u.points[N+1].usrCoords):(E=u.points[N].usrCoords,x=u.points[N+1].usrCoords,S=u.points[N+2].usrCoords,O=u.points[N+3].usrCoords,w=(1-_)*(1-_)*(x[1]-E[1])+2*(1-_)*_*(S[1]-x[1])+_*_*(O[1]-S[1]),T=(1-_)*(1-_)*(x[2]-E[2])+2*(1-_)*_*(S[2]-x[2])+_*_*(O[2]-S[2]),w/=M=Math.sqrt(w*w+T*T),T/=M,C=[1,(b=d.coords.usrCoords)[1]+w,b[2]+T]),C[2]-b[2])},function(){var b,C,_,E,x,S,O,w,T,M,N=Math.floor(d.position);if(u.bezierDegree===1)N===u.numberPoints-1&&N--;else{if(u.bezierDegree!==3)return 0;N=3*Math.floor(d.position*(u.numberPoints-1)/3),_=(d.position*(u.numberPoints-1)-N)/3,N>=u.numberPoints-1&&(N=u.numberPoints-4,_=1)}return N<0?0:(u.bezierDegree===1?(b=u.points[N].usrCoords,C=u.points[N+1].usrCoords):(E=u.points[N].usrCoords,x=u.points[N+1].usrCoords,S=u.points[N+2].usrCoords,O=u.points[N+3].usrCoords,w=(1-_)*(1-_)*(x[1]-E[1])+2*(1-_)*_*(S[1]-x[1])+_*_*(O[1]-S[1]),T=(1-_)*(1-_)*(x[2]-E[2])+2*(1-_)*_*(S[2]-x[2])+_*_*(O[2]-S[2]),w/=M=Math.sqrt(w*w+T*T),T/=M,C=[1,(b=d.coords.usrCoords)[1]+w,b[2]+T]),b[1]-C[1])}],a),d.addChild(f),f.glider=d):u.type===l.OBJECT_TYPE_TURTLE?(f=t.create("line",[function(){var b=Math.floor(d.position);for(n=0;n<u.objects.length;n++)if((p=u.objects[n]).type===l.OBJECT_TYPE_CURVE){if(b<p.numberPoints)break;b-=p.numberPoints}return b===p.numberPoints-1&&b--,b<0?1:p.Y(b)*p.X(b+1)-p.X(b)*p.Y(b+1)},function(){var b=Math.floor(d.position);for(n=0;n<u.objects.length;n++)if((p=u.objects[n]).type===l.OBJECT_TYPE_CURVE){if(b<p.numberPoints)break;b-=p.numberPoints}return b===p.numberPoints-1&&b--,b<0?0:p.Y(b+1)-p.Y(b)},function(){var b=Math.floor(d.position);for(n=0;n<u.objects.length;n++)if((p=u.objects[n]).type===l.OBJECT_TYPE_CURVE){if(b<p.numberPoints)break;b-=p.numberPoints}return b===p.numberPoints-1&&b--,b<0?0:p.X(b)-p.X(b+1)}],a),d.addChild(f),f.glider=d):u.elementClass!==l.OBJECT_CLASS_CIRCLE&&u.type!==l.OBJECT_TYPE_CONIC||(f=t.create("line",[function(){return P.matVecMult(u.quadraticform,d.coords.usrCoords)[0]},function(){return P.matVecMult(u.quadraticform,d.coords.usrCoords)[1]},function(){return P.matVecMult(u.quadraticform,d.coords.usrCoords)[2]}],a),d.addChild(f),f.glider=d),!e.exists(f))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return f.elType="tangent",f.type=l.OBJECT_TYPE_TANGENT,f.setParents(s),f},g.createRadicalAxis=function(t,s,a){var d,u,n;if(s.length!==2||s[0].elementClass!==l.OBJECT_CLASS_CIRCLE||s[1].elementClass!==l.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent type: [circle,circle]`);return u=t.select(s[0]),n=t.select(s[1]),(d=t.create("line",[function(){var p=u.stdform,f=n.stdform;return P.matVecMult(P.transpose([p.slice(0,3),f.slice(0,3)]),[f[3],-p[3]])}],a)).elType="radicalaxis",d.setParents([u.id,n.id]),u.addChild(d),n.addChild(d),d},g.createPolarLine=function(t,s,a){var d,u,n,p,f,b,C;if(s.length>1&&(p=s[0].type===l.OBJECT_TYPE_CONIC||s[0].elementClass===l.OBJECT_CLASS_CIRCLE,f=s[1].type===l.OBJECT_TYPE_CONIC||s[1].elementClass===l.OBJECT_CLASS_CIRCLE,b=e.isPoint(s[0]),C=e.isPoint(s[1])),s.length!==2||!(p&&C||b&&f))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent type: [conic|circle,point], [point,conic|circle]`);return C?(u=t.select(s[0]),n=t.select(s[1])):(u=t.select(s[1]),n=t.select(s[0])),(d=t.create("tangent",[u,n],a)).elType="polarline",d},g.registerElement("tangent",g.createTangent),g.registerElement("polar",g.createTangent),g.registerElement("radicalaxis",g.createRadicalAxis),g.registerElement("polarline",g.createPolarLine),{Line:g.Line,createLine:g.createLine,createTangent:g.createTangent,createPolar:g.createTangent,createSegment:g.createSegment,createAxis:g.createAxis,createArrow:g.createArrow,createRadicalAxis:g.createRadicalAxis,createPolarLine:g.createPolarLine}}),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],function(g,P,y,v,m){return g.Group=function(l,c,h,e,o){var t,s,a,d;for(this.board=l,this.objects={},t=this.board.numObjects,this.board.numObjects+=1,c!==""&&m.exists(c)?this.id=c:this.id=this.board.id+"Group"+t,this.board.groups[this.id]=this,this.type=P.OBJECT_TYPE_POINT,this.elementClass=P.OBJECT_CLASS_POINT,h!==""&&m.exists(h)?this.name=h:this.name="group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=o.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],s=m.isArray(e)?e:Array.prototype.slice.call(arguments,3),a=0;a<s.length;a++)d=this.board.select(s[a]),!m.evaluate(d.visProp.fixed)&&m.exists(d.coords)&&this.addPoint(d);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},g.extend(g.Group.prototype,{ungroup:function(){var l,c,h;for(l in this.objects)this.objects.hasOwnProperty(l)&&(c=this.objects[l].point,m.isArray(c.groups)&&(h=m.indexOf(c.groups,this.id))>=0&&delete c.groups[h]);return this.objects={},this},addParents:function(l){var c,h,e;for(h=(e=m.isArray(l)?l:arguments).length,c=0;c<h;++c)m.isId(this.board,e[c])?this.parents.push(e[c]):m.exists(e[c].id)&&this.parents.push(e[c].id);this.parents=m.uniqueArray(this.parents)},setParents:function(l){return this.parents=[],this.addParents(l),this},getParents:function(){return m.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(l){var c;l!==""&&m.exists(this.objects[l])&&(c=this.objects[l].point,this.coords[c.id]={usrCoords:c.coords.usrCoords.slice(0)})},update:function(){var l,c,h,e,o,t,s,a,d,u,n=null;if(!this.needsUpdate)return this;if((l=this._update_find_drag_type()).action==="nothing")return this._updateCoordsCache(l.id),this;if(n=this.objects[l.id].point,l.action==="translation")d=[n.coords.usrCoords[1]-this.coords[l.id].usrCoords[1],n.coords.usrCoords[2]-this.coords[l.id].usrCoords[2]];else if(l.action==="rotation"||l.action==="scaling"){if(h=l.action==="rotation"?"rotationCenter":"scaleCenter",m.isPoint(this[h]))u=this[h].coords.usrCoords.slice(1);else if(this[h]==="centroid")u=this._update_centroid_center();else if(m.isArray(this[h]))u=this[h];else{if(!m.isFunction(this[h]))return this;u=this[h]()}if(l.action==="rotation")a=v.rad(this.coords[l.id].usrCoords.slice(1),u,this.objects[l.id].point),(d=this.board.create("transform",[a,u[0],u[1]],{type:"rotate"})).update();else{if(l.action!=="scaling")return this;if(o=v.distance(this.coords[l.id].usrCoords.slice(1),u),Math.abs(o)<y.eps)return this;o=v.distance(n.coords.usrCoords.slice(1),u)/o,t=this.scaleDirections[l.id].indexOf("x")>=0?o:1,s=this.scaleDirections[l.id].indexOf("y")>=0?o:1,(d=this.board.create("transform",[1,0,0,u[0]*(1-t),t,0,u[1]*(1-s),0,s],{type:"generic"})).update()}}for(c in this._update_apply_transformation(l,d),this.needsUpdate=!1,this.objects)if(this.objects.hasOwnProperty(c))for(e in this.objects[c].descendants)this.objects[c].descendants.hasOwnProperty(e)&&(this.objects[c].descendants.needsUpdate=this.objects[c].descendants.needsRegularUpdate||this.board.needsFullUpdate);for(c in this.board.updateElements(l),this.objects)this.objects.hasOwnProperty(c)&&this._updateCoordsCache(c);return this},_update_find_drag_type:function(){var l,c,h,e="nothing",o=[];for(l in this.objects)this.objects.hasOwnProperty(l)&&(c=this.objects[l].point).coords.distance(P.COORDS_BY_USER,this.coords[l])>y.eps&&o.push(c.id);return o.length===0?{action:e,id:"",changed:o}:(h=o[0],c=this.objects[h].point,o.length>1?e="translation":m.isInArray(this.rotationPoints,c)&&m.exists(this.rotationCenter)?e="rotation":m.isInArray(this.scalePoints,c)&&m.exists(this.scaleCenter)?e="scaling":m.isInArray(this.translationPoints,c)&&(e="translation"),{action:e,id:h,changed:o})},_update_centroid_center:function(){var l,c,h;for(h in l=[0,0],c=0,this.coords)this.coords.hasOwnProperty(h)&&(l[0]+=this.coords[h].usrCoords[1],l[1]+=this.coords[h].usrCoords[2],++c);return c>0&&(l[0]/=c,l[1]/=c),l},_update_apply_transformation:function(l,c){var h,e;for(h in this.objects)this.objects.hasOwnProperty(h)&&(m.exists(this.board.objects[h])?(e=this.objects[h].point).id!==l.id?l.action==="translation"?m.isInArray(l.changed,e.id)||e.coords.setCoordinates(P.COORDS_BY_USER,[this.coords[h].usrCoords[1]+c[0],this.coords[h].usrCoords[2]+c[1]]):l.action!=="rotation"&&l.action!=="scaling"||c.applyOnce([e]):l.action!=="rotation"&&l.action!=="scaling"||e.coords.setCoordinates(P.COORDS_BY_USER,y.matVecMult(c.matrix,this.coords[e.id].usrCoords)):delete this.objects[h])},addPoint:function(l){return this.objects[l.id]={point:this.board.select(l)},this._updateCoordsCache(l.id),this.translationPoints.push(l),l.groups.push(this.id),l.groups=m.uniqueArray(l.groups),this},addPoints:function(l){var c;for(c=0;c<l.length;c++)this.addPoint(l[c]);return this},addGroup:function(l){var c;for(c in l.objects)l.objects.hasOwnProperty(c)&&this.addPoint(l.objects[c].point);return this},removePoint:function(l){return delete this.objects[l.id],this},setRotationCenter:function(l){return this.rotationCenter=l,this},setRotationPoints:function(l){return this._setActionPoints("rotation",l)},addRotationPoint:function(l){return this._addActionPoint("rotation",l)},removeRotationPoint:function(l){return this._removeActionPoint("rotation",l)},setTranslationPoints:function(l){return this._setActionPoints("translation",l)},addTranslationPoint:function(l){return this._addActionPoint("translation",l)},removeTranslationPoint:function(l){return this._removeActionPoint("translation",l)},setScaleCenter:function(l){return this.scaleCenter=l,this},setScalePoints:function(l,c){var h,e,o;for(o=(h=m.isArray(l)?l:arguments).length,e=0;e<o;++e)this.scaleDirections[this.board.select(h[e]).id]=c||"xy";return this._setActionPoints("scale",l)},addScalePoint:function(l,c){return this._addActionPoint("scale",l),this.scaleDirections[this.board.select(l).id]=c||"xy",this},removeScalePoint:function(l){return this._removeActionPoint("scale",l)},_setActionPoints:function(l,c){var h,e,o;for(o=(h=m.isArray(c)?c:arguments).length,this[l+"Points"]=[],e=0;e<o;++e)this._addActionPoint(l,h[e]);return this},_addActionPoint:function(l,c){return this[l+"Points"].push(this.board.select(c)),this},_removeActionPoint:function(l,c){var h=this[l+"Points"].indexOf(this.board.select(c));return h>-1&&this[l+"Points"].splice(h,1),this},setProperty:function(){g.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var l;for(l in this.objects)this.objects.hasOwnProperty(l)&&this.objects[l].point.setAttribute.apply(this.objects[l].point,arguments);return this}}),g.createGroup=function(l,c,h){var e=m.copyAttributes(h,l.options,"group"),o=new g.Group(l,e.id,e.name,c,e);return o.elType="group",o.setParents(c),o},g.registerElement("group",g.createGroup),{Group:g.Group,createGroup:g.createGroup}}),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type"],function(g,P,y,v,m,l,c){return g.createEllipse=function(h,e,o){var t,s,a,d,u,n,p,f=[],b=c.copyAttributes(o,h.options,"conic","foci"),C=c.copyAttributes(o,h.options,"conic","center"),_=c.copyAttributes(o,h.options,"conic");for(n=0;n<2;n++)if(e[n].length>1)f[n]=h.create("point",e[n],b);else if(c.isPoint(e[n]))f[n]=h.select(e[n]);else if(c.isFunction(e[n])&&c.isPoint(e[n]()))f[n]=e[n]();else{if(!c.isString(e[n]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);f[n]=h.select(e[n])}if(c.isNumber(e[2]))u=c.createFunction(e[2],h);else if(c.isFunction(e[2])&&c.isNumber(e[2]()))u=e[2];else{if(c.isPoint(e[2]))d=h.select(e[2]);else if(e[2].length>1)d=h.create("point",e[2],b);else if(c.isFunction(e[2])&&c.isPoint(e[2]()))d=e[2]();else{if(!c.isString(e[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);d=h.select(e[2])}u=function(){return d.Dist(f[0])+d.Dist(f[1])}}for(c.exists(e[4])||(e[4]=2*Math.PI),c.exists(e[3])||(e[3]=0),a=h.create("point",[function(){return .5*(f[0].X()+f[1].X())},function(){return .5*(f[0].Y()+f[1].Y())}],C),(s=h.create("curve",[function(E){return 0},function(E){return 0},e[3],e[4]],_)).majorAxis=u,p=s.hasPoint,t=function(E,x){var S,O,w,T,M,N,A,R,L;x||(O=(S=u())*S,w=f[0].X(),T=f[0].Y(),A=w-(M=f[1].X()),R=T-(N=f[1].Y()),L=(O-w*w-T*T+M*M+N*N)/(2*S),s.quadraticform=[[L*L-M*M-N*N,L*A/S+M,L*R/S+N],[L*A/S+M,A*A/O-1,A*R/O],[L*R/S+N,A*R/O,R*R/O-1]])},s.X=function(E,x){var S=u(),O=f[1].Dist(f[0]),w=.5*(O*O-S*S)/(O*Math.cos(E)-S),T=Math.atan2(f[1].Y()-f[0].Y(),f[1].X()-f[0].X());return x||t(0,x),f[0].X()+Math.cos(T+E)*w},s.Y=function(E,x){var S=u(),O=f[1].Dist(f[0]),w=.5*(O*O-S*S)/(O*Math.cos(E)-S),T=Math.atan2(f[1].Y()-f[0].Y(),f[1].X()-f[0].X());return f[0].Y()+Math.sin(T+E)*w},s.midpoint=s.center=a,s.type=P.OBJECT_TYPE_CONIC,s.subs={center:s.center},s.inherits.push(s.center,f[0],f[1]),c.isPoint(d)&&s.inherits.push(d),s.hasPoint=function(E,x){var S,O,w,T;return c.evaluate(this.visProp.hasinnerpoints)?(S=f[0].coords,O=f[1].coords,w=this.majorAxis(),(T=new y(P.COORDS_BY_SCREEN,[E,x],this.board)).distance(P.COORDS_BY_USER,S)+T.distance(P.COORDS_BY_USER,O)<=w):p.apply(this,arguments)},a.addChild(s),n=0;n<2;n++)c.isPoint(f[n])&&f[n].addChild(s);return c.isPoint(d)&&d.addChild(s),s.setParents(e),s},g.createHyperbola=function(h,e,o){var t,s,a,d,u,n,p=[],f=c.copyAttributes(o,h.options,"conic","foci"),b=c.copyAttributes(o,h.options,"conic","center"),C=c.copyAttributes(o,h.options,"conic");for(n=0;n<2;n++)if(e[n].length>1)p[n]=h.create("point",e[n],f);else if(c.isPoint(e[n]))p[n]=h.select(e[n]);else if(c.isFunction(e[n])&&c.isPoint(e[n]()))p[n]=e[n]();else{if(!c.isString(e[n]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);p[n]=h.select(e[n])}if(c.isNumber(e[2]))u=c.createFunction(e[2],h);else if(c.isFunction(e[2])&&c.isNumber(e[2]()))u=e[2];else{if(c.isPoint(e[2]))d=h.select(e[2]);else if(e[2].length>1)d=h.create("point",e[2],f);else if(c.isFunction(e[2])&&c.isPoint(e[2]()))d=e[2]();else{if(!c.isString(e[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);d=h.select(e[2])}u=function(){return d.Dist(p[0])-d.Dist(p[1])}}for(c.exists(e[4])||(e[4]=1.0001*Math.PI),c.exists(e[3])||(e[3]=-1.0001*Math.PI),a=h.create("point",[function(){return .5*(p[0].X()+p[1].X())},function(){return .5*(p[0].Y()+p[1].Y())}],b),(s=h.create("curve",[function(_){return 0},function(_){return 0},e[3],e[4]],C)).majorAxis=u,t=function(_,E){var x,S,O,w,T,M,N,A,R;E||(S=(x=u())*x,O=p[0].X(),w=p[0].Y(),N=O-(T=p[1].X()),A=w-(M=p[1].Y()),R=(S-O*O-w*w+T*T+M*M)/(2*x),s.quadraticform=[[R*R-T*T-M*M,R*N/x+T,R*A/x+M],[R*N/x+T,N*N/S-1,N*A/S],[R*A/x+M,N*A/S,A*A/S-1]])},s.X=function(_,E){var x=u(),S=p[1].Dist(p[0]),O=.5*(S*S-x*x)/(S*Math.cos(_)+x),w=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return E||t(0,E),p[0].X()+Math.cos(w+_)*O},s.Y=function(_,E){var x=u(),S=p[1].Dist(p[0]),O=.5*(S*S-x*x)/(S*Math.cos(_)+x),w=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return p[0].Y()+Math.sin(w+_)*O},s.midpoint=s.center=a,s.subs={center:s.center},s.inherits.push(s.center,p[0],p[1]),c.isPoint(d)&&s.inherits.push(d),s.type=P.OBJECT_TYPE_CONIC,a.addChild(s),n=0;n<2;n++)c.isPoint(p[n])&&p[n].addChild(s);return c.isPoint(d)&&d.addChild(s),s.setParents(e),s},g.createParabola=function(h,e,o){var t,s,a,d,u=e[0],n=e[1],p=c.copyAttributes(o,h.options,"conic","foci"),f=c.copyAttributes(o,h.options,"conic","center"),b=c.copyAttributes(o,h.options,"conic");if(e[0].length>1)u=h.create("point",e[0],p);else if(c.isPoint(e[0]))u=h.select(e[0]);else if(c.isFunction(e[0])&&c.isPoint(e[0]()))u=e[0]();else{if(!c.isString(e[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,line]`);u=h.select(e[0])}return c.isArray(n)&&n.length===2&&(d=c.copyAttributes(o,h.options,"conic","line"),n=h.create("line",n,d)),c.exists(e[3])||(e[3]=2*Math.PI),c.exists(e[2])||(e[2]=0),a=h.create("point",[function(){return l.projectPointToLine(u,n,h).usrCoords}],f),(s=h.create("curve",[function(C){return 0},function(C){return 0},e[2],e[3]],b)).midpoint=s.center=a,s.subs={center:s.center},s.inherits.push(s.center),t=function(C,_){var E,x,S,O,w,T;_||(E=n.stdform[1],x=n.stdform[2],S=n.stdform[0],O=E*E+x*x,w=u.X(),T=u.Y(),s.quadraticform=[[S*S-O*(w*w+T*T),S*E+O*w,S*x+O*T],[S*E+O*w,-x*x,E*x],[S*x+O*T,E*x,-E*E]])},s.X=function(C,_){var E,x=n.getAngle(),S=l.distPointLine(u.coords.usrCoords,n.stdform),O=n.point1.coords.usrCoords,w=n.point2.coords.usrCoords,T=u.coords.usrCoords;return O[0]===0?O=[1,w[1]+n.stdform[2],w[2]-n.stdform[1]]:w[0]===0&&(w=[1,O[1]+n.stdform[2],O[2]-n.stdform[1]]),E=((w[1]-O[1])*(T[2]-O[2])-(w[2]-O[2])*(T[1]-O[1])>=0?1:-1)*S/(1-Math.sin(C)),_||t(0,_),u.X()+Math.cos(C+x)*E},s.Y=function(C,_){var E,x=n.getAngle(),S=l.distPointLine(u.coords.usrCoords,n.stdform),O=n.point1.coords.usrCoords,w=n.point2.coords.usrCoords,T=u.coords.usrCoords;return O[0]===0?O=[1,w[1]+n.stdform[2],w[2]-n.stdform[1]]:w[0]===0&&(w=[1,O[1]+n.stdform[2],O[2]-n.stdform[1]]),E=((w[1]-O[1])*(T[2]-O[2])-(w[2]-O[2])*(T[1]-O[1])>=0?1:-1)*S/(1-Math.sin(C)),u.Y()+Math.sin(C+x)*E},s.type=P.OBJECT_TYPE_CONIC,a.addChild(s),c.isPoint(u)&&(u.addChild(s),s.inherits.push(u)),n.addChild(s),s.setParents(e),s},g.createConic=function(h,e,o){var t,s,a,d,u,n,p,f,b,C,_,E,x,S,O=[[1,0,0],[0,1,0],[0,0,1]],w=[[1,0,0],[0,1,0],[0,0,1]],T=[],M=[],N=c.copyAttributes(o,h.options,"conic","point"),A=c.copyAttributes(o,h.options,"conic","center"),R=c.copyAttributes(o,h.options,"conic");if(e.length===5)S=!0;else{if(e.length!==6)throw new Error("JSXGraph: Can't create generic Conic with "+e.length+" parameters.");S=!1}if(S)for(E=0;E<5;E++)if(e[E].length>1)T[E]=h.create("point",e[E],N);else if(c.isPoint(e[E]))T[E]=h.select(e[E]);else if(c.isFunction(e[E])&&c.isPoint(e[E]()))T[E]=e[E]();else{if(!c.isString(e[E]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof e[E]+`'.
Possible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]`);T[E]=h.select(e[E])}else(x=[[0,0,0],[0,0,0],[0,0,0]])[0][0]=c.isFunction(e[2])?function(){return e[2]()}:function(){return e[2]},x[0][1]=c.isFunction(e[4])?function(){return e[4]()}:function(){return e[4]},x[0][2]=c.isFunction(e[5])?function(){return e[5]()}:function(){return e[5]},x[1][1]=c.isFunction(e[0])?function(){return e[0]()}:function(){return e[0]},x[1][2]=c.isFunction(e[3])?function(){return e[3]()}:function(){return e[3]},x[2][2]=c.isFunction(e[1])?function(){return e[1]()}:function(){return e[1]};if(u=function(L){var D,k;for(D=0;D<3;D++)for(k=D;k<3;k++)L[D][k]+=L[k][D];for(D=0;D<3;D++)for(k=0;k<D;k++)L[D][k]=L[k][D];return L},d=function(L,D){var k,B,I=[[0,0,0],[0,0,0],[0,0,0]];for(k=0;k<3;k++)for(B=0;B<3;B++)I[k][B]=L[k]*D[B];return u(I)},a=function(L,D,k){var B,I,Y,q,V,W=[[0,0,0],[0,0,0],[0,0,0]];for(V=v.matVecMult(D,k),Y=v.innerProduct(k,V),V=v.matVecMult(L,k),q=v.innerProduct(k,V),B=0;B<3;B++)for(I=0;I<3;I++)W[B][I]=Y*L[B][I]-q*D[B][I];return W},s=h.create("curve",[function(L){return 0},function(L){return 0},0,2*Math.PI],R),t=function(L,D){var k,B,I,Y;if(!D){if(S){for(k=0;k<5;k++)M[k]=T[k].coords.usrCoords;C=d(v.crossProduct(M[0],M[1]),v.crossProduct(M[2],M[3])),_=d(v.crossProduct(M[0],M[2]),v.crossProduct(M[1],M[3])),w=a(C,_,M[4])}else for(k=0;k<3;k++)for(B=k;B<3;B++)w[k][B]=x[k][B](),B>k&&(w[B][k]=w[k][B]);for(s.quadraticform=w,(n=m.Jacobi(w))[0][0][0]<0&&(n[0][0][0]*=-1,n[0][1][1]*=-1,n[0][2][2]*=-1),k=0;k<3;k++){for(I=0,B=0;B<3;B++)I+=n[1][B][k]*n[1][B][k];I=Math.sqrt(I)}O=n[1],b=Math.sqrt(Math.abs(n[0][0][0])),p=Math.sqrt(Math.abs(n[0][1][1])),f=Math.sqrt(Math.abs(n[0][2][2]))}return n[0][1][1]<=0&&n[0][2][2]<=0?Y=v.matVecMult(O,[1/b,Math.cos(L)/p,Math.sin(L)/f]):n[0][1][1]<=0&&n[0][2][2]>0?Y=v.matVecMult(O,[Math.cos(L)/b,1/p,Math.sin(L)/f]):n[0][2][2]<0&&(Y=v.matVecMult(O,[Math.sin(L)/b,Math.cos(L)/p,1/f])),c.exists(Y)?(Y[1]/=Y[0],Y[2]/=Y[0],Y[0]=1):Y=[1,NaN,NaN],Y},s.X=function(L,D){return t(L,D)[1]},s.Y=function(L,D){return t(L,D)[2]},s.midpoint=h.create("point",[function(){var L=s.quadraticform;return[L[1][1]*L[2][2]-L[1][2]*L[1][2],L[1][2]*L[0][2]-L[2][2]*L[0][1],L[0][1]*L[1][2]-L[1][1]*L[0][2]]}],A),s.type=P.OBJECT_TYPE_CONIC,s.center=s.midpoint,s.subs={center:s.center},s.inherits.push(s.center),s.inherits=s.inherits.concat(T),S){for(E=0;E<5;E++)c.isPoint(T[E])&&T[E].addChild(s);s.setParents(e)}return s.addChild(s.center),s},g.registerElement("ellipse",g.createEllipse),g.registerElement("hyperbola",g.createHyperbola),g.registerElement("parabola",g.createParabola),g.registerElement("conic",g.createConic),{createEllipse:g.createEllipse,createHyperbola:g.createHyperbola,createParabola:g.createParabola,createConic:g.createConic}}),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],function(g,P,y,v,m,l,c){return g.Circle=function(h,e,o,t,s){this.constructor(h,s,v.OBJECT_TYPE_CIRCLE,v.OBJECT_CLASS_CIRCLE),this.method=e,this.midpoint=this.board.select(o),this.center=this.board.select(o),this.point2=null,this.radius=0,this.line=null,this.circle=null,this.points=[],e==="twoPoints"?(this.point2=h.select(t),this.radius=this.Radius()):e==="pointRadius"?(this.gxtterm=t,this.updateRadius=c.createFunction(t,this.board,null,!0),this.updateRadius()):e==="pointLine"?(this.line=h.select(t),this.radius=this.line.point1.coords.distance(v.COORDS_BY_USER,this.line.point2.coords)):e==="pointCircle"&&(this.circle=h.select(t),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),c.exists(this.center._is_new)?(this.addChild(this.center),delete this.center._is_new):this.center.addChild(this),e==="pointRadius"?this.notifyParents(t):e==="pointLine"?this.line.addChild(this):e==="pointCircle"?this.circle.addChild(this):e==="twoPoints"&&(c.exists(this.point2._is_new)?(this.addChild(this.point2),delete this.point2._is_new):this.point2.addChild(this)),this.methodMap=c.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},g.Circle.prototype=new P,g.extend(g.Circle.prototype,{hasPoint:function(h,e){var o,t,s,a,d,u=this.center.coords.usrCoords,n=new y(v.COORDS_BY_SCREEN,[h,e],this.board),p=this.Radius();return c.isObject(c.evaluate(this.visProp.precision))?(t=this.board._inputDevice,o=c.evaluate(this.visProp.precision[t])):o=this.board.options.precision.hasPoint,s=u[1]-n.usrCoords[1],a=u[2]-n.usrCoords[2],d=Math.sqrt(s*s+a*a),o+=.5*c.evaluate(this.visProp.strokewidth),o/=Math.sqrt(this.board.unitX*this.board.unitY),c.evaluate(this.visProp.hasinnerpoints)?d<p+o:Math.abs(d-p)<o},generatePolynomial:function(h){var e=this.center.symbolic.x,o=this.center.symbolic.y,t=h.symbolic.x,s=h.symbolic.y,a=this.generateRadiusSquared();return a===""?[]:["(("+t+")-("+e+"))^2 + (("+s+")-("+o+"))^2 - ("+a+")"]},generateRadiusSquared:function(){var h,e,o,t,s="";return this.method==="twoPoints"?(h=this.center.symbolic.x,e=this.center.symbolic.y,s="(("+(o=this.point2.symbolic.x)+")-("+h+"))^2 + (("+(t=this.point2.symbolic.y)+")-("+e+"))^2"):this.method==="pointRadius"?c.isNumber(this.radius)&&(s=(this.radius*this.radius).toString()):this.method==="pointLine"?(o=this.line.point1.symbolic.x,t=this.line.point1.symbolic.y,s="(("+o+")-("+this.line.point2.symbolic.x+"))^2 + (("+t+")-("+this.line.point2.symbolic.y+"))^2"):this.method==="pointCircle"&&(s=this.circle.Radius()),s},update:function(){var h,e,o,t,s,a;if(this.needsUpdate)for(c.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.method==="pointLine"?this.radius=this.line.point1.coords.distance(v.COORDS_BY_USER,this.line.point2.coords):this.method==="pointCircle"?this.radius=this.circle.Radius():this.method==="pointRadius"&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform(),o=this.center.coords.usrCoords[0],h=this.center.coords.usrCoords[1]/o,e=this.center.coords.usrCoords[2]/o,o/=o,t=this.Radius(),s=.551915024494,this.numberPoints=13,this.dataX=[h+t,h+t,h+t*s,h,h-t*s,h-t,h-t,h-t,h-t*s,h,h+t*s,h+t,h+t],this.dataY=[e,e+t*s,e+t,e+t,e+t,e+t*s,e,e-t*s,e-t,e-t,e-t,e-t*s,e],this.bezierDegree=3,a=0;a<this.numberPoints;a++)this.points[a]=new y(v.COORDS_BY_USER,[this.dataX[a],this.dataY[a]],this.board);return this},updateQuadraticform:function(){var h=this.center,e=h.X(),o=h.Y(),t=this.Radius();this.quadraticform=[[e*e+o*o-t*t,-e,-o],[-e,1,0],[-o,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=c.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(h){c.isString(h)&&l.findDependencies(this,h,this.board)},setRadius:function(h){return this.updateRadius=c.createFunction(h,this.board,null,!0),this.board.update(),this},Radius:function(h){return c.exists(h)?(this.setRadius(h),this.Radius()):this.method==="twoPoints"?c.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||c.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):this.method==="pointLine"||this.method==="pointCircle"?this.radius:this.method==="pointRadius"?this.updateRadius():NaN},getRadius:function(){return g.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var h,e,o=this.Radius(),t=this.center.coords.usrCoords,s=.7071067811865476;switch(c.evaluate(this.visProp.label.position)){case"lft":h=t[1]-o,e=t[2];break;case"llft":h=t[1]-s*o,e=t[2]-s*o;break;case"rt":h=t[1]+o,e=t[2];break;case"lrt":h=t[1]+s*o,e=t[2]-s*o;break;case"urt":h=t[1]+s*o,e=t[2]+s*o;break;case"top":h=t[1],e=t[2]+o;break;case"bot":h=t[1],e=t[2]-o;break;default:h=t[1]-s*o,e=t[2]+s*o}return new y(v.COORDS_BY_USER,[h,e],this.board)},cloneToBackground:function(){var h,e=this.Radius(),o={id:this.id+"T"+this.numTraces,elementClass:v.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return e},getRadius:function(){return e},board:this.board,visProp:c.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return o.visProp.layer=this.board.options.layer.trace,this.numTraces++,c.clearVisPropOld(o),o.visPropCalc={visible:c.evaluate(o.visProp.visible)},h=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(o),this.board.renderer.enhancedRendering=h,this.traces[o.id]=o.rendNode,this},addTransform:function(h){var e,o=c.isArray(h)?h:[h],t=o.length;for(e=0;e<t;e++)this.center.transformations.push(o[e]),this.method==="twoPoints"&&this.point2.transformations.push(o[e]);return this},snapToGrid:function(){var h=c.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(h,!0),this.method==="twoPoints"&&this.point2.handleSnapToGrid(h,!0),this},snapToPoints:function(){var h=c.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(h),this.method==="twoPoints"&&this.point2.handleSnapToPoints(h),this},X:function(h){return this.Radius()*Math.cos(2*h*Math.PI)+this.center.coords.usrCoords[1]},Y:function(h){return this.Radius()*Math.sin(2*h*Math.PI)+this.center.coords.usrCoords[2]},Z:function(h){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var h=this.Radius();return h*h*Math.PI},bounds:function(){var h=this.center.coords.usrCoords,e=this.Radius();return[h[1]-e,h[2]+e,h[1]+e,h[2]-e]},getParents:function(){return this.parents.length===1?this.parents.concat(this.radius):this.parents}}),g.createCircle=function(h,e,o){var t,s,a,d,u,n=["center","point2"];if(s=[],u=h.select(e[0]),c.isObject(u)&&u.elementClass===v.OBJECT_CLASS_CIRCLE&&c.isTransformationOrArray(e[1]))return d=c.copyAttributes(o,h.options,"circle"),(t=m.createEllipse(h,[u.center,u.center,function(){return 2*u.Radius()}],d)).addTransform(e[1]),t;for(a=0;a<e.length;a++)if(c.isPointType(h,e[a])){if((s=s.concat(c.providePoints(h,[e[a]],o,"circle",[n[a]])))[s.length-1]===!1)throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else s.push(e[a]);if(d=c.copyAttributes(o,h.options,"circle"),s.length===2&&c.isPoint(s[0])&&c.isPoint(s[1]))t=new g.Circle(h,"twoPoints",s[0],s[1],d);else if((c.isNumber(s[0])||c.isFunction(s[0])||c.isString(s[0]))&&c.isPoint(s[1]))t=new g.Circle(h,"pointRadius",s[1],s[0],d);else if((c.isNumber(s[1])||c.isFunction(s[1])||c.isString(s[1]))&&c.isPoint(s[0]))t=new g.Circle(h,"pointRadius",s[0],s[1],d);else if(s[0].elementClass===v.OBJECT_CLASS_CIRCLE&&c.isPoint(s[1]))t=new g.Circle(h,"pointCircle",s[1],s[0],d);else if(s[1].elementClass===v.OBJECT_CLASS_CIRCLE&&c.isPoint(s[0]))t=new g.Circle(h,"pointCircle",s[0],s[1],d);else if(s[0].elementClass===v.OBJECT_CLASS_LINE&&c.isPoint(s[1]))t=new g.Circle(h,"pointLine",s[1],s[0],d);else if(s[1].elementClass===v.OBJECT_CLASS_LINE&&c.isPoint(s[0]))t=new g.Circle(h,"pointLine",s[0],s[1],d);else{if(!(e.length===3&&c.isPoint(s[0])&&c.isPoint(s[1])&&c.isPoint(s[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]`);if(!g.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");t=g.elements.circumcircle(h,s,d)}for(t.isDraggable=!0,t.setParents(s),t.elType="circle",a=0;a<s.length;a++)c.isPoint(s[a])&&t.inherits.push(s[a]);return t},g.registerElement("circle",g.createCircle),{Circle:g.Circle,createCircle:g.createCircle}}),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element"],function(g,P,y,v,m,l,c){return g.Polygon=function(h,e,o){this.constructor(h,o,P.OBJECT_TYPE_POLYGON,P.OBJECT_CLASS_AREA);var t,s,a,d,u,n=l.copyAttributes(o,h.options,"polygon","borders");for(this.withLines=o.withlines,this.attr_line=n,this.vertices=[],t=0;t<e.length;t++)this.vertices[t]=this.board.select(e[t]);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(a=this.vertices.length-1,d=0;d<a;d++)t=(d+1)%a,n.id=n.ids&&n.ids[t],n.name=n.names&&n.names[t],n.strokecolor=l.isArray(n.colors)&&n.colors[t%n.colors.length]||n.strokecolor,n.visible=l.exists(o.borders.visible)?o.borders.visible:o.visible,n.strokecolor===!1&&(n.strokecolor="none"),(s=h.create("segment",[this.vertices[t],this.vertices[t+1]],n)).dump=!1,this.borders[t]=s,s.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),t=0;t<this.vertices.length-1;t++)u=this.board.select(this.vertices[t]),l.exists(u._is_new)?(this.addChild(u),delete u._is_new):u.addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=g.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},g.Polygon.prototype=new c,g.extend(g.Polygon.prototype,{pnpoly:function(h,e,o){var t,s,a,d,u,n,p=this.vertices,f=!1;for(o===P.COORDS_BY_USER?(d=(n=new y(P.COORDS_BY_USER,[h,e],this.board)).scrCoords[1],u=n.scrCoords[2]):(d=h,u=e),t=0,s=(a=this.vertices.length)-2;t<a-1;s=t++)p[t].coords.scrCoords[2]>u!=p[s].coords.scrCoords[2]>u&&d<(p[s].coords.scrCoords[1]-p[t].coords.scrCoords[1])*(u-p[t].coords.scrCoords[2])/(p[s].coords.scrCoords[2]-p[t].coords.scrCoords[2])+p[t].coords.scrCoords[1]&&(f=!f);return f},hasPoint:function(h,e){var o,t;if(l.evaluate(this.visProp.hasinnerpoints)&&this.pnpoly(h,e))return!0;for(t=this.borders.length,o=0;o<t;o++)if(this.borders[o].hasPoint(h,e))return!0;return!1},updateRenderer:function(){var h,e;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(e=this.vertices.length,this.isReal=!0,h=0;h<e;++h)if(!this.vertices[h].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var h,e,o,t,s;if(this.vertices.length===0)return new y(P.COORDS_BY_USER,[1,0,0],this.board);for(o=h=this.vertices[0].X(),t=e=this.vertices[0].Y(),s=0;s<this.vertices.length;s++)this.vertices[s].X()<h&&(h=this.vertices[s].X()),this.vertices[s].X()>o&&(o=this.vertices[s].X()),this.vertices[s].Y()>e&&(e=this.vertices[s].Y()),this.vertices[s].Y()<t&&(t=this.vertices[s].Y());return new y(P.COORDS_BY_USER,[.5*(h+o),.5*(e+t)],this.board)},getLabelAnchor:g.shortcut(g.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var h,e={};return e.id=this.id+"T"+this.numTraces,this.numTraces++,e.vertices=this.vertices,e.visProp=l.deepCopy(this.visProp,this.visProp.traceattributes,!0),e.visProp.layer=this.board.options.layer.trace,e.board=this.board,l.clearVisPropOld(e),e.visPropCalc={visible:l.evaluate(e.visProp.visible)},h=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(e),this.board.renderer.enhancedRendering=h,this.traces[e.id]=e.rendNode,this},hideElement:function(h){var e;if(g.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!h)for(e=0;e<this.borders.length;e++)this.borders[e].hideElement();this.hasLabel&&l.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(h){var e;if(g.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!h)for(e=0;e<this.borders.length;e++)this.borders[e].showElement().updateRenderer();return l.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(m.signedPolygon(this.vertices,!0))},Perimeter:function(){var h,e=this.vertices.length,o=0;for(h=1;h<e;++h)o+=this.vertices[h].Dist(this.vertices[h-1]);return o},boundingBox:function(){var h,e,o=[0,0,0,0],t=this.vertices.length-1;if(t===0)return o;for(o[0]=this.vertices[0].X(),o[2]=o[0],o[1]=this.vertices[0].Y(),o[3]=o[1],h=1;h<t;++h)(e=this.vertices[h].X())<o[0]?o[0]=e:e>o[2]&&(o[2]=e),(e=this.vertices[h].Y())>o[1]?o[1]=e:e<o[3]&&(o[3]=e);return o},bounds:function(){return this.boundingBox()},remove:function(){var h;for(h=0;h<this.borders.length;h++)this.board.removeObject(this.borders[h]);c.prototype.remove.call(this)},findPoint:function(h){var e;if(!l.isPoint(h))return-1;for(e=0;e<this.vertices.length;e++)if(this.vertices[e].id===h.id)return e;return-1},addPoints:function(h){var e=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(e))},insertPoints:function(h,e){var o,t;if(arguments.length===0)return this;if(h<-1||h>this.vertices.length-2)return this;for(t=arguments.length-1,o=1;o<t+1;o++)this.vertices.splice(h+o,0,l.providePoints(this.board,[arguments[o]],{},"polygon",["vertices"])[0]);if(h===-1&&(this.vertices[this.vertices.length-1]=this.vertices[0]),this.withLines)for(h<0?this.borders[this.borders.length-1].point2=this.vertices[this.vertices.length-1]:this.borders[h].point2=this.vertices[h+1],o=h+1;o<h+1+t;o++)this.borders.splice(o,0,this.board.create("segment",[this.vertices[o],this.vertices[o+1]],this.attr_line));return this.board.update(),this},removePoints:function(h){var e,o,t,s=[],a=[],d=[],u=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),e=0;e<arguments.length;e++)t=arguments[e],l.isPoint(t)&&(t=this.findPoint(t)),l.isNumber(t)&&t>-1&&t<this.vertices.length&&l.indexOf(d,t)===-1&&d.push(t);for(e=0;e<d.length;e++)this.vertices[d[e]].removeChild(this);for(d=d.sort(),s=this.vertices.slice(),a=this.borders.slice(),this.withLines&&u.push([d[d.length-1]]),e=d.length-1;e>-1;e--)s[d[e]]=-1,this.withLines&&d[e]-1>d[e-1]&&(u[u.length-1][1]=d[e],u.push([d[e-1]]));for(this.withLines&&(u[u.length-1][1]=d[0]),this.vertices=[],e=0;e<s.length;e++)l.isPoint(s[e])&&this.vertices.push(s[e]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(e=0;e<u.length;e++){for(o=u[e][1]-1;o<u[e][0]+1;o++)o<0?(o=0,this.board.removeObject(this.borders[a.length-1]),a[a.length-1]=-1):o>a.length-1&&(o=a.length-1),this.board.removeObject(this.borders[o]),a[o]=-1;u[e][1]!==0&&u[e][0]!==s.length-1&&(a[u[e][0]-1]=this.board.create("segment",[s[Math.max(u[e][1]-1,0)],s[Math.min(u[e][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],e=0;e<a.length;e++)a[e]!==-1&&this.borders.push(a[e]);u[0][1]!==this.vertices.length-1&&u[u.length-1][1]!==0||this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var h,e=c.prototype.getAttributes.call(this);if(this.withLines)for(e.lines=e.lines||{},e.lines.ids=[],e.lines.colors=[],h=0;h<this.borders.length;h++)e.lines.ids.push(this.borders[h].id),e.lines.colors.push(this.borders[h].visProp.strokecolor);return e},snapToGrid:function(){var h,e;for(e=!!l.evaluate(this.visProp.snaptogrid),h=0;h<this.vertices.length;h++)this.vertices[h].handleSnapToGrid(e,!0)},setPositionDirectly:function(h,e,o){var t,s,a,d=new y(h,e,this.board),u=new y(h,o,this.board);for(a=this.vertices.length-1,s=0;s<a;s++)if(!this.vertices[s].draggable())return this;return t=v.subtract(d.usrCoords,u.usrCoords),this.board.create("transform",t.slice(1),{type:"translate"}).applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(h){var e,o,t,s,a,d,u,n=g.Math.Geometry.sortVertices(this.vertices),p=g.Math.Geometry.sortVertices(h.vertices),f=n.length-1,b=p.length-1,C=[],_=function(E,x,S){return(x[1]-E[1])*(S[2]-E[2])-(x[2]-E[2])*(S[1]-E[1])>=0};for(t=0;t<b;t++)C.push(p[t]);for(t=0;t<f;t++)for(o=C.slice(0),C=[],a=o[(e=o.length)-1],s=0;s<e;s++)d=o[s],_(n[t],n[t+1],d)?(_(n[t],n[t+1],a)||((u=g.Math.Geometry.meetSegmentSegment(a,d,n[t],n[t+1]))[0][1]/=u[0][0],u[0][2]/=u[0][0],u[0][0]=1,C.push(u[0])),C.push(d)):_(n[t],n[t+1],a)&&((u=g.Math.Geometry.meetSegmentSegment(a,d,n[t],n[t+1]))[0][1]/=u[0][0],u[0][2]/=u[0][0],u[0][0]=1,C.push(u[0])),a=d;return C},intersect:function(h){return this.sutherlandHodgman(h)}}),g.createPolygon=function(h,e,o){var t,s,a,d,u,n,p=[],f=!1;if(l.copyAttributes(o,h.options,"polygon"),(d=h.select(e[0]))===null&&(d=e[0]),l.isObject(d)&&d.type===P.OBJECT_TYPE_POLYGON&&l.isTransformationOrArray(e[1]))for(f=!0,a=d.vertices.length-1,n=l.copyAttributes(o,h.options,"polygon","vertices"),s=0;s<a;s++)n.withlabel&&(n.name=d.vertices[s].name===""?"":d.vertices[s].name+"'"),p.push(h.create("point",[d.vertices[s],e[1]],n));else if((p=l.providePoints(h,e,o,"polygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create polygon / polygonalchain with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(u=l.copyAttributes(o,h.options,"polygon"),(t=new g.Polygon(h,p,u)).isDraggable=!0,f)for(t.prepareUpdate().update().updateVisibility().updateRenderer(),a=d.vertices.length-1,s=0;s<a;s++)p[s].prepareUpdate().update().updateVisibility().updateRenderer();return t},g.createRegularPolygon=function(h,e,o){var t,s,a,d,u,n,p,f=[];if(a=e[(u=e.length)-1],l.isNumber(a)&&(e.length!==3||a<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(l.isNumber(h.select(a))?(u--,n=!1):(a=u,n=!0),(f=l.providePoints(h,e.slice(0,u),o,"regularpolygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(p=l.copyAttributes(o,h.options,"regularpolygon","vertices"),s=2;s<a;s++)d=h.create("transform",[Math.PI*(2-(a-2)/a),f[s-1]],{type:"rotate"}),n?(f[s].addTransform(f[s-2],d),f[s].fullUpdate()):(l.isArray(p.ids)&&p.ids.length>=a-2&&(p.id=p.ids[s-2]),f[s]=h.create("point",[f[s-2],d],p),f[s].type=P.OBJECT_TYPE_CAS,f[s].isDraggable=!0,f[s].visProp.fixed=!1);return p=l.copyAttributes(o,h.options,"regularpolygon"),(t=h.create("polygon",f,p)).elType="regularpolygon",t},g.createPolygonalChain=function(h,e,o){var t,s;return t=l.copyAttributes(o,h.options,"polygonalchain"),(s=h.create("polygon",e,t)).elType="polygonalchain",s.vertices.pop(),h.removeObject(s.borders[s.borders.length-1]),s.borders.pop(),s},g.registerElement("polygon",g.createPolygon),g.registerElement("regularpolygon",g.createRegularPolygon),g.registerElement("polygonalchain",g.createPolygonalChain),{Polygon:g.Polygon,createPolygon:g.createPolygon,createRegularPolygon:g.createRegularPolygon}}),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/numerics","math/plot","math/geometry","parser/geonext","utils/type","math/qdt"],function(g,P,y,v,m,l,c,h,e,o,t){return g.Curve=function(s,a,d){this.constructor(s,d,P.OBJECT_TYPE_CURVE,P.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=o.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.ticks=[],this.qdt=null,o.exists(a[0])?this.varname=a[0]:this.varname="x",this.xterm=a[1],this.yterm=a[2],this.generateTerm(this.varname,this.xterm,this.yterm,a[3],a[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),o.isString(this.xterm)&&this.notifyParents(this.xterm),o.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=o.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},g.Curve.prototype=new v,g.extend(g.Curve.prototype,{minX:function(){return o.evaluate(this.visProp.curvetype)==="polar"?0:new y(P.COORDS_BY_SCREEN,[.1*-this.board.canvasWidth,0],this.board,!1).usrCoords[1]},maxX:function(){return o.evaluate(this.visProp.curvetype)==="polar"?2*Math.PI:new y(P.COORDS_BY_SCREEN,[1.1*this.board.canvasWidth,0],this.board,!1).usrCoords[1]},X:function(s){return NaN},Y:function(s){return NaN},Z:function(s){return 1},hasPoint:function(s,a,d){var u,n,p,f,b,C,_,E,x,S,O,w,T,M,N,A,R=[],L=o.evaluate(this.visProp.numberpointslow),D=(this.maxX()-this.minX())/L,k=1/0;if(o.isObject(o.evaluate(this.visProp.precision))?(w=this.board._inputDevice,O=o.evaluate(this.visProp.precision[w])):O=this.board.options.precision.hasPoint,s=(n=new y(P.COORDS_BY_SCREEN,[s,a],this.board,!1)).usrCoords[1],a=n.usrCoords[2],O+=.5*o.evaluate(this.visProp.strokewidth),O*=O,T=this.board.unitX*this.board.unitX,M=this.board.unitY*this.board.unitY,A=this.minX(),this.maxX(),o.exists(this._visibleArea)&&(A=this._visibleArea[0],D=(this._visibleArea[1]-A)/L),(N=o.evaluate(this.visProp.curvetype))==="parameter"||N==="polar")for(this.transformations.length>0&&(this.updateTransformMatrix(),f=m.inverse(this.transformMat),s=(b=m.matVecMult(f,[1,s,a]))[1],a=b[2]),C=0,u=A;C<L;C++){if((k=(s-(_=this.X(u,!0)))*(s-_)*T+(a-(E=this.Y(u,!0)))*(a-E)*M)<=O)return!0;u+=D}else if(N==="plot"||N==="functiongraph"){for((!o.exists(d)||d<0)&&(d=0),o.exists(this.qdt)&&o.evaluate(this.visProp.useqdt)&&this.bezierDegree!==3?p=(x=(S=this.qdt.query(new y(P.COORDS_BY_USER,[s,a],this.board))).points).length:(x=this.points,p=this.numberPoints-1),C=d;C<p;C++)if(this.bezierDegree===3?R.push(h.projectCoordsToBeziersegment([1,s,a],this,C)):S?(x[C].prev&&(R=h.projectCoordsToSegment([1,s,a],x[C].prev.usrCoords,x[C].usrCoords)),x[C].next&&x[C+1]!==x[C].next&&(R=h.projectCoordsToSegment([1,s,a],x[C].usrCoords,x[C].next.usrCoords))):R=h.projectCoordsToSegment([1,s,a],x[C].usrCoords,x[C+1].usrCoords),R[1]>=0&&R[1]<=1&&(s-R[0][1])*(s-R[0][1])*T+(a-R[0][2])*(a-R[0][2])*M<=O)return!0;return!1}return k<O},allocatePoints:function(){var s,a;if(a=this.numberPoints,this.points.length<this.numberPoints)for(s=this.points.length;s<a;s++)this.points[s]=new y(P.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(o.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=c.checkReal(this.points),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var s,a,d,u,n,p,f=this.visProp.plotversion,b=!1;if(this.updateTransformMatrix(),this.updateDataArray(),a=this.minX(),d=this.maxX(),o.exists(this.dataX))for(this.numberPoints=this.dataX.length,s=this.numberPoints,this.allocatePoints(),p=0;p<s;p++)u=p,o.exists(this.dataY)?(n=p,this.points[p].setCoordinates(P.COORDS_BY_USER,[this.dataX[p],this.dataY[p]],!1)):(n=this.X(u),this.points[p].setCoordinates(P.COORDS_BY_USER,[this.dataX[p],this.Y(n,b)],!1)),this.points[p]._t=p,b=!0;else if(o.evaluate(this.visProp.doadvancedplot)?f===1||o.evaluate(this.visProp.doadvancedplotold)?c.updateParametricCurveOld(this,a,d):f===2?c.updateParametricCurve_v2(this,a,d):f===3?c.updateParametricCurve_v3(this,a,d):f===4?c.updateParametricCurve_v4(this,a,d):c.updateParametricCurve_v2(this,a,d):(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.numberPoints=o.evaluate(this.visProp.numberpointshigh):this.numberPoints=o.evaluate(this.visProp.numberpointslow),this.allocatePoints(),c.updateParametricCurveNaive(this,a,d,this.numberPoints)),s=this.numberPoints,o.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new t(this.board.getBoundingBox()),p=0;p<this.points.length;p++)this.qdt.insert(this.points[p]),p>0&&(this.points[p].prev=this.points[p-1]),p<s-1&&(this.points[p].next=this.points[p+1]);for(o.evaluate(this.visProp.curvetype)!=="plot"&&o.evaluate(this.visProp.rdpsmoothing)&&(this.points=l.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),s=this.numberPoints,p=0;p<s;p++)this.updateTransform(this.points[p]);return this},updateTransformMatrix:function(){var s,a,d=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],a=0;a<d;a++)(s=this.transformations[a]).update(),this.transformMat=m.matMatMult(s.matrix,this.transformMat);return this},updateTransform:function(s){var a;return this.transformations.length>0&&(a=m.matVecMult(this.transformMat,s.usrCoords),s.setCoordinates(P.COORDS_BY_USER,a,!1,!0)),s},addTransform:function(s){var a,d=o.isArray(s)?s:[s],u=d.length;for(a=0;a<u;a++)this.transformations.push(d[a]);return this},interpolationFunctionFromArray:function(s){var a="data"+s,d=this;return function(u,n){var p,f,b,C,_=d[a],E=_.length,x=[];if(isNaN(u))return NaN;if(u<0)return o.isFunction(_[0])?_[0]():_[0];if(d.bezierDegree===3){if(u>=(E-1)/3)return o.isFunction(_[_.length-1])?_[_.length-1]():_[_.length-1];for(p=3*Math.floor(u),C=1-(b=u%1),f=0;f<4;f++)o.isFunction(_[p+f])?x[f]=_[p+f]():x[f]=_[p+f];return C*C*(C*x[0]+3*b*x[1])+(3*C*x[2]+b*x[3])*b*b}if((p=u>E-2?E-2:parseInt(Math.floor(u),10))===u)return o.isFunction(_[p])?_[p]():_[p];for(f=0;f<2;f++)o.isFunction(_[p+f])?x[f]=_[p+f]():x[f]=_[p+f];return x[0]+(x[1]-x[0])*(u-p)}},generateTerm:function(s,a,d,u,n){var p,f;o.isArray(a)?(this.dataX=a,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray.apply(this,["X"]),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=o.createFunction(a,this.board,s),o.isString(a)?this.visProp.curvetype="functiongraph":(o.isFunction(a)||o.isNumber(a))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),o.isArray(d)?(this.dataY=d,this.Y=this.interpolationFunctionFromArray.apply(this,["Y"])):this.Y=o.createFunction(d,this.board,s),o.isFunction(a)&&o.isArray(d)&&(p=o.createFunction(d[0],this.board,""),f=o.createFunction(d[1],this.board,""),this.X=function(b){return a(b)*Math.cos(b)+p()},this.Y=function(b){return a(b)*Math.sin(b)+f()},this.visProp.curvetype="polar"),o.exists(u)&&(this.minX=o.createFunction(u,this.board,"")),o.exists(n)&&(this.maxX=o.createFunction(n,this.board,""))},notifyParents:function(s){var a,d,u,n=!1;for(a in u={xterm:1,yterm:1})if(u.hasOwnProperty(a)&&this.hasOwnProperty(a)&&this[a].origin)for(d in n=!0,this[a].origin.deps)this[a].origin.deps.hasOwnProperty(d)&&this[a].origin.deps[d].addChild(this);n||e.findDependencies(this,s,this.board)},getLabelAnchor:function(){var s,a,d,u=.05*this.board.canvasWidth,n=.05*this.board.canvasHeight,p=.95*this.board.canvasWidth,f=.95*this.board.canvasHeight;switch(o.evaluate(this.visProp.label.position)){case"ulft":a=u,d=n;break;case"llft":a=u,d=f;break;case"rt":a=p,d=.5*f;break;case"lrt":a=p,d=f;break;case"urt":a=p,d=n;break;case"top":a=.5*p,d=n;break;case"bot":a=.5*p,d=f;break;default:a=u,d=.5*f}return s=new y(P.COORDS_BY_SCREEN,[a,d],this.board,!1),h.projectCoordsToCurve(s.usrCoords[1],s.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var s,a={id:this.id+"T"+this.numTraces,elementClass:P.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:o.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return a.visProp.layer=this.board.options.layer.trace,a.visProp.curvetype=this.visProp.curvetype,this.numTraces++,o.clearVisPropOld(a),a.visPropCalc={visible:o.evaluate(a.visProp.visible)},s=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(a),this.board.renderer.enhancedRendering=s,this.traces[a.id]=a.rendNode,this},bounds:function(){var s,a,d,u=1/0,n=-1/0,p=1/0,f=-1/0,b=this.points.length;if(this.bezierDegree===3){for(s=0;s<b;s++)this.points[s].X=o.bind(function(){return this.usrCoords[1]},this.points[s]),this.points[s].Y=o.bind(function(){return this.usrCoords[2]},this.points[s]);return d=(a=l.bezier(this.points))[3](),u=l.fminbr(function(C){return a[0](C)},[0,d]),n=l.fminbr(function(C){return-a[0](C)},[0,d]),p=l.fminbr(function(C){return a[1](C)},[0,d]),f=l.fminbr(function(C){return-a[1](C)},[0,d]),u=a[0](u),n=a[0](n),p=a[1](p),[u,f=a[1](f),n,p]}for(s=0;s<b;s++)u>this.points[s].usrCoords[1]&&(u=this.points[s].usrCoords[1]),n<this.points[s].usrCoords[1]&&(n=this.points[s].usrCoords[1]),p>this.points[s].usrCoords[2]&&(p=this.points[s].usrCoords[2]),f<this.points[s].usrCoords[2]&&(f=this.points[s].usrCoords[2]);return[u,f,n,p]},getParents:function(){var s=[this.xterm,this.yterm,this.minX(),this.maxX()];return this.parents.length!==0&&(s=this.parents),s},moveTo:function(s){var a,d=[];return this.points.length>0&&!o.evaluate(this.visProp.fixed)&&(a=this.points[0],d=s.length===3?[s[0]-a.usrCoords[0],s[1]-a.usrCoords[1],s[2]-a.usrCoords[2]]:[s[0]-a.usrCoords[1],s[1]-a.usrCoords[2]],this.setPosition(P.COORDS_BY_USER,d)),this},getTransformationSource:function(){var s,a;return o.exists(this._transformationSource)&&(a=this._transformationSource).elementClass===P.OBJECT_CLASS_CURVE&&(s=!0),[s,a]}}),g.createCurve=function(s,a,d){var u,n,p=o.copyAttributes(d,s.options,"curve");return u=s.select(a[0],!0),o.isObject(u)&&(u.type===P.OBJECT_TYPE_CURVE||u.type===P.OBJECT_TYPE_ANGLE||u.type===P.OBJECT_TYPE_ARC||u.type===P.OBJECT_TYPE_CONIC||u.type===P.OBJECT_TYPE_SECTOR)&&o.isTransformationOrArray(a[1])?(u.type===P.OBJECT_TYPE_SECTOR?p=o.copyAttributes(d,s.options,"sector"):u.type===P.OBJECT_TYPE_ARC?p=o.copyAttributes(d,s.options,"arc"):u.type===P.OBJECT_TYPE_ANGLE?(o.exists(d.withLabel)||(d.withLabel=!1),p=o.copyAttributes(d,s.options,"angle")):p=o.copyAttributes(d,s.options,"curve"),p=o.copyAttributes(p,s.options,"curve"),(n=new g.Curve(s,["x",[],[]],p)).updateDataArray=function(){var f,b=u.numberPoints;for(this.bezierDegree=u.bezierDegree,this.dataX=[],this.dataY=[],f=0;f<b;f++)this.dataX.push(u.points[f].usrCoords[1]),this.dataY.push(u.points[f].usrCoords[2]);return this},n.addTransform(a[1]),u.addChild(n),n.setParents([u]),n._transformationSource=u,n):(p=o.copyAttributes(d,s.options,"curve"),new g.Curve(s,["x"].concat(a),p))},g.registerElement("curve",g.createCurve),g.createFunctiongraph=function(s,a,d){var u,n=["x","x"].concat(a);return(u=o.copyAttributes(d,s.options,"curve")).curvetype="functiongraph",new g.Curve(s,n,u)},g.registerElement("functiongraph",g.createFunctiongraph),g.registerElement("plot",g.createFunctiongraph),g.createSpline=function(s,a,d){var u,n,p;return n=function(){var f,b=[],C=[];return[function(_,E){var x,S,O;if(!E){if(b=[],C=[],a.length===2&&o.isArray(a[0])&&o.isArray(a[1])&&a[0].length===a[1].length)for(x=0;x<a[0].length;x++)o.isFunction(a[0][x])?b.push(a[0][x]()):b.push(a[0][x]),o.isFunction(a[1][x])?C.push(a[1][x]()):C.push(a[1][x]);else for(x=0;x<a.length;x++)if(o.isPoint(a[x]))b.push(a[x].X()),C.push(a[x].Y());else if(o.isArray(a[x])&&a[x].length===2)for(S=0;S<a.length;S++)o.isFunction(a[S][0])?b.push(a[S][0]()):b.push(a[S][0]),o.isFunction(a[S][1])?C.push(a[S][1]()):C.push(a[S][1]);else o.isFunction(a[x])&&a[x]().length===2&&(O=a[x](),b.push(O[0]),C.push(O[1]));f=l.splineDef(b,C)}return l.splineEval(_,b,C,f)},function(){return b[0]},function(){return b[b.length-1]}]},(d=o.copyAttributes(d,s.options,"curve")).curvetype="functiongraph",p=n(),(u=new g.Curve(s,["x","x",p[0],p[1],p[2]],d)).setParents(a),u.elType="spline",u},g.registerElement("spline",g.createSpline),g.createCardinalSpline=function(s,a,d){var u,n,p,f,b,C,_,E,x,S,O=`
Possible parent types: [points:array, tau:number|function, type:string]`;if(!o.exists(a[0])||!o.isArray(a[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+O);if(!o.exists(a[1])||!o.isNumber(a[1])&&!o.isFunction(a[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+O);if(!o.exists(a[2])||!o.isString(a[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+O);if(d=o.copyAttributes(d,s.options,"curve"),(d=o.copyAttributes(d,s.options,"cardinalspline")).curvetype="parameter",C=a[0],_=[],!d.isarrayofcoordinates&&C.length===2&&o.isArray(C[0])&&o.isArray(C[1])&&C[0].length===C[1].length)for(E=0;E<C[0].length;E++)_[E]=[],o.isFunction(C[0][E])?_[E].push(C[0][E]()):_[E].push(C[0][E]),o.isFunction(C[1][E])?_[E].push(C[1][E]()):_[E].push(C[1][E]);else for(E=0;E<C.length;E++)o.isString(C[E])?_.push(s.select(C[E])):o.isPoint(C[E])?_.push(C[E]):o.isArray(C[E])&&C[E].length===2?(_[E]=[],o.isFunction(C[E][0])?_[E].push(C[E][0]()):_[E].push(C[E][0]),o.isFunction(C[E][1])?_[E].push(C[E][1]()):_[E].push(C[E][1])):o.isFunction(C[E])&&C[E]().length===2&&_.push(a[E]());if(d.createpoints===!0)p=o.providePoints(s,_,d,"cardinalspline",["points"]);else for(p=[],n=function(w){return{X:function(){return _[w][0]},Y:function(){return _[w][1]},Dist:function(T){var M=this.X()-T.X(),N=this.Y()-T.Y();return Math.sqrt(M*M+N*N)}}},E=0;E<_.length;E++)o.isPoint(_[E])?p.push(_[E]):p.push(n(E));for(f=a[1],b=a[2],S=["x"].concat(l.CardinalSpline(p,f,b)),u=new g.Curve(s,S,d),x=p.length,u.setParents(p),E=0;E<x;E++)C=p[E],o.isPoint(C)&&(o.exists(C._is_new)?(u.addChild(C),delete C._is_new):C.addChild(u));return u.elType="cardinalspline",u},g.registerElement("cardinalspline",g.createCardinalSpline),g.createMetapostSpline=function(s,a,d){var u,n,p,f,b,C,_,E,x=`
Possible parent types: [points:array, controls:object`;if(!o.exists(a[0])||!o.isArray(a[0]))throw new Error("JSXGraph: JXG.createMetapostSpline: argument 1 'points' has to be array of points or coordinate pairs"+x);if(!o.exists(a[1])||!o.isObject(a[1]))throw new Error("JSXGraph: JXG.createMetapostSpline: argument 2 'controls' has to be a JavaScript object'"+x);if(d=o.copyAttributes(d,s.options,"curve"),(d=o.copyAttributes(d,s.options,"metapostspline")).curvetype="parameter",b=a[0],C=[],!d.isarrayofcoordinates&&b.length===2&&o.isArray(b[0])&&o.isArray(b[1])&&b[0].length===b[1].length)for(_=0;_<b[0].length;_++)C[_]=[],o.isFunction(b[0][_])?C[_].push(b[0][_]()):C[_].push(b[0][_]),o.isFunction(b[1][_])?C[_].push(b[1][_]()):C[_].push(b[1][_]);else for(_=0;_<b.length;_++)o.isString(b[_])?C.push(s.select(b[_])):o.isPoint(b[_])?C.push(b[_]):o.isArray(b[_])&&b[_].length===2?(C[_]=[],o.isFunction(b[_][0])?C[_].push(b[_][0]()):C[_].push(b[_][0]),o.isFunction(b[_][1])?C[_].push(b[_][1]()):C[_].push(b[_][1])):o.isFunction(b[_])&&b[_]().length===2&&C.push(a[_]());if(d.createpoints===!0)p=o.providePoints(s,C,d,"metapostspline",["points"]);else for(p=[],n=function(S){return{X:function(){return C[S][0]},Y:function(){return C[S][1]}}},_=0;_<C.length;_++)o.isPoint(C[_])?p.push(C[_]):p.push(n);for(f=a[1],(u=new g.Curve(s,["t",[],[],0,b.length-1],d)).updateDataArray=function(){var S,O,w=p.length,T=[];for(O=0;O<w;O++)T.push([p[O].X(),p[O].Y()]);S=g.Math.Metapost.curve(T,f),this.dataX=S[0],this.dataY=S[1]},u.bezierDegree=3,E=p.length,u.setParents(p),_=0;_<E;_++)o.isPoint(p[_])&&p[_].addChild(u);return u.elType="metapostspline",u},g.registerElement("metapostspline",g.createMetapostSpline),g.createRiemannsum=function(s,a,d){var u,n,p,f,b,C;if((C=o.copyAttributes(d,s.options,"riemannsum")).curvetype="plot",p=a[0],u=o.createFunction(a[1],s,""),!o.exists(u))throw new Error(`JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);if(n=o.createFunction(a[2],s,"",!1),!o.exists(n))throw new Error(`JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);return f=[[0],[0]].concat(a.slice(3)),(b=s.create("curve",f,C)).sum=0,b.Value=function(){return this.sum},b.updateDataArray=function(){var _=l.riemann(p,u(),n(),this.minX(),this.maxX());this.dataX=_[0],this.dataY=_[1],this.sum=_[2]},b},g.registerElement("riemannsum",g.createRiemannsum),g.createTracecurve=function(s,a,d){var u,n,p,f;if(a.length!==2)throw new Error(`JSXGraph: Can't create trace curve with given parent'
Possible parent types: [glider, point]`);if(n=s.select(a[0]),p=s.select(a[1]),n.type!==P.OBJECT_TYPE_GLIDER||!o.isPoint(p))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof a[0]+"' and '"+typeof a[1]+`'.
Possible parent types: [glider, point]`);return(f=o.copyAttributes(d,s.options,"tracecurve")).curvetype="plot",(u=s.create("curve",[[0],[0]],f)).updateDataArray=function(){var b,C,_,E,x,S,O,w,T,M=f.numberpoints,N=n.position,A=n.slideObject,R=A.minX();for(C=(A.maxX()-R)/M,this.dataX=[],this.dataY=[],A.elementClass!==P.OBJECT_CLASS_CURVE&&M++,b=0;b<M;b++){for(E in _=R+b*C,S=A.X(_)/A.Z(_),O=A.Y(_)/A.Z(_),n.setPositionDirectly(P.COORDS_BY_USER,[S,O]),w=!1,this.board.objects)if(this.board.objects.hasOwnProperty(E)&&((x=this.board.objects[E])===n&&(w=!0),w&&x.needsRegularUpdate&&(T=x.visProp.trace,x.visProp.trace=!1,x.needsUpdate=!0,x.update(!0),x.visProp.trace=T,x===p)))break;this.dataX[b]=p.X(),this.dataY[b]=p.Y()}for(E in n.position=N,w=!1,this.board.objects)if(this.board.objects.hasOwnProperty(E)&&((x=this.board.objects[E])===n&&(w=!0),w&&x.needsRegularUpdate&&(T=x.visProp.trace,x.visProp.trace=!1,x.needsUpdate=!0,x.update(!0),x.visProp.trace=T,x===p)))break},u},g.registerElement("tracecurve",g.createTracecurve),g.createStepfunction=function(s,a,d){var u,n;if(a.length!==2)throw new Error(`JSXGraph: Can't create step function with given parent'
Possible parent types: [array, array|function]`);return n=o.copyAttributes(d,s.options,"stepfunction"),(u=s.create("curve",a,n)).updateDataArray=function(){var p,f=0,b=this.xterm.length;if(this.dataX=[],this.dataY=[],b!==0)for(this.dataX[f]=this.xterm[0],this.dataY[f]=this.yterm[0],++f,p=1;p<b;++p)this.dataX[f]=this.xterm[p],this.dataY[f]=this.dataY[f-1],++f,this.dataX[f]=this.xterm[p],this.dataY[f]=this.yterm[p],++f},u},g.registerElement("stepfunction",g.createStepfunction),g.createDerivative=function(s,a,d){var u,n,p,f,b;if(a.length!==1&&a[0].class!==P.OBJECT_CLASS_CURVE)throw new Error(`JSXGraph: Can't create derivative curve with given parent'
Possible parent types: [curve]`);return b=o.copyAttributes(d,s.options,"curve"),n=a[0],p=l.D(n.X),f=l.D(n.Y),(u=s.create("curve",[function(C){return n.X(C)},function(C){return f(C)/p(C)},n.minX(),n.maxX()],b)).setParents(n),u},g.registerElement("derivative",g.createDerivative),g.createCurveIntersection=function(s,a,d){var u;if(a.length!==2)throw new Error(`JSXGraph: Can't create curve intersection with given parent'
Possible parent types: [array, array|function]`);return(u=s.create("curve",[[],[]],d)).updateDataArray=function(){var n=g.Math.Clip.intersection(a[0],a[1],this.board);this.dataX=n[0],this.dataY=n[1]},u},g.createCurveUnion=function(s,a,d){var u;if(a.length!==2)throw new Error(`JSXGraph: Can't create curve union with given parent'
Possible parent types: [array, array|function]`);return(u=s.create("curve",[[],[]],d)).updateDataArray=function(){var n=g.Math.Clip.union(a[0],a[1],this.board);this.dataX=n[0],this.dataY=n[1]},u},g.createCurveDifference=function(s,a,d){var u;if(a.length!==2)throw new Error(`JSXGraph: Can't create curve difference with given parent'
Possible parent types: [array, array|function]`);return(u=s.create("curve",[[],[]],d)).updateDataArray=function(){var n=g.Math.Clip.difference(a[0],a[1],this.board);this.dataX=n[0],this.dataY=n[1]},u},g.registerElement("curvedifference",g.createCurveDifference),g.registerElement("curveintersection",g.createCurveIntersection),g.registerElement("curveunion",g.createCurveUnion),g.createBoxPlot=function(s,a,d){var u,n,p,f=o.copyAttributes(d,s.options,"boxplot");if(a.length!==3)throw new Error(`JSXGraph: Can't create box plot with given parent'
Possible parent types: [array, number|function, number|function] containing quantiles, axis, width`);if(a[0].length<5)throw new Error(`JSXGraph: Can't create box plot with given parent[0]'
parent[0] has to conatin at least 5 quantiles.`);for(u=s.create("curve",[[],[]],f),p=a[0].length,u.Q=[],n=0;n<p;n++)u.Q[n]=o.createFunction(a[0][n],s,null,!0);return u.x=o.createFunction(a[1],s,null,!0),u.w=o.createFunction(a[2],s,null,!0),u.updateDataArray=function(){var b,C,_,E,x,S,O,w,T;O=o.evaluate(this.visProp.smallwidth),w=o.evaluate(this.visProp.dir),_=(T=this.x())-.5*this.w(),E=T-.5*this.w()*O,x=T+.5*this.w(),b=[T,E,S=T+.5*this.w()*O,T,T,_,_,x,x,T,NaN,_,x,NaN,T,T,E,S,T],C=[this.Q[0](),this.Q[0](),this.Q[0](),this.Q[0](),this.Q[1](),this.Q[1](),this.Q[3](),this.Q[3](),this.Q[1](),this.Q[1](),NaN,this.Q[2](),this.Q[2](),NaN,this.Q[3](),this.Q[4](),this.Q[4](),this.Q[4](),this.Q[4]()],w==="vertical"?(this.dataX=b,this.dataY=C):(this.dataX=C,this.dataY=b)},u},g.registerElement("boxplot",g.createBoxPlot),{Curve:g.Curve,createCardinalSpline:g.createCardinalSpline,createCurve:g.createCurve,createCurveDifference:g.createCurveDifference,createCurveIntersection:g.createCurveIntersection,createCurveUnion:g.createCurveUnion,createDerivative:g.createDerivative,createFunctiongraph:g.createFunctiongraph,createMetapostSpline:g.createMetapostSpline,createPlot:g.createFunctiongraph,createSpline:g.createSpline,createRiemannsum:g.createRiemannsum,createStepfunction:g.createStepfunction,createTracecurve:g.createTracecurve}}),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants"],function(g,P,y,v,m,l,c){return g.createArc=function(h,e,o){var t,s,a;if((a=l.providePoints(h,e,o,"arc",["center","radiusPoint","anglePoint"]))===!1||a.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [arc, transformation]`);return s=l.copyAttributes(o,h.options,"arc"),(t=h.create("curve",[[0],[0]],s)).elType="arc",t.setParents(a),t.type=c.OBJECT_TYPE_ARC,t.center=a[0],t.radiuspoint=a[1],t.point2=t.radiuspoint,t.anglepoint=a[2],t.point3=t.anglepoint,l.exists(t.center._is_new)?(t.addChild(t.center),delete t.center._is_new):t.center.addChild(t),l.exists(t.radiuspoint._is_new)?(t.addChild(t.radiuspoint),delete t.radiuspoint._is_new):t.radiuspoint.addChild(t),l.exists(t.anglepoint._is_new)?(t.addChild(t.anglepoint),delete t.anglepoint._is_new):t.anglepoint.addChild(t),t.useDirection=s.usedirection,t.updateDataArray=function(){var d,u,n,p,f,b=1,C=this.radiuspoint,_=this.center,E=this.anglepoint,x=l.evaluate(this.visProp.selection);u=P.rad(C,_,E),(x==="minor"&&u>Math.PI||x==="major"&&u<Math.PI)&&(b=-1),this.useDirection&&(n=a[1].coords.usrCoords,p=a[3].coords.usrCoords,f=a[2].coords.usrCoords,(n[1]-f[1])*(n[2]-p[2])-(n[2]-f[2])*(n[1]-p[1])<0?(this.radiuspoint=a[1],this.anglepoint=a[2]):(this.radiuspoint=a[2],this.anglepoint=a[1])),C=C.coords.usrCoords,_=_.coords.usrCoords,E=E.coords.usrCoords,d=P.bezierArc(C,_,E,!1,b),this.dataX=d[0],this.dataY=d[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},t.Radius=function(){return this.radiuspoint.Dist(this.center)},t.getRadius=function(){return g.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},t.Value=function(){return this.Radius()*P.rad(this.radiuspoint,this.center,this.anglepoint)},t.hasPoint=function(d,u){var n,p,f,b,C,_,E,x=this.Radius();return l.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(d,u):(l.isObject(l.evaluate(this.visProp.precision))?(E=this.board._inputDevice,_=l.evaluate(this.visProp.precision[E])):_=this.board.options.precision.hasPoint,_/=Math.min(this.board.unitX,this.board.unitY),p=new v(c.COORDS_BY_SCREEN,[d,u],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),b=y.inverse(this.transformMat),C=y.matVecMult(b,p.usrCoords),p=new v(c.COORDS_BY_USER,C,this.board)),n=this.center.coords.distance(c.COORDS_BY_USER,p),(f=Math.abs(n-x)<_)&&(f=P.coordsOnArc(this,p)),f)},t.hasPointSector=function(d,u){var n=new v(c.COORDS_BY_SCREEN,[d,u],this.board),p=this.Radius(),f=this.center.coords.distance(c.COORDS_BY_USER,n)<p;return f&&(f=P.coordsOnArc(this,n)),f},t.getTextAnchor=function(){return this.center.coords},t.getLabelAnchor=function(){var d,u,n,p,f,b=P.rad(this.radiuspoint,this.center,this.anglepoint),C=10/this.board.unitX,_=10/this.board.unitY,E=this.point2.coords.usrCoords,x=this.center.coords.usrCoords,S=E[1]-x[1],O=E[2]-x[2],w=l.evaluate(this.visProp.selection),T=this.label?this.label.visProp:this.visProp.label;return(w==="minor"&&b>Math.PI||w==="major"&&b<Math.PI)&&(b=-(2*Math.PI-b)),n=(d=new v(c.COORDS_BY_USER,[x[1]+Math.cos(.5*b)*S-Math.sin(.5*b)*O,x[2]+Math.sin(.5*b)*S+Math.cos(.5*b)*O],this.board)).usrCoords[1]-x[1],p=d.usrCoords[2]-x[2],n=n*((f=Math.sqrt(n*n+p*p))+C)/f,p=p*(f+_)/f,u=[x[1]+n,x[2]+p],T.position=P.calcLabelQuadrant(P.rad([1,0],[0,0],u)),new v(c.COORDS_BY_USER,u,this.board)},t.updateQuadraticform=m.Circle.prototype.updateQuadraticform,t.updateStdform=m.Circle.prototype.updateStdform,t.methodMap=g.deepCopy(t.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),t.prepareUpdate().update(),t},g.registerElement("arc",g.createArc),g.createSemicircle=function(h,e,o){var t,s,a,d;if((d=l.providePoints(h,e,o,"point"))===!1||d.length!==2)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point]`);return a=l.copyAttributes(o,h.options,"semicircle","center"),(s=h.create("midpoint",d,a)).dump=!1,a=l.copyAttributes(o,h.options,"semicircle"),(t=h.create("arc",[s,d[1],d[0]],a)).elType="semicircle",t.setParents([d[0].id,d[1].id]),t.subs={midpoint:s},t.inherits.push(s),t.midpoint=t.center=s,t},g.registerElement("semicircle",g.createSemicircle),g.createCircumcircleArc=function(h,e,o){var t,s,a,d;if((d=l.providePoints(h,e,o,"point"))===!1||d.length!==3)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`);return a=l.copyAttributes(o,h.options,"circumcirclearc","center"),(s=h.create("circumcenter",d,a)).dump=!1,(a=l.copyAttributes(o,h.options,"circumcirclearc")).usedirection=!0,(t=h.create("arc",[s,d[0],d[2],d[1]],a)).elType="circumcirclearc",t.setParents([d[0].id,d[1].id,d[2].id]),t.subs={center:s},t.inherits.push(s),t.center=s,t},g.registerElement("circumcirclearc",g.createCircumcircleArc),g.createMinorArc=function(h,e,o){return o.selection="minor",g.createArc(h,e,o)},g.registerElement("minorarc",g.createMinorArc),g.createMajorArc=function(h,e,o){return o.selection="major",g.createArc(h,e,o)},g.registerElement("majorarc",g.createMajorArc),{createArc:g.createArc,createSemicircle:g.createSemicircle,createCircumcircleArc:g.createCircumcircleArc,createMinorArc:g.createMinorArc,createMajorArc:g.createMajorArc}}),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type"],function(g,P,y,v,m,l,c){return g.createSector=function(h,e,o){var t,s,a,d,u,n,p="invalid";if(e[0].elementClass===l.OBJECT_CLASS_LINE&&e[1].elementClass===l.OBJECT_CLASS_LINE&&(c.isArray(e[2])||c.isNumber(e[2]))&&(c.isArray(e[3])||c.isNumber(e[3]))&&(c.isNumber(e[4])||c.isFunction(e[4])||c.isString(e[4])))p="2lines";else{if((n=c.providePoints(h,e,o,"sector",["center","radiusPoint","anglePoint"]))===!1)throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");p="3points"}if(s=c.copyAttributes(o,h.options,"sector"),(t=h.create("curve",[[0],[0]],s)).type=l.OBJECT_TYPE_SECTOR,t.elType="sector",t.autoRadius=function(){var f=20/t.board.unitX,b=1/0,C=50/t.board.unitX;return c.isPoint(t.center)&&(b=.3333*t.center.Dist(t.point2)),Math.max(f,Math.min(b,C))},p==="2lines")t.Radius=function(){var f=c.evaluate(e[4]);return f==="auto"?this.autoRadius():f},t.line1=h.select(e[0]),t.line2=h.select(e[1]),t.line1.addChild(t),t.line2.addChild(t),t.setParents(e),t.point1={visProp:{}},t.point2={visProp:{}},t.point3={visProp:{}},d=P.meetLineLine(t.line1.stdform,t.line2.stdform,0,h),c.isArray(e[2])?(e[2].length===2&&(e[2]=[1].concat(e[2])),u=P.projectPointToLine({coords:{usrCoords:e[2]}},t.line1,h),u=v.subtract(u.usrCoords,d.usrCoords),t.direction1=y.innerProduct(u,[0,t.line1.stdform[2],-t.line1.stdform[1]],3)>=0?1:-1):t.direction1=e[2]>=0?1:-1,c.isArray(e[3])?(e[3].length===2&&(e[3]=[1].concat(e[3])),u=P.projectPointToLine({coords:{usrCoords:e[3]}},t.line2,h),u=v.subtract(u.usrCoords,d.usrCoords),t.direction2=y.innerProduct(u,[0,t.line2.stdform[2],-t.line2.stdform[1]],3)>=0?1:-1):t.direction2=e[3]>=0?1:-1,t.updateDataArray=function(){var f,b,C,_,E,x,S=[0,0,0];if(b=this.line1,C=this.line2,S=y.crossProduct(b.stdform,C.stdform),Math.abs(S[0])>y.eps*y.eps&&(S[1]/=S[0],S[2]/=S[0],S[0]/=S[0]),f=this.direction1*this.Radius(),_=v.add(S,[0,f*b.stdform[2],-f*b.stdform[1]]),f=this.direction2*this.Radius(),E=v.add(S,[0,f*C.stdform[2],-f*C.stdform[1]]),this.point2.coords=new m(l.COORDS_BY_USER,_,t.board),this.point1.coords=new m(l.COORDS_BY_USER,S,t.board),this.point3.coords=new m(l.COORDS_BY_USER,E,t.board),Math.abs(_[0])<y.eps||Math.abs(S[0])<y.eps||Math.abs(E[0])<y.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);x=P.bezierArc(_,S,E,!0,1),this.dataX=x[0],this.dataY=x[1],this.bezierDegree=3},t.methodMap=g.deepCopy(t.methodMap,{radius:"Radius",getRadius:"Radius",setRadius:"setRadius"});else if(p==="3points"){for(t.point1=n[0],t.point2=n[1],t.point3=n[2],a=0;a<3;a++)c.exists(n[a]._is_new)?(t.addChild(n[a]),delete n[a]._is_new):n[a].addChild(t);t.useDirection=o.usedirection,t.setParents(n),c.exists(n[3])&&(t.point4=n[3],t.point4.addChild(t)),t.methodMap=g.deepCopy(t.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"Radius",getRadius:"Radius",setRadius:"setRadius"}),t.updateDataArray=function(){var f,b,C,_,E,x=this.point2,S=this.point1,O=this.point3,w=1,T=c.evaluate(this.visProp.selection);if(!x.isReal||!S.isReal||!O.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);E=P.rad(x,S,O),(T==="minor"&&E>Math.PI||T==="major"&&E<Math.PI)&&(w=-1),this.useDirection&&c.exists(this.point4)&&(b=this.point2.coords.usrCoords,C=this.point4.coords.usrCoords,_=this.point3.coords.usrCoords,(b[1]-_[1])*(b[2]-C[2])-(b[2]-_[2])*(b[1]-C[1])>=0&&(O=this.point2,x=this.point3)),x=x.coords.usrCoords,S=S.coords.usrCoords,O=O.coords.usrCoords,f=P.bezierArc(x,S,O,!0,w),this.dataX=f[0],this.dataY=f[1],this.bezierDegree=3},t.Radius=function(){return this.point2.Dist(this.point1)},(s=c.copyAttributes(o,h.options,"sector","arc")).withLabel=!1,s.name+="_arc",t.arc=h.create("arc",[t.point1,t.point2,t.point3],s),t.addChild(t.arc)}return t.center=t.point1,t.radiuspoint=t.point2,t.anglepoint=t.point3,t.hasPointCurve=function(f,b){var C,_,E,x,S,O,w=new m(l.COORDS_BY_SCREEN,[f,b],this.board),T=this.Radius(),M=this.center.coords.distance(l.COORDS_BY_USER,w),N=c.evaluate(this.visProp.selection);return c.isObject(c.evaluate(this.visProp.precision))?(S=this.board._inputDevice,x=c.evaluate(this.visProp.precision[S])):x=this.board.options.precision.hasPoint,x/=Math.min(this.board.unitX,this.board.unitY),(O=Math.abs(M-T)<x)&&(C=P.rad(this.point2,this.center,w.usrCoords.slice(1)),_=0,E=P.rad(this.point2,this.center,this.point3),(N==="minor"&&E>Math.PI||N==="major"&&E<Math.PI)&&(_=E,E=2*Math.PI),(C<_||C>E)&&(O=!1)),O},t.hasPointSector=function(f,b){var C,_,E,x=new m(l.COORDS_BY_SCREEN,[f,b],this.board),S=this.Radius(),O=this.point1.coords.distance(l.COORDS_BY_USER,x)<S,w=c.evaluate(this.visProp.selection);return O&&(C=P.rad(this.radiuspoint,this.center,x.usrCoords.slice(1)),_=0,E=P.rad(this.radiuspoint,this.center,this.anglepoint),(w==="minor"&&E>Math.PI||w==="major"&&E<Math.PI)&&(_=E,E=2*Math.PI),(C<_||C>E)&&(O=!1)),O},t.hasPoint=function(f,b){return c.evaluate(this.visProp.highlightonsector)||c.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(f,b):this.hasPointCurve(f,b)},t.getTextAnchor=function(){return this.point1.coords},t.getLabelAnchor=function(){var f,b,C,_,E,x=P.rad(this.point2,this.point1,this.point3),S=13/this.board.unitX,O=13/this.board.unitY,w=this.point2.coords.usrCoords,T=this.point1.coords.usrCoords,M=w[1]-T[1],N=w[2]-T[2],A=c.evaluate(this.visProp.selection),R=this.label?this.label.visProp:this.visProp.label;return(A==="minor"&&x>Math.PI||A==="major"&&x<Math.PI)&&(x=-(2*Math.PI-x)),C=(f=new m(l.COORDS_BY_USER,[T[1]+Math.cos(.5*x)*M-Math.sin(.5*x)*N,T[2]+Math.sin(.5*x)*M+Math.cos(.5*x)*N],this.board)).usrCoords[1]-T[1],_=f.usrCoords[2]-T[2],C=C*((E=Math.sqrt(C*C+_*_))+S)/E,_=_*(E+O)/E,b=[T[1]+C,T[2]+_],R.position=P.calcLabelQuadrant(P.rad([1,0],[0,0],b)),new m(l.COORDS_BY_USER,b,this.board)},t.setRadius=function(f){t.Radius=function(){var b=c.evaluate(f);return b==="auto"?this.autoRadius():b}},t.getRadius=function(){return g.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},p==="3points"&&(t.setPositionDirectly=function(f,b,C){var _,E=new m(f,b,this.board),x=new m(f,C,this.board);return t.point1.draggable()&&t.point2.draggable()&&t.point3.draggable()?(_=v.subtract(E.usrCoords,x.usrCoords),this.board.create("transform",_.slice(1),{type:"translate"}).applyOnce([t.point1,t.point2,t.point3]),this):this}),t.prepareUpdate().update(),t},g.registerElement("sector",g.createSector),g.createCircumcircleSector=function(h,e,o){var t,s,a,d;if((d=c.providePoints(h,e,o,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");return(s=h.create("circumcenter",d.slice(0,3),a)).dump=!1,a=c.copyAttributes(o,h.options,"circumcirclesector"),(t=h.create("sector",[s,d[0],d[2],d[1]],a)).elType="circumcirclesector",t.setParents(d),t.center=s,t.subs={center:s},t},g.registerElement("circumcirclesector",g.createCircumcircleSector),g.createMinorSector=function(h,e,o){return o.selection="minor",g.createSector(h,e,o)},g.registerElement("minorsector",g.createMinorSector),g.createMajorSector=function(h,e,o){return o.selection="major",g.createSector(h,e,o)},g.registerElement("majorsector",g.createMajorSector),g.createAngle=function(h,e,o){var t,s,a,d,u,n,p="invalid";if(e[0].elementClass===l.OBJECT_CLASS_LINE&&e[1].elementClass===l.OBJECT_CLASS_LINE&&(c.isArray(e[2])||c.isNumber(e[2]))&&(c.isArray(e[3])||c.isNumber(e[3])))p="2lines";else{if((n=c.providePoints(h,e,o,"point"))===!1)throw new Error("JSXGraph: Can't create angle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");p="3points"}if(a=c.copyAttributes(o,h.options,"angle"),c.exists(a.name)&&a.name!==""||(a.name=h.generateName({type:l.OBJECT_TYPE_ANGLE})),s=c.exists(a.radius)?a.radius:0,p==="2lines"?(e.push(s),(t=h.create("sector",e,a)).updateDataArraySector=t.updateDataArray,t.setAngle=function(f){},t.free=function(f){}):((t=h.create("sector",[n[1],n[0],n[2]],a)).arc.visProp.priv=!0,t.point=t.point2=t.radiuspoint=n[0],t.pointsquare=t.point3=t.anglepoint=n[2],t.Radius=function(){var f=c.evaluate(s);return f==="auto"?t.autoRadius():f},t.updateDataArraySector=function(){var f,b,C=this.point2,_=this.point1,E=this.point3,x=this.Radius(),S=_.Dist(C),O=1,w=c.evaluate(this.visProp.selection);b=P.rad(C,_,E),(w==="minor"&&b>Math.PI||w==="major"&&b<Math.PI)&&(O=-1),C=C.coords.usrCoords,_=_.coords.usrCoords,E=E.coords.usrCoords,C=[1,_[1]+(C[1]-_[1])*x/S,_[2]+(C[2]-_[2])*x/S],E=[1,_[1]+(E[1]-_[1])*x/S,_[2]+(E[2]-_[2])*x/S],f=P.bezierArc(C,_,E,!0,O),this.dataX=f[0],this.dataY=f[1],this.bezierDegree=3},t.setAngle=function(f){var b,C,_,E=this.anglepoint,x=this.radiuspoint;return E.draggable()&&(b=this.board.create("transform",[f,this.center],{type:"rotate"}),E.addTransform(x,b),b.update(),E.moveTo(y.matVecMult(b.matrix,x.coords.usrCoords)),_=c.isFunction(f)?function(){return 2*Math.PI-f()}:function(){return 2*Math.PI-f},C=this.board.create("transform",[_,this.center],{type:"rotate"}),E.coords.on("update",function(){C.update(),x.moveTo(y.matVecMult(C.matrix,E.coords.usrCoords))}),E.setParents(x)),this},t.free=function(){var f=this.anglepoint;return f.transformations.length>0&&(f.transformations.pop(),f.isDraggable=!0,f.parents=[],f.coords.off("update")),this},t.setParents(n)),c.exists(t.visProp.text)&&t.label.setText(c.evaluate(t.visProp.text)),t.elType="angle",t.type=l.OBJECT_TYPE_ANGLE,t.subs={},t.updateDataArraySquare=function(){var f,b,C,_,E,x,S,O,w=this.Radius();p==="2lines"&&this.updateDataArraySector(),f=this.point2,b=this.point1,C=this.point3,f=f.coords.usrCoords,b=b.coords.usrCoords,C=C.coords.usrCoords,_=P.distance(f,b,3),E=P.distance(C,b,3),f=[1,b[1]+(f[1]-b[1])*w/_,b[2]+(f[2]-b[2])*w/_],C=[1,b[1]+(C[1]-b[1])*w/E,b[2]+(C[2]-b[2])*w/E],x=y.crossProduct(C,b),S=[-f[1]*x[1]-f[2]*x[2],f[0]*x[1],f[0]*x[2]],x=y.crossProduct(f,b),O=[-C[1]*x[1]-C[2]*x[2],C[0]*x[1],C[0]*x[2]],(x=y.crossProduct(S,O))[1]/=x[0],x[2]/=x[0],this.dataX=[b[1],f[1],x[1],C[1],b[1]],this.dataY=[b[2],f[2],x[2],C[2],b[2]],this.bezierDegree=1},t.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},t.updateDataArray=function(){var f=c.evaluate(this.visProp.type),b=P.trueAngle(this.point2,this.point1,this.point3),C=c.evaluate(this.visProp.selection);(C==="minor"&&b>180||C==="major"&&b<180)&&(b=360-b),Math.abs(b-90)<c.evaluate(this.visProp.orthosensitivity)+y.eps&&(f=c.evaluate(this.visProp.orthotype)),f==="none"?this.updateDataArrayNone():f==="square"?this.updateDataArraySquare():f==="sector"?this.updateDataArraySector():f==="sectordot"&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||f!=="sectordot"&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},d=c.copyAttributes(o,h.options,"angle","dot"),t.dot=h.create("point",[function(){var f,b,C,_,E,x,S,O,w;return c.exists(t.dot)&&!t.dot.visProp.visible?[0,0]:(f=t.point2.coords.usrCoords,b=t.point1.coords.usrCoords,C=t.Radius(),_=P.distance(f,b,3),E=P.rad(t.point2,t.point1,t.point3),((w=c.evaluate(t.visProp.selection))==="minor"&&E>Math.PI||w==="major"&&E<Math.PI)&&(E=-(2*Math.PI-E)),E*=.5,x=Math.cos(E),S=Math.sin(E),f=[1,b[1]+(f[1]-b[1])*C/_,b[2]+(f[2]-b[2])*C/_],O=[[1,0,0],[b[1]-.5*b[1]*x+.5*b[2]*S,.5*x,.5*-S],[b[2]-.5*b[1]*S-.5*b[2]*x,.5*S,.5*x]],y.matVecMult(O,f))}],d),t.dot.dump=!1,t.subs.dot=t.dot,p==="2lines")for(u=0;u<2;u++)h.select(e[u]).addChild(t.dot);else for(u=0;u<3;u++)h.select(n[u]).addChild(t.dot);return t.getLabelAnchor=function(){var f,b,C,_,E,x,S,O,w,T=12,M=c.evaluate(t.visProp.selection),N=this.label?this.label.visProp:this.visProp.label;return c.exists(this.label.visProp.fontSize)&&(T=c.evaluate(this.label.visProp.fontSize)),T/=this.board.unitX,b=t.point2.coords.usrCoords,C=t.point1.coords.usrCoords,_=t.Radius(),E=P.distance(b,C,3),x=P.rad(t.point2,t.point1,t.point3),(M==="minor"&&x>Math.PI||M==="major"&&x<Math.PI)&&(x=-(2*Math.PI-x)),x*=.5,S=Math.cos(x),O=Math.sin(x),b=[1,C[1]+(b[1]-C[1])*_/E,C[2]+(b[2]-C[2])*_/E],w=[[1,0,0],[C[1]-.5*C[1]*S+.5*C[2]*O,.5*S,.5*-O],[C[2]-.5*C[1]*O-.5*C[2]*S,.5*O,.5*S]],(f=y.matVecMult(w,b))[1]/=f[0],f[2]/=f[0],f[0]/=f[0],E=P.distance(f,C,3),f=[f[0],C[1]+(f[1]-C[1])*(_+T)/E,C[2]+(f[2]-C[2])*(_+T)/E],N.position=P.calcLabelQuadrant(P.rad([1,0],[0,0],f)),new m(l.COORDS_BY_USER,f,this.board)},t.Value=function(){return P.rad(this.point2,this.point1,this.point3)},t.methodMap=c.deepCopy(t.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),t},g.registerElement("angle",g.createAngle),g.createNonreflexAngle=function(h,e,o){var t;return o.selection="minor",(t=g.createAngle(h,e,o)).Value=function(){var s=P.rad(this.point2,this.point1,this.point3);return s<Math.PI?s:2*Math.PI-s},t},g.registerElement("nonreflexangle",g.createNonreflexAngle),g.createReflexAngle=function(h,e,o){var t;return o.selection="major",(t=g.createAngle(h,e,o)).Value=function(){var s=P.rad(this.point2,this.point1,this.point3);return s>=Math.PI?s:2*Math.PI-s},t},g.registerElement("reflexangle",g.createReflexAngle),{createSector:g.createSector,createCircumcircleSector:g.createCircumcircleSector,createMinorSector:g.createMinorSector,createMajorSector:g.createMajorSector,createAngle:g.createAngle,createReflexAngle:g.createReflexAngle,createNonreflexAngle:g.createNonreflexAngle}}),define("base/transformation",["jxg","base/constants","math/math","utils/type"],function(g,P,y,v){return g.Transformation=function(m,l,c){this.elementClass=P.OBJECT_CLASS_OTHER,this.type=P.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=m,this.isNumericMatrix=!1,this.setMatrix(m,l,c),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bindTo",melt:"melt"}},g.Transformation.prototype={},g.extend(g.Transformation.prototype,{update:function(){return this},setMatrix:function(m,l,c){var h;for(this.isNumericMatrix=!0,h=0;h<c.length;h++)if(typeof c[h]!="number"){this.isNumericMatrix=!1;break}if(l==="translate"){if(c.length!==2)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=v.createEvalFunction(m,c,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if(l==="scale"){if(c.length!==2)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=v.createEvalFunction(m,c,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if(l==="reflect")c.length<4&&(c[0]=m.select(c[0])),c.length===2&&(c[1]=m.select(c[1])),c.length===4&&(this.evalParam=v.createEvalFunction(m,c,4)),this.update=function(){var e,o,t,s,a,d,u,n;c.length===1?u=c[0].stdform:c.length===2?u=y.crossProduct(c[1].coords.usrCoords,c[0].coords.usrCoords):c.length===4&&(u=y.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),e=u[1],o=u[2],d=(n=[-(t=u[0])*e,-t*o,e*e+o*o])[2],s=n[0]/n[2],a=n[1]/n[2],e=-u[2],o=u[1],this.matrix[1][1]=(e*e-o*o)/d,this.matrix[1][2]=2*e*o/d,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=s*(1-this.matrix[1][1])-a*this.matrix[1][2],this.matrix[2][0]=a*(1-this.matrix[2][2])-s*this.matrix[2][1]};else if(l==="rotate")c.length===3?this.evalParam=v.createEvalFunction(m,c,3):c.length>0&&c.length<=2&&(this.evalParam=v.createEvalFunction(m,c,1),c.length!==2||v.isArray(c[1])||(c[1]=m.select(c[1]))),this.update=function(){var e,o,t=this.evalParam(0),s=Math.cos(t),a=Math.sin(t);this.matrix[1][1]=s,this.matrix[1][2]=-a,this.matrix[2][1]=a,this.matrix[2][2]=s,c.length>1&&(c.length===3?(e=this.evalParam(1),o=this.evalParam(2)):v.isArray(c[1])?(e=c[1][0],o=c[1][1]):(e=c[1].X(),o=c[1].Y()),this.matrix[1][0]=e*(1-s)+o*a,this.matrix[2][0]=o*(1-s)-e*a)};else if(l==="shear"){if(c.length!==2)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=v.createEvalFunction(m,c,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if(l==="generic"){if(c.length!==9)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=v.createEvalFunction(m,c,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(m,l){return this.update(),v.exists(l)?y.matVecMult(this.matrix,m.initialCoords.usrCoords):y.matVecMult(this.matrix,m.coords.usrCoords)},applyOnce:function(m){var l,c,h;for(v.isArray(m)||(m=[m]),c=m.length,h=0;h<c;h++)this.update(),l=y.matVecMult(this.matrix,m[h].coords.usrCoords),m[h].coords.setCoordinates(P.COORDS_BY_USER,l)},bindTo:function(m){var l,c;if(v.isArray(m))for(c=m.length,l=0;l<c;l++)m[l].transformations.push(this);else m.transformations.push(this)},setProperty:function(m){g.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(m){},melt:function(m){var l,c,h,e,o,t,s=[];for(c=m.matrix.length,h=this.matrix[0].length,l=0;l<c;l++)s[l]=[];for(this.update(),m.update(),l=0;l<c;l++)for(t=0;t<h;t++){for(o=0,e=0;e<c;e++)o+=m.matrix[l][e]*this.matrix[e][t];s[l][t]=o}return this.update=function(){var a=this.matrix.length,d=this.matrix[0].length;for(l=0;l<a;l++)for(t=0;t<d;t++)this.matrix[l][t]=s[l][t]},this},getParents:function(){var m=[[].concat.apply([],this.matrix)];return this.parents.length!==0&&(m=this.parents),m}}),g.createTransform=function(m,l,c){return new g.Transformation(m,c.type,l)},g.registerElement("transform",g.createTransform),{Transformation:g.Transformation,createTransform:g.createTransform}}),define("element/composition",["jxg","math/math","math/geometry","math/numerics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/polygon"],function(g,P,y,v,m,l,c,h,e,o,t,s,a,d){return g.createOrthogonalProjection=function(u,n,p){var f,b,C,_;if(n[0]=u.select(n[0]),n[1]=u.select(n[1]),l.isPointType(u,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)b=l.providePoints(u,[n[0]],p,"point")[0],f=n[1];else{if(!l.isPointType(u,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line]`);b=l.providePoints(u,[n[1]],p,"point")[0],f=n[0]}return _=l.copyAttributes(p,u.options,"orthogonalprojection"),C=u.create("point",[function(){return y.projectPointToLine(b,f,u)}],_),l.exists(b._is_new)?(C.addChild(b),delete b._is_new):b.addChild(C),f.addChild(C),C.elType="orthogonalprojection",C.setParents([b.id,C.id]),C.update(),C.generatePolynomial=function(){var E=f.point1.symbolic.x,x=f.point1.symbolic.y,S=f.point2.symbolic.x,O=f.point2.symbolic.y,w=b.symbolic.x,T=b.symbolic.y,M=C.symbolic.x,N=C.symbolic.y;return["("+x+")*("+M+")-("+x+")*("+S+")+("+N+")*("+S+")-("+E+")*("+N+")+("+E+")*("+O+")-("+M+")*("+O+")","("+T+")*("+x+")-("+T+")*("+O+")-("+N+")*("+x+")+("+N+")*("+O+")+("+w+")*("+E+")-("+w+")*("+S+")-("+M+")*("+E+")+("+M+")*("+S+")"]},C},g.createPerpendicular=function(u,n,p){var f,b,C,_;if(n[0]=u.select(n[0]),n[1]=u.select(n[1]),l.isPointType(u,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)b=n[1],f=l.providePoints(u,[n[0]],p,"point")[0];else{if(!l.isPointType(u,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [line,point]`);b=n[0],f=l.providePoints(u,[n[1]],p,"point")[0]}return _=l.copyAttributes(p,u.options,"perpendicular"),(C=e.createLine(u,[function(){return b.stdform[2]*f.X()-b.stdform[1]*f.Y()},function(){return-b.stdform[2]*f.Z()},function(){return b.stdform[1]*f.Z()}],_)).elType="perpendicular",C.setParents([b.id,f.id]),l.exists(f._is_new)?(C.addChild(f),delete f._is_new):f.addChild(C),b.addChild(C),C},g.createPerpendicularPoint=function(u,n,p){var f,b,C;if(n[0]=u.select(n[0]),n[1]=u.select(n[1]),l.isPointType(u,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)b=l.providePoints(u,[n[0]],p,"point")[0],f=n[1];else{if(!l.isPointType(u,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line]`);b=l.providePoints(u,[n[1]],p,"point")[0],f=n[0]}return C=u.create("point",[function(){return y.perpendicular(f,b,u)[0]}],p),l.exists(b._is_new)?(C.addChild(b),delete b._is_new):b.addChild(C),f.addChild(C),C.elType="perpendicularpoint",C.setParents([b.id,f.id]),C.update(),C.generatePolynomial=function(){var _=f.point1.symbolic.x,E=f.point1.symbolic.y,x=f.point2.symbolic.x,S=f.point2.symbolic.y,O=b.symbolic.x,w=b.symbolic.y,T=C.symbolic.x,M=C.symbolic.y;return["("+E+")*("+T+")-("+E+")*("+x+")+("+M+")*("+x+")-("+_+")*("+M+")+("+_+")*("+S+")-("+T+")*("+S+")","("+w+")*("+E+")-("+w+")*("+S+")-("+M+")*("+E+")+("+M+")*("+S+")+("+O+")*("+_+")-("+O+")*("+x+")-("+T+")*("+_+")+("+T+")*("+x+")"]},C},g.createPerpendicularSegment=function(u,n,p){var f,b,C,_,E;if(n[0]=u.select(n[0]),n[1]=u.select(n[1]),l.isPointType(u,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)b=n[1],f=l.providePoints(u,[n[0]],p,"point")[0];else{if(!l.isPointType(u,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [line,point]`);b=n[0],f=l.providePoints(u,[n[1]],p,"point")[0]}return E=l.copyAttributes(p,u.options,"perpendicularsegment","point"),(_=g.createPerpendicularPoint(u,[b,f],E)).dump=!1,l.exists(p.layer)||(p.layer=u.options.layer.line),E=l.copyAttributes(p,u.options,"perpendicularsegment"),(C=e.createLine(u,[function(){return y.perpendicular(b,f,u)[1]?[_,f]:[f,_]}],E)).point=_,l.exists(f._is_new)?(C.addChild(f),delete f._is_new):f.addChild(C),b.addChild(C),C.elType="perpendicularsegment",C.setParents([f.id,b.id]),C.subs={point:_},C.inherits.push(_),C},g.createMidpoint=function(u,n,p){var f,b,C,_,E;for(_=0;_<n.length;++_)n[_]=u.select(n[_]);if(n.length===2&&l.isPointType(u,n[0])&&l.isPointType(u,n[1]))n=l.providePoints(u,n,p,"point"),f=n[0],b=n[1];else{if(n.length!==1||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error(`JSXGraph: Can't create midpoint.
Possible parent types: [point,point], [line]`);f=n[0].point1,b=n[0].point2}return E=l.copyAttributes(p,u.options,"midpoint"),C=u.create("point",[function(){var x=f.coords.usrCoords[1]+b.coords.usrCoords[1];return isNaN(x)||Math.abs(f.coords.usrCoords[0])<P.eps||Math.abs(b.coords.usrCoords[0])<P.eps?NaN:.5*x},function(){var x=f.coords.usrCoords[2]+b.coords.usrCoords[2];return isNaN(x)||Math.abs(f.coords.usrCoords[0])<P.eps||Math.abs(b.coords.usrCoords[0])<P.eps?NaN:.5*x}],E),l.exists(f._is_new)?(C.addChild(f),delete f._is_new):f.addChild(C),l.exists(b._is_new)?(C.addChild(b),delete b._is_new):b.addChild(C),C.elType="midpoint",C.setParents([f.id,b.id]),C.prepareUpdate().update(),C.generatePolynomial=function(){var x=f.symbolic.x,S=f.symbolic.y,O=b.symbolic.x,w=b.symbolic.y,T=C.symbolic.x,M=C.symbolic.y;return["("+S+")*("+T+")-("+S+")*("+O+")+("+M+")*("+O+")-("+x+")*("+M+")+("+x+")*("+w+")-("+T+")*("+w+")","("+x+")^2 - 2*("+x+")*("+T+")+("+S+")^2-2*("+S+")*("+M+")-("+O+")^2+2*("+O+")*("+T+")-("+w+")^2+2*("+w+")*("+M+")"]},C},g.createParallelPoint=function(u,n,p){var f,b,C,_,E;for(E=0;E<n.length;++E)n[E]=u.select(n[E]);if(n.length===3&&l.isPointType(u,n[0])&&l.isPointType(u,n[1])&&l.isPointType(u,n[2]))n=l.providePoints(u,n,p,"point"),f=n[0],b=n[1],C=n[2];else if(l.isPointType(u,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)C=l.providePoints(u,[n[0]],p,"point")[0],f=n[1].point1,b=n[1].point2;else{if(!l.isPointType(u,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [line,point], [point,point,point]`);C=l.providePoints(u,[n[1]],p,"point")[0],f=n[0].point1,b=n[0].point2}return _=u.create("point",[function(){return C.coords.usrCoords[1]+b.coords.usrCoords[1]-f.coords.usrCoords[1]},function(){return C.coords.usrCoords[2]+b.coords.usrCoords[2]-f.coords.usrCoords[2]}],p),l.exists(f._is_new)?(_.addChild(f),delete f._is_new):f.addChild(_),l.exists(b._is_new)?(_.addChild(b),delete b._is_new):b.addChild(_),l.exists(C._is_new)?(_.addChild(C),delete C._is_new):C.addChild(_),_.elType="parallelpoint",_.setParents([f.id,b.id,C.id]),_.prepareUpdate().update(),_.generatePolynomial=function(){var x=f.symbolic.x,S=f.symbolic.y,O=b.symbolic.x,w=b.symbolic.y,T=C.symbolic.x,M=C.symbolic.y,N=_.symbolic.x,A=_.symbolic.y;return["("+w+")*("+N+")-("+w+")*("+T+")-("+S+")*("+N+")+("+S+")*("+T+")-("+A+")*("+O+")+("+A+")*("+x+")+("+M+")*("+O+")-("+M+")*("+x+")","("+A+")*("+x+")-("+A+")*("+T+")-("+w+")*("+x+")+("+w+")*("+T+")-("+N+")*("+S+")+("+N+")*("+M+")+("+O+")*("+S+")-("+O+")*("+M+")"]},_},g.createParallel=function(u,n,p){var f,b,C,_,E,x;for(E=0;E<n.length;++E)n[E]=u.select(n[E]);return f=null,n.length===3?(f=(n=l.providePoints(u,n,p,"point"))[2],_=function(){return P.crossProduct(n[0].coords.usrCoords,n[1].coords.usrCoords)}):l.isPointType(u,n[0])?(f=l.providePoints(u,[n[0]],p,"point")[0],_=function(){return n[1].stdform}):l.isPointType(u,n[1])&&(f=l.providePoints(u,[n[1]],p,"point")[0],_=function(){return n[0].stdform}),l.exists(p.layer)||(p.layer=u.options.layer.line),x=l.copyAttributes(p,u.options,"parallel","point"),(b=u.create("point",[function(){return P.crossProduct([1,0,0],_())}],x)).isDraggable=!0,x=l.copyAttributes(p,u.options,"parallel"),(C=u.create("line",[f,b],x)).elType="parallel",C.subs={point:b},C.inherits.push(b),C.setParents([n[0].id,n[1].id]),n.length===3&&C.addParents(n[2].id),C.point=b,C},g.createArrowParallel=function(u,n,p){var f;try{return p.firstArrow=!1,p.lastArrow=!0,(f=g.createParallel(u,n,p).setAttribute({straightFirst:!1,straightLast:!1})).elType="arrowparallel",f}catch{throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [line,point], [point,point,point]`)}},g.createNormal=function(u,n,p){var f,b,C,_,E,x,S,O,w;for(_=0;_<n.length;++_)n[_]=u.select(n[_]);if(n.length===1)f=n[0],b=f.slideObject;else{if(n.length!==2)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);if(l.isPointType(u,n[0]))f=l.providePoints(u,[n[0]],p,"point")[0],b=n[1];else{if(!l.isPointType(u,n[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);b=n[0],f=l.providePoints(u,[n[1]],p,"point")[0]}}if(S=l.copyAttributes(p,u.options,"normal"),b.elementClass===c.OBJECT_CLASS_LINE)w=l.copyAttributes(p,u.options,"normal","point"),O=u.create("point",[function(){var T=P.crossProduct([1,0,0],b.stdform);return[T[0],-T[2],T[1]]}],w),O.isDraggable=!0,(C=u.create("line",[f,O],S)).point=O,C.subs={point:O},C.inherits.push(O);else if(b.elementClass===c.OBJECT_CLASS_CIRCLE)C=u.create("line",[b.midpoint,f],S);else if(b.elementClass===c.OBJECT_CLASS_CURVE)l.evaluate(b.visProp.curvetype)!=="plot"?(E=b.X,x=b.Y,C=u.create("line",[function(){return-f.X()*v.D(E)(f.position)-f.Y()*v.D(x)(f.position)},function(){return v.D(E)(f.position)},function(){return v.D(x)(f.position)}],S)):C=u.create("line",[function(){var T,M,N,A,R,L,D,k,B,I,Y=Math.floor(f.position),q=f.position-Y;if(b.bezierdegree===1)Y===b.numberPoints-1&&(Y-=1,q=1);else{if(b.bezierDegree!==3)return 0;Y=3*Math.floor(f.position*(b.numberPoints-1)/3),N=(f.position*(b.numberPoints-1)-Y)/3,Y>=b.numberPoints-1&&(Y=b.numberPoints-4,N=1)}return Y<0?1:b.bezierDegree===1?(b.Y(Y)+q*(b.Y(Y+1)-b.Y(Y)))*(b.Y(Y)-b.Y(Y+1))-(b.X(Y)+q*(b.X(Y+1)-b.X(Y)))*(b.X(Y+1)-b.X(Y)):(A=b.points[Y].usrCoords,R=b.points[Y+1].usrCoords,L=b.points[Y+2].usrCoords,D=b.points[Y+3].usrCoords,k=(1-N)*(1-N)*(R[1]-A[1])+2*(1-N)*N*(L[1]-R[1])+N*N*(D[1]-L[1]),B=(1-N)*(1-N)*(R[2]-A[2])+2*(1-N)*N*(L[2]-R[2])+N*N*(D[2]-L[2]),k/=I=Math.sqrt(k*k+B*B),B/=I,M=[1,(T=f.coords.usrCoords)[1]-B,T[2]+k],T[2]*M[1]-T[1]*M[2])},function(){var T,M,N,A,R,L,D,k,B,I=Math.floor(f.position);if(b.bezierdegree===1)I===b.numberPoints-1&&(I-=1);else{if(b.bezierDegree!==3)return 0;I=3*Math.floor(f.position*(b.numberPoints-1)/3),M=(f.position*(b.numberPoints-1)-I)/3,I>=b.numberPoints-1&&(I=b.numberPoints-4,M=1)}return I<0?0:b.bezierDegree===1?b.X(I+1)-b.X(I):(N=b.points[I].usrCoords,A=b.points[I+1].usrCoords,R=b.points[I+2].usrCoords,L=b.points[I+3].usrCoords,D=(1-M)*(1-M)*(A[1]-N[1])+2*(1-M)*M*(R[1]-A[1])+M*M*(L[1]-R[1]),k=(1-M)*(1-M)*(A[2]-N[2])+2*(1-M)*M*(R[2]-A[2])+M*M*(L[2]-R[2]),D/=B=Math.sqrt(D*D+k*k),k/=B,[1,(T=f.coords.usrCoords)[1]-k,T[2]+D][2]-T[2])},function(){var T,M,N,A,R,L,D,k,B,I,Y=Math.floor(f.position);if(b.bezierdegree===1)Y===b.numberPoints-1&&(Y-=1);else{if(b.bezierDegree!==3)return 0;Y=3*Math.floor(f.position*(b.numberPoints-1)/3),N=(f.position*(b.numberPoints-1)-Y)/3,Y>=b.numberPoints-1&&(Y=b.numberPoints-4,N=1)}return Y<0?0:b.bezierDegree===1?b.Y(Y+1)-b.Y(Y):(A=b.points[Y].usrCoords,R=b.points[Y+1].usrCoords,L=b.points[Y+2].usrCoords,D=b.points[Y+3].usrCoords,k=(1-N)*(1-N)*(R[1]-A[1])+2*(1-N)*N*(L[1]-R[1])+N*N*(D[1]-L[1]),B=(1-N)*(1-N)*(R[2]-A[2])+2*(1-N)*N*(L[2]-R[2])+N*N*(D[2]-L[2]),k/=I=Math.sqrt(k*k+B*B),B/=I,M=[1,(T=f.coords.usrCoords)[1]-B,T[2]+k],T[1]-M[1])}],S);else{if(b.type!==c.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);C=u.create("line",[function(){var T,M,N=Math.floor(f.position),A=f.position-N;for(M=0;M<b.objects.length;M++)if((T=b.objects[M]).type===c.OBJECT_TYPE_CURVE){if(N<T.numberPoints)break;N-=T.numberPoints}return N===T.numberPoints-1&&(N-=1,A=1),N<0?1:(T.Y(N)+A*(T.Y(N+1)-T.Y(N)))*(T.Y(N)-T.Y(N+1))-(T.X(N)+A*(T.X(N+1)-T.X(N)))*(T.X(N+1)-T.X(N))},function(){var T,M,N=Math.floor(f.position);for(M=0;M<b.objects.length;M++)if((T=b.objects[M]).type===c.OBJECT_TYPE_CURVE){if(N<T.numberPoints)break;N-=T.numberPoints}return N===T.numberPoints-1&&(N-=1),N<0?0:T.X(N+1)-T.X(N)},function(){var T,M,N=Math.floor(f.position);for(M=0;M<b.objects.length;M++)if((T=b.objects[M]).type===c.OBJECT_TYPE_CURVE){if(N<T.numberPoints)break;N-=T.numberPoints}return N===T.numberPoints-1&&(N-=1),N<0?0:T.Y(N+1)-T.Y(N)}],S)}return C.elType="normal",C.setParents(n),l.exists(f._is_new)?(C.addChild(f),delete f._is_new):f.addChild(C),b.addChild(C),C},g.createBisector=function(u,n,p){var f,b,C,_;if(n=l.providePoints(u,n,p,"point"),l.isPoint(n[0])&&l.isPoint(n[1])&&l.isPoint(n[2])){for((_=l.copyAttributes(p,u.options,"bisector","point")).snapToGrid=!1,(f=u.create("point",[function(){return y.angleBisector(n[0],n[1],n[2],u)}],_)).dump=!1,C=0;C<3;C++)l.exists(n[C]._is_new)?(f.addChild(n[C]),delete n[C]._is_new):n[C].addChild(f);return l.exists(p.layer)||(p.layer=u.options.layer.line),_=l.copyAttributes(p,u.options,"bisector"),(b=e.createLine(u,[n[1],f],_)).point=f,b.elType="bisector",b.setParents(n),b.subs={point:f},b.inherits.push(f),b}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,point,point]`)},g.createAngularBisectorsOfTwoLines=function(u,n,p){var f,b,C,_,E=u.select(n[0]),x=u.select(n[1]);if(E.elementClass!==c.OBJECT_CLASS_LINE||x.elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [line,line]`);return l.exists(p.layer)||(p.layer=u.options.layer.line),C=l.copyAttributes(p,u.options,"bisectorlines","line1"),f=u.create("line",[function(){var S=Math.sqrt(E.stdform[1]*E.stdform[1]+E.stdform[2]*E.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return E.stdform[0]/S-x.stdform[0]/O},function(){var S=Math.sqrt(E.stdform[1]*E.stdform[1]+E.stdform[2]*E.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return E.stdform[1]/S-x.stdform[1]/O},function(){var S=Math.sqrt(E.stdform[1]*E.stdform[1]+E.stdform[2]*E.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return E.stdform[2]/S-x.stdform[2]/O}],C),l.exists(p.layer)||(p.layer=u.options.layer.line),C=l.copyAttributes(p,u.options,"bisectorlines","line2"),b=u.create("line",[function(){var S=Math.sqrt(E.stdform[1]*E.stdform[1]+E.stdform[2]*E.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return E.stdform[0]/S+x.stdform[0]/O},function(){var S=Math.sqrt(E.stdform[1]*E.stdform[1]+E.stdform[2]*E.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return E.stdform[1]/S+x.stdform[1]/O},function(){var S=Math.sqrt(E.stdform[1]*E.stdform[1]+E.stdform[2]*E.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return E.stdform[2]/S+x.stdform[2]/O}],C),_=new s({line1:f,line2:b}),f.dump=!1,b.dump=!1,_.elType="bisectorlines",_.setParents([E.id,x.id]),_.subs={line1:f,line2:b},_},g.createCircumcenter=function(u,n,p){var f,b,C,_,E;if(n=l.providePoints(u,n,p,"point"),l.isPoint(n[0])&&l.isPoint(n[1])&&l.isPoint(n[2])){for(C=n[0],_=n[1],E=n[2],f=h.createPoint(u,[function(){return y.circumcenter(C,_,E,u)}],p),b=0;b<3;b++)l.exists(n[b]._is_new)?(f.addChild(n[b]),delete n[b]._is_new):n[b].addChild(f);return f.elType="circumcenter",f.setParents(n),f.generatePolynomial=function(){var x=C.symbolic.x,S=C.symbolic.y,O=_.symbolic.x,w=_.symbolic.y,T=E.symbolic.x,M=E.symbolic.y,N=f.symbolic.x,A=f.symbolic.y;return[["((",N,")-(",x,"))^2+((",A,")-(",S,"))^2-((",N,")-(",O,"))^2-((",A,")-(",w,"))^2"].join(""),["((",N,")-(",x,"))^2+((",A,")-(",S,"))^2-((",N,")-(",T,"))^2-((",A,")-(",M,"))^2"].join("")]},f}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`)},g.createIncenter=function(u,n,p){var f,b,C,_,E;if(!((n=l.providePoints(u,n,p,"point")).length>=3&&l.isPoint(n[0])&&l.isPoint(n[1])&&l.isPoint(n[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`);for(b=n[0],C=n[1],_=n[2],f=u.create("point",[function(){var x,S,O;return x=Math.sqrt((C.X()-_.X())*(C.X()-_.X())+(C.Y()-_.Y())*(C.Y()-_.Y())),S=Math.sqrt((b.X()-_.X())*(b.X()-_.X())+(b.Y()-_.Y())*(b.Y()-_.Y())),O=Math.sqrt((C.X()-b.X())*(C.X()-b.X())+(C.Y()-b.Y())*(C.Y()-b.Y())),new m(c.COORDS_BY_USER,[(x*b.X()+S*C.X()+O*_.X())/(x+S+O),(x*b.Y()+S*C.Y()+O*_.Y())/(x+S+O)],u)}],p),E=0;E<3;E++)l.exists(n[E]._is_new)?(f.addChild(n[E]),delete n[E]._is_new):n[E].addChild(f);return f.elType="incenter",f.setParents(n),f},g.createCircumcircle=function(u,n,p){var f,b,C,_;if((n=l.providePoints(u,n,p,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`);try{for(C=l.copyAttributes(p,u.options,"circumcircle","center"),(f=g.createCircumcenter(u,n,C)).dump=!1,l.exists(p.layer)||(p.layer=u.options.layer.circle),C=l.copyAttributes(p,u.options,"circumcircle"),(b=o.createCircle(u,[f,n[0]],C)).elType="circumcircle",b.setParents(n),b.subs={center:f},b.inherits.push(b),_=0;_<3;_++)l.exists(n[_]._is_new)?(b.addChild(n[_]),delete n[_]._is_new):n[_].addChild(b)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`)}return b},g.createIncircle=function(u,n,p){var f,b,C,_;if((n=l.providePoints(u,n,p,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`);try{for(_=l.copyAttributes(p,u.options,"incircle","center"),(b=g.createIncenter(u,n,_)).dump=!1,l.exists(p.layer)||(p.layer=u.options.layer.circle),_=l.copyAttributes(p,u.options,"incircle"),(C=o.createCircle(u,[b,function(){var E=Math.sqrt((n[1].X()-n[2].X())*(n[1].X()-n[2].X())+(n[1].Y()-n[2].Y())*(n[1].Y()-n[2].Y())),x=Math.sqrt((n[0].X()-n[2].X())*(n[0].X()-n[2].X())+(n[0].Y()-n[2].Y())*(n[0].Y()-n[2].Y())),S=Math.sqrt((n[1].X()-n[0].X())*(n[1].X()-n[0].X())+(n[1].Y()-n[0].Y())*(n[1].Y()-n[0].Y())),O=(E+x+S)/2;return Math.sqrt((O-E)*(O-x)*(O-S)/O)}],_)).elType="incircle",C.setParents(n),f=0;f<3;f++)l.exists(n[f]._is_new)?(C.addChild(n[f]),delete n[f]._is_new):n[f].addChild(C);C.center=b,C.subs={center:C.center},C.inherits.push(b)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`)}return C},g.createReflection=function(u,n,p){var f,b,C,_,E,x,S,O,w=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, line]`;for(x=0;x<n.length;++x)n[x]=u.select(n[x]);if(S=l.copyAttributes(p,u.options,"reflection"),l.isPoint(n[0]))b=l.providePoints(u,[n[0]],O)[0];else{if(n[0].elementClass!==c.OBJECT_CLASS_CURVE&&n[0].elementClass!==c.OBJECT_CLASS_LINE&&n[0].type!==c.OBJECT_TYPE_POLYGON&&n[0].elementClass!==c.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);b=n[0]}if(n[1].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);if(f=n[1],E=t.createTransform(u,[f],{type:"reflect"}),l.isPoint(b))C=h.createPoint(u,[b,E],S);else if(b.elementClass===c.OBJECT_CLASS_CURVE)C=a.createCurve(u,[b,E],S);else if(b.elementClass===c.OBJECT_CLASS_LINE)C=e.createLine(u,[b,E],S);else if(b.type===c.OBJECT_TYPE_POLYGON)C=d.createPolygon(u,[b,E],S);else{if(b.elementClass!==c.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);S.type.toLowerCase()==="euclidean"?(O=l.copyAttributes(p,u.options,"reflection","center"),(_=h.createPoint(u,[b.center,E],O)).prepareUpdate().update().updateVisibility(l.evaluate(_.visProp.visible)).updateRenderer(),C=o.createCircle(u,[_,function(){return b.Radius()}],S)):C=o.createCircle(u,[b,E],S)}return l.exists(b._is_new)&&(C.addChild(b),delete b._is_new),f.addChild(C),C.elType="reflection",C.addParents(f),C.prepareUpdate().update(),l.isPoint(C)&&(C.generatePolynomial=function(){var T=f.point1.symbolic.x,M=f.point1.symbolic.y,N=f.point2.symbolic.x,A=f.point2.symbolic.y,R=b.symbolic.x,L=b.symbolic.y,D=C.symbolic.x,k=C.symbolic.y;return[["((",k,")-(",L,"))*((",M,")-(",A,"))+((",T,")-(",N,"))*((",D,")-(",R,"))"].join(""),["((",D,")-(",T,"))^2+((",k,")-(",M,"))^2-((",R,")-(",T,"))^2-((",L,")-(",M,"))^2"].join("")]}),C},g.createMirrorElement=function(u,n,p){var f,b,C,_,E,x,S,O,w=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, point]`;for(b=0;b<n.length;++b)n[b]=u.select(n[b]);if(S=l.copyAttributes(p,u.options,"mirrorelement"),l.isPoint(n[0]))f=l.providePoints(u,[n[0]],S)[0];else{if(n[0].elementClass!==c.OBJECT_CLASS_CURVE&&n[0].elementClass!==c.OBJECT_CLASS_LINE&&n[0].type!==c.OBJECT_TYPE_POLYGON&&n[0].elementClass!==c.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);f=n[0]}if(!l.isPoint(n[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);if(O=l.copyAttributes(p,u.options,"mirrorelement","point"),C=l.providePoints(u,[n[1]],O)[0],x=t.createTransform(u,[Math.PI,C],{type:"rotate"}),l.isPoint(f))_=h.createPoint(u,[f,x],S);else if(f.elementClass===c.OBJECT_CLASS_CURVE)_=a.createCurve(u,[f,x],S);else if(f.elementClass===c.OBJECT_CLASS_LINE)_=e.createLine(u,[f,x],S);else if(f.type===c.OBJECT_TYPE_POLYGON)_=d.createPolygon(u,[f,x],S);else{if(f.elementClass!==c.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);S.type.toLowerCase()==="euclidean"?(O=l.copyAttributes(p,u.options,"mirrorelement","center"),(E=h.createPoint(u,[f.center,x],O)).prepareUpdate().update().updateVisibility(l.evaluate(E.visProp.visible)).updateRenderer(),_=o.createCircle(u,[E,function(){return f.Radius()}],S)):_=o.createCircle(u,[f,x],S)}return l.exists(f._is_new)&&(_.addChild(f),delete f._is_new),C.addChild(_),_.elType="mirrorelement",_.addParents(C),_.prepareUpdate().update(),_},g.createMirrorPoint=function(u,n,p){var f=g.createMirrorElement(u,n,p);return f.elType="mirrorpoint",f},g.createIntegral=function(u,n,p){var f,b,C,_,E,x,S,O,w,T,M,N,A,R,L=null;if(l.isArray(n[0])&&n[1].elementClass===c.OBJECT_CLASS_CURVE)f=n[0],b=n[1];else{if(!l.isArray(n[1])||n[0].elementClass!==c.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [[number|function,number|function],curve]`);f=n[1],b=n[0]}return(C=l.copyAttributes(p,u.options,"integral")).withLabel=!1,R=u.create("curve",[[0],[0]],C),_=f[0],E=f[1],l.isFunction(_)?(S=function(){return b.Y(x())},_=(x=_)()):(x=_,S=b.Y(_)),l.isFunction(E)?(w=function(){return b.Y(O())},E=(O=E)()):(O=E,w=b.Y(E)),C=l.copyAttributes(p,u.options,"integral","curveLeft"),T=u.create("glider",[x,S,b],C),l.isFunction(x)&&T.hideElement(),C=l.copyAttributes(p,u.options,"integral","baseLeft"),M=u.create("point",[function(){return l.evaluate(R.visProp.axis)==="y"?0:T.X()},function(){return l.evaluate(R.visProp.axis)==="y"?T.Y():0}],C),C=l.copyAttributes(p,u.options,"integral","curveRight"),N=u.create("glider",[O,w,b],C),l.isFunction(O)&&N.hideElement(),C=l.copyAttributes(p,u.options,"integral","baseRight"),A=u.create("point",[function(){return l.evaluate(R.visProp.axis)==="y"?0:N.X()},function(){return l.evaluate(R.visProp.axis)==="y"?N.Y():0}],C),(C=l.copyAttributes(p,u.options,"integral")).withlabel!==!1&&C.axis!=="y"&&(C=l.copyAttributes(p,u.options,"integral","label"),C=l.copyAttributes(C,u.options,"label"),(L=u.create("text",[function(){var D=new m(c.COORDS_BY_SCREEN,[l.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),k=this.board.getBoundingBox(),B=.1*(k[2]-k[0]),I=N.X();return I<k[0]?I=k[0]+B:I>k[2]&&(I=k[2]-B),I+D.usrCoords[1]},function(){var D=new m(c.COORDS_BY_SCREEN,[0,l.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),k=this.board.getBoundingBox(),B=.1*(k[1]-k[3]),I=N.Y();return I>k[1]?I=k[1]-B:I<k[3]&&(I=k[3]+B),I+D.usrCoords[2]},function(){var D=v.NewtonCotes([M.X(),A.X()],b.Y);return"&int; = "+l.toFixed(D,4)}],C)).dump=!1,T.addChild(L),N.addChild(L)),T.dump=!1,M.dump=!1,N.dump=!1,A.dump=!1,R.elType="integral",R.setParents([b.id,f]),R.subs={curveLeft:T,baseLeft:M,curveRight:N,baseRight:A},R.inherits.push(T,M,N,A),C.withLabel&&(R.subs.label=L,R.inherits.push(L)),R.Value=function(){return v.I([M.X(),A.X()],b.Y)},R.updateDataArray=function(){var D,k,B,I,Y,q,V,W,X;if(l.evaluate(this.visProp.axis)==="y"){for(T.Y()<N.Y()?(q=T.X(),W=T.Y(),V=N.X(),X=N.Y()):(q=N.X(),W=N.Y(),V=T.X(),X=T.Y()),I=Math.min(q,V),Y=Math.max(q,V),D=[0,q],k=[W,W],B=0;B<b.numberPoints;B++)W<=b.points[B].usrCoords[2]&&I<=b.points[B].usrCoords[1]&&b.points[B].usrCoords[2]<=X&&b.points[B].usrCoords[1]<=Y&&(D.push(b.points[B].usrCoords[1]),k.push(b.points[B].usrCoords[2]));D.push(V),k.push(X),D.push(0),k.push(X),D.push(0),k.push(W)}else{for(M.X()<A.X()?(I=M.X(),Y=A.X()):(I=A.X(),Y=M.X()),D=[I,I],k=[0,b.Y(I)],B=0;B<b.numberPoints;B++)I<=b.points[B].usrCoords[1]&&b.points[B].usrCoords[1]<=Y&&(D.push(b.points[B].usrCoords[1]),k.push(b.points[B].usrCoords[2]));D.push(Y),k.push(b.Y(Y)),D.push(Y),k.push(0),D.push(I),k.push(0)}this.dataX=D,this.dataY=k},T.addChild(R),N.addChild(R),M.addChild(R),A.addChild(R),R.baseLeft=M,R.baseRight=A,R.curveLeft=T,R.curveRight=N,R.methodMap=g.deepCopy(R.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),R.label=L,R},g.createGrid=function(u,n,p){var f,b;return b=l.copyAttributes(p,u.options,"grid"),(f=u.create("curve",[[null],[null]],b)).elType="grid",f.type=c.OBJECT_TYPE_GRID,f.updateDataArray=function(){var C,_,E,x,S,O=l.evaluate(this.visProp.gridx),w=l.evaluate(this.visProp.gridy);for(x=l.isArray(this.visProp.topleft)?new m(l.evaluate(this.visProp.tltype)||c.COORDS_BY_USER,this.visProp.topleft,u):new m(c.COORDS_BY_SCREEN,[0,0],u),S=l.isArray(this.visProp.bottomright)?new m(l.evaluate(this.visProp.brtype)||c.COORDS_BY_USER,this.visProp.bottomright,u):new m(c.COORDS_BY_SCREEN,[u.canvasWidth,u.canvasHeight],u),u.options.grid.hasGrid=!0,f.dataX=[],f.dataY=[],C=Math.floor(x.usrCoords[2]/w)*w,_=Math.ceil(S.usrCoords[2]/w)*w,x.usrCoords[2]<S.usrCoords[2]&&(C=Math.ceil(S.usrCoords[2]/w)*w,_=Math.floor(x.usrCoords[2]/w)*w),E=C;E>_-w;E-=w)f.dataX.push(x.usrCoords[1],S.usrCoords[1],NaN),f.dataY.push(E,E,NaN);for(C=Math.ceil(x.usrCoords[1]/O)*O,_=Math.floor(S.usrCoords[1]/O)*O,x.usrCoords[1]>S.usrCoords[1]&&(C=Math.floor(S.usrCoords[1]/O)*O,_=Math.ceil(x.usrCoords[1]/O)*O),E=C;E<_+O;E+=O)f.dataX.push(E,E,NaN),f.dataY.push(x.usrCoords[2],S.usrCoords[2],NaN)},f.hasPoint=function(){return!1},u.grids.push(f),f},g.createInequality=function(u,n,p){var f,b,C;if(C=l.copyAttributes(p,u.options,"inequality"),n[0].elementClass===c.OBJECT_CLASS_LINE)(b=u.create("curve",[[],[]],C)).hasPoint=function(){return!1},b.updateDataArray=function(){var _,E,x,S=u.getBoundingBox(),O=C.inverse?-1:1,w=1.5*Math.max(S[2]-S[0],S[1]-S[3]),T={coords:{usrCoords:[1,(S[0]+S[2])/2,C.inverse?S[1]:S[3]]}},M=n[0].stdform.slice(1),N=M;x=1.5*Math.max(y.perpendicular(n[0],T,u)[0].distance(c.COORDS_BY_USER,T.coords),w),x*=O,T={coords:{usrCoords:[1,(S[0]+S[2])/2,(S[1]+S[3])/2]}},_=[1,(T=Math.abs(P.innerProduct(T.coords.usrCoords,n[0].stdform,3))>=P.eps?y.perpendicular(n[0],T,u)[0].usrCoords:T.coords.usrCoords)[1]+M[1]*w,T[2]-M[0]*w],E=[1,T[1]-N[1]*w,T[2]+N[0]*w],this.dataX=[_[1],_[1]+M[0]*x,E[1]+N[0]*x,E[1],_[1]],this.dataY=[_[2],_[2]+M[1]*x,E[2]+N[1]*x,E[2],_[2]]};else if(n[0].elementClass===c.OBJECT_CLASS_CURVE&&n[0].visProp.curvetype==="functiongraph")(b=u.create("curve",[[],[]],C)).updateDataArray=function(){var _,E,x,S,O,w,T,M,N,A=this.board.getBoundingBox(),R=[],L=n[0].minX(),D=n[0].maxX(),k=.3*(A[1]-A[3]);if(_=l.evaluate(this.visProp.inverse)?1:3,this.dataX=[],this.dataY=[],(S=n[0].points.length)!==0)for(A[1]+=k,A[3]-=k,x=-1;x<S-1;){for(O=x+1,E=S;O<S;O++)if(n[0].points[O].isReal()){E=O;break}if(E>=S)break;for(O=E,x=S-1;O<S-1;O++)if(!n[0].points[O+1].isReal()){x=O;break}for(M=n[0].points[E].usrCoords[1],N=n[0].points[x].usrCoords[1],w=A[0]<L?L:A[0],T=A[2]>D?D:A[2],w=E===0?w:Math.max(w,M),T=x===S-1?T:Math.min(T,N),T=x===S-1?D:N,(R=[]).push([1,w=E===0?L:M,A[_]]),R.push([1,w,n[0].points[E].usrCoords[2]]),O=E;O<=x;O++)R.push(n[0].points[O].usrCoords);for(R.push([1,T,n[0].points[x].usrCoords[2]]),R.push([1,T,A[_]]),R.push(R[0]),O=0;O<R.length;O++)this.dataX.push(R[O][1]),this.dataY.push(R[O][2]);x<S-1&&(this.dataX.push(NaN),this.dataY.push(NaN))}},b.hasPoint=function(){return!1};else if(f=l.createFunction(n[0]),!l.exists(f))throw new Error(`JSXGraph: Can't create area with the given parents.
Possible parent types: [line], [function]`);return b.addParents(n[0]),b},g.registerElement("arrowparallel",g.createArrowParallel),g.registerElement("bisector",g.createBisector),g.registerElement("bisectorlines",g.createAngularBisectorsOfTwoLines),g.registerElement("msector",g.createMsector),g.registerElement("circumcircle",g.createCircumcircle),g.registerElement("circumcirclemidpoint",g.createCircumcenter),g.registerElement("circumcenter",g.createCircumcenter),g.registerElement("incenter",g.createIncenter),g.registerElement("incircle",g.createIncircle),g.registerElement("integral",g.createIntegral),g.registerElement("midpoint",g.createMidpoint),g.registerElement("mirrorelement",g.createMirrorElement),g.registerElement("mirrorpoint",g.createMirrorPoint),g.registerElement("normal",g.createNormal),g.registerElement("orthogonalprojection",g.createOrthogonalProjection),g.registerElement("parallel",g.createParallel),g.registerElement("parallelpoint",g.createParallelPoint),g.registerElement("perpendicular",g.createPerpendicular),g.registerElement("perpendicularpoint",g.createPerpendicularPoint),g.registerElement("perpendicularsegment",g.createPerpendicularSegment),g.registerElement("reflection",g.createReflection),g.registerElement("grid",g.createGrid),g.registerElement("inequality",g.createInequality),{createArrowParallel:g.createArrowParallel,createBisector:g.createBisector,createAngularBisectorOfTwoLines:g.createAngularBisectorsOfTwoLines,createCircumcircle:g.createCircumcircle,createCircumcenter:g.createCircumcenter,createIncenter:g.createIncenter,createIncircle:g.createIncircle,createIntegral:g.createIntegral,createMidpoint:g.createMidpoint,createMirrorElement:g.createMirrorElement,createMirrorPoint:g.createMirrorPoint,createNormal:g.createNormal,createOrthogonalProjection:g.createOrthogonalProjection,createParallel:g.createParallel,createParallelPoint:g.createParallelPoint,createPerpendicular:g.createPerpendicular,createPerpendicularPoint:g.createPerpendicularPoint,createPerpendicularSegmen:g.createPerpendicularSegment,createReflection:g.createReflection,createGrid:g.createGrid,createInequality:g.createInequality}}),define("element/locus",["jxg","math/symbolic","utils/type"],function(g,P,y){return g.createLocus=function(v,m,l){var c,h;if(!y.isArray(m)||m.length!==1||!y.isPoint(m[0]))throw new Error(`JSXGraph: Can't create locus with parent of type other than point.
Possible parent types: [point]`);return h=m[0],(c=v.create("curve",[[null],[null]],l)).dontCallServer=!1,c.elType="locus",c.setParents([h.id]),c.updateDataArray=function(){var e,o,t;c.board.mode>0||(e=P.generatePolynomials(v,h,!0).join("|"))!==c.spe&&(c.spe=e,(o=function(s,a,d,u){var n;c.dataX=s,c.dataY=a,c.eq=d,c.ctime=u,c.generatePolynomial=(n=d,function(p){var f,b="("+p.symbolic.x+")",C="("+p.symbolic.y+")",_=[];for(f=0;f<n.length;f++)_[f]=n[f].replace(/\*\*/g,"^").replace(/x/g,b).replace(/y/g,C);return _})})((t=P.geometricLocusByGroebnerBase(v,h,o)).datax,t.datay,t.polynomial,t.exectime))},c},g.registerElement("locus",g.createLocus),{createLocus:g.createLocus}}),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","utils/type","base/coordselement"],function(g,P,y,v,m,l,c){return g.Image=function(h,e,o,t,s){this.constructor(h,o,P.OBJECT_TYPE_IMAGE,P.OBJECT_CLASS_OTHER),this.element=this.board.select(o.anchor),this.coordsConstructor(e),this.W=l.createFunction(s[0],this.board,""),this.H=l.createFunction(s[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*h.unitX),Math.abs(this.usrSize[1]*h.unitY)],this.url=t,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=g.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},g.Image.prototype=new v,l.copyPrototypeMethods(g.Image,c,"coordsConstructor"),g.extend(g.Image.prototype,{hasPoint:function(h,e){var o,t,s,a,d,u,n,p,f,b=this.transformations.length;return l.isObject(l.evaluate(this.visProp.precision))?(a=this.board._inputDevice,d=l.evaluate(this.visProp.precision[a])):d=this.board.options.precision.hasPoint,b===0?(o=h-this.coords.scrCoords[1],t=this.coords.scrCoords[2]-e,o>=-(s=d)&&o-this.size[0]<=s&&t>=-s&&t-this.size[1]<=s):(n=[(u=(u=new y(P.COORDS_BY_SCREEN,[h,e],this.board)).usrCoords)[0]-this.span[0][0],u[1]-this.span[0][1],u[2]-this.span[0][2]],0<=(p=(f=m.innerProduct)(n,this.span[1]))&&p<=f(this.span[1],this.span[1])&&0<=(p=f(n,this.span[2]))&&p<=f(this.span[2],this.span[2]))},update:function(h){return this.needsUpdate?(this.updateCoords(h),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var h,e,o=this.transformations.length,t=[];if(o===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(t[0]=[this.Z(),this.X(),this.Y()],t[1]=[this.Z(),this.X()+this.W(),this.Y()],t[2]=[this.Z(),this.X(),this.Y()+this.H()],h=0;h<o;h++)for(e=0;e<3;e++)t[e]=m.matVecMult(this.transformations[h].matrix,t[e]);for(e=0;e<3;e++)t[e][1]/=t[e][0],t[e][2]/=t[e][0],t[e][0]/=t[e][0];for(e=1;e<3;e++)t[e][0]-=t[0][0],t[e][1]-=t[0][1],t[e][2]-=t[0][2];this.span=t}return this},addTransform:function(h){var e;if(l.isArray(h))for(e=0;e<h.length;e++)this.transformations.push(h[e]);else this.transformations.push(h);return this},getParents:function(){var h=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(h=this.parents),h},setSize:function(h,e){return this.W=l.createFunction(h,this.board,""),this.H=l.createFunction(e,this.board,""),this},W:function(){},H:function(){}}),g.createImage=function(h,e,o){var t,s,a=e[0],d=e[1],u=e[2];if(t=l.copyAttributes(o,h.options,"image"),!(s=c.create(g.Image,h,d,t,a,u)))throw new Error("JSXGraph: Can't create image with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return t.rotate!==0&&s.addRotation(t.rotate),s},g.registerElement("image",g.createImage),{Image:g.Image,createImage:g.createImage}}),define("element/slider",["jxg","math/math","base/constants","base/coords","utils/type","base/point"],function(g,P,y,v,m,l){return g.createSlider=function(c,h,e){var o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O,w,T,M,N,A;return w=(A=m.copyAttributes(e,c.options,"slider")).withticks,O=A.withlabel,T=A.snapwidth,A=m.copyAttributes(e,c.options,"slider","point1"),n=c.create("point",h[0],A),A=m.copyAttributes(e,c.options,"slider","point2"),p=c.create("point",h[1],A),A=m.copyAttributes(e,c.options,"slider","baseline"),(f=c.create("segment",[n,p],A)).updateStdform(),o=n.coords.usrCoords.slice(1),t=p.coords.usrCoords.slice(1),s=h[2][0],a=h[2][1],d=h[2][2],u=d-s,N=(M=m.evaluate(T))===-1?a:Math.round(a/M)*M,C=o[0]+(t[0]-o[0])*(N-s)/(d-s),_=o[1]+(t[1]-o[1])*(N-s)/(d-s),(A=m.copyAttributes(e,c.options,"slider")).withLabel=!1,(E=c.create("glider",[C,_,f],A)).setAttribute({snapwidth:T}),A=m.copyAttributes(e,c.options,"slider","highline"),x=c.create("segment",[n,E],A),E.Value=function(){var R=this._smax-this._smin,L=m.evaluate(this.visProp.snapwidth);return L===-1?this.position*R+this._smin:Math.round((this.position*R+this._smin)/L)*L},E.methodMap=m.deepCopy(E.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),E._smax=d,E._smin=s,E.setMax=function(R){return this._smax=R,this},E.setValue=function(R){var L=this._smax-this._smin;return Math.abs(L)>P.eps?this.position=(R-this._smin)/L:this.position=0,this.position=Math.max(0,Math.min(1,this.position)),this},E.setMin=function(R){return this._smin=R,this},O&&(A=m.copyAttributes(e,c.options,"slider","label"),S=c.create("text",[function(){return .05*(p.X()-n.X())+p.X()},function(){return .05*(p.Y()-n.Y())+p.Y()},function(){var R,L=m.evaluate(E.visProp.digits),D=m.evaluate(E.visProp.suffixlabel),k=m.evaluate(E.visProp.unitlabel),B=m.evaluate(E.visProp.postlabel);return L===2&&m.evaluate(E.visProp.precision)!==2&&(L=m.evaluate(E.visProp.precision)),R=D!==null?D:E.name&&E.name!==""?E.name+" = ":"",R+=m.toFixed(E.Value(),L),k!==null&&(R+=k),B!==null&&(R+=B),R}],A),E.label=S,E.visProp.withlabel=!0,E.hasLabel=!0),E.point1=n,E.point2=p,E.baseline=f,E.highline=x,w&&(A=m.copyAttributes(e,c.options,"slider","ticks"),m.exists(A.generatelabeltext)||(A.generateLabelText=function(R,L,D){var k=E.point1.Dist(E.point2),B=E._smin,I=E._smax,Y=this.getDistanceFromZero(L,R)*(I-B)/k+B;return k<P.eps||Math.abs(Y)<P.eps?"0":this.formatLabelText(Y)}),b=c.create("ticks",[E.baseline,E.point1.Dist(n)/2,function(R){var L=E.point1.Dist(E.point2),D=E.point1.coords.distance(y.COORDS_BY_USER,R);return L<P.eps?0:D/L*u+s}],A),E.ticks=b),E.remove=function(){O&&c.removeObject(S),c.removeObject(x),c.removeObject(f),c.removeObject(p),c.removeObject(n),l.Point.prototype.remove.call(E)},n.dump=!1,p.dump=!1,f.dump=!1,x.dump=!1,O&&(S.dump=!1),E.elType="slider",E.parents=h,E.subs={point1:n,point2:p,baseLine:f,highLine:x},E.inherits.push(n,p,f,x),w&&(b.dump=!1,E.subs.ticks=b,E.inherits.push(b)),E.getParents=function(){return[this.point1.coords.usrCoords.slice(1),this.point2.coords.usrCoords.slice(1),[this._smin,this.position*(this._smax-this._smin)+this._smin,this._smax]]},E.baseline.on("up",function(R){var L,D;m.evaluate(E.visProp.moveonup)&&!m.evaluate(E.visProp.fixed)&&(L=f.board.getMousePosition(R,0),D=new v(y.COORDS_BY_SCREEN,L,this.board),E.moveTo([D.usrCoords[1],D.usrCoords[2]]))}),E.prepareUpdate().update(),c.isSuspendedUpdate||(E.updateVisibility().updateRenderer(),E.baseline.updateVisibility().updateRenderer(),E.highline.updateVisibility().updateRenderer(),w&&E.ticks.updateVisibility().updateRenderer()),E},g.registerElement("slider",g.createSlider),{createSlider:g.createSlider}}),define("element/measure",["jxg","utils/type","base/element"],function(g,P,y){return g.createTapemeasure=function(v,m,l){var c,h,e,o,t,s,a,d,u,n,p;return c=m[0],h=m[1],e=P.copyAttributes(l,v.options,"tapemeasure","point1"),d=v.create("point",c,e),e=P.copyAttributes(l,v.options,"tapemeasure","point2"),u=v.create("point",h,e),d.setAttribute({ignoredSnapToPoints:[u]}),u.setAttribute({ignoredSnapToPoints:[d]}),e=P.copyAttributes(l,v.options,"tapemeasure"),o=e.withticks,t=e.withlabel,(s=e.digits)===2&&e.precision!==2&&(s=e.precision),t&&(e.withlabel=!0),a=v.create("segment",[d,u],e),t&&(n=l.name&&l.name!==""?l.name+" = ":"",a.label.setText(function(){return n+P.toFixed(d.Dist(u),s)})),o&&(e=P.copyAttributes(l,v.options,"tapemeasure","ticks"),p=v.create("ticks",[a,.1],e),a.inherits.push(p)),a.remove=function(){o&&a.removeTicks(p),v.removeObject(u),v.removeObject(d),y.prototype.remove.call(this)},a.Value=function(){return d.Dist(u)},d.dump=!1,u.dump=!1,a.elType="tapemeasure",a.getParents=function(){return[[d.X(),d.Y()],[u.X(),u.Y()]]},a.subs={point1:d,point2:u},o&&(p.dump=!1),a.methodMap=g.deepCopy(a.methodMap,{Value:"Value"}),a.prepareUpdate().update(),v.isSuspendedUpdate||(a.updateVisibility().updateRenderer(),a.point1.updateVisibility().updateRenderer(),a.point2.updateVisibility().updateRenderer()),a},g.registerElement("tapemeasure",g.createTapemeasure),{createTapemeasure:g.createTapemeasure}}),define("parser/datasource",["jxg","utils/type"],function(g,P){return g.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},g.extend(g.DataSource.prototype,{loadFromArray:function(y,v,m){var l,c,h;if(P.isArray(v)&&(this.columnHeaders=v,v=!1),P.isArray(m)&&(this.rowHeaders=m,m=!1),this.data=[],v&&(this.columnHeaders=[]),m&&(this.rowHeaders=[]),P.exists(y)){for(this.data=[],l=0;l<y.length;l++)for(this.data[l]=[],c=0;c<y[l].length;c++)h=y[l][c],parseFloat(h).toString()===h?this.data[l][c]=parseFloat(h):this.data[l][c]=h!=="-"?h:NaN;if(v&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),m)for(this.rowHeaders=[],l=0;l<this.data.length;l++)this.rowHeaders.push(this.data[l][0]),this.data[l]=this.data[l].slice(1)}return this},loadFromTable:function(y,v,m){var l,c,h,e,o;if(P.isArray(v)&&(this.columnHeaders=v,v=!1),P.isArray(m)&&(this.rowHeaders=m,m=!1),this.data=[],v&&(this.columnHeaders=[]),m&&(this.rowHeaders=[]),y=document.getElementById(y),P.exists(y)){for(l=y.getElementsByTagName("tr"),this.data=[],c=0;c<l.length;c++)for(e=l[c].getElementsByTagName("td"),this.data[c]=[],h=0;h<e.length;h++)o=e[h].innerHTML,parseFloat(o).toString()===o?this.data[c][h]=parseFloat(o):this.data[c][h]=o!=="-"?o:NaN;if(v&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),m)for(this.rowHeaders=[],c=0;c<this.data.length;c++)this.rowHeaders.push(this.data[c][0]),this.data[c]=this.data[c].slice(1)}return this},addColumn:function(y,v,m){throw new Error("not implemented")},addRow:function(y,v,m){throw new Error("not implemented")},getColumn:function(y){var v,m=[];if(P.isString(y)){for(v=0;v<this.columnHeaders.length;v++)if(y===this.columnHeaders[v]){y=v;break}}for(v=0;v<this.data.length;v++)this.data[v].length>y&&(m[v]=parseFloat(this.data[v][y]));return m},getRow:function(y){var v,m;if(P.isString(y)){for(m=0;m<this.rowHeaders.length;m++)if(y===this.rowHeaders[m]){y=m;break}}for(v=[],m=0;m<this.data[y].length;m++)v[m]=this.data[y][m];return v}}),g.DataSource}),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],function(g,P,y,v,m,l,c,h,e,o,t,s,a,d,u,n,p,f){return g.Chart=function(b,C,_){var E,x,S,O,w,T;if(this.constructor(b,_),!e.isArray(C)||C.length===0)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],e.isNumber(C[0]))for(x=C,E=[],S=0;S<x.length;S++)E[S]=S+1;else if(C.length===1&&e.isArray(C[0]))for(x=C[0],E=[],T=e.evaluate(x).length,S=0;S<T;S++)E[S]=S+1;else C.length===2&&(T=Math.min(C[0].length,C[1].length),E=C[0].slice(0,T),x=C[1].slice(0,T));if(e.isArray(x)&&x.length===0)throw new Error("JSXGraph: Can't create charts without data.");for(w=_.chartstyle.replace(/ /g,"").split(","),S=0;S<w.length;S++){switch(w[S]){case"bar":O=this.drawBar(b,E,x,_);break;case"line":O=this.drawLine(b,E,x,_);break;case"fit":O=this.drawFit(b,E,x,_);break;case"spline":O=this.drawSpline(b,E,x,_);break;case"pie":O=this.drawPie(b,x,_);break;case"point":O=this.drawPoints(b,E,x,_);break;case"radar":O=this.drawRadar(b,C,_)}this.elements.push(O)}return this.id=this.board.setId(this,"Chart"),this.elements},g.Chart.prototype=new l,g.extend(g.Chart.prototype,{drawLine:function(b,C,_,E){return E.fillcolor="none",E.highlightfillcolor="none",b.create("curve",[C,_],E)},drawSpline:function(b,C,_,E){return E.fillColor="none",E.highlightfillcolor="none",b.create("spline",[C,_],E)},drawFit:function(b,C,_,E){var x=E.degree;return x=Math.max(parseInt(x,10),1)||1,E.fillcolor="none",E.highlightfillcolor="none",b.create("functiongraph",[P.regressionPolynomial(x,C,_)],E)},drawBar:function(b,C,_,E){var x,S,O,w,T,M,N,A,R,L,D=[],k=[],B=function(Y,q){return function(){return C[Y]()-q*O}},I={fixed:!0,withLabel:!1,visible:!1,name:""};if((R=e.copyAttributes(E,b.options,"chart"))&&R.width)O=R.width;else{if(C.length<=1)O=1;else for(O=C[1]-C[0],x=1;x<C.length-1;x++)O=C[x+1]-C[x]<O?C[x+1]-C[x]:O;O*=.8}for(L=e.copyAttributes(E,b.options,"chart","label"),x=0;x<C.length;x++)e.isFunction(C[x])?(w=B(x,-.5),T=B(x,0),M=B(x,.5)):(w=C[x]-.5*O,T=C[x],M=C[x]+.5*O),N=e.isFunction(_[x])?_[x]():_[x],N=_[x],R.dir==="horizontal"?(k[0]=b.create("point",[0,w],I),k[1]=b.create("point",[N,w],I),k[2]=b.create("point",[N,M],I),k[3]=b.create("point",[0,M],I),e.exists(R.labels)&&e.exists(R.labels[x])&&(L.anchorY="middle",(S=b.create("text",[N,T,R.labels[x]],L)).visProp.anchorx=function(Y){return function(){return Y.X()>=0?"left":"right"}}(S))):(k[0]=b.create("point",[w,0],I),k[1]=b.create("point",[w,N],I),k[2]=b.create("point",[M,N],I),k[3]=b.create("point",[M,0],I),e.exists(R.labels)&&e.exists(R.labels[x])&&(L.anchorX="middle",(S=b.create("text",[T,N,R.labels[x]],L)).visProp.anchory=function(Y){return function(){return Y.Y()>=0?"bottom":"top"}}(S))),e.isArray(R.colors)&&(A=R.colors,R.fillcolor=A[x%A.length]),D[x]=b.create("polygon",k,R),e.exists(R.labels)&&e.exists(R.labels[x])&&(D[x].text=S);return D},drawPoints:function(b,C,_,E){var x,S=[],O=E.infoboxarray;for(E.fixed=!0,E.name="",x=0;x<C.length;x++)E.infoboxtext=!!O&&O[x%O.length],S[x]=b.create("point",[C[x],_[x]],E);return S},drawPie:function(b,C,_){var E,x,S=[],O=[],w=(y.sum(C),_.colors),T=_.highlightcolors,M=_.labels,N=_.radius||4,A=N,R=_.center||[0,0],L=R[0],D=R[1],k=function(V,W,X){return function(){var Q,G,F,U=0;for(G=0;G<=V;G++)U+=parseFloat(e.evaluate(C[G]));for(Q=U,G=V+1;G<C.length;G++)Q+=parseFloat(e.evaluate(C[G]));return F=Q!==0?2*Math.PI*U/Q:0,A()*Math[W](F)+X}},B=function(V,W){var X=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],Q=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];e.exists(this.label)&&(this.label.rendNode.style.fontSize=W*e.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new m(v.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+X*V,this.point1.coords.usrCoords[2]+Q*V],this.board),this.fullUpdate()},I=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),B.call(this,1.1,2))},Y=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),B.call(this,.9090909,1))},q={fixed:!0,withLabel:!1,visible:!1,name:""};if(!e.isArray(M))for(M=[],E=0;E<C.length;E++)M[E]="";for(e.isFunction(N)||(A=function(){return N}),_.highlightonsector=_.highlightonsector||!1,_.straightfirst=!1,_.straightlast=!1,x=b.create("point",[L,D],q),S[0]=b.create("point",[function(){return A()+L},function(){return D}],q),E=0;E<C.length;E++)S[E+1]=b.create("point",[k(E,"cos",L),k(E,"sin",D)],q),_.name=M[E],_.withlabel=_.name!=="",_.fillcolor=w&&w[E%w.length],_.labelcolor=w&&w[E%w.length],_.highlightfillcolor=T&&T[E%T.length],O[E]=b.create("sector",[x,S[E],S[E+1]],_),_.highlightonsector&&(O[E].hasPoint=O[E].hasPointSector),_.highlightbysize&&(O[E].highlight=I,O[E].noHighlight=Y);return{sectors:O,points:S,midpoint:x}},drawRadar:function(b,C,_){var E,x,S,O,w,T,M,N,A,R,L,D,k,B,I,Y,q,V,W,X,Q,G,F,U,z,re,te,le,oe,he,H,ce,de,ne,ge,fe,ye,Ce,ue,Pe,Ee,ee,K=C.length,Ae=function(){var pe,$,ie,ae,se=e.evaluate(this.visProp.label.offset).slice(0);return pe=this.point1.X(),$=this.point2.X(),ie=this.point1.Y(),ae=this.point2.Y(),$<pe&&(se[0]=-se[0]),ae<ie&&(se[1]=-se[1]),this.setLabelRelativeCoords(se),new m(v.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},Oe=function(pe,$){var ie,ae,se;return ie=b.create("transform",[-(I[$]-k[$]),0],{type:"translate"}),ae=b.create("transform",[W/(Y[$]+B[$]-(I[$]-k[$])),1],{type:"scale"}),ie.melt(ae),se=b.create("transform",[pe],{type:"rotate"}),ie.melt(se),ie};if(K<=0)throw new Error("JSXGraph radar chart: no data");if(S=_.paramarray,!e.exists(S))throw new Error("JSXGraph radar chart: need paramArray attribute");if((O=S.length)<=1)throw new Error("JSXGraph radar chart: need more than one param in paramArray");for(E=0;E<K;E++)if(O!==C[E].length)throw new Error("JSXGraph radar chart: use data length equal to number of params ("+C[E].length+" != "+O+")");for(w=[],T=[],x=0;x<O;x++)w[x]=C[0][x],T[x]=w[x];for(E=1;E<K;E++)for(x=0;x<O;x++)C[E][x]>w[x]&&(w[x]=C[E][x]),C[E][x]<T[x]&&(T[x]=C[E][x]);for(M=[],N=[],E=0;E<K;E++)M[E]="",N[E]=[];for(A=[],R=[],L=_.startshiftratio||0,D=_.endshiftratio||0,E=0;E<O;E++)A[E]=(w[E]-T[E])*L,R[E]=(w[E]-T[E])*D;if(k=_.startshiftarray||A,B=_.endshiftarray||R,I=_.startarray||T,e.exists(_.start))for(E=0;E<O;E++)I[E]=_.start;if(Y=_.endarray||w,e.exists(_.end))for(E=0;E<O;E++)Y[E]=_.end;if(k.length!==O)throw new Error("JSXGraph radar chart: start shifts length is not equal to number of parameters");if(B.length!==O)throw new Error("JSXGraph radar chart: end shifts length is not equal to number of parameters");if(I.length!==O)throw new Error("JSXGraph radar chart: starts length is not equal to number of parameters");if(Y.length!==O)throw new Error("JSXGraph radar chart: snds length is not equal to number of parameters");for(q=_.labelarray||M,V=_.colors,_.highlightcolors,W=_.radius||10,Ee=_.strokewidth||1,e.exists(_.highlightonsector)||(_.highlightonsector=!1),X={name:_.name,id:_.id,strokewidth:Ee,polystrokewidth:_.polystrokewidth||Ee,strokecolor:_.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:_.fillColor||"#FFFF88",fillopacity:_.fillOpacity||.4,highlightfillcolor:_.highlightFillColor||"#FF7400",highlightstrokecolor:_.highlightStrokeColor||"black",gradient:_.gradient||"none"},G=(Q=_.center||[0,0])[0],F=Q[1],U=b.create("point",[G,F],{name:"",fixed:!0,withlabel:!1,visible:!1}),re=z=_.startangle||0,te=[],le=[],E=0;E<O;E++)for(re+=2*Math.PI/O,he=W*Math.cos(re)+G,H=W*Math.sin(re)+F,te[E]=b.create("point",[he,H],{name:"",fixed:!0,withlabel:!1,visible:!1}),le[E]=b.create("line",[U,te[E]],{name:S[E],strokeColor:X.strokecolor,strokeWidth:X.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:X.highlightstrokecolor}),le[E].getLabelAnchor=Ae,oe=Oe(re,E),x=0;x<C.length;x++)ee=C[x][E],N[x][E]=b.create("point",[ee,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),N[x][E].addTransform(N[x][E],oe);for(ce=[],E=0;E<K;E++)for(X.labelcolor=V&&V[E%V.length],X.strokecolor=V&&V[E%V.length],X.fillcolor=V&&V[E%V.length],ce[E]=b.create("polygon",N[E],{withLines:!0,withLabel:!1,fillColor:X.fillcolor,fillOpacity:X.fillopacity,highlightFillColor:X.highlightfillcolor}),x=0;x<O;x++)ce[E].borders[x].setAttribute("strokecolor:"+V[E%V.length]),ce[E].borders[x].setAttribute("strokewidth:"+X.polystrokewidth);switch(_.legendposition||"none"){case"right":ne=_.legendleftoffset||2,ge=_.legendtopoffset||1,this.legend=b.create("legend",[G+W+ne,F+W-ge],{labels:q,colors:V});break;case"none":break;default:g.debug("Unknown legend position")}if(de=[],_.showcircles){for(fe=[],E=0;E<6;E++)fe[E]=20*E;if(fe[0]="0",(Ce=(ye=_.circlelabelarray||fe).length)<2)throw new Error("JSXGraph radar chart: too less circles in circleLabelArray");for(ue=[],oe=Oe(z+Math.PI/O,0),X.fillcolor="none",X.highlightfillcolor="none",X.strokecolor=_.strokecolor||"black",X.strokewidth=_.circlestrokewidth||.5,X.layer=0,Pe=(Y[0]-I[0])/(Ce-1),E=0;E<Ce;E++)ue[E]=b.create("point",[I[0]+E*Pe,0],{name:ye[E],size:0,fixed:!0,withLabel:!0,visible:!0}),ue[E].addTransform(ue[E],oe),de[E]=b.create("circle",[U,ue[E]],X)}return this.rendNode=ce[0].rendNode,{circles:de,lines:le,points:N,midpoint:U,polygons:ce}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){return this}}),g.createChart=function(b,C,_){var E,x,S,O,w,T,M,N,A,R,L,D,k,B,I,Y,q=[],V=o.isBrowser?b.document.getElementById(C[0]):null;if(C.length===1&&e.isString(C[0])){if(e.exists(V)){if(A=e.copyAttributes(_,b.options,"chart"),E=(V=new c().loadFromTable(C[0],A.withheaders,A.withheaders)).data,w=V.columnHeaders,x=V.rowHeaders,R=A.width,L=A.name,D=A.strokecolor,k=A.fillcolor,B=A.highlightstrokecolor,I=A.highlightfillcolor,b.suspendUpdate(),Y=E.length,N=[],A.rows&&e.isArray(A.rows)){for(S=0;S<Y;S++)for(O=0;O<A.rows.length;O++)if(A.rows[O]===S||A.withheaders&&A.rows[O]===x[S]){N.push(E[S]);break}}else N=E;for(Y=N.length,S=0;S<Y;S++){if(M=[],A.chartstyle&&A.chartstyle.indexOf("bar")!==-1){for(T=R||.8,M.push(1-T/2+(S+.5)*T/Y),O=1;O<N[S].length;O++)M.push(M[O-1]+1);A.width=T/Y}L&&L.length===Y?A.name=L[S]:A.withheaders&&(A.name=w[S]),D&&D.length===Y?A.strokecolor=D[S]:A.strokecolor=h.hsv2rgb((S+1)/Y*360,.9,.6),k&&k.length===Y?A.fillcolor=k[S]:A.fillcolor=h.hsv2rgb((S+1)/Y*360,.9,1),B&&B.length===Y?A.highlightstrokecolor=B[S]:A.highlightstrokecolor=h.hsv2rgb((S+1)/Y*360,.9,1),I&&I.length===Y?A.highlightfillcolor=I[S]:A.highlightfillcolor=h.hsv2rgb((S+1)/Y*360,.9,.6),A.chartstyle&&A.chartstyle.indexOf("bar")!==-1?q.push(new g.Chart(b,[M,N[S]],A)):q.push(new g.Chart(b,[N[S]],A))}b.unsuspendUpdate()}return q}return A=e.copyAttributes(_,b.options,"chart"),new g.Chart(b,C,A)},g.registerElement("chart",g.createChart),g.Legend=function(b,C,_){var E;if(this.constructor(),E=e.copyAttributes(_,b.options,"legend"),this.board=b,this.coords=new m(v.COORDS_BY_USER,C,this.board),this.myAtts={},this.label_array=E.labelarray||E.labels,this.color_array=E.colorarray||E.colors,this.lines=[],this.myAtts.strokewidth=E.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=E.legendstyle||E.style,this.style!=="vertical")throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(b,E)},g.Legend.prototype=new l,g.Legend.prototype.drawVerticalLegend=function(b,C){var _,E=C.linelength||1,x=(C.rowheight||20)/this.board.unitY,S=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new m(v.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(_=0;_<this.label_array.length;_++)this.myAtts.name=this.label_array[_],this.myAtts.strokecolor=this.color_array[_%this.color_array.length],this.myAtts.highlightstrokecolor=this.color_array[_%this.color_array.length],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[_%this.color_array.length],strokeWidth:this.myAtts.strokewidth},this.lines[_]=b.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-_*x],[this.coords.usrCoords[1]+E,this.coords.usrCoords[2]-_*x]],this.myAtts),this.lines[_].getLabelAnchor=S,this.lines[_].prepareUpdate().update().updateVisibility(e.evaluate(this.lines[_].visProp.visible)).updateRenderer()},g.createLegend=function(b,C,_){var E=[0,0];if(!e.exists(C)||C.length!==2)throw new Error("JSXGraph: Legend element needs two numbers as parameters");return E=C,new g.Legend(b,E,_)},g.registerElement("legend",g.createLegend),{Chart:g.Chart,Legend:g.Legend,createChart:g.createChart,createLegend:g.createLegend}}),define("base/turtle",["jxg","base/constants","base/element","utils/type"],function(g,P,y,v){return g.Turtle=function(m,l,c){var h,e,o;return this.constructor(m,c,P.OBJECT_TYPE_TURTLE,P.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=m,this.visProp.curveType="plot",this._attributes=v.copyAttributes(this.visProp,m.options,"turtle"),delete this._attributes.id,h=0,e=0,o=90,l.length!==0&&(l.length===3?(h=l[0],e=l[1],o=l[2]):l.length===2?v.isArray(l[0])?(h=l[0][0],e=l[0][1],o=l[1]):(h=l[0],e=l[1]):(h=l[0][0],e=l[0][1])),this.init(h,e,o),this.methodMap=v.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},g.Turtle.prototype=new y,g.extend(g.Turtle.prototype,{init:function(m,l,c){var h={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[m,l],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,h),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],h),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-c),this.board.update()},forward:function(m){if(m===0)return this;var l,c=m*Math.cos(this.dir*Math.PI/180),h=m*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||((l=this.board.create("transform",[c,h],{type:"translate"})).applyOnce(this.turtle),l.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=c,this.pos[1]+=h,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(m){return this.forward(-m)},right:function(m){return this.dir-=m,this.dir%=360,this.turtleIsHidden||this.board.create("transform",[-m*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2),this.board.update(),this},left:function(m){return this.right(-m)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var m,l;for(m=0;m<this.objects.length;m++)(l=this.objects[m]).type===P.OBJECT_TYPE_CURVE&&(this.board.removeObject(l),this.objects.splice(m,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var m,l,c=this.objects.length;for(m=0;m<c;m++)l=this.objects[m],this.board.removeObject(l);return this.init(0,0,90),this},setPos:function(m,l){return v.isArray(m)?this.pos=m:this.pos=[m,l],this.turtleIsHidden||(this.turtle.setPositionDirectly(P.COORDS_BY_USER,[m,l]),this.turtle2.setPositionDirectly(P.COORDS_BY_USER,[m,l+this.arrowLen]),this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(m){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",m)),this.objects.push(this.curve),this},setPenColor:function(m){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",m)),this.objects.push(this.curve),this},setHighlightPenColor:function(m){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",m)),this.objects.push(this.curve),this},setAttribute:function(m){var l,c,h,e=this.objects.length;for(l=0;l<e;l++)(c=this.objects[l]).type===P.OBJECT_TYPE_CURVE&&c.setAttribute(m);return h=this.visProp.id,this.visProp=v.deepCopy(this.curve.visProp),this.visProp.id=h,this._attributes=v.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(m,l){return this._attributes[m.toLowerCase()]=l,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var m=this.stack.pop();return this.pos[0]=m[0],this.pos[1]=m[1],this.dir=m[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(m){var l,c,h,e,o;return v.isArray(m)?(l=this.pos[0],c=this.pos[1],h=m[0],e=m[1],o=Math.atan2(e-c,h-l),this.right(this.dir-180*o/Math.PI)):v.isNumber(m)&&this.right(this.dir-m),this},moveTo:function(m){var l,c,h;return v.isArray(m)&&(l=m[0]-this.pos[0],c=m[1]-this.pos[1],this.turtleIsHidden||((h=this.board.create("transform",[l,c],{type:"translate"})).applyOnce(this.turtle),h.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=m[0],this.pos[1]=m[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(m){return this.forward(m)},bk:function(m){return this.back(m)},lt:function(m){return this.left(m)},rt:function(m){return this.right(m)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(m,l){var c,h,e,o,t=this.objects.length;for(c=0,h=0;c<t;c++)if((e=this.objects[c]).elementClass===P.OBJECT_CLASS_CURVE){if(h<=m&&m<h+e.numberPoints)return o=m-h,e[l](o);h+=e.numberPoints}return this[l]()},X:function(m){return v.exists(m)?this.evalAt(m,"X"):this.pos[0]},Y:function(m){return v.exists(m)?this.evalAt(m,"Y"):this.pos[1]},Z:function(m){return 1},minX:function(){return 0},maxX:function(){var m,l=this.objects.length,c=0;for(m=0;m<l;m++)this.objects[m].elementClass===P.OBJECT_CLASS_CURVE&&(c+=this.objects[m].numberPoints);return c},hasPoint:function(m,l){var c,h;for(c=0;c<this.objects.length;c++)if((h=this.objects[c]).type===P.OBJECT_TYPE_CURVE&&h.hasPoint(m,l))return!0;return!1}}),g.createTurtle=function(m,l,c){var h;return l=l||[],h=v.copyAttributes(c,m.options,"turtle"),new g.Turtle(m,l,h)},g.registerElement("turtle",g.createTurtle),{Turtle:g.Turtle,createTurtle:g.createTurtle}}),define("base/ticks",["jxg","math/math","math/geometry","math/numerics","base/constants","base/element","base/coords","utils/type","base/text"],function(g,P,y,v,m,l,c,h,e){return g.Ticks=function(o,t,s){if(this.constructor(o.board,s,m.OBJECT_TYPE_TICKS,m.OBJECT_CLASS_OTHER),this.line=o,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],h.isFunction(t))throw this.ticksFunction=t,new Error("Function arguments are no longer supported.");h.isArray(t)?this.fixedTicks=t:((Math.abs(t)<P.eps||t<0)&&(t=s.defaultdistance),this.ticksFunction=this.makeTicksFunction(t),this.equidistant=!0),this.minTicksDistance=s.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},g.Ticks.prototype=new l,g.extend(g.Ticks.prototype,{makeTicksFunction:function(o){return function(){var t,s,a;return h.evaluate(this.visProp.insertticks)?((a=(s=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance")).upper-s.lower)<=6*(t=Math.pow(10,Math.floor(Math.log(.6*a)/Math.LN10)))&&(t*=.5),t):o}},hasPoint:function(o,t){var s,a,d,u,n=this.ticks&&this.ticks.length||0;if(h.isObject(h.evaluate(this.visProp.precision))?(u=this.board._inputDevice,d=h.evaluate(this.visProp.precision[u])):d=this.board.options.precision.hasPoint,d+=.5*h.evaluate(this.visProp.strokewidth),!h.evaluate(this.line.visProp.scalable)||this.line.elementClass===m.OBJECT_CLASS_CURVE||this.line.stdform[1]!==0&&this.line.stdform[2]!==0&&this.line.type!==m.OBJECT_TYPE_AXIS)return!1;for(s=0;s<n;s++)if((a=this.ticks[s])[2]&&!(this.line.stdform[1]===0&&Math.abs(a[0][0]-this.line.point1.coords.scrCoords[1])<P.eps||this.line.stdform[2]===0&&Math.abs(a[1][0]-this.line.point1.coords.scrCoords[2])<P.eps)&&(Math.abs(a[0][0]-a[0][1])>=1||Math.abs(a[1][0]-a[1][1])>=1)){if(this.line.stdform[1]===0){if(Math.abs(t-.5*(a[1][0]+a[1][1]))<2*d&&a[0][0]-d<o&&o<a[0][1]+d)return!0}else if(this.line.stdform[2]===0&&Math.abs(o-.5*(a[0][0]+a[0][1]))<2*d&&a[1][0]-d<t&&t<a[1][1]+d)return!0}return!1},setPositionDirectly:function(o,t,s){var a,d,u=new c(o,t,this.board),n=new c(o,s,this.board),p=this.board.getBoundingBox();return this.line.type===m.OBJECT_TYPE_AXIS&&h.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<P.eps&&Math.abs(u.usrCoords[1]*n.usrCoords[1])>P.eps?(a=n.usrCoords[1]/u.usrCoords[1],p[0]*=a,p[2]*=a,this.board.setBoundingBox(p,this.board.keepaspectratio,"update")):Math.abs(this.line.stdform[2])<P.eps&&Math.abs(u.usrCoords[2]*n.usrCoords[2])>P.eps&&(d=n.usrCoords[2]/u.usrCoords[2],p[3]*=d,p[1]*=d,this.board.setBoundingBox(p,this.board.keepaspectratio,"update")),this):this},calculateTicksCoordinates:function(){var o,t,s,a;if(!(this.line.elementClass===m.OBJECT_CLASS_LINE&&(this.setTicksSizeVariables(),Math.abs(this.dx)<P.eps&&Math.abs(this.dy)<P.eps)))return o=this.getZeroCoordinates(),t=this.line.elementClass===m.OBJECT_CLASS_LINE?this.getLowerAndUpperBounds(o):{lower:this.line.minX(),upper:this.line.maxX()},h.evaluate(this.visProp.type)==="polar"&&(a=this.board.getBoundingBox(),s=Math.max(Math.sqrt(a[0]*a[0]+a[1]*a[1]),Math.sqrt(a[2]*a[2]+a[3]*a[3])),t.upper=s),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(o,t):this.generateFixedTicks(o,t),this},setTicksSizeVariables:function(o){var t,s,a,d,u=.5*h.evaluate(this.visProp.majorheight),n=.5*h.evaluate(this.visProp.minorheight);h.exists(o)?(s=this.line.minX(),a=this.line.maxX(),(d=this.line.points.length)<2?(this.dxMaj=0,this.dyMaj=0):P.relDif(o,s)<P.eps?(this.dxMaj=this.line.points[0].usrCoords[2]-this.line.points[1].usrCoords[2],this.dyMaj=this.line.points[1].usrCoords[1]-this.line.points[0].usrCoords[1]):P.relDif(o,a)<P.eps?(this.dxMaj=this.line.points[d-2].usrCoords[2]-this.line.points[d-1].usrCoords[2],this.dyMaj=this.line.points[d-1].usrCoords[1]-this.line.points[d-2].usrCoords[1]):(this.dxMaj=-v.D(this.line.Y)(o),this.dyMaj=v.D(this.line.X)(o))):(this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2]),this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,t=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=u/t*this.board.unitX,this.dyMaj*=u/t*this.board.unitY,this.dxMin*=n/t*this.board.unitX,this.dyMin*=n/t*this.board.unitY,this.minStyle=h.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=h.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var o,t,s,a,d,u,n,p,f=h.evaluate(this.visProp.anchor);return this.line.elementClass===m.OBJECT_CLASS_LINE?this.line.type===m.OBJECT_TYPE_AXIS?y.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(s=this.line.point1.coords.usrCoords[0],o=this.line.point1.coords.usrCoords[1],t=this.line.point1.coords.usrCoords[2],u=this.line.point2.coords.usrCoords[0],a=this.line.point2.coords.usrCoords[1],d=this.line.point2.coords.usrCoords[2],f==="right"?this.line.point2.coords:f==="middle"?new c(m.COORDS_BY_USER,[.5*(s+u),.5*(o+a),.5*(t+d)],this.board):h.isNumber(f)?new c(m.COORDS_BY_USER,[s+(u-s)*f,o+(a-o)*f,t+(d-t)*f],this.board):this.line.point1.coords):(n=this.line.minX(),p=this.line.maxX(),f==="right"?p:f==="middle"?.5*(n+p):h.isNumber(f)?n*(1-f)+p*f:n)},getLowerAndUpperBounds:function(o,t){var s,a,d,u,n,p,f,b,C,_,E=h.evaluate(this.line.visProp.straightfirst),x=h.evaluate(this.line.visProp.straightlast),S=h.evaluate(this.visProp.includeboundaries);return this.line.elementClass===m.OBJECT_CLASS_CURVE?{lower:this.line.minX(),upper:this.line.maxX()}:(n=new c(m.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),p=new c(m.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),f=Math.abs(n.usrCoords[0])>=P.eps&&n.scrCoords[1]>=0&&n.scrCoords[1]<=this.board.canvasWidth&&n.scrCoords[2]>=0&&n.scrCoords[2]<=this.board.canvasHeight,b=Math.abs(p.usrCoords[0])>=P.eps&&p.scrCoords[1]>=0&&p.scrCoords[1]<=this.board.canvasWidth&&p.scrCoords[2]>=0&&p.scrCoords[2]<=this.board.canvasHeight,h.exists(t)||t==="tickdistance"?y.calcStraight(this.line,n,p,h.evaluate(this.line.visProp.margin)):y.calcLineDelimitingPoints(this.line,n,p),d=h.evaluate(this.line.visProp.firstarrow),u=h.evaluate(this.line.visProp.lastarrow),(d||u)&&(this.board.renderer.getPositionArrowHead(this.line,n,p,h.evaluate(this.line.visProp.strokewidth)),d&&n.setCoordinates(m.COORDS_BY_SCREEN,[n.scrCoords[1],n.scrCoords[2]]),u&&p.setCoordinates(m.COORDS_BY_SCREEN,[p.scrCoords[1],p.scrCoords[2]])),(C=this.getDistanceFromZero(o,n))<(_=this.getDistanceFromZero(o,p))?(s=C,E||!f||S||(s+=P.eps),a=_,x||!b||S||(a-=P.eps)):_<C?(s=_,x||!b||S||(s+=P.eps),a=C,E||!f||S||(a-=P.eps)):(s=0,a=0),{lower:s,upper:a})},getDistanceFromZero:function(o,t){var s,a,d,u,n;return s=this.line.point1.coords,a=this.line.point2.coords,n=o.distance(m.COORDS_BY_USER,t),d=[a.usrCoords[0]-s.usrCoords[0],a.usrCoords[1]-s.usrCoords[1],a.usrCoords[2]-s.usrCoords[2]],u=[t.usrCoords[0]-o.usrCoords[0],t.usrCoords[1]-o.usrCoords[1],t.usrCoords[2]-o.usrCoords[2]],P.innerProduct(d,u,3)<0&&(n*=-1),n},generateEquidistantTicks:function(o,t){var s,a,d=P.eps,u=this.equidistant?this.ticksFunction(1):this.ticksDelta,n=h.evaluate(this.visProp.insertticks),p=h.evaluate(this.visProp.minorticks);if(this.line.elementClass===m.OBJECT_CLASS_LINE&&(a=this.getXandYdeltas()),u*=h.evaluate(this.visProp.scale),n&&this.minTicksDistance>P.eps?(u=this.adjustTickDistance(u,o,a),u/=p+1):n||(u/=p+1),this.ticksDelta=u,!(u<P.eps)){for(s=0,h.evaluate(this.visProp.drawzero)||(s=u);s<=t.upper+d&&(s>=t.lower-d&&this.processTickPosition(o,s,u,a),s+=u,!(t.upper-s>1e4*u)););for(s=-u;s>=t.lower-d&&(s<=t.upper+d&&this.processTickPosition(o,s,u,a),!((s-=u)-t.lower>1e4*u)););}},adjustTickDistance:function(o,t,s){var a,d,u,n=1,p=h.evaluate(this.visProp.minorticks);if(this.line.elementClass===m.OBJECT_CLASS_CURVE)return o;if(this.getLowerAndUpperBounds(t,"ticksdistance"),a=t.usrCoords[1]+s.x*o,d=t.usrCoords[2]+s.y*o,u=t.distance(m.COORDS_BY_SCREEN,new c(m.COORDS_BY_USER,[a,d],this.board)),o===0)return 0;for(;u/(p+1)<this.minTicksDistance;)o*=n===1?2:5,n*=-1,a=t.usrCoords[1]+s.x*o,d=t.usrCoords[2]+s.y*o,u=t.distance(m.COORDS_BY_SCREEN,new c(m.COORDS_BY_USER,[a,d],this.board));return o},processTickPosition:function(o,t,s,a){var d,u,n,p,f=null;this.line.elementClass===m.OBJECT_CLASS_LINE?(d=o.usrCoords[1]+t*a.x,u=o.usrCoords[2]+t*a.y):(d=this.line.X(o+t),u=this.line.Y(o+t)),n=new c(m.COORDS_BY_USER,[d,u],this.board),this.line.elementClass===m.OBJECT_CLASS_CURVE&&(f=o+t,this.setTicksSizeVariables(f)),n.major=Math.round(t/s)%(h.evaluate(this.visProp.minorticks)+1)==0,(p=this.createTickPath(n,n.major)).length===3&&(this.ticks.push(p),n.major&&h.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(n,o,f),n,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(o,t){var s,a,d,u,n,p,f,b,C=P.eps,_=h.isArray(this.visProp.labels),E=h.evaluate(this.visProp.drawlabels);for(this.line.elementClass===m.OBJECT_CLASS_LINE&&(b=this.getXandYdeltas()),d=0;d<this.fixedTicks.length;d++)this.line.elementClass===m.OBJECT_CLASS_LINE?(f=this.fixedTicks[d],n=o.usrCoords[1]+f*b.x,p=o.usrCoords[2]+f*b.y):(f=o+this.fixedTicks[d],n=this.line.X(f),p=this.line.Y(f)),s=new c(m.COORDS_BY_USER,[n,p],this.board),this.line.elementClass===m.OBJECT_CLASS_CURVE&&this.setTicksSizeVariables(f),(u=this.createTickPath(s,!0)).length===3&&f>=t.lower-C&&f<=t.upper+C&&(this.ticks.push(u),E&&(_||h.exists(this.visProp.labels[d]))?(a=_?h.evaluate(this.visProp.labels[d]):f,this.labelsData.push(this.generateLabelData(this.generateLabelText(s,o,a),s,d))):this.labelsData.push(null))},getXandYdeltas:function(){var o,t,s=this.line.point1.Dist(this.line.point2);return this.line.type===m.OBJECT_TYPE_AXIS?(o=this.line.point1.coords.usrCoords,t=this.line.point2.coords.usrCoords,(o[1]>t[1]||Math.abs(o[1]-t[1])<P.eps&&o[2]>t[2])&&(o=this.line.point2.coords.usrCoords,t=this.line.point1.coords.usrCoords)):(o=this.line.point1.coords.usrCoords,t=this.line.point2.coords.usrCoords),{x:(t[1]-o[1])/s,y:(t[2]-o[2])/s}},_isInsideCanvas:function(o,t,s){var a=this.board.canvasWidth,d=this.board.canvasHeight;return s===void 0&&(s=0),o[0]>=s&&o[0]<=a-s&&t[0]>=s&&t[0]<=d-s||o[1]>=s&&o[1]<=a-s&&t[1]>=s&&t[1]<=d-s},createTickPath:function(o,t){var s,a,d,u,n,p,f,b,C,_,E,x,S,O,w=[-2e6,-2e6],T=[-2e6,-2e6];if(s=o.scrCoords,t?(u=this.dxMaj,n=this.dyMaj,C=this.majStyle):(u=this.dxMin,n=this.dyMin,C=this.minStyle),a=[-n*s[1]-u*s[2],n,u],t&&h.evaluate(this.visProp.type)==="polar"){if(x=this.board.getBoundingBox(),O=(S=2*Math.PI)/180,s=o.usrCoords,(E=Math.sqrt(s[1]*s[1]+s[2]*s[2]))<Math.max(Math.sqrt(x[0]*x[0]+x[1]*x[1]),Math.sqrt(x[2]*x[2]+x[3]*x[3]))){for(w=[],T=[],_=0;_<=S;_+=O)w.push(this.board.origin.scrCoords[1]+E*Math.cos(_)*this.board.unitX),T.push(this.board.origin.scrCoords[2]+E*Math.sin(_)*this.board.unitY);return[w,T,t]}}else if(C==="infinite"?(d=y.meetLineBoard(a,this.board),w[0]=d[0].scrCoords[1],w[1]=d[1].scrCoords[1],T[0]=d[0].scrCoords[2],T[1]=d[1].scrCoords[2]):(b=h.evaluate(this.visProp.face)===">"?Math.PI/4:h.evaluate(this.visProp.face)==="<"?-Math.PI/4:0,p=Math.cos(b)*u-Math.sin(b)*n,f=Math.sin(b)*u+Math.cos(b)*n,w[0]=s[1]+p*h.evaluate(this.visProp.tickendings[0]),T[0]=s[2]-f*h.evaluate(this.visProp.tickendings[0]),w[1]=s[1],T[1]=s[2],b=-b,p=Math.cos(b)*u-Math.sin(b)*n,f=Math.sin(b)*u+Math.cos(b)*n,w[2]=s[1]-p*h.evaluate(this.visProp.tickendings[1]),T[2]=s[2]+f*h.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(w,T))return[w,T,t];return[]},formatLabelText:function(o){var t,s,a=h.evaluate(this.visProp.scalesymbol);return h.isNumber(o)?(((t=(Math.round(1e13*o)/1e13).toString()).length>h.evaluate(this.visProp.maxlabellength)||t.indexOf("e")!==-1)&&(s=h.evaluate(this.visProp.digits),h.evaluate(this.visProp.precision)!==3&&s===3&&(s=h.evaluate(this.visProp.precision)),t=o.toExponential(s).toString()),h.evaluate(this.visProp.beautifulscientificticklabels)&&(t=this.beautifyScientificNotationLabel(t)),t.indexOf(".")>-1&&t.indexOf("e")===-1&&(t=(t=t.replace(/0+$/,"")).replace(/\.$/,""))):t=o.toString(),a.length>0&&(t==="1"?t=a:t==="-1"?t="-"+a:t!=="0"&&(t+=a)),h.evaluate(this.visProp.useunicodeminus)&&(t=t.replace(/-/g,"\u2212")),t},beautifyScientificNotationLabel:function(o){return o.indexOf("e")===-1?o:(parseFloat(o.substring(0,o.indexOf("e")))+o.substring(o.indexOf("e"))).replace(/e(.*)$/g,function(t,s){var a="\u202210";return a+=s.replace(/-/g,"\u207B").replace(/\+/g,"").replace(/0/g,"\u2070").replace(/1/g,"\xB9").replace(/2/g,"\xB2").replace(/3/g,"\xB3").replace(/4/g,"\u2074").replace(/5/g,"\u2075").replace(/6/g,"\u2076").replace(/7/g,"\u2077").replace(/8/g,"\u2078").replace(/9/g,"\u2079")})},generateLabelText:function(o,t,s){var a;if(!h.exists(s)){if(a=this.getDistanceFromZero(t,o),Math.abs(a)<P.eps)return"0";s=a/h.evaluate(this.visProp.scale)}return this.formatLabelText(s)},generateLabelData:function(o,t,s){var a,d,u,n;return n=h.evaluate(this.visProp.label.fontsize),a=[t.scrCoords[1],t.scrCoords[1]],d=[t.scrCoords[2],t.scrCoords[2]],u=n===void 0?12:n,u*=.5,this._isInsideCanvas(a,d,u)?(a=h.evaluate(this.visProp.label.offset[0]),d=h.evaluate(this.visProp.label.offset[1]),{x:t.usrCoords[1]+a/this.board.unitX,y:t.usrCoords[2]+d/this.board.unitY,t:o,i:s}):null},update:function(){return this.needsUpdate&&this.board.canvasWidth!==0&&this.board.canvasHeight!==0&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var o,t,s,a,d,u,n,p;for(s=this.labelsData.length,a=this.labels.length,o=0,t=0;o<s;o++)this.labelsData[o]!==null&&(n=this.labelsData[o],t<a?((u=this.labels[t]).setText(n.t),u.setCoords(n.x,n.y),t++):(this.labelCounter+=1,d={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},(d=h.deepCopy(d,this.visProp.label)).id=this.id+n.i+"Label"+this.labelCounter,u=e.createText(this.board,[n.x,n.y,n.t],d),this.addChild(u),u.setParents(this),u.isDraggable=!1,u.dump=!1,this.labels.push(u)),(p=h.evaluate(this.visProp.label.visible))==="inherit"&&(p=this.visPropCalc.visible),u.prepareUpdate().updateVisibility(p).updateRenderer(),u.distanceX=h.evaluate(this.visProp.label.offset[0]),u.distanceY=h.evaluate(this.visProp.label.offset[1]));for(t=s=t;t<a;t++)this.board.renderer.display(this.labels[t],!1),this.labels[t].visProp.visible=this.labels[t].visPropCalc.visible=!1;return this},hideElement:function(){var o;for(g.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),o=0;o<this.labels.length;o++)h.exists(this.labels[o])&&this.labels[o].hideElement();return this},showElement:function(){var o;for(g.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),o=0;o<this.labels.length;o++)h.exists(this.labels[o])&&this.labels[o].showElement();return this}}),g.createTicks=function(o,t,s){var a,d,u=h.copyAttributes(s,o.options,"ticks");if(d=t.length<2?u.ticksdistance:t[1],t[0].elementClass!==m.OBJECT_CLASS_LINE&&t[0].elementClass!==m.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof t[0]+"'.");return a=new g.Ticks(t[0],d,u),h.isFunction(u.generatelabelvalue)&&(a.generateLabelText=u.generatelabelvalue),h.isFunction(u.generatelabeltext)&&(a.generateLabelText=u.generatelabeltext),a.setParents(t[0]),a.isDraggable=!0,a.fullUpdate(t[0].visPropCalc.visible),a},g.createHatchmark=function(o,t,s){var a,d,u,n,p,f=[],b=h.copyAttributes(s,o.options,"hatch");if(t[0].elementClass!==m.OBJECT_CLASS_LINE&&t[0].elementClass!==m.OBJECT_CLASS_CURVE||typeof t[1]!="number")throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof t[0]+"' and '"+typeof t[1]+" and ''"+typeof t[2]+"'.");for(u=.5*-(((a=t[1])-1)*(n=b.ticksdistance)),d=0;d<a;d++)f[d]=u+d*n;return(p=o.create("ticks",[t[0],f],b)).elType="hatch",p},g.registerElement("ticks",g.createTicks),g.registerElement("hash",g.createHatchmark),g.registerElement("hatch",g.createHatchmark),{Ticks:g.Ticks,createTicks:g.createTicks,createHashmark:g.createHatchmark,createHatchmark:g.createHatchmark}}),define("parser/ca",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/env"],function(g,P,y,v,m,l,c,h){return g.CA=function(e,o,t){this.node=e,this.createNode=o,this.parser=t},g.extend(g.CA.prototype,{findMapNode:function(e,o){var t,s,a;if(o.value==="op_assign"&&o.children[0].value===e)return o.children[1];if(o.children){for(s=o.children.length,t=0;t<s;++t)if((a=this.findMapNode(e,o.children[t]))!==null)return a}return null},setMath:function(e){var o,t;if((e.type!="node_op"||e.value!="op_add"&&e.value!="op_sub"&&e.value!="op_mul"&&e.value!="op_div"&&e.value!="op_neg"&&e.value!="op_execfun"&&e.value!="op_exp")&&e.type!="node_var"&&e.type!="node_const"||(e.isMath=!0),e.children)for(t=e.children.length,o=0;o<t;++o)this.setMath(e.children[o])},deriveElementary:function(e,o){var t,s=e.children[0].value,a=e.children[1];switch(s){case"abs":t=this.createNode("node_op","op_div",a[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",c.deepCopy(a[0]),c.deepCopy(a[0]))]));break;case"sqrt":t=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(e.type,e.value,c.deepCopy(e.children[0]),c.deepCopy(e.children[1]))));break;case"sin":t=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),c.deepCopy(a));break;case"cos":t=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),c.deepCopy(a)));break;case"tan":t=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),c.deepCopy(a)),this.createNode("node_const",2)));break;case"cot":t=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),c.deepCopy(a)),this.createNode("node_const",2))));break;case"exp":t=this.createNode(e.type,e.value,c.deepCopy(e.children[0]),c.deepCopy(e.children[1]));break;case"pow":t=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",c.deepCopy(e.children[0]),c.deepCopy(e.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(e.children[1][0],o),this.createNode("node_op","op_div",c.deepCopy(e.children[1][1]),c.deepCopy(e.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(e.children[1][1],o),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[c.deepCopy(e.children[1][0])]))));break;case"log":case"ln":t=this.createNode("node_op","op_div",this.createNode("node_const",1),c.deepCopy(a[0]));break;case"log2":case"lb":case"ld":t=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),c.deepCopy(a[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":t=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),c.deepCopy(a[0])),this.createNode("node_const",.43429448190325176));break;case"asin":t=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(a[0]),c.deepCopy(a[0])))]));break;case"acos":t=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(a[0]),c.deepCopy(a[0])))])));break;case"atan":t=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(a[0]),c.deepCopy(a[0]))));break;case"acot":t=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(a[0]),c.deepCopy(a[0])))));break;case"sinh":t=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[c.deepCopy(a[0])]);break;case"cosh":t=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[c.deepCopy(a[0])]);break;case"tanh":t=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[c.deepCopy(a[0])]),this.createNode("node_const",2)));break;case"asinh":t=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",c.deepCopy(a[0]),c.deepCopy(a[0])),this.createNode("node_const",1))]));break;case"acosh":t=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",c.deepCopy(a[0]),c.deepCopy(a[0])),this.createNode("node_const",1))]));break;case"atanh":t=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(a[0]),c.deepCopy(a[0]))));break;default:throw t=this.createNode("node_const",0),console.log('Derivative of "'+s+'" not yet implemented'),new Error("Error("+this.line+"): ")}return t},derivative:function(e,o){var t;switch(e.type){case"node_op":switch(e.value){case"op_execfun":t=e.children[0].value=="pow"?this.deriveElementary(e,o):e.children[1].length===0?this.createNode("node_const",0):this.createNode("node_op","op_mul",this.deriveElementary(e,o),this.derivative(e.children[1][0],o));break;case"op_div":t=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(e.children[0],o),c.deepCopy(e.children[1])),this.createNode("node_op","op_mul",c.deepCopy(e.children[0]),this.derivative(e.children[1],o))),this.createNode("node_op","op_mul",c.deepCopy(e.children[1]),c.deepCopy(e.children[1])));break;case"op_mul":t=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",c.deepCopy(e.children[0]),this.derivative(e.children[1],o)),this.createNode("node_op","op_mul",this.derivative(e.children[0],o),c.deepCopy(e.children[1])));break;case"op_neg":t=this.createNode("node_op","op_neg",this.derivative(e.children[0],o));break;case"op_add":case"op_sub":t=this.createNode("node_op",e.value,this.derivative(e.children[0],o),this.derivative(e.children[1],o));break;case"op_exp":t=this.createNode("node_op","op_mul",c.deepCopy(e),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(e.children[0],o),this.createNode("node_op","op_div",c.deepCopy(e.children[1]),c.deepCopy(e.children[0]))),this.createNode("node_op","op_mul",this.derivative(e.children[1],o),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[c.deepCopy(e.children[0])]))))}break;case"node_var":t=e.value===o?this.createNode("node_const",1):this.createNode("node_const",0);break;case"node_const":t=this.createNode("node_const",0)}return t},expandDerivatives:function(e,o,t){var s,a,d,u,n,p,f,b,C,_,E;if(!e)return 0;for(this.line=e.line,this.col=e.col,s=e.children.length,a=0;a<s;++a)if(e.children[a]&&e.children[a].type)e.children[a]=this.expandDerivatives(e.children[a],e,t);else if(c.isArray(e.children[a]))for(d=0;d<e.children[a].length;++d)e.children[a][d]&&e.children[a][d].type&&(e.children[a][d]=this.expandDerivatives(e.children[a][d],e,t));if(e.type==="node_op"&&e.value==="op_execfun"&&e.children[0]&&e.children[0].value==="D"){if(e.children[1][0].type=="node_var"?(b=e.children[1][0].value,_=(u=this.findMapNode(b,t)).children[0],C=e.children[1].length>=2?e.children[1][1].value:u.children[0][0],n=u.children[1]):(n=e.children[1][0],_=["x"],C=e.children[1].length>=2?e.children[1][1].value:"x"),f=n,(E=e.children[1].length>=3?e.children[1][2].value:1)>=1)for(;E>=1;)f=this.derivative(f,C),f=this.removeTrivialNodes(f),E--;p=o.type=="node_op"&&o.value=="op_assign"?this.createNode("node_op","op_map",_,f):f,this.setMath(p),e.type=p.type,e.value=p.value,e.children[0]=p.children[0],e.children[1]=p.children[1]}return e},removeTrivialNodes:function(e){var o,t,s,a,d;if(c.isArray(e))for(t=e.length,o=0;o<t;++o)e[o]=this.removeTrivialNodes(e[o]);if(e.type!="node_op"||!e.children)return e;for(t=e.children.length,o=0;o<t;++o){this.mayNotBeSimplified=!1;do e.children[o]=this.removeTrivialNodes(e.children[o]);while(this.mayNotBeSimplified)}switch(e.value){case"op_map":if(s=e.children[0],(a=e.children[1]).type=="node_var"){for(o=0;o<s.length;++o)if(s[o]==a.value){a.isMath=!0;break}}break;case"op_add":if(s=e.children[0],a=e.children[1],s.type=="node_const"&&s.value===0)return a;if(a.type=="node_const"&&a.value===0)return s;if(s.type=="node_const"&&a.type=="node_const")return s.value+=a.value,s;break;case"op_mul":if(s=e.children[0],a=e.children[1],s.type=="node_const"&&s.value==1)return a;if(a.type=="node_const"&&a.value==1||s.type=="node_const"&&s.value===0)return s;if(a.type=="node_const"&&a.value===0||a.type=="node_const"&&a.value===0)return a;if(s.type=="node_op"&&s.value=="op_neg"&&a.type=="node_op"&&a.value=="op_neg")return e.children=[s.children[0],a.children[0]],this.mayNotBeSimplified=!0,e;if(s.value=="op_neg"&&a.value!="op_neg")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_op","op_mul",s.children[0],a)],this.mayNotBeSimplified=!0,e;if(s.value!="op_neg"&&a.value=="op_neg")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_op","op_mul",s,a.children[0])],this.mayNotBeSimplified=!0,e;if(s.value=="op_div"&&s.children[0].type=="node_const"&&s.children[0].value==1)return e.type="node_op",e.value="op_div",e.children=[a,s.children[1]],this.mayNotBeSimplified=!0,e;if(a.value=="op_div"&&a.children[0].type=="node_const"&&a.children[0].value==1)return e.type="node_op",e.value="op_div",e.children=[s,a.children[1]],this.mayNotBeSimplified=!0,e;if(s.type!="node_const"&&a.type=="node_const")return e.children=[a,s],this.mayNotBeSimplified=!0,e;if(s.type!="node_const"&&a.type=="node_op"&&a.value=="op_neg"&&a.children[0].type=="node_const")return e.children=[a,s],this.mayNotBeSimplified=!0,e;if(s.type=="node_op"&&s.value!="op_execfun"&&(a.type=="node_var"||a.type=="node_op"&&a.value=="op_execfun"))return e.children=[a,s],this.mayNotBeSimplified=!0,e;if(s.type!="node_op"&&a.type=="node_op"&&a.value=="op_neg"&&a.children[0].type=="node_var")return e.children=[a,s],this.mayNotBeSimplified=!0,e;if(s.type!="node_const"&&a.type=="node_op"&&(a.value=="op_mul"||a.value=="op_div")&&a.children[0].type=="node_const")return d=a.children[0],a.children[0]=s,e.children=[d,a],this.mayNotBeSimplified=!0,e;if(a.type!="node_const"&&s.type=="node_op"&&s.value=="op_mul"&&s.children[0].type=="node_const")return e.children=[s.children[0],this.createNode("node_op","op_mul",s.children[1],a)],this.mayNotBeSimplified=!0,e;if(s.type=="node_const"&&a.type=="node_const")return s.value*=a.value,s;if(s.type=="node_const"&&a.type=="node_op"&&(a.value=="op_mul"||a.value=="op_div")&&a.children[0].type=="node_const")return a.children[0].value*=s.value,a;if(s.hash=this.parser.compile(s),a.hash=this.parser.compile(a),s.hash===a.hash)return e.value="op_exp",e.children[1]=this.createNode("node_const",2),e;if(s.type=="node_const"&&a.type=="node_op"&&(a.value=="op_mul"||a.value=="op_div")&&a.children[0].type=="node_const")return a.children[0].value*=s.value,a;if(a.type=="node_op"&&a.value=="op_exp"&&(s.hash||(s.hash=this.parser.compile(s)),a.children[0].hash||(a.children[0].hash=this.parser.compile(a.children[0])),s.hash===a.children[0].hash))return a.children[1]=this.createNode("node_op","op_add",a.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,a;if(s.type=="node_op"&&s.value=="op_exp"&&a.type=="node_op"&&a.value=="op_exp"&&(s.children[0].hash=this.parser.compile(s.children[0]),a.children[0].hash=this.parser.compile(a.children[0]),s.children[0].hash===a.children[0].hash))return s.children[1]=this.createNode("node_op","op_add",s.children[1],a.children[1]),this.mayNotBeSimplified=!0,s;break;case"op_sub":if(s=e.children[0],a=e.children[1],s.type=="node_const"&&s.value===0)return e.value="op_neg",e.children[0]=a,e;if(a.type=="node_const"&&a.value===0)return s;if(s.type=="node_const"&&a.type=="node_const"&&s.value==a.value)return this.createNode("node_const",0);if(s.type=="node_var"&&a.type=="node_var"&&s.value==a.value)return this.createNode("node_const",0);if(s.type=="node_const"&&a.type=="node_const")return s.value-=a.value,s;if(s.type=="node_op"&&s.value=="op_mul"&&a.type=="node_op"&&a.value=="op_mul"&&(s.children[1].hash=this.parser.compile(s.children[1]),a.children[1].hash=this.parser.compile(a.children[1]),s.children[1].hash===a.children[1].hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_sub",s.children[0],a.children[0]),s.children[1]],this.mayNotBeSimplified=!0,e;if(s.type=="node_op"&&s.value=="op_mul"&&(s.children[1].hash=this.parser.compile(s.children[1]),a.hash=this.parser.compile(a),s.children[1].hash===a.hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_sub",s.children[0],this.createNode("node_const",1)),a],this.mayNotBeSimplified=!0,e;if(a.type=="node_op"&&a.value=="op_mul"&&(a.children[1].hash=this.parser.compile(a.children[1]),s.hash=this.parser.compile(s),a.children[1].hash===s.hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),a.children[0]),s],this.mayNotBeSimplified=!0,e;break;case"op_neg":if((s=e.children[0]).type=="node_const"&&s.value===0)return s;if(s.type=="node_op"&&s.value=="op_neg")return s.children[0];break;case"op_div":if(s=e.children[0],a=e.children[1],s.type=="node_const"&&a.type=="node_const"&&s.value==a.value&&s.value!==0)return s.value=1,s;if(s.type=="node_const"&&s.value===0&&a.type=="node_const"&&a.value!==0)return s.value=0,s;if(s.type=="node_const"&&s.value===0&&(a.type=="node_op"||a.type=="node_var"))return e.type="node_const",e.value=0,e;if(s.type=="node_var"&&a.type=="node_var"&&s.value==a.value)return this.createNode("node_const",1);if(s.type=="node_const"&&s.value!==0&&a.type=="node_const"&&a.value===0)return s.value>0?s.value=1/0:s.value=-1/0,s;if(s.type=="node_op"&&s.value=="op_neg"&&a.type=="node_op"&&a.value=="op_neg")return e.children=[s.children[0],a.children[0]],this.mayNotBeSimplified=!0,e;if(s.value=="op_neg"&&a.value!="op_neg")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_op","op_div",s.children[0],a)],this.mayNotBeSimplified=!0,e;if(s.value!="op_neg"&&a.value=="op_neg")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_op","op_div",s,a.children[0])],this.mayNotBeSimplified=!0,e;if(s.type=="node_op"&&s.value=="op_exp"&&(a.hash||(a.hash=this.parser.compile(a)),s.children[0].hash||(s.children[0].hash=this.parser.compile(s.children[0])),a.hash===s.children[0].hash))return s.children[1]=this.createNode("node_op","op_sub",s.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,s;if(a.type!="node_const"&&s.type=="node_op"&&s.value=="op_mul"&&s.children[0].type=="node_const")return e.value="op_mul",e.children=[s.children[0],this.createNode("node_op","op_div",s.children[1],a)],this.mayNotBeSimplified=!0,e;if(s.type=="node_op"&&s.value=="op_exp"&&a.type=="node_op"&&a.value=="op_exp"&&(s.children[0].hash=this.parser.compile(s.children[0]),a.children[0].hash=this.parser.compile(a.children[0]),s.children[0].hash===a.children[0].hash))return s.children[1]=this.createNode("node_op","op_sub",s.children[1],a.children[1]),this.mayNotBeSimplified=!0,s;break;case"op_exp":if(s=e.children[0],(a=e.children[1]).type=="node_const"&&a.value===0)return a.value=1,a;if(a.type=="node_const"&&a.value==1||s.type=="node_const"&&s.value==1||s.type=="node_const"&&s.value===0&&a.type=="node_const"&&a.value!==0)return s;if(s.type=="node_op"&&s.value=="op_exp")return e.children=[s.children[0],this.createNode("node_op","op_mul",s.children[1],a)],e}switch(e.value){case"op_add":if(s=e.children[0],a=e.children[1],s.type=="node_const"&&a.type=="node_const"&&s.value==a.value)return s.value+=a.value,s;if(s.type=="node_var"&&a.type=="node_var"&&s.value==a.value)return e.children[0]=this.createNode("node_const",2),e.value="op_mul",e;if(s.type=="node_op"&&s.value=="op_neg")return e.value="op_sub",e.children[0]=a,e.children[1]=s.children[0],this.mayNotBeSimplified=!0,e;if(a.type=="node_op"&&a.value=="op_neg")return e.value="op_sub",e.children[1]=a.children[0],this.mayNotBeSimplified=!0,e;if(s.type=="node_op"&&s.value=="op_mul"&&a.type=="node_op"&&a.value=="op_mul"&&(s.children[1].hash=this.parser.compile(s.children[1]),a.children[1].hash=this.parser.compile(a.children[1]),s.children[1].hash===a.children[1].hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_add",s.children[0],a.children[0]),s.children[1]],this.mayNotBeSimplified=!0,e;if(s.type=="node_op"&&s.value=="op_mul"&&(s.children[1].hash=this.parser.compile(s.children[1]),a.hash=this.parser.compile(a),s.children[1].hash===a.hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_add",s.children[0],this.createNode("node_const",1)),a],this.mayNotBeSimplified=!0,e;if(a.type=="node_op"&&a.value=="op_mul"&&(a.children[1].hash=this.parser.compile(a.children[1]),s.hash=this.parser.compile(s),a.children[1].hash===s.hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),a.children[0]),s],this.mayNotBeSimplified=!0,e;break;case"op_sub":if(s=e.children[0],(a=e.children[1]).type=="node_op"&&a.value=="op_neg")return e.value="op_add",e.children[1]=a.children[0],this.mayNotBeSimplified=!0,e;break;case"op_execfun":return this.simplifyElementary(e)}return e},simplifyElementary:function(e){var o=e.children[0].value,t=e.children[1];if(t.length==0)return e;switch(o){case"sin":case"tan":if(t[0].type=="node_const"&&t[0].value===0||t[0].type=="node_var"&&t[0].value=="PI"||t[0].type=="node_op"&&t[0].value=="op_mul"&&t[0].children[0].type=="node_const"&&t[0].children[0].value%1==0&&t[0].children[1].type=="node_var"&&t[0].children[1].value=="PI")return e.type="node_const",e.value=0,e;break;case"cos":if(t[0].type=="node_const"&&t[0].value===0)return e.type="node_const",e.value=1,e;if(t[0].type=="node_var"&&t[0].value=="PI")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_const",1)],e;break;case"exp":if(t[0].type=="node_const"&&t[0].value===0)return e.type="node_const",e.value=1,e;break;case"pow":if(t[1].type=="node_const"&&t[1].value===0)return e.type="node_const",e.value=1,e}return e}}),g.CA}),define("utils/dump",["jxg","utils/type"],function(g,P){return g.Dump={addMarkers:function(y,v,m){var l,c,h;for(l in P.isArray(v)||(v=[v]),P.isArray(m)||(m=[m]),c=Math.min(v.length,m.length),v.length=c,m.length=c,y.objects)if(y.objects.hasOwnProperty(l))for(h=0;h<c;h++)y.objects[l][v[h]]=m[h]},deleteMarkers:function(y,v){var m,l,c;for(m in P.isArray(v)||(v=[v]),l=v.length,v.length=l,y.objects)if(y.objects.hasOwnProperty(m))for(c=0;c<l;c++)delete y.objects[m][v[c]]},str:function(y){return typeof y=="string"&&y.substr(0,7)!=="function"&&(y='"'+y+'"'),y},minimizeObject:function(y,v){var m,l,c,h={},e=P.deepCopy(y),o=[];for(c=1;c<arguments.length;c++)o.push(arguments[c]);for(h=P.deepCopy(h,g.Options.elements,!0),c=o.length;c>0;c--)h=P.deepCopy(h,o[c-1],!0);for(m in h)h.hasOwnProperty(m)&&(l=m.toLowerCase(),typeof h[m]!="object"&&h[m]===e[l]&&delete e[l]);return e},prepareAttributes:function(y,v){var m,l;for(l in m=this.minimizeObject(v.getAttributes(),g.Options[v.elType]),v.subs)v.subs.hasOwnProperty(l)&&(m[l]=this.minimizeObject(v.subs[l].getAttributes(),g.Options[v.elType][l],g.Options[v.subs[l].elType]),m[l].id=v.subs[l].id,m[l].name=v.subs[l].name);return m.id=v.id,m.name=v.name,m},setBoundingBox:function(y,v,m){return y.push({obj:m,method:"setBoundingBox",params:[v.getBoundingBox(),v.keepaspectratio]}),y},dump:function(y){var v,m,l,c,h=[],e=[],o=y.objectsList.length;for(this.addMarkers(y,"dumped",!1),v=0;v<o;v++)if(l={},!(m=y.objectsList[v]).dumped&&m.dump){for(l.type=m.getType(),l.parents=m.getParents().slice(),l.type==="point"&&l.parents[0]===1&&(l.parents=l.parents.slice(1)),c=0;c<l.parents.length;c++)P.isString(l.parents[c])&&l.parents[c][0]!=="'"&&l.parents[c][0]!=='"'?l.parents[c]='"'+l.parents[c]+'"':P.isArray(l.parents[c])&&(l.parents[c]="["+l.parents[c].toString()+"]");l.attributes=this.prepareAttributes(y,m),l.type==="glider"&&m.onPolygon&&h.push({obj:m.id,prop:"onPolygon",val:!0}),e.push(l)}return this.deleteMarkers(y,"dumped"),{elements:e,props:h,methods:[]}},arrayToParamStr:function(y,v){var m,l=[];for(m=0;m<y.length;m++)l.push(v.call(this,y[m]));return l.join(", ")},toJCAN:function(y){var v,m,l;switch(typeof y){case"object":if(y){if(m=[],P.isArray(y)){for(v=0;v<y.length;v++)m.push(this.toJCAN(y[v]));return"["+m.join(",")+"]"}for(l in y)y.hasOwnProperty(l)&&m.push(l+": "+this.toJCAN(y[l]));return"<<"+m.join(", ")+">> "}return"null";case"string":return"'"+y.replace(/\\/g,"\\\\").replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return y.toString();case"null":return"null"}},toJessie:function(y){var v,m,l,c=this.dump(y),h=[];for(c.methods=this.setBoundingBox(c.methods,y,"$board"),m=c.elements,v=0;v<m.length;v++)m[v].attributes.name.length>0&&h.push("// "+m[v].attributes.name),h.push("s"+v+" = "+m[v].type+"("+m[v].parents.join(", ")+") "+this.toJCAN(m[v].attributes).replace(/\n/,"\\n")+";"),m[v].type==="axis"&&(l=m[v].attributes.id,y.objects[l].defaultTicks===null&&h.push("s"+v+".removeAllTicks();")),h.push("");for(v=0;v<c.methods.length;v++)h.push(c.methods[v].obj+"."+c.methods[v].method+"("+this.arrayToParamStr(c.methods[v].params,this.toJCAN)+");"),h.push("");for(v=0;v<c.props.length;v++)h.push(c.props[v].obj+"."+c.props[v].prop+" = "+this.toJCAN(c.props[v].val)+";"),h.push("");return h.join(`
`)},toJavaScript:function(y){var v,m,l,c=this.dump(y),h=[];for(c.methods=this.setBoundingBox(c.methods,y,"board"),m=c.elements,v=0;v<m.length;v++)h.push('board.create("'+m[v].type+'", ['+m[v].parents.join(", ")+"], "+P.toJSON(m[v].attributes)+");"),m[v].type==="axis"&&(l=m[v].attributes.id,y.objects[l].defaultTicks===null&&h.push('board.objects["'+l+'"].removeTicks(board.objects["'+l+'"].defaultTicks);'));for(v=0;v<c.methods.length;v++)h.push(c.methods[v].obj+"."+c.methods[v].method+"("+this.arrayToParamStr(c.methods[v].params,P.toJSON)+");"),h.push("");for(v=0;v<c.props.length;v++)h.push(c.props[v].obj+"."+c.props[v].prop+" = "+P.toJSON(c.props[v].val)+";"),h.push("");return h.join(`
`)}},g.Dump}),define("element/comb",["jxg","utils/type","base/point"],function(g,P,y){return g.createComb=function(v,m,l){var c,h,e,o,t;if(m.length!==2)throw t=m.map(function(s){return"'"+typeof s+"'"}),new Error("JSXGraph: Can't create comb with parent types "+t.join(", ")+`.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);if(P.isArray(m[0])&&m[0].length>1)o=P.copyAttributes(l,v.options,"comb","point1"),c=v.create("point",m[0],o);else if(P.isString(m[0])||P.isPoint(m[0]))c=v.select(m[0]);else if(P.isFunction(m[0])&&P.isPoint(m[0]()))c=m[0]();else{if(!(P.isFunction(m[0])&&m[0]().length&&m[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof m[0]+"' and '"+typeof m[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);o=P.copyAttributes(l,v.options,"comb","point1"),c=y.createPoint(v,m[0](),o)}if(P.isArray(m[1])&&m[1].length>1)o=P.copyAttributes(l,v.options,"comb","point2"),h=v.create("point",m[1],o);else if(P.isString(m[1])||P.isPoint(m[1]))h=v.select(m[1]);else if(P.isFunction(m[1])&&P.isPoint(m[1]()))h=m[1]();else{if(!(P.isFunction(m[1])&&m[1]().length&&m[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof m[0]+"' and '"+typeof m[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);o=P.copyAttributes(l,v.options,"comb","point2"),h=y.createPoint(v,m[1](),o)}return o=P.copyAttributes(l,v.options,"comb"),P.merge(o,P.copyAttributes(l,v.options,"comb","curve")),(e=v.create("curve",[[0],[0]],o)).updateDataArray=function(){var s,a,d,u,n,p,f,b,C,_,E=0,x=c.Dist(h),S=c,O=h;for(b=P.evaluate(e.visProp.frequency),C=-P.evaluate(e.visProp.angle),_=P.evaluate(e.visProp.width),P.evaluate(e.visProp.reverse)&&(S=h,O=c,C=-C),s=Math.cos(C),a=Math.sin(C),d=(O.X()-S.X())/x,u=(O.Y()-S.Y())/x,s*=_/Math.abs(a),a*=_/Math.abs(a),this.dataX=[],this.dataY=[];E<x;)n=S.X()+d*E,p=S.Y()+u*E,a*=f=Math.min(s,x-E)/Math.abs(s),s*=f,this.dataX.push(n),this.dataY.push(p),this.dataX.push(n+d*s+u*a),this.dataY.push(p-d*a+u*s),this.dataX.push(NaN),this.dataY.push(NaN),E+=b},e},g.registerElement("comb",g.createComb),{createComb:g.createComb}}),define("element/slopetriangle",["jxg","utils/type","base/constants","base/polygon"],function(g,P,y,v){var m=function(){v.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},l=function(){return this.tangent.getSlope()};return g.createSlopeTriangle=function(c,h,e){var o,t,s,a,d,u,n,p,f,b=!1;if(h.length===1&&h[0].type===y.OBJECT_TYPE_TANGENT)t=h[0],s=t.glider;else if(h.length===1&&h[0].type===y.OBJECT_TYPE_GLIDER)s=h[0],f=P.copyAttributes(e,c.options,"slopetriangle","tangent"),t=c.create("tangent",[s],f),b=!0;else{if(h.length!==2||h[0].elementClass!==y.OBJECT_CLASS_LINE||!P.isPoint(h[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof h[0]+"'.");t=h[0],s=h[1]}return f=P.copyAttributes(e,c.options,"slopetriangle","basepoint"),n=c.create("point",[function(){return[s.X()+1,s.Y()]}],f),f=P.copyAttributes(e,c.options,"slopetriangle","baseline"),u=c.create("line",[s,n],f),f=P.copyAttributes(e,c.options,"slopetriangle","glider"),a=c.create("glider",[s.X()+1,s.Y(),u],f),f=P.copyAttributes(e,c.options,"slopetriangle","toppoint"),d=c.create("point",[function(){return[a.X(),a.Y()+(a.X()-s.X())*t.getSlope()]}],f),(f=P.copyAttributes(e,c.options,"slopetriangle")).borders=P.copyAttributes(f.borders,c.options,"slopetriangle","borders"),(o=c.create("polygon",[s,a,d],f)).Value=l,o.tangent=t,o._isPrivateTangent=b,o.borders[2].setArrow(!1,!1),f=P.copyAttributes(e,c.options,"slopetriangle","label"),(p=c.create("text",[function(){return a.X()+.1},function(){return .5*(a.Y()+d.Y())},function(){return""}],f))._setText(function(){return P.toFixed(o.Value(),P.evaluate(p.visProp.digits))}),p.fullUpdate(),o.glider=a,o.basepoint=n,o.baseline=u,o.toppoint=d,o.label=p,o.subs={glider:a,basePoint:n,baseLine:u,topPoint:d,label:p},o.inherits.push(a,n,u,d,p),o.methodMap=g.deepCopy(o.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),o.remove=m,o},g.registerElement("slopetriangle",g.createSlopeTriangle),{createSlopeTriangle:g.createSlopeTriangle}}),define("element/checkbox",["jxg","utils/env","utils/type"],function(g,P,y){var v=function(){this._value=this.rendNodeCheckbox.checked,this.board.update()};return g.createCheckbox=function(m,l,c){var h,e,o=y.copyAttributes(c,m.options,"checkbox");return e=[l[0],l[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],(h=m.create("text",e,o)).type=y.OBJECT_TYPE_CHECKBOX,h.rendNodeCheckbox=h.rendNode.childNodes[0].childNodes[0],h.rendNodeLabel=h.rendNode.childNodes[0].childNodes[1],h.rendNodeTag=h.rendNodeCheckbox,h.rendNodeTag.disabled=!!o.disabled,h.rendNodeLabel.innerHTML=l[2],h.rendNodeCheckbox.id=h.rendNode.id+"_checkbox",h.rendNodeLabel.id=h.rendNode.id+"_label",h.rendNodeLabel.setAttribute("for",h.rendNodeCheckbox.id),h.visPropOld.fontsize="0px",m.renderer.updateTextStyle(h,!1),h.rendNodeCheckbox.checked=o.checked,h._value=o.checked,h.Value=function(){return this._value},h.update=function(){return this.needsUpdate&&(g.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},P.addEvent(h.rendNodeCheckbox,"change",v,h),h},g.registerElement("checkbox",g.createCheckbox),{createCheckbox:g.createCheckbox}}),define("element/input",["jxg","utils/env","utils/type"],function(g,P,y){var v=function(m){this._value=this.rendNodeInput.value,this.board.update()};return g.createInput=function(m,l,c){var h,e,o=y.copyAttributes(c,m.options,"input");return e=[l[0],l[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+o.maxlength+'" style="width:100%"/></span>'],(h=m.create("text",e,o)).type=y.OBJECT_TYPE_INPUT,h.rendNodeLabel=h.rendNode.childNodes[0].childNodes[0],h.rendNodeInput=h.rendNode.childNodes[0].childNodes[1],h.rendNodeLabel.innerHTML=l[3],h.rendNodeInput.value=l[2],h.rendNodeTag=h.rendNodeInput,h.rendNodeTag.disabled=!!o.disabled,h.rendNodeLabel.id=h.rendNode.id+"_label",h.rendNodeInput.id=h.rendNode.id+"_input",h._value=l[2],h.update=function(){return this.needsUpdate&&(g.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},h.Value=function(){return this._value},h.set=function(t){return this._value=t,this.rendNodeInput.value=t,this},P.addEvent(h.rendNodeInput,"input",v,h),P.addEvent(h.rendNodeInput,"mousedown",function(t){y.exists(t.stopPropagation)&&t.stopPropagation()},h),P.addEvent(h.rendNodeInput,"touchstart",function(t){y.exists(t.stopPropagation)&&t.stopPropagation()},h),P.addEvent(h.rendNodeInput,"pointerdown",function(t){y.exists(t.stopPropagation)&&t.stopPropagation()},h),h.visPropOld.fontsize="0px",m.renderer.updateTextStyle(h,!1),h},g.registerElement("input",g.createInput),{createInput:g.createInput}}),define("element/button",["jxg","utils/env","utils/type"],function(g,P,y){var v=function(){this._handler&&this._handler(),this.board.update()};return g.createButton=function(m,l,c){var h,e,o=y.copyAttributes(c,m.options,"button");return e=[l[0],l[1],'<button type="button" style="width:100%;"></button>'],(h=m.create("text",e,o)).type=y.OBJECT_TYPE_BUTTON,h.rendNodeButton=h.rendNode.childNodes[0],h.rendNodeButton.id=h.rendNode.id+"_button",h.rendNodeButton.innerHTML=l[2],h.rendNodeTag=h.rendNodeButton,h.rendNodeTag.disabled=!!o.disabled,h.visPropOld.fontsize="0px",m.renderer.updateTextStyle(h,!1),l[3]&&(y.isString(l[3])?(h._jc=new g.JessieCode,h._jc.use(m),h._handler=function(){h._jc.parse(l[3])}):h._handler=l[3]),P.addEvent(h.rendNodeButton,"click",v,h),P.addEvent(h.rendNodeButton,"mousedown",function(t){y.exists(t.stopPropagation)&&t.stopPropagation()},h),P.addEvent(h.rendNodeButton,"touchstart",function(t){y.exists(t.stopPropagation)&&t.stopPropagation()},h),P.addEvent(h.rendNodeButton,"pointerdown",function(t){y.exists(t.stopPropagation)&&t.stopPropagation()},h),h},g.registerElement("button",g.createButton),{createButton:g.createButton}}),define("base/foreignobject",["jxg","base/constants","base/coords","base/element","math/math","utils/type","base/coordselement"],function(g,P,y,v,m,l,c){return g.ForeignObject=function(h,e,o,t,s){this.constructor(h,o,P.OBJECT_TYPE_FOREIGNOBJECT,P.OBJECT_CLASS_OTHER),this.element=this.board.select(o.anchor),this.coordsConstructor(e),this._useUserSize=!1,this.size=[1,1],l.exists(s)&&s.length>0&&(this._useUserSize=!0,this.W=l.createFunction(s[0],this.board,""),this.H=l.createFunction(s[1],this.board,""),this.usrSize=[this.W(),this.H()]),this.content=t,this.elType="foreignobject",this.id=this.board.setId(this,"Im"),this.board.renderer.drawForeignObject(this),this.board.finalizeAdding(this),this.methodMap=g.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},g.ForeignObject.prototype=new v,l.copyPrototypeMethods(g.ForeignObject,c,"coordsConstructor"),g.extend(g.ForeignObject.prototype,{hasPoint:function(h,e){var o,t,s,a,d,u,n,p,f,b=this.transformations.length;return l.isObject(l.evaluate(this.visProp.precision))?(a=this.board._inputDevice,d=l.evaluate(this.visProp.precision[a])):d=this.board.options.precision.hasPoint,b===0?(o=h-this.coords.scrCoords[1],t=this.coords.scrCoords[2]-e,o>=-(s=d)&&o-this.size[0]<=s&&t>=-s&&t-this.size[1]<=s):(n=[(u=(u=new y(P.COORDS_BY_SCREEN,[h,e],this.board)).usrCoords)[0]-this.span[0][0],u[1]-this.span[0][1],u[2]-this.span[0][2]],0<=(p=(f=m.innerProduct)(n,this.span[1]))&&p<=f(this.span[1],this.span[1])&&0<=(p=f(n,this.span[2]))&&p<=f(this.span[2],this.span[2]))},update:function(h){return this.needsUpdate?(this.updateCoords(h),this.updateSize(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateForeignObject")},updateSize:function(){var h=[0,0];return this._useUserSize?(this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)]):this.rendNode.hasChildNodes()&&(h=this.rendNode.childNodes[0].getBoundingClientRect(),this.size=[h.width,h.height]),this},updateSpan:function(){var h,e,o=this.transformations.length,t=[];if(o===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(t[0]=[this.Z(),this.X(),this.Y()],t[1]=[this.Z(),this.X()+this.W(),this.Y()],t[2]=[this.Z(),this.X(),this.Y()+this.H()],h=0;h<o;h++)for(e=0;e<3;e++)t[e]=m.matVecMult(this.transformations[h].matrix,t[e]);for(e=0;e<3;e++)t[e][1]/=t[e][0],t[e][2]/=t[e][0],t[e][0]/=t[e][0];for(e=1;e<3;e++)t[e][0]-=t[0][0],t[e][1]-=t[0][1],t[e][2]-=t[0][2];this.span=t}return this},addTransform:function(h){var e;if(l.isArray(h))for(e=0;e<h.length;e++)this.transformations.push(h[e]);else this.transformations.push(h);return this},getParents:function(){var h=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(h=this.parents),h},setSize:function(h,e){return this.W=l.createFunction(h,this.board,""),this.H=l.createFunction(e,this.board,""),this._useUserSize=!0,this},W:function(){},H:function(){}}),g.createForeignObject=function(h,e,o){var t,s,a=e[0],d=e[1],u=[];if(e.length>=2&&(u=e[2]),t=l.copyAttributes(o,h.options,"foreignobject"),!(s=c.create(g.ForeignObject,h,d,t,a,u)))throw new Error("JSXGraph: Can't create foreignObject with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [string, [x, y], [w, h]], [string, [x, y]], [element,transformation]`);return s},g.registerElement("foreignobject",g.createForeignObject),g.registerElement("fo",g.createForeignObject),{ForeignObject:g.ForeignObject,createForeignobject:g.createForeignObject}}),define("3d/threed",["jxg"],function(g){return g.ThreeD={},g.ThreeD}),define("3d/view3d",["jxg","options","base/constants","utils/type","math/math","base/element","3d/threed"],function(g,P,y,v,m,l,c){return c.View3D=function(h,e,o){var t,s,a;this.constructor(h,o,y.OBJECT_TYPE_VIEW3D,y.OBJECT_CLASS_CURVE),t=e[2],s=e[0],a=e[1],this.D3={},this.D3.objects={},this.D3.objectsList=[],this.D3.defaultAxes=null,this.D3.matrix=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],this.D3.bbox3d=t,this.D3.coords=s,this.D3.size=a,this.D3.r=-1,this.timeoutAzimuth=null,this.id=this.board.setId(this,"V"),this.board.finalizeAdding(this),this.elType="view3d",this.methodMap=v.deepCopy(this.methodMap,{})},c.View3D.prototype=new l,g.extend(c.View3D.prototype,{create:function(h,e,o){var t,s=[];return h.indexOf("3d")>0&&s.push(this),t=this.board.create(h,s.concat(e),o),this.add(t),t},add:function(h){this.D3.objects[h.id]=h,this.D3.objectsList.push(h)},update:function(){var h,e,o,t,s,a=this.D3;return v.exists(a.el_slide)&&v.exists(a.az_slide)&&this.needsUpdate?(h=a.el_slide.Value(),e=a.r,o=a.az_slide.Value(),t=e*Math.sin(h),s=[[1,0,0],[0,1,0],[0,0,1]],a.matrix=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],a.matrix[1][1]=e*Math.cos(o),a.matrix[1][2]=-e*Math.sin(o),a.matrix[2][1]=t*Math.sin(o),a.matrix[2][2]=t*Math.cos(o),a.matrix[2][3]=Math.cos(h),s[1][1]=a.size[0]/(a.bbox3d[0][1]-a.bbox3d[0][0]),s[2][2]=a.size[1]/(a.bbox3d[1][1]-a.bbox3d[1][0]),s[1][0]=a.coords[0]-s[1][1]*a.bbox3d[0][0],s[2][0]=a.coords[1]-s[2][2]*a.bbox3d[1][0],a.matrix=m.matMatMult(s,a.matrix),this):this},updateRenderer:function(){return this.needsUpdate=!1,this},project3DTo2D:function(h,e,o){var t;return t=arguments.length===3?[1,h,e,o]:h.length===3?[1].concat(h):h,m.matVecMult(this.D3.matrix,t)},project2DTo3DPlane:function(h,e,o){var t,s,a,d,u=e.slice(1),n=[1,0,0,0];o=o||[1,0,0,0],d=m.norm(u,3),a=m.innerProduct(o.slice(1),u,3)/d,(t=this.D3.matrix.slice(0,3)).push([0].concat(u)),s=h.coords.usrCoords.concat([a]);try{t[2][3]===1&&(t[2][1]=t[2][2]=.001*m.eps),n=m.Numerics.Gauss(t,s)}catch{n=[0,NaN,NaN,NaN]}return n},project3DToCube:function(h){var e=this.D3.bbox3d;return h[1]<e[0][0]&&(h[1]=e[0][0]),h[1]>e[0][1]&&(h[1]=e[0][1]),h[2]<e[1][0]&&(h[2]=e[1][0]),h[2]>e[1][1]&&(h[2]=e[1][1]),h[3]<e[2][0]&&(h[3]=e[2][0]),h[3]>e[2][1]&&(h[3]=e[2][1]),h},intersectionLineCube:function(h,e,o){var t,s,a,d;for(t=o,s=0;s<3;s++)e[s]!==0&&(a=(this.D3.bbox3d[s][0]-h[s])/e[s],d=(this.D3.bbox3d[s][1]-h[s])/e[s],t=o<0?Math.max(t,Math.min(a,d)):Math.min(t,Math.max(a,d)));return t},isInCube:function(h){return h[0]>this.D3.bbox3d[0][0]-m.eps&&h[0]<this.D3.bbox3d[0][1]+m.eps&&h[1]>this.D3.bbox3d[1][0]-m.eps&&h[1]<this.D3.bbox3d[1][1]+m.eps&&h[2]>this.D3.bbox3d[2][0]-m.eps&&h[2]<this.D3.bbox3d[2][1]+m.eps},intersectionPlanePlane:function(h,e,o){var t,s,a,d,u=[[],[]];return o=o||e.D3.d,t=m.Geometry.meet3Planes(h.D3.normal,h.D3.d,e.D3.normal,o,m.crossProduct(h.D3.normal,e.D3.normal),0),s=m.Geometry.meetPlanePlane(h.D3.dir1,h.D3.dir2,e.D3.dir1,e.D3.dir2),a=this.intersectionLineCube(t,s,1/0),d=m.axpy(a,s,t),this.isInCube(d)&&(u[0]=d),a=this.intersectionLineCube(t,s,-1/0),d=m.axpy(a,s,t),this.isInCube(d)&&(u[1]=d),u},getMesh:function(h,e,o,t,s){var a,d,u,n,p,f,b,C=[0,0,0],_=t[2],E=s[2],x=[],S=[];for(f=(v.evaluate(t[1])-v.evaluate(t[0]))/_,b=(v.evaluate(s[1])-v.evaluate(s[0]))/E,a=0;a<=_;a++){for(u=t[0]+f*a,d=0;d<=E;d++)n=s[0]+b*d,C[0]=h(u,n),C[1]=e(u,n),C[2]=o(u,n),p=this.project3DTo2D(C),x.push(p[1]),S.push(p[2]);x.push(NaN),S.push(NaN)}for(d=0;d<=E;d++){for(n=s[0]+b*d,a=0;a<=_;a++)u=t[0]+f*a,C[0]=h(u,n),C[1]=e(u,n),C[2]=o(u,n),p=this.project3DTo2D(C),x.push(p[1]),S.push(p[2]);x.push(NaN),S.push(NaN)}return[x,S]},animateAzimuth:function(){var h=this.D3.az_slide._smin,e=this.D3.az_slide._smax-h,o=this.D3.az_slide.Value()+.1;this.D3.az_slide.position=(o-h)/e,this.D3.az_slide.position>1&&(this.D3.az_slide.position=0),this.board.update(),this.timeoutAzimuth=setTimeout(function(){this.animateAzimuth()}.bind(this),200)},stopAzimuth:function(){clearTimeout(this.timeoutAzimuth),this.timeoutAzimuth=null}}),c.createView3D=function(h,e,o){var t,s,a,d,u,n,p=e[0],f=e[1];return s=v.copyAttributes(o,h.options,"view3d"),(t=new c.View3D(h,e,s)).defaultAxes=t.create("axes3d",e,o),a=p[0],d=p[1],u=f[0],n=f[1],t.D3.az_slide=h.create("slider",[[a-1,d-2],[a+u+1,d-2],[0,1,2*Math.PI]],{style:6,name:"az",point1:{frozen:!0},point2:{frozen:!0}}),t.D3.el_slide=h.create("slider",[[a-1,d],[a-1,d+n],[0,.3,Math.PI/2]],{style:6,name:"el",point1:{frozen:!0},point2:{frozen:!0}}),t.board.highlightInfobox=function(b,C,_){var E;v.exists(_.D3)?(E=v.evaluate(_.visProp.infoboxdigits))==="auto"?t.board.highlightCustomInfobox("("+v.autoDigits(_.D3.X())+" | "+v.autoDigits(_.D3.Y())+" | "+v.autoDigits(_.D3.Z())+")",_):t.board.highlightCustomInfobox("("+v.toFixed(_.D3.X(),E)+" | "+v.toFixed(_.D3.Y(),E)+" | "+v.toFixed(_.D3.Z(),E)+")",_):t.board.highlightCustomInfobox("("+b+", "+C+")",_)},t},g.registerElement("view3d",c.createView3D),c.View3D}),define("3d/box3d",["jxg","utils/type","math/math","math/geometry","3d/view3d"],function(g,P,y,v,m){m.createAxes=function(l,c,h){var e,o,t,s,a,d,u,n,p,f,b,C,_,E,x,S,O=c[0],w=["x","y","z"],T="Axis",M=["Rear","Front"],N=[0,0,0],A=[0,0,0],R={};if(P.exists(O.D3))for(e=0;e<w.length;e++)N[e]=O.D3.bbox3d[e][0],A[e]=O.D3.bbox3d[e][1];else for(e=0;e<w.length;e++)N[e]=c[1][e],A[e]=c[2][1];for(u=(d=P.copyAttributes(h,l.options,"axes3d")).axesposition,e=0;e<w.length;e++)x=(n=w[e])+T,u==="center"?(p=[0,0,0],(f=[0,0,0])[e]=A[e],R[x]=O.create("axis3d",[p,f],d[x.toLowerCase()])):(x+="Border",p=N.slice(),f=A.slice(),e===2?(p[1]=A[1],f[0]=N[0]):(p[e]=A[e],f[2]=N[2]),f[e]=A[e],d[x.toLowerCase()].lastArrow=!1,R[x]=O.create("axis3d",[p,f],d[x.toLowerCase()]),S={visible:!0,minorTicks:0,tickEndings:[0,1],drawLabels:!1},e===2&&(S.tickEndings=[1,0]),R[x+"Ticks"]=O.create("ticks",[R[x],1],S));for(R.O=l.create("intersection",[R[w[0]+T],R[w[1]+T]],{name:"",visible:!1,withLabel:!1}),e=0;e<w.length;e++)for(s=(e+1)%3,a=(e+2)%3,n=w[e],o=0;o<M.length;o++)(p=[0,0,0])[e]=o===0?N[e]:A[e],C=[0,0,0],(b=[0,0,0])[s]=1,C[a]=1,_=[N[s],A[s]],E=[N[a],A[a]],R[x=n+"Plane"+M[o]]=O.create("plane3d",[p,b,C,_,E],d[x.toLowerCase()]),R[x].D3.elType="axisplane3d";for(e=0;e<w.length;e++)for(n=w[e],o=0;o<M.length;o++)for(t=1;t<=2;t++)x=n+"Plane"+M[o]+w[s=(e+t)%3].toUpperCase()+"Axis",(p=[0,0,0])[e]=(f=[0,0,0])[e]=o===0?N[e]:A[e],p[s]=N[s],f[s]=A[s],R[x]=O.create("axis3d",[p,f],d[x.toLowerCase()]);return R},g.registerElement("axes3d",m.createAxes),m.createAxis=function(l,c,h){var e,o,t,s,a,d,u=c[0],n=c[1],p=c[2];return e=P.copyAttributes(h.point1,l.options,"axis3d","point1"),o=l.create("point",[(s=n[0],a=n[1],d=n[2],function(){return u.project3DTo2D(s,a,d)[1]}),function(f,b,C){return function(){return u.project3DTo2D(f,b,C)[2]}}(n[0],n[1],n[2])],e),e=P.copyAttributes(h.point2,l.options,"axis3d","point2"),t=l.create("point",[function(f,b,C){return function(){return u.project3DTo2D(f,b,C)[1]}}(p[0],p[1],p[2]),function(f,b,C){return function(){return u.project3DTo2D(f,b,C)[2]}}(p[0],p[1],p[2])],e),e=P.copyAttributes(h,l.options,"axis3d"),l.create("arrow",[o,t],e)},g.registerElement("axis3d",m.createAxis),m.createMesh=function(l,c,h){var e,o=c[0],t=c[1],s=c[2],a=c[3],d=c[4],u=c[5];return(e=l.create("curve",[[],[]],h)).updateDataArray=function(){var n,p,f,b,C=a[0],_=a[1],E=u[0],x=u[1],S=[0,0,0],O=[0,0,0],w=[0,0,0];for(this.dataX=[],this.dataY=[],b=0;b<3;b++)w[b]=P.evaluate(t[b]),S[b]=P.evaluate(s[b]),O[b]=P.evaluate(d[b]);for(n=g.Math.norm(S,3),p=g.Math.norm(O,3),b=0;b<3;b++)S[b]/=n,O[b]/=p;f=o.getMesh(function(T,M){return w[0]+T*S[0]+M*O[0]},function(T,M){return w[1]+T*S[1]+M*O[1]},function(T,M){return w[2]+T*S[2]+M*O[2]},[Math.ceil(C),Math.floor(_),(Math.ceil(_)-Math.floor(C))/1],[Math.ceil(E),Math.floor(x),(Math.ceil(x)-Math.floor(E))/1]),this.dataX=f[0],this.dataY=f[1]},e},g.registerElement("mesh3d",m.createMesh)}),define("3d/curve3d",["jxg","utils/type","3d/view3d"],function(g,P,y){y.createCurve=function(v,m,l){var c,h,e=m[0];return(c={elType:"curve3D",X:m[1],Y:m[2],Z:m[3]}).F=[c.X,c.Y,c.Z],(h=v.create("curve",[[],[]],l)).D3=c,P.isFunction(h.D3.X)?(h.D3.range=m[4],h.updateDataArray=function(){var o,t,s,a=P.evaluate(this.visProp.numberpointshigh),d=P.evaluate(this.D3.range[0]),u=P.evaluate(this.D3.range[1]),n=(u-d)/(a-1),p=[0,0,0];for(this.dataX=[],this.dataY=[],t=d;t<=u;t+=n){for(s=0;s<3;s++)p[s]=this.D3.F[s](t);o=e.project3DTo2D(p),this.dataX.push(o[1]),this.dataY.push(o[2])}}):P.isArray(h.D3.X)&&(h.updateDataArray=function(){var o,t,s=this.D3.X.length;for(this.dataX=[],this.dataY=[],o=0;o<s;o++)t=e.project3DTo2D([this.D3.X[o],this.D3.Y[o],this.D3.Z[o]]),this.dataX.push(t[1]),this.dataY.push(t[2])}),h},g.registerElement("curve3d",y.createCurve)}),define("3d/linspace3d",["jxg","utils/type","math/math","math/geometry","3d/view3d"],function(g,P,y,v,m){m.createLine=function(l,c,h){var e,o,t,s,a,d,u=c[0];return o={elType:"line3d",range:c[3]||[-1/0,1/0]},t=P.isPoint(c[1])?c[1]:u.create("point3d",c[1],{visible:!1,name:"",withLabel:!1}),o.point=t,P.isPoint(c[2])&&P.exists(c[2].D3)?(s=t,a=c[2],o.direction=function(){return[a.D3.X()-t.D3.X(),a.D3.Y()-t.D3.Y(),a.D3.Z()-t.D3.Z()]},o.range=[0,1]):(P.isFunction(c[2])?o.direction=c[2]:c[2].length===3?o.direction=[1].concat(c[2]):c[2].length===4&&(o.direction=c[2]),o.getPointCoords=function(n){var p,f=[],b=[];if(f.push(t.D3.X()),f.push(t.D3.Y()),f.push(t.D3.Z()),P.isFunction(o.direction))b=o.direction();else for(p=1;p<4;p++)b.push(P.evaluate(o.direction[p]));return Math.abs(n)===1/0&&(n=u.intersectionLineCube(f,b,n)),[f[0]+b[0]*n,f[1]+b[1]*n,f[2]+b[2]*n]},e=P.copyAttributes(h,l.options,"line3d","point1"),s=u.create("point3d",[function(){return o.getPointCoords(P.evaluate(o.range[0]))}],e),e=P.copyAttributes(h,l.options,"line3d","point2"),a=u.create("point3d",[function(){return o.getPointCoords(P.evaluate(o.range[1]))}],e)),e=P.copyAttributes(h,l.options,"line3d"),(d=u.create("segment",[s,a],e)).point1=s,d.point2=a,s.addChild(d),a.addChild(d),d.D3=o,d},g.registerElement("line3d",m.createLine),m.createPlane=function(l,c,h){var e,o,t,s,a,d=c[0],u=c[2],n=c[3];return o={elType:"plane3d",dir1:[],dir2:[],range1:c[4],range2:c[5],vec1:u,vec2:n},t=P.isPoint(c[1])?c[1]:d.create("point3d",c[1],{visible:!1,name:"",withLabel:!1}),o.point=t,o.updateNormal=function(){var p;for(p=0;p<3;p++)o.dir1[p]=P.evaluate(o.vec1[p]),o.dir2[p]=P.evaluate(o.vec2[p]);o.normal=y.crossProduct(o.dir1,o.dir2),o.d=y.innerProduct(o.point.D3.coords.slice(1),o.normal,3)},o.updateNormal(),e=P.copyAttributes(h,l.options,"plane3d"),(s=l.create("curve",[[],[]],e)).D3=o,s.updateDataArray=function(){var p,f,b,C,_,E,x,S,O,w,T,M,N,A,R=["xPlaneRear","yPlaneRear","zPlaneRear"],L=[],D=[0,0,0],k=[0,0,0],B=[0,0,0],I=[0,0,0];if(this.dataX=[],this.dataY=[],this.D3.updateNormal(),this.D3.elType==="axisplane3d"||!d.defaultAxes||o.range1&&o.range2){for(p=P.evaluate(this.D3.range1[0]),f=P.evaluate(this.D3.range1[1]),b=P.evaluate(this.D3.range2[0]),C=P.evaluate(this.D3.range2[1]),B=this.D3.point.D3.coords.slice(1),D=this.D3.dir1.slice(),k=this.D3.dir2.slice(),E=y.norm(D,3),x=y.norm(k,3),O=0;O<3;O++)D[O]/=E,k[O]/=x;for(w=0;w<4;w++){switch(w){case 0:T=p,M=b;break;case 1:T=f,M=b;break;case 2:T=f,M=C;break;case 3:T=p,M=C}for(O=0;O<3;O++)I[O]=B[O]+T*D[O]+M*k[O];_=d.project3DTo2D(I),this.dataX.push(_[1]),this.dataY.push(_[2])}this.dataX.push(this.dataX[0]),this.dataY.push(this.dataY[0])}else{for(w=0;w<R.length;w++){if((I=d.intersectionPlanePlane(this,d.defaultAxes[R[w]]))[0].length===3&&I[1].length===3){for(O=0;O<L.length&&!(v.distance(I[0],L[O][0],3)<y.eps&&v.distance(I[1],L[O][1],3)<y.eps||v.distance(I[0],L[O][1],3)<y.eps&&v.distance(I[1],L[O][0],3)<y.eps);O++);O===L.length&&L.push(I.slice())}if((I=[0,0,0])[w]=d.D3.bbox3d[w][1],S=y.innerProduct(I,d.defaultAxes[R[w]].D3.normal,3),(I=d.intersectionPlanePlane(this,d.defaultAxes[R[w]],S))[0].length===3&&I[1].length===3){for(O=0;O<L.length&&!(v.distance(I[0],L[O][0],3)<y.eps&&v.distance(I[1],L[O][1],3)<y.eps||v.distance(I[0],L[O][1],3)<y.eps&&v.distance(I[1],L[O][0],3)<y.eps);O++);O===L.length&&L.push(I.slice())}}N=0,O=0;do{for((I=L[N][O]).length===3&&(_=d.project3DTo2D(I),this.dataX.push(_[1]),this.dataY.push(_[2])),O=(O+1)%2,I=L[N][O],A=N,w=0;w<L.length;w++){if(w!==N&&v.distance(I,L[w][0])<y.eps){N=w,O=0;break}if(w!==N&&v.distance(I,L[w][1])<y.eps){N=w,O=1;break}}if(N===A){console.log("Error: update plane3d: did not find next",N);break}}while(N!==0);_=d.project3DTo2D(L[0][0]),this.dataX.push(_[1]),this.dataY.push(_[2])}},e=P.copyAttributes(h.mesh3d,l.options,"mesh3d"),o.range1&&o.range2&&(a=d.create("mesh3d",[t.D3.coords.slice(1),u,o.range1,n,o.range2],e),s.grid=a,s.inherits.push(a)),s},g.registerElement("plane3d",m.createPlane)}),define("3d/point3d",["jxg","base/constants","math/math","math/geometry","utils/type","3d/view3d"],function(g,P,y,v,m,l){l.createPoint=function(c,h,e){var o,t,s,a,d,u,n=h[0];if(o=m.copyAttributes(e,c.options,"point3d"),s={elType:"point3d",coords:[1,0,0,0],X:function(){return this.coords[1]},Y:function(){return this.coords[2]},Z:function(){return this.coords[3]}},h.length>2&&m.exists(h[h.length-1].D3)?s.slide=h.pop():s.slide=null,h.length===2)s.F=h[1],s.coords=[1].concat(m.evaluate(s.F));else if(h.length===4)for(s.F=h.slice(1),a=0;a<3;a++)s.coords[a+1]=m.evaluate(s.F[a]);return s.updateCoords=function(){var p,f;if(m.isFunction(this.F))p=m.evaluate(this.F),this.coords=[1,p[0],p[1],p[2]];else for(this.coords[0]=1,f=0;f<3;f++)m.isFunction(this.F[f])&&(this.coords[f+1]=m.evaluate(this.F[f]));return this},s.updateCoords(),d=n.project3DTo2D(s.coords),(u=c.create("point",d,o)).D3=s,u.D3.c2d=u.coords.usrCoords.slice(),t=u.update,u.D3.slide&&(u._minFunc=function(p,f,b,C){var _=u.D3.slide.D3,E=[1,_.X(b[0],b[1]),_.Y(b[0],b[1]),_.Z(b[0],b[1])],x=n.project3DTo2D(E);return C[0]=u.X()-x[1],C[1]=u.Y()-x[2],C[0]*C[0]+C[1]*C[1]},u.projectCoords2Surface=function(){var p,f,b=[0,0],C=this.D3.slide.D3;m.exists(this.D3.params)&&(b=this.D3.params.slice()),y.Nlp.FindMinimum(this._minFunc,2,2,b,5,1e-6,0,200),p=[1,C.X(b[0],b[1]),C.Y(b[0],b[1]),C.Z(b[0],b[1])],f=n.project3DTo2D(p),this.D3.params=b,this.D3.coords=p,this.coords.setCoordinates(P.COORDS_BY_USER,f),this.D3.c2d=f}),u.update=function(p){var f,b;return this.needsUpdate?(this.draggable()&&v.distance(this.D3.c2d,this.coords.usrCoords)!==0?this.D3.slide?this.projectCoords2Surface():(b=[1,0,0,this.D3.coords[3]],(f=n.project2DTo3DPlane(u,[1,0,0,1],b))[0]!==0&&(this.D3.coords=n.project3DToCube(f))):(this.D3.updateCoords(),u.coords.setCoordinates(P.COORDS_BY_USER,n.project3DTo2D([1,this.D3.X(),this.D3.Y(),this.D3.Z()]))),this.D3.c2d=u.coords.usrCoords.slice(),t.apply(this,[p]),this):this},u},g.registerElement("point3d",l.createPoint)}),define("3d/surface3d",["jxg","utils/type","3d/view3d"],function(g,P,y){y.createParametricSurface=function(v,m,l){var c,h,e,o=m[0];return h={elType:"surface3d",X:m[1],Y:m[2],Z:m[3],range_u:m[4],range_v:m[5]},c=P.copyAttributes(l,v.options,"surface3d"),(e=v.create("curve",[[],[]],c)).updateDataArray=function(){var t=P.evaluate(this.visProp.stepsu),s=P.evaluate(this.visProp.stepsv),a=o.getMesh(this.D3.X,this.D3.Y,this.D3.Z,this.D3.range_u.concat([t]),this.D3.range_v.concat([s]));this.dataX=a[0],this.dataY=a[1]},e.D3=h,e},g.registerElement("parametricsurface3d",y.createParametricSurface),y.createFunctiongraph=function(v,m,l){var c=m[0],h=m[1],e=m[2],o=m[3];return c.create("parametricsurface3d",[function(t,s){return t},function(t,s){return s},h,e,o],l)},g.registerElement("functiongraph3d",y.createFunctiongraph)}),define("../build/core.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/probfuncs","math/ia","math/extrapolate","math/qdt","math/numerics","math/nlp","math/plot","math/metapost","math/statistics","math/symbolic","math/geometry","math/clip","math/poly","math/complex","renderer/abstract","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/coordselement","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","parser/datasource","parser/jessiecode","parser/ca","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button","base/foreignobject","3d/box3d","3d/curve3d","3d/linspace3d","3d/point3d","3d/surface3d","3d/threed","3d/view3d"],function(g,P){return P.isBrowser?window.JXG=g:P.isNode()?module.exports=g:P.isWebWorker()&&(self.JXG=g),g}),require("../build/core.deps.js")})})(jsxgraphcore,jsxgraphcore.exports);var JXG$1=jsxgraphcore.exports;export{JXG$1 as J};
